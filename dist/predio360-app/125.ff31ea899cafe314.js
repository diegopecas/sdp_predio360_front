"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[125],{34013:(Ce,he,h)=>{h.d(he,{I:()=>L,b:()=>j});var C=h(62208),k=h(99770),Q=h(13934),$=h(78925),I=h(24255),Y=h(10109),te=h(67022),se=h(33726),me=h(2166),F=h(95285),B=h(65787),Z=h(17625),H=h(22355),P=h(35387),W=h(44835),x=h(16396);function j(R){const U=new H.kG,{vertex:V,fragment:A}=U;return(0,me.Sv)(V,R),U.include(I.w,R),U.attributes.add(x.T.POSITION,"vec3"),U.attributes.add(x.T.UV0,"vec2"),U.varyings.add("vpos","vec3"),R.hasMultipassTerrain&&U.varyings.add("depth","float"),V.uniforms.add(new F.A("textureCoordinateScaleFactor",S=>(0,C.pC)(S.texture)&&(0,C.pC)(S.texture.descriptor.textureCoordinateScaleFactor)?S.texture.descriptor.textureCoordinateScaleFactor:k.O)),V.code.add(Z.H`
    void main(void) {
      vpos = position;
      ${R.hasMultipassTerrain?"depth = (view * vec4(vpos, 1.0)).z;":""}
      vTexCoord = uv0 * textureCoordinateScaleFactor;
      gl_Position = transformPosition(proj, view, vpos);
    }
  `),U.include($.f5,R),U.include(Y.l,R),A.uniforms.add([new P.A("tex",S=>S.texture),new B.p("opacity",S=>S.opacity)]),U.varyings.add("vTexCoord","vec2"),R.output===Q.H.Alpha?A.code.add(Z.H`
    void main() {
      discardBySlice(vpos);
      ${R.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":""}

      float alpha = texture2D(tex, vTexCoord).a * opacity;
      if (alpha  < ${Z.H.float(te.F)}) {
        discard;
      }

      gl_FragColor = vec4(alpha);
    }
    `):(A.include(se.Y),A.code.add(Z.H`
    void main() {
      discardBySlice(vpos);
      ${R.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":""}
      gl_FragColor = texture2D(tex, vTexCoord) * opacity;

      if (gl_FragColor.a < ${Z.H.float(te.F)}) {
        discard;
      }

      gl_FragColor = highlightSlice(gl_FragColor, vpos);
      ${R.transparencyPassType===W.A.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}
    }
    `)),U}const L=Object.freeze(Object.defineProperty({__proto__:null,build:j},Symbol.toStringTag,{value:"Module"}))},93310:(Ce,he,h)=>{h.d(he,{S:()=>R,b:()=>x});var C=h(4794),k=h(81801),Q=h(13934),$=h(78925),I=h(24255),Y=h(10109),te=h(67022),se=h(33726),me=h(2166),F=h(97139),B=h(69960),Z=h(17625),H=h(22355),P=h(44835),W=h(16396);function x(U){const V=new H.kG,A=U.hasMultipassTerrain&&(U.output===Q.H.Color||U.output===Q.H.Alpha);V.include(I.w,U),V.include(k.A,U),V.include($.f5,U);const{vertex:S,fragment:G}=V;return G.include(se.Y),(0,me.Sv)(S,U),G.uniforms.add(new B.N("uColor",oe=>oe.color)),V.attributes.add(W.T.POSITION,"vec3"),V.varyings.add("vWorldPosition","vec3"),A&&V.varyings.add("depth","float"),U.screenSizeEnabled&&V.attributes.add(W.T.OFFSET,"vec3"),U.shadingEnabled&&((0,me._8)(S),V.attributes.add(W.T.NORMAL,"vec3"),V.varyings.add("vViewNormal","vec3")),S.code.add(Z.H`
    void main(void) {
      vWorldPosition = ${U.screenSizeEnabled?"screenSizeScaling(offset, position)":"position"};
  `),U.shadingEnabled&&S.code.add(Z.H`vec3 worldNormal = normal;
vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`),S.code.add(Z.H`
    ${A?"depth = (view * vec4(vWorldPosition, 1.0)).z;":""}
    gl_Position = transformPosition(proj, view, vWorldPosition);
  }
  `),A&&V.include(Y.l,U),G.code.add(Z.H`
    void main() {
      discardBySlice(vWorldPosition);
      ${A?"terrainDepthTest(gl_FragCoord, depth);":""}
    `),U.shadingEnabled?(G.uniforms.add(new F.J("shadingDirection",oe=>oe.shadingDirection)),G.uniforms.add(new B.N("shadedColor",oe=>function j(U,V){const A=1-U[3],S=U[3]+V[3]*A;return 0===S?(L[3]=S,L):(L[0]=(U[0]*U[3]+V[0]*V[3]*A)/S,L[1]=(U[1]*U[3]+V[1]*V[3]*A)/S,L[2]=(U[2]*U[3]+V[2]*V[3]*A)/S,L[3]=V[3],L)}(oe.shadingTint,oe.color))),G.code.add(Z.H`vec3 viewNormalNorm = normalize(vViewNormal);
float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
vec4 finalColor = mix(uColor, shadedColor, shadingFactor);`)):G.code.add(Z.H`vec4 finalColor = uColor;`),G.code.add(Z.H`
      ${U.output===Q.H.ObjectAndLayerIdColor?Z.H`finalColor.a = 1.0;`:""}
      if (finalColor.a < ${Z.H.float(te.b)}) {
        discard;
      }
      ${U.output===Q.H.Alpha?Z.H`gl_FragColor = vec4(finalColor.a);`:""}

      ${U.output===Q.H.Color?Z.H`gl_FragColor = highlightSlice(finalColor, vWorldPosition); ${U.transparencyPassType===P.A.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}`:""}
    }
    `),V}const L=(0,C.c)(),R=Object.freeze(Object.defineProperty({__proto__:null,build:x},Symbol.toStringTag,{value:"Module"}))},60507:(Ce,he,h)=>{h.d(he,{Jn:()=>te,RL:()=>me,VW:()=>Y,W_:()=>L,jG:()=>R,tR:()=>U,tq:()=>x,vQ:()=>H,zx:()=>P});var C=h(62208),k=h(29505);function Q(A){return A?R:U}function Y(A,S){return function $(A,S){return(0,C.Wi)(S)||!S.mode?Q(A).mode:S.mode}(!!(0,C.pC)(A)&&A.hasZ,S)}function te(A,S){return function I(A,S){return(0,C.pC)(S)?S:Q(A)}(!!(0,C.pC)(A)&&!!A.hasZ,S)}function me(A){const S=function B(A){return A.layer&&"elevationInfo"in A.layer?A.layer.elevationInfo:null}(A),G=Y(A.geometry,S);return{mode:G,offset:(0,C.pC)(S)&&"on-the-ground"!==G?(0,C.Pt)(S.offset,0)*(0,k.Z7)((0,C.Pt)(S.unit,"meters")):0}}function H(A,S,G,oe=null){return W(A,S.x,S.y,S.hasZ?S.z:0,S.spatialReference,G,oe)}function P(A,S,G,oe,ne=null){return W(A,S[0],S[1],S.length>2?S[2]:0,G,oe,ne)}function W(A,S,G,oe,ne,Oe,ue=null){if((0,C.Wi)(Oe))return;const de=(0,C.pC)(ue)?ue.mode:"absolute-height";if("on-the-ground"===de)return 0;const{absoluteZ:Me}=x(S,G,oe,ne,A,Oe);return function j(A,S,G,oe,ne,Oe,ue,de){const Me=(0,C.pC)(ue)&&(0,C.pC)(ue.offset)?ue.offset:0;switch(de){case"absolute-height":return A-Me;case"relative-to-ground":return A-((0,C.Pt)(Oe.elevationProvider.getElevation(S,G,oe,ne,"ground"),0)+Me);case"relative-to-scene":return A-((0,C.Pt)(Oe.elevationProvider.getElevation(S,G,oe,ne,"scene"),0)+Me)}}(Me,S,G,oe,ne,A,ue,de)}function x(A,S,G,oe,ne,Oe){const ue=(0,C.pC)(Oe.offset)?Oe.offset:0;switch(Oe.mode){case"absolute-height":return{absoluteZ:G+ue,elevation:0};case"on-the-ground":{const de=(0,C.Pt)(ne.elevationProvider.getElevation(A,S,0,oe,"ground"),0);return{absoluteZ:de,elevation:de}}case"relative-to-ground":{const de=(0,C.Pt)(ne.elevationProvider.getElevation(A,S,G,oe,"ground"),0);return{absoluteZ:G+de+ue,elevation:de}}case"relative-to-scene":{const de=(0,C.Pt)(ne.elevationProvider.getElevation(A,S,G,oe,"scene"),0);return{absoluteZ:G+de+ue,elevation:de}}}}function L(A,S){if((0,C.Wi)(S))return!1;const{mode:G}=S;return(0,C.pC)(G)&&("scene"===A&&"relative-to-scene"===G||"ground"===A&&"absolute-height"!==G)}const R={mode:"absolute-height",offset:0},U={mode:"on-the-ground",offset:null}},1437:(Ce,he,h)=>{h.d(he,{p:()=>me});var C=h(17626),k=h(54024),Q=h(62208),$=h(60330),I=h(77712),se=(h(90912),h(85931),h(76898));const me=F=>{let B=class extends((0,$.v)(F)){constructor(){super(...arguments),this.parent=null,this._userInteractive=!1,this._interactiveViewModelCount=0}get interactive(){return this._interactiveViewModelCount>0||this._userInteractive}set interactive(Z){this._userInteractive=Z}get updating(){return!1}get visible(){return!(0,Q.pC)(this.parent)||this.parent.visible&&!this.parent.suspended}set visible(Z){this._overrideIfSome("visible",Z)}forceInteractiveForViewModel(){return this._interactiveViewModelCount++,(0,k.kB)(()=>this._interactiveViewModelCount--)}};return(0,C._)([(0,I.Cb)({readOnly:!0})],B.prototype,"type",void 0),(0,C._)([(0,I.Cb)({constructOnly:!0})],B.prototype,"analysis",void 0),(0,C._)([(0,I.Cb)({constructOnly:!0})],B.prototype,"parent",void 0),(0,C._)([(0,I.Cb)({constructOnly:!0})],B.prototype,"view",void 0),(0,C._)([(0,I.Cb)({type:Boolean})],B.prototype,"interactive",null),(0,C._)([(0,I.Cb)()],B.prototype,"_userInteractive",void 0),(0,C._)([(0,I.Cb)({readOnly:!0})],B.prototype,"updating",null),(0,C._)([(0,I.Cb)()],B.prototype,"visible",null),(0,C._)([(0,I.Cb)()],B.prototype,"_interactiveViewModelCount",void 0),B=(0,C._)([(0,se.j)("esri.views.3d.analysis.AnalysisView3D")],B),B}},54865:(Ce,he,h)=>{h.d(he,{G:()=>$,e:()=>I});var C=h(62208),k=h(55915),Q=h(53929);function $(Y,te,se,me=!1){const F=(0,k.fM)(Y,te);return(0,C.Wi)(F)?null:(F.hasZ&&!me||!(0,C.pC)(se)||(F.z=(0,C.Pt)((0,Q.KO)(se,F),0)),F)}function I(Y,te,se){se.warnOnce(`Failed to project analysis geometry (id: '${Y.id}'), projection from spatial reference (wkid: '${te.wkid}') to view spatial reference is not supported. Projection may be possible after calling projection.load().`)}},45403:(Ce,he,h)=>{h.d(he,{Z:()=>le}),h(29132);var k=h(94573),Q=h(61885),$=h(21286),I=h(62208),Y=h(23841),te=h(52323),se=h(30217),me=h(550),F=h(28347),B=h(43703),Z=h(67831),H=h(84161),P=h(28093),W=h(92383),x=h(55915),j=h(65401),L=h(13777),R=h(90014),U=h(70562),V=h(26242),A=h(84786),S=h(53929),G=h(26046),oe=h(59598),ne=h(97272),Oe=h(23147),ue=h(34103),de=h(33786),Me=h(72642);class le{constructor(_){this.metadata=void 0,this._camera=new oe.V,this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=new Array,this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=(0,B.c)(),this._worldFrame=null,this._renderLocation=(0,P.c)(),this._renderLocationDirty=!0,this._location=new Me.Z({x:0,y:0,z:0}),this._elevationAlignedLocation=new Me.Z,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this.grabCursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=de.jg.None,this._focused=!1,this.events=new Q.Z.EventEmitter,this._screenLocation={screenPointArray:(0,Y.s1)(),renderScreenPointArray:(0,Y.J$)(),pixelSize:0},this._screenLocationDirty=!0,this._engineResourcesAddedToStage=!1,this._attached=!1,this._location.spatialReference=_.view.spatialReference;for(const b in _)this[b]=_[b];const y=this.view.state?.camera;y&&this._camera.copyFrom(y)}destroy(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this._camera=null}get _stage(){return this.view?._stage}get elevationInfo(){return this._elevationInfo}set elevationInfo(_){this._elevationInfo=_,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(_){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=_.slice(),this._updateEngineObject()}set available(_){_!==this._available&&(this._available=_,this._updateEngineObject())}get available(){return this._available}disableDisplay(){return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:(0,te.IH)(()=>{this._noDisplayCount--,0===this._noDisplayCount&&this._updateEngineObject()})}}set radius(_){_!==this._radius&&(this._radius=_,this._updateEngineObject())}get radius(){return this._radius}set worldSized(_){_!==this._worldSized&&(this._worldSized=_,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(_){ye(_)&&(this._screenLocationDirty=!0),(0,F.c)(this._modelTransform,_),this._updateEngineObject()}get renderLocation(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=(0,B.c)()),function Ae(T,_,y){switch(T.viewingMode){case"local":return(0,F.i)(y),!0;case"global":{const b=(0,W.Iu)(T.renderCoordsHelper.spatialReference);(0,x.PR)(_,0,be,0,b.radius),(0,x.yH)((0,$.Vl)(be[0]),(0,$.Vl)(be[1]),y)}}}(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation}set renderLocation(_){this.view.renderCoordsHelper.fromRenderCoords(_,this._location),this.elevationAlignedLocation=this._location}get location(){return this._location}set location(_){(0,A.WG)(_,this._location),this._notifyLocationChanged()}_notifyLocationChanged(){this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}get elevationAlignedLocation(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation}set elevationAlignedLocation(_){(0,A.WG)(_,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}_updateElevationAlignedLocation(){const _=(0,I.pC)(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y,this._elevationAlignedLocation.z=_+this._elevation.offset,this._elevationAlignedLocation.spatialReference=(0,A.D)(this.location.spatialReference),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(_){_!==this._grabbing&&(this._grabbing=_,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(_){_!==this._hovering&&(this._hovering=_,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(_){_!==this._selected&&(this._selected=_,this._updateEngineObject(),this.events.emit("select-changed",{action:_?"select":"deselect"}))}get state(){return this._state}set state(_){_!==this._state&&(this._state=_,this._updateEngineObject())}updateStateEnabled(_,y){y?this.state|=_:this.state&=~_}_setFocused(_){_!==this._focused&&(this._focused=_,this.events.emit("focus-changed",{action:!0===_?"focus":"unfocus"}))}get focused(){return this._focused}get screenLocation(){return this._ensureScreenLocation(),this._screenLocation}_ensureScreenLocation(){if(!this._screenLocationDirty)return;let _;if(this._screenLocation.pixelSize=this._camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1,ye(this._modelTransform)){const y=this._calculateModelTransformOffset(E);_=(0,H.a)(y,y,this.renderLocation)}else _=this.renderLocation;this._camera.projectToRenderScreen(_,this._screenLocation.renderScreenPointArray),this._camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(_){this._applyObjectTransform=_,this._screenLocationDirty=!0,this._updateEngineObject()}get attached(){return this._attached}intersectionDistance(_,y){if(!this.available)return null;const b=(0,Y.md)(_,q),K=this._getCollisionRadius(y),X=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if((0,Z.k)(this.screenLocation.screenPointArray,b)<K*K)return this.screenLocation.renderScreenPointArray[2]+X;break;case"line":{const z=this.collisionType.paths,ae=this._getWorldToScreenObjectScale(),ce=this._calculateObjectTransform(ae,re),Ee=K*this.screenLocation.pixelSize,ve=(0,G.u4)(this._camera,b,ie);if((0,I.Wi)(ve))return null;for(const fe of z){if(0===fe.length)continue;const pe=(0,H.m)(be,fe[0],ce);for(let De=1;De<fe.length;De++){const Pe=(0,H.m)(Re,fe[De],ce),Te=(0,L.Gr)((0,L.zk)(pe,Pe,ee),ve);if(null!=Te&&Te<Ee*Ee){const _e=(0,H.a)(V.WM.get(),pe,Pe);(0,H.g)(_e,_e,.5);const Le=(0,Y.So)(V.WM.get());return this._camera.projectToRenderScreen(_e,Le),Le[2]+X}(0,H.c)(pe,Pe)}}break}case"disc":{const z=this.collisionType.direction,ae=this.collisionType.offset??P.Z,ce=this._getWorldToScreenObjectScale(),Ee=this._calculateObjectTransform(ce,re),ve=K*this.screenLocation.pixelSize,fe=(0,G.u4)(this._camera,b,ie);if((0,I.Wi)(fe))return null;const pe=(0,se.f)(N,Ee),De=(0,H.t)(v,z,pe),Pe=(0,H.m)(D,ae,Ee);(0,R.Yq)(Pe,De,ge);const Te=Se;if((0,R.BR)(ge,fe,Te)&&(0,H.d)(Te,Pe)<ve*ve)return this.screenLocation.renderScreenPointArray[2]+X;break}case"ribbon":{const{paths:z,direction:ae}=this.collisionType,ce=this._getWorldToScreenObjectScale(),Ee=this._calculateObjectTransform(ce,re),ve=K*this._camera.computeScreenPixelSizeAt(this.renderLocation),fe=(0,G.u4)(this._camera,b,ie);if((0,I.Wi)(fe))return null;const pe=(0,se.f)(N,Ee),De=(0,H.t)(v,ae,pe),Pe=this._calculateModelTransformPosition(D);(0,R.Yq)(Pe,De,ge);const Te=Se;if(!(0,R.BR)(ge,fe,Te))break;for(const _e of z){if(0===_e.length)continue;const Le=(0,H.m)(be,_e[0],Ee);for(let je=1;je<_e.length;je++){const Ie=(0,H.m)(Re,_e[je],Ee),We=(0,L.Jk)((0,L.zk)(Le,Ie,ee),Te);if(null!=We&&We<ve*ve){const xe=(0,H.a)(V.WM.get(),Le,Ie);(0,H.g)(xe,xe,.5);const Ue=(0,Y.So)(V.WM.get());return this._camera.projectToRenderScreen(xe,Ue),Ue[2]+X}(0,H.c)(Le,Ie)}}break}default:(0,k.Bg)(this.collisionType)}return null}attach(_={manipulator3D:{}}){const y=this._stage;if(!y)return;const b=_.manipulator3D;if((0,I.Wi)(b.engineLayerId)){const K=new ue.F({pickable:!1,updatePolicy:Oe.j.SYNC});y.add(K),b.engineLayerId=K.id,this._engineLayer=K}else y?.getObject&&(this._engineLayer=y.getObject(b.engineLayerId));b.engineLayerReferences=(b.engineLayerReferences||0)+1,this._materialIdReferences=b.materialIdReferences,(0,I.Wi)(this._materialIdReferences)&&(this._materialIdReferences=new Map,b.materialIdReferences=this._materialIdReferences),this._camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),(0,x.Up)(this._location.spatialReference,this.view.spatialReference)||(this.location=new Me.Z({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}detach(_={manipulator3D:{}}){const y=_.manipulator3D;y.engineLayerReferences--;const b=0===y.engineLayerReferences;b&&(y.engineLayerId=null),this._removeResourcesFromStage(b),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}onViewChange(){this._camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}onElevationChange(_){(0,x.nF)(this.location,g,_.spatialReference)&&(0,j.Qn)(_.extent,g)&&this._notifyLocationChanged()}_evaluateElevationAlignment(){if((0,I.Wi)(this.elevationInfo))return;let _=null,y=0;const b=(0,I.Pt)(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case"on-the-ground":_=(0,I.Pt)((0,S.KO)(this.view.elevationProvider,this.location,"ground"),0);break;case"relative-to-ground":y=(0,I.Pt)((0,S.KO)(this.view.elevationProvider,this.location,"ground"),0)+b;break;case"relative-to-scene":y=(0,I.Pt)((0,S.KO)(this.view.elevationProvider,this.location,"scene"),0)+b;break;case"absolute-height":y=b}return y!==this._elevation.offset||_!==this._elevation.override?(this._elevation.offset=y,void(this._elevation.override=_)):void 0}_updateEngineObject(){if(!this._attached)return;if(!this.available)return void this._removeResourcesFromStage();const _=this._getWorldToScreenObjectScale(),y=re;if(!0===this.autoScaleRenderObjects){const z=this._getFocusedSize(this._radius,this.focused)*_;this._calculateObjectTransform(z,y)}else this._calculateObjectTransform(_,y);const{objectsByState:b}=this._ensureEngineResources(),K=(this.focused?de.Q9.Focused:de.Q9.Unfocused)|(this.selected?de.Q9.Selected:de.Q9.Unselected),X=this._noDisplayCount>0;for(const{stateMask:z,objects:ae}of b)if(X)for(const pe of ae)pe.visible=!1;else if((z&de.Q9.All)!==de.Q9.None&&(K&z)!=(z&de.Q9.All)||(z&de.jg.All)!==de.jg.None&&(this.state&z)!=(z&de.jg.All))for(const pe of ae)pe.visible=!1;else for(const pe of ae)pe.visible=!0,pe.transformation=y}_ensureEngineResources(){if((0,I.Wi)(this._engineResources)){const _=(0,I.Wg)(this._engineLayer),y=[],b=new Set;this.renderObjects.forEach(({geometry:{material:z}})=>{b.has(z)||(y.push(z),b.add(z))});const K=new Map;this._renderObjects.forEach(z=>{const ae=new ne.T({castShadow:!1,geometries:[z.geometry]}),ce=K.get(z.stateMask)||[];ce.push(ae),K.set(z.stateMask,ce)});const X=[];K.forEach((z,ae)=>X.push({stateMask:ae,objects:z})),this._engineResources={objectsByState:X,layer:_,materials:y}}return this._addResourcesToStage(),this._engineResources}_addResourcesToStage(){const _=this._stage;if(this._engineResourcesAddedToStage||(0,I.Wi)(this._engineResources)||!_)return;const{objectsByState:y,layer:b,materials:K}=this._engineResources;K.forEach(X=>{const z=(0,I.Wg)(this._materialIdReferences),ae=z.get(X.id)||0;0===ae&&_.add(X),z.set(X.id,ae+1)}),y.forEach(({objects:X})=>{b.addMany(X),_.addMany(X)}),this._engineResourcesAddedToStage=!0}_removeResourcesFromStage(_=!1){const y=this._stage;if(!this._engineResourcesAddedToStage||(0,I.Wi)(this._engineResources)||!y)return;const{objectsByState:b,layer:K,materials:X}=this._engineResources;b.forEach(({objects:z})=>{K.removeMany(z),y.removeMany(z)}),X.forEach(z=>{const ae=(0,I.Wg)(this._materialIdReferences),ce=ae.get(z.id);1===ce?(y.remove(z),ae.delete(z.id)):ae.set(z.id,ce-1)}),_&&y.remove(K),this._engineResourcesAddedToStage=!1}_getCollisionRadius(_){return this._getFocusedSize(this.radius,!0)*("touch"===_?this.touchMultiplier:1)}_getFocusedSize(_,y){return _*(y?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(_){const y=this._getWorldToScreenObjectScale(),b=this._calculateObjectTransform(y,J);return(0,H.s)(_,b[12],b[13],b[14])}_calculateModelTransformOffset(_){const y=this._calculateModelTransformPosition(_);return(0,H.b)(_,y,this.renderLocation)}_calculateObjectTransform(_,y){return(0,F.s)(y,_,0,0,0,0,_,0,0,0,0,_,0,0,0,0,1),this._worldFrame&&(0,F.m)(y,y,this._worldFrame),(0,F.m)(y,y,this._modelTransform),y[12]+=this.renderLocation[0],y[13]+=this.renderLocation[1],y[14]+=this.renderLocation[2],y[15]=1,(0,I.pC)(this._applyObjectTransform)&&this._applyObjectTransform(y),y}get test(){let _=!1;if((0,I.pC)(this._engineResources))for(const y in this._engineResources.objectsByState){const b=this._engineResources.objectsByState[y];for(const K of b.objects)if(K.visible){_=!0;break}if(_)break}return{areAnyResourcesVisible:_}}}function ye(T){return 0!==T[12]||0!==T[13]||0!==T[14]}const q=(0,Y.s1)(),ee=(0,L.Ue)(),ie=(0,U.Ue)(),N=(0,me.c)(),J=(0,B.c)(),re=(0,B.c)(),ge=(0,R.Ue)(),be=(0,P.c)(),Re=(0,P.c)(),Se=(0,P.c)(),v=(0,P.c)(),D=(0,P.c)(),E=(0,P.c)(),g=new Me.Z({x:0,y:0,z:0,spatialReference:null})},40345:(Ce,he,h)=>{h.d(he,{r:()=>k});var C=h(33786);class k{constructor($,I=C.Q9.None){this.geometry=$,this.stateMask=I}}},19142:(Ce,he,h)=>{h.d(he,{Aq:()=>Me,Bz:()=>ne,EA:()=>A,Gd:()=>de,Ju:()=>oe,X9:()=>ue,aD:()=>Oe});var C=h(28347),k=h(84161),Q=h(28093),$=h(4794),I=h(26242),te=(h(84786),h(45403)),se=h(40345),F=(h(67225),h(94255)),B=h(42743),Z=h(41120),H=h(57521),P=h(40723),W=h(16396),x=h(92972),j=h(79967),L=h(49580),R=h(92222),U=h(81040),V=h(33786);function A(q,ee=P.yD.OccludeAndTransparent,ie=!0){const N=(0,$.f)(q[0],q[1],q[2],q.length>3?q[3]:1),J=q[3]<1;return ie?new U.Q({color:N,transparent:J,writeDepth:!0,cullFace:B.Vr.Back,renderOccluded:ee}):new x.E({color:N,transparent:J,writeDepth:!0,cullFace:B.Vr.Back,renderOccluded:ee})}const G=Object.freeze({calloutLength:40,calloutWidth:1,discRadius:27,focusMultiplier:1.1,calloutColor:(0,Q.f)(1,.5,0)});function oe(q,ee){const ie=new te.Z({view:q,autoScaleRenderObjects:!1,collisionPriority:1,metadata:ee.metadata});return ne(ie,ee),ie}function ne(q,ee){const ie=ee.material??new j.j({transparent:!0,writeDepth:!1,textureId:ee.texture?.id,renderOccluded:P.yD.Opaque}),N=ee.focusMultiplier??G.focusMultiplier,J=ee.calloutLength??G.calloutLength,re=G.discRadius*(ee.discScale??1),ge=re*N,be=(T,_)=>{const y=[0,1,2,2,3,0];return new Z.Z(_,[[W.T.POSITION,new F.a([J-T,-T,0,J+T,-T,0,J+T,T,0,J-T,T,0],3,!0)],[W.T.UV0,new F.a([0,0,1,0,1,1,0,1],2,!0)]],[[W.T.POSITION,y],[W.T.UV0,y]])},Re=G.calloutColor,Se=ee.calloutWidth??G.calloutWidth,v=new(Se>1?R.U:L.Y)({width:Se,color:(0,$.f)(Re[0],Re[1],Re[2],ee.calloutOpacity??1),renderOccluded:P.yD.OccludeAndTransparent}),D=(0,H.rh)(v,[[0,0,0],[J-re,0,0]]),E=(0,H.rh)(v,[[0,0,0],[J-ge,0,0]]),g=ee.customStateMask??V.jg.None;q.collisionType={type:"disc",direction:[0,0,1],offset:[J,0,0]},q.focusMultiplier=N,q.metadata=ee.metadata,q.radius=re,q.renderObjects=[new se.r(be(re,ie),V.Q9.Unfocused|g),new se.r(D,V.Q9.Unfocused|g),new se.r(be(ge,ie),V.Q9.Focused|g),new se.r(E,V.Q9.Focused|g)]}function Oe(q,ee,ie=1,N=V.jg.None){const J=A((0,$.f)(ee[0],ee[1],ee[2],ie??1)),re=[new se.r((0,H.PI)(J,1,32,32),N)];return new te.Z({view:q,renderObjects:re})}const ue=Object.freeze({autoScaleRenderObjects:!1,worldSized:!0});function de(q,ee,ie,N){const J=(0,k.b)(I.WM.get(),q,ie),re=Me(J,(0,k.f)(I.WM.get(),N,J),ie,I.MP.get());(0,C.a)(re,re);const ge=(0,k.m)(I.WM.get(),ee,re);return Math.atan2(ge[1],ge[0])}function Me(q,ee,ie,N){const J=(0,k.n)(I.WM.get(),q),re=(0,k.n)(I.WM.get(),ee),ge=(0,k.f)(I.WM.get(),J,re);return N[0]=J[0],N[1]=J[1],N[2]=J[2],N[3]=0,N[4]=re[0],N[5]=re[1],N[6]=re[2],N[7]=0,N[8]=ge[0],N[9]=ge[1],N[10]=ge[2],N[11]=0,N[12]=ie[0],N[13]=ie[1],N[14]=ie[2],N[15]=1,N}},87469:(Ce,he,h)=>{h.d(he,{r:()=>B});var C=h(62208),k=h(28347),Q=h(43703),$=h(84161),I=h(28093),Y=h(4794),te=h(53928),se=h(79020),me=h(40723),F=h(92222);class B extends te._{constructor(P,W){super(P),this._hasExternalMaterial=!1,this._hasExternalMaterial=(0,C.pC)(W),this._material=(0,C.pC)(W)?W:new F.U({width:1,color:(0,Y.f)(1,0,1,1),stippleOffColor:null,stipplePattern:null,stipplePreferContinuous:!0,isClosed:!1,falloff:0,innerColor:null,innerWidth:1,hasPolygonOffset:!1,renderOccluded:me.yD.OccludeAndTransparent,writeDepth:!0}),this.applyProps(P)}setGeometryFromRenderSpacePoint(P,W=1e3){this.geometry=[[[P[0]-W,P[1]+0,P[2]+0],[P[0]+W,P[1]+0,P[2]+0]],[[P[0]-0,P[1]-W,P[2]+0],[P[0]+0,P[1]+W,P[2]+0]],[[P[0]-0,P[1]+0,P[2]-W],[P[0]+0,P[1]+0,P[2]+W]]]}setGeometryFromExtent(P){const W=this.view.spatialReference,x=(0,I.c)(),j=(0,I.c)(),L=100,R=[];(0,$.s)(x,P[0],P[1],L),this.view.renderCoordsHelper.toRenderCoords(x,W,j),R.push([j[0],j[1],j[2]]),(0,$.s)(x,P[2],P[1],L),this.view.renderCoordsHelper.toRenderCoords(x,W,j),R.push([j[0],j[1],j[2]]),(0,$.s)(x,P[2],P[3],L),this.view.renderCoordsHelper.toRenderCoords(x,W,j),R.push([j[0],j[1],j[2]]),(0,$.s)(x,P[0],P[3],L),this.view.renderCoordsHelper.toRenderCoords(x,W,j),R.push([j[0],j[1],j[2]]),(0,$.s)(x,P[0],P[1],L),this.view.renderCoordsHelper.toRenderCoords(x,W,j),R.push([j[0],j[1],j[2]]),(0,$.s)(x,P[0],P[1],L),this.view.renderCoordsHelper.toRenderCoords(x,W,j),R.push([j[0],j[1],j[2]]),this.geometry=[R]}setGeometryFromFrustum(P){const W=[];P.lines.forEach(x=>{W.push([x.origin[0],x.origin[1],x.origin[2]]),W.push([x.endpoint[0],x.endpoint[1],x.endpoint[2]])}),this.geometry=[W]}setGeometryFromBoundedPlane(P){const W=[],x=P.origin,j=P.basis1,L=P.basis2,R=.5,U=(0,I.c)(),V=(0,I.c)(),A=(0,I.c)(),S=(0,I.c)();U[0]=x[0]-j[0]*R-L[0]*R,U[1]=x[1]-j[1]*R-L[1]*R,U[2]=x[2]-j[2]*R-L[2]*R,V[0]=x[0]-j[0]*R+L[0]*R,V[1]=x[1]-j[1]*R+L[1]*R,V[2]=x[2]-j[2]*R+L[2]*R,A[0]=x[0]+j[0]*R+L[0]*R,A[1]=x[1]+j[1]*R+L[1]*R,A[2]=x[2]+j[2]*R+L[2]*R,S[0]=x[0]+j[0]*R-L[0]*R,S[1]=x[1]+j[1]*R-L[1]*R,S[2]=x[2]+j[2]*R-L[2]*R,W.push([U[0],U[1],U[2]]),W.push([V[0],V[1],V[2]]),W.push([A[0],A[1],A[2]]),W.push([S[0],S[1],S[2]]),W.push([U[0],U[1],U[2]]),this.geometry=[W]}setGeometryFromSegment(P){const W=P.endRenderSpace;this.transform=(0,k.f)(Z,W);const{points:x}=P.createRenderGeometry(W,this.view.renderCoordsHelper);this.geometry=[x]}setGeometryFromSegments(P,W=I.Z){this.transform=(0,k.f)(Z,W),this.geometry=P.map(x=>x.createRenderGeometry(W,this.view.renderCoordsHelper).points)}getTransformedGeometry(){return(0,C.Wi)(this._geometry)?null:this._geometry.map(P=>P.map(W=>(0,$.m)((0,I.c)(),W,this.transform)))}get renderOccluded(){return this._material.parameters.renderOccluded}set renderOccluded(P){this._material.setParameters({renderOccluded:P})}get geometry(){return this._geometry}set geometry(P){this._geometry=P,this.recreateGeometry()}get width(){return this._material.parameters.width}set width(P){this._material.setParameters({width:P})}get color(){return this._material.parameters.color}set color(P){this._material.setParameters({color:(0,Y.d)(P)})}get innerWidth(){return this._material.parameters.innerWidth}set innerWidth(P){this._material.setParameters({innerWidth:P})}get innerColor(){return this._material.parameters.innerColor}set innerColor(P){this._material.setParameters({innerColor:(0,C.pC)(P)?(0,Y.d)(P):null})}get stipplePattern(){return this._material.parameters.stipplePattern}set stipplePattern(P){(0,C.pC)(this._material)&&this._material.setParameters({stipplePattern:P})}get stippleOffColor(){return this._material.parameters.stippleOffColor}set stippleOffColor(P){this._material.setParameters({stippleOffColor:(0,C.pC)(P)?(0,Y.d)(P):null})}get stipplePreferContinuous(){return this._material.parameters.stipplePreferContinuous}set stipplePreferContinuous(P){this._material.setParameters({stipplePreferContinuous:P})}get writeDepthEnabled(){return this._material.parameters.writeDepth}set writeDepthEnabled(P){this._material.setParameters({writeDepth:P})}get falloff(){return this._material.parameters.falloff}set falloff(P){this._material.setParameters({falloff:P})}get polygonOffset(){return this._material.parameters.hasPolygonOffset}set polygonOffset(P){this._material.setParameters({hasPolygonOffset:P})}createExternalResources(){}destroyExternalResources(){}createGeometries(P){for(const W of(0,se.c)(this.geometry)){const x=(0,se.Y)((0,C.Wg)(this._material),W);P.addGeometry(x)}}forEachExternalMaterial(P){this._hasExternalMaterial||P((0,C.Wg)(this._material))}}const Z=(0,Q.c)()},53928:(Ce,he,h)=>{h.d(he,{_:()=>se});var C=h(62208),k=h(28347),Q=h(43703),$=h(68604),I=h(97272),Y=h(23147),te=h(34103);class se extends $.l{constructor(F){super(F.view),this._resources=null,this._transform=(0,Q.c)()}get object(){return(0,C.pC)(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(F){(0,k.c)(this._transform,F),(0,C.pC)(this._resources)&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if((0,C.Wi)(this._resources))return;const F=this._resources.object,B=this.view._stage;B.removeMany(F.geometries),F.removeAllGeometries(),this.createGeometries(F),F.visible=this.visible,B.addMany(F.geometries)}createResources(){this.destroyResources();const F=this.view._stage;if(!F)return;const B=new te.F({pickable:!1,updatePolicy:Y.j.SYNC});F.add(B);const Z=new I.T({castShadow:!1});Z.transformation=this._transform,this.createExternalResources(),this.createGeometries(Z),F.addMany(Z.geometries),this.forEachExternalMaterial(H=>F.add(H)),F.add(Z),B.add(Z),Z.visible=this.visible,this._resources={layer:B,object:Z}}destroyResources(){const F=this.view._stage;!(0,C.Wi)(this._resources)&&F&&(F.remove(this._resources.object),F.remove(this._resources.layer),this.forEachExternalMaterial(B=>{F.remove(B),B.dispose()}),F.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(F){(0,C.Wi)(this._resources)||(this._resources.object.visible=F)}}},68604:(Ce,he,h)=>{h.d(he,{l:()=>k});var C=h(32917);class k{constructor($){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=$,this._handle=(0,C.YP)(()=>this.view.ready,I=>{this._resourcesCreated&&(I?this._createResources():this._destroyResources())})}applyProps($){let I=!1;for(const Y in $)Y in this?"attached"===Y?I=$[Y]:this[Y]=$[Y]:console.error("Cannot set unknown property",Y);this.attached=I}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached($){$!==this._attached&&this.view._stage&&(this._attached=$,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange($))}onAttachedChange($){}get visible(){return this._visible}set visible($){$!==this._visible&&(this._visible=$,this.attached&&this.updateVisibility($))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}},81801:(Ce,he,h)=>{h.d(he,{A:()=>$});var C=h(2166),k=h(65787),Q=h(17625);function $(I,Y){if(!Y.screenSizeEnabled)return;const te=I.vertex;(0,C.hY)(te,Y),te.uniforms.add(new k.p("perScreenPixelRatio",(se,me)=>me.camera.perScreenPixelRatio)),te.uniforms.add(new k.p("screenSizeScale",se=>se.screenSizeScale)),te.code.add(Q.H`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));
return viewDirectionDistance * perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;
}`)}},79967:(Ce,he,h)=>{h.d(he,{j:()=>Oe});var C=h(13934),k=h(42743),Q=h(33470),$=h(40723),I=h(88569),Y=h(5894),te=h(2770),se=h(66131),me=h(15842),F=h(17626),Z=(h(17625),h(651)),H=h(91056),P=h(87601),W=h(39114),x=h(12407),j=h(64127),L=h(44835),R=h(41528),U=h(34013),V=h(67969),A=h(2078);class G extends H.A{initializeProgram(le){return new x.$(le.rctx,G.shader.get().build(this.configuration),W.i)}_setPipelineState(le,ye){const Ae=this.configuration,q=le===L.A.NONE,ee=le===L.A.FrontFace;return(0,A.sm)({blending:Ae.output!==C.H.Color&&Ae.output!==C.H.Alpha||!Ae.transparent?null:q?oe:(0,I.j7)(le),culling:(0,A.zp)(Ae.cullFace),depthTest:{func:(0,I.Bh)(le)},depthWrite:q?Ae.writeDepth?A.LZ:null:(0,I.K5)(le),colorWrite:A.BK,stencilWrite:Ae.hasOccludees?j.s3:null,stencilTest:Ae.hasOccludees?ye?j.eD:j.RY:null,polygonOffset:q||ee?null:(0,I.je)(Ae.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(le,ye){return ye?this._occludeePipelineState:super.getPipelineState(le,ye)}}G.shader=new Z.J(U.I,()=>h.e(8586).then(h.bind(h,18586)));const oe=(0,A.if)(V.zi.ONE,V.zi.ONE_MINUS_SRC_ALPHA);class ne extends R.W{constructor(){super(...arguments),this.output=C.H.Color,this.cullFace=k.Vr.None,this.hasSlicePlane=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.transparencyPassType=L.A.NONE,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}}(0,F._)([(0,P.o)({count:C.H.COUNT})],ne.prototype,"output",void 0),(0,F._)([(0,P.o)({count:k.Vr.COUNT})],ne.prototype,"cullFace",void 0),(0,F._)([(0,P.o)()],ne.prototype,"hasSlicePlane",void 0),(0,F._)([(0,P.o)()],ne.prototype,"transparent",void 0),(0,F._)([(0,P.o)()],ne.prototype,"enableOffset",void 0),(0,F._)([(0,P.o)()],ne.prototype,"writeDepth",void 0),(0,F._)([(0,P.o)()],ne.prototype,"hasOccludees",void 0),(0,F._)([(0,P.o)({count:L.A.COUNT})],ne.prototype,"transparencyPassType",void 0),(0,F._)([(0,P.o)()],ne.prototype,"hasMultipassTerrain",void 0),(0,F._)([(0,P.o)()],ne.prototype,"cullAboveGround",void 0);class Oe extends me.c{constructor(le){super(le,new de),this.supportsEdges=!0,this._configuration=new ne}getConfiguration(le,ye){return this._configuration.output=le,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=ye.transparencyPassType,this._configuration.enableOffset=ye.camera.relativeElevation<I.ve,this._configuration.hasMultipassTerrain=ye.multipassTerrain.enabled,this._configuration.cullAboveGround=ye.multipassTerrain.cullAboveGround,this._configuration}requiresSlot(le,ye){return!(ye!==C.H.Color&&ye!==C.H.Alpha&&ye!==C.H.Highlight||le!==Y.r.DRAPED_MATERIAL&&(ye===C.H.Highlight?le!==Y.r.OPAQUE_MATERIAL:le!==(this.parameters.transparent?this.parameters.writeDepth?Y.r.TRANSPARENT_MATERIAL:Y.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:Y.r.OPAQUE_MATERIAL)))}createGLMaterial(le){return new ue(le)}createBufferWriter(){return new te.G(se.W1)}}class ue extends Q.F{constructor(le){super({...le,...le.material.parameters})}_updateParameters(le){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(G,le)}_updateOccludeeState(le){le.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:le.hasOccludees}),this._updateParameters(le))}beginSlot(le){return this._output!==C.H.Color&&this._output!==C.H.Alpha||this._updateOccludeeState(le),this._updateParameters(le)}}class de extends $.Mt{constructor(){super(...arguments),this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=k.Vr.None,this.hasOccludees=!1,this.opacity=1,this.textureId=null,this.initTextureTransparent=!0}}},81040:(Ce,he,h)=>{h.d(he,{Q:()=>Me});var C=h(84161),k=h(28093),Q=h(4794),$=h(5548),I=h(60479),Y=h(19625),te=h(13934),se=h(42743),me=h(60881),F=h(40723),B=h(5894),Z=h(2282),H=h(16396),P=h(42037),W=h(57623),x=h(17626),j=h(651),L=h(91056),R=h(87601),U=h(88569),V=h(12407),A=h(44835),S=h(41528),G=h(93310),oe=h(67969),ne=h(2078);class Oe extends L.A{initializeProgram(N){return new V.$(N.rctx,Oe.shader.get().build(this.configuration),de)}_setPipelineState(N){const J=this.configuration,re=N===A.A.NONE,ge=N===A.A.FrontFace;return(0,ne.sm)({blending:J.output!==te.H.Color&&J.output!==te.H.Alpha||!J.transparent?null:re?U.wu:(0,U.j7)(N),culling:(0,ne.zp)(J.cullFace),depthTest:{func:ge?oe.wb.LESS:J.shadingEnabled?oe.wb.LEQUAL:oe.wb.LESS},depthWrite:re?J.writeDepth?ne.LZ:null:(0,U.K5)(N),colorWrite:ne.BK,polygonOffset:re||ge?null:U.E0})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}}Oe.shader=new j.J(G.S,()=>h.e(8271).then(h.bind(h,88271)));class ue extends S.W{constructor(){super(...arguments),this.output=te.H.Color,this.cullFace=se.Vr.None,this.transparencyPassType=A.A.NONE,this.hasSlicePlane=!1,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}}(0,x._)([(0,R.o)({count:te.H.COUNT})],ue.prototype,"output",void 0),(0,x._)([(0,R.o)({count:se.Vr.COUNT})],ue.prototype,"cullFace",void 0),(0,x._)([(0,R.o)({count:A.A.COUNT})],ue.prototype,"transparencyPassType",void 0),(0,x._)([(0,R.o)()],ue.prototype,"hasSlicePlane",void 0),(0,x._)([(0,R.o)()],ue.prototype,"transparent",void 0),(0,x._)([(0,R.o)()],ue.prototype,"writeDepth",void 0),(0,x._)([(0,R.o)()],ue.prototype,"screenSizeEnabled",void 0),(0,x._)([(0,R.o)()],ue.prototype,"shadingEnabled",void 0),(0,x._)([(0,R.o)()],ue.prototype,"hasMultipassTerrain",void 0),(0,x._)([(0,R.o)()],ue.prototype,"cullAboveGround",void 0);const de=new Map([[H.T.POSITION,0],[H.T.NORMAL,1],[H.T.OFFSET,2]]);class Me extends F.F5{constructor(N){super(N,new ye),this.supportsEdges=!0,this._configuration=new ue,this._vertexAttributeLocations=de}getConfiguration(N,J){return this._configuration.output=N,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.screenSizeEnabled=this.parameters.screenSizeEnabled,this._configuration.shadingEnabled=this.parameters.shadingEnabled,this._configuration.transparencyPassType=J.transparencyPassType,this._configuration.hasMultipassTerrain=J.multipassTerrain.enabled,this._configuration.cullAboveGround=J.multipassTerrain.cullAboveGround,this._configuration}intersect(N,J,re,ge,be,Re){if(this.parameters.screenSizeEnabled){const Se=N.vertexAttributes.get(H.T.OFFSET),v={applyToVertex:(D,E,g,T)=>{const _=(0,C.s)(q,Se.data[3*T+0],Se.data[3*T+1],Se.data[3*T+2]),y=(0,C.s)(ee,D,E,g);return(0,C.g)(_,_,this.parameters.screenSizeScale*re.camera.computeRenderPixelSizeAt(_)),(0,C.a)(y,y,_),[y[0],y[1],y[2]]},applyToAabb:D=>{const E=(0,$.be)(D,q);return(0,$.bA)(D,this.parameters.screenSizeScale*re.camera.computeRenderPixelSizeAt(E))}};(0,W.Bw)(N,re,ge,be,v,Re)}else(0,W.Bw)(N,re,ge,be,void 0,Re)}requiresSlot(N,J){if(J===te.H.Highlight)return N===B.r.OPAQUE_MATERIAL;if(J===te.H.Color||J===te.H.Alpha||J===te.H.ObjectAndLayerIdColor){let re=B.r.OPAQUE_MATERIAL;return this.parameters.transparent&&(re=this.parameters.writeDepth?B.r.TRANSPARENT_MATERIAL:B.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),N===re||N===B.r.DRAPED_MATERIAL}return!1}createGLMaterial(N){return new le(N)}createBufferWriter(){return new Ae(this.parameters.screenSizeEnabled)}}class le extends me.Z{beginSlot(N){return this.ensureTechnique(Oe,N)}}class ye extends F.Mt{constructor(){super(...arguments),this.color=(0,Q.f)(1,1,1,1),this.shadingTint=(0,Q.f)(0,0,0,.25),this.shadingDirection=(0,C.n)((0,k.c)(),[.5,-.5,-.5]),this.screenSizeScale=14,this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=se.Vr.None,this.screenSizeEnabled=!1,this.shadingEnabled=!0}}class Ae{constructor(N){this.screenSizeEnabled=N;const J=(0,Y.U$)().vec3f(H.T.POSITION).vec3f(H.T.NORMAL);this.screenSizeEnabled&&J.vec3f(H.T.OFFSET),this.vertexBufferLayout=J}allocate(N){return this.vertexBufferLayout.createBuffer(N)}elementCount(N){return N.indices.get(H.T.POSITION).length}write(N,J,re,ge,be){if((0,P.NK)(re,this.vertexBufferLayout,N,J,ge,be),this.screenSizeEnabled){if(!re.vertexAttributes.has(H.T.OFFSET))throw new Error(`${H.T.OFFSET} vertex attribute required for screenSizeEnabled ShadedColorMaterial`);{const Re=re.vertexAttributes.get(H.T.OFFSET),Se=re.indices.get(H.T.OFFSET);(0,Z.hu)(3===Re.size);const v=ge.getField(H.T.OFFSET,I.ct);if(!v)throw new Error("unable to acquire view for "+H.T.OFFSET);(0,P.ho)(Se,Re.data,J,v,be)}}}}const q=(0,k.c)(),ee=(0,k.c)()},95925:(Ce,he,h)=>{h.d(he,{Er:()=>Y,Lp:()=>te,Yq:()=>F});var C=h(15861),k=h(59213),Q=h(62208),$=h(10699),I=h(32917);function Y(B,Z){B.interactive=!0;const{tool:H,view:P}=B;P.activeTool=H;let W=(0,$.fu)(Z,()=>{P.activeTool===H&&(P.activeTool=null)});return(0,k.vr)(function(){var x=(0,C.Z)(function*(j){yield(0,I.N1)(()=>(0,Q.Wi)(H)||!H.active,j),W=(0,Q.hw)(W)});return function(j){return x.apply(this,arguments)}}(),Z)}function te(B,Z){return(0,I.YP)(()=>B.interactive,()=>function se(B,Z){B.interactive?function me(B,Z){F(B);const{view:H,analysis:P}=B,W=new Z({view:H,analysis:P,analysisViewData:B});B.tool=W,H.tools.add(W)}(B,Z):F(B)}(B,Z),I.tX)}function F(B){const{view:Z,tool:H}=B;(0,Q.Wi)(H)||(Z.tools.remove(H),B.tool=null)}},58997:(Ce,he,h)=>{h.d(he,{f:()=>x});var H,j,C=h(17626),k=h(32917),Q=h(77712),Y=(h(90912),h(85931),h(76898)),te=h(14517),se=h(63290),me=h(62208),F=h(10699),B=h(33786),Z=h(46160);(j=H||(H={}))[j.WhenToolEditable=0]="WhenToolEditable",j[j.WhenToolNotEditable=1]="WhenToolNotEditable",j[j.Always=2]="Always";class P{constructor(){this._isToolEditable=!0,this._manipulators=new Z.Z,this._resourceContexts={manipulator3D:{}},this._attached=!1}set isToolEditable(L){this._isToolEditable=L}get length(){return this._manipulators.length}add(L,R=H.WhenToolEditable){this.addMany([L],R)}addMany(L,R=H.WhenToolEditable){for(const U of L){const V={manipulator:U,visibilityPredicate:R,attached:!1};this._manipulators.add(V),this._attached&&this._updateManipulatorAttachment(V)}}remove(L){for(let R=0;R<this._manipulators.length;R++)if(this._manipulators.getItemAt(R).manipulator===L){const U=this._manipulators.splice(R,1)[0];this._detachManipulator(U);break}}removeAll(){this._manipulators.forEach(L=>{this._detachManipulator(L)}),this._manipulators.removeAll()}attach(){this._manipulators.forEach(L=>{this._updateManipulatorAttachment(L)}),this._attached=!0}detach(){this._manipulators.forEach(L=>{this._detachManipulator(L)}),this._attached=!1}destroy(){this.detach(),this._manipulators.forEach(({manipulator:L})=>{L.destroy&&L.destroy()}),this._manipulators.destroy(),this._resourceContexts=null}on(L,R){return this._manipulators.on(L,U=>{R(U)})}forEach(L){for(const R of this._manipulators.items)L(R)}some(L){return this._manipulators.items.some(L)}toArray(){const L=[];return this.forEach(R=>L.push(R.manipulator)),L}intersect(L,R){let U=null,V=Number.MAX_VALUE;return this._manipulators.forEach(({manipulator:A,attached:S})=>{if(!S||!A.interactive)return;const G=A.intersectionDistance(L,R);(0,me.pC)(G)&&G<V&&(V=G,U=A)}),U}_updateManipulatorAttachment(L){this._isManipulatorItemVisible(L)?this._attachManipulator(L):this._detachManipulator(L)}_attachManipulator(L){L.attached||(L.manipulator.attach&&L.manipulator.attach(this._resourceContexts),L.attached=!0)}_detachManipulator(L){if(!L.attached)return;const R=L.manipulator;R.grabbing=!1,R.dragging=!1,R.hovering=!1,R.selected=!1,R.detach&&R.detach(this._resourceContexts),L.attached=!1}_isManipulatorItemVisible(L){return L.visibilityPredicate===H.Always||(this._isToolEditable?L.visibilityPredicate===H.WhenToolEditable:L.visibilityPredicate===H.WhenToolNotEditable)}}let W=class extends te.Z{constructor(j){super(j),this.manipulators=new P,this.automaticManipulatorSelection=!0,this.hasGrabbedManipulators=!1,this.hasHoveredManipulators=!1,this.firstGrabbedManipulator=null,this.created=!1,this.removeIncompleteOnCancel=!0,this._editableFlags=new Map([[B.bH.MANAGER,!0],[B.bH.USER,!0]]),this._creationFinishedResolver=(0,F.hh)()}get active(){return null!=this.view&&this.view.activeTool===this}set visible(j){this._get("visible")!==j&&(this._set("visible",j),this._syncVisible())}get editable(){return this.getEditableFlag(B.bH.USER)}set editable(j){this.setEditableFlag(B.bH.USER,j)}get updating(){return!1}get cursor(){return null}get hasFocusedManipulators(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}destroy(){this.manipulators.destroy(),this._set("view",null)}onAdd(){this._syncVisible()}activate(){(0,me.Wi)(this.view)?se.Z.getLogger(this.declaredClass).error("Can't activate tool if view is not defined."):(this.view.focus(),this.onActivate())}deactivate(){this.onDeactivate()}handleInputEvent(j){this.onInputEvent(j)}handleInputEventAfter(j){this.onInputEventAfter(j)}setEditableFlag(j,L){this._editableFlags.set(j,L),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),j===B.bH.USER&&this.notifyChange("editable"),this.onEditableChange(),this.onManipulatorSelectionChanged()}getEditableFlag(j){return this._editableFlags.get(j)??!1}whenCreated(){return this._creationFinishedResolver.promise}onManipulatorSelectionChanged(){}onActivate(){}onDeactivate(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(j){}onInputEventAfter(j){}get internallyEditable(){return this.getEditableFlag(B.bH.USER)&&this.getEditableFlag(B.bH.MANAGER)}finishToolCreation(){this.created||this._creationFinishedResolver.resolve(this),this._set("created",!0)}_syncVisible(){if(this.initialized)if(this.visible)this._show();else if(this._hide(),this.active)return void(this.view.activeTool=null)}_show(){this._updateManipulatorAttachment(),this.onShow()}_hide(){this._updateManipulatorAttachment(),this.onHide()}_updateManipulatorAttachment(){this.visible?this.manipulators.attach():this.manipulators.detach()}};(0,C._)([(0,Q.Cb)({constructOnly:!0})],W.prototype,"view",void 0),(0,C._)([(0,Q.Cb)({readOnly:!0})],W.prototype,"active",null),(0,C._)([(0,Q.Cb)({value:!0})],W.prototype,"visible",null),(0,C._)([(0,Q.Cb)({value:!0})],W.prototype,"editable",null),(0,C._)([(0,Q.Cb)({readOnly:!0})],W.prototype,"manipulators",void 0),(0,C._)([(0,Q.Cb)({readOnly:!0})],W.prototype,"updating",null),(0,C._)([(0,Q.Cb)()],W.prototype,"cursor",null),(0,C._)([(0,Q.Cb)({readOnly:!0})],W.prototype,"automaticManipulatorSelection",void 0),(0,C._)([(0,Q.Cb)()],W.prototype,"hasFocusedManipulators",null),(0,C._)([(0,Q.Cb)()],W.prototype,"hasGrabbedManipulators",void 0),(0,C._)([(0,Q.Cb)()],W.prototype,"hasHoveredManipulators",void 0),(0,C._)([(0,Q.Cb)()],W.prototype,"firstGrabbedManipulator",void 0),(0,C._)([(0,Q.Cb)({readOnly:!0})],W.prototype,"created",void 0),(0,C._)([(0,Q.Cb)({readOnly:!0})],W.prototype,"removeIncompleteOnCancel",void 0),W=(0,C._)([(0,Y.j)("esri.views.interactive.InteractiveToolBase")],W);let x=class extends W{constructor(j){super(j)}initialize(){this.addHandles((0,k.YP)(()=>this.analysisViewData.visible,j=>this.visible=j,k.tX))}deactivate(){this.onDeactivate(),this.created||this.analysis.clear()}resetCreated(){this._set("created",!1)}};(0,C._)([(0,Q.Cb)({constructOnly:!0})],x.prototype,"analysis",void 0),(0,C._)([(0,Q.Cb)()],x.prototype,"analysisViewData",void 0),x=(0,C._)([(0,Y.j)("esri.views.interactive.AnalysisToolBase")],x)},30260:(Ce,he,h)=>{h.d(he,{hM:()=>ge,Xd:()=>S,di:()=>ye}),h(29132),h(8314);var Q=h(58817),I=(h(21286),h(62208));function S(v,D){return v.events.on("drag",function A(v,D){let E=null,g=null;return T=>{if("cancel"===T.action)return void((0,I.pC)(g)&&(g.execute({action:"cancel"}),E=null,g=null));const _={action:T.action,screenStart:T.start,screenEnd:T.screenPoint};"start"===T.action&&(0,I.Wi)(E)&&(E=new ge,g=new ge,D(v,E,g,T.pointerType,_)),(0,I.pC)(E)&&E.execute(_),"end"===T.action&&(0,I.pC)(E)&&(E=null,g=null)}}(v,D))}function ye(v,D){const E=new Map;for(const g of D)E.set(g,(0,Q.d9)(v[g]));return g=>(E.forEach((T,_)=>{v[_]=T}),g)}h(28093),h(55915),h(84786),h(60507),h(59617),h(65401),h(32442),h(25748),h(72642);const re=()=>{};class ge{constructor(){this.execute=re}next(D,E=new ge){return(0,I.pC)(D)&&(this.execute=g=>{const T=D(g);(0,I.pC)(T)&&E.execute(T)}),E}}}}]);