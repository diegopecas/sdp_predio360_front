"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[7434],{67434:(v,E,o)=>{o.r(E),o.d(E,{default:()=>j});var M=o(15861),p=o(17626),c=(o(8314),o(62208)),u=(o(63290),o(90912),o(85931),o(26584),o(76898)),C=o(84682),I=o(36859),R=o(39351),B=o(13112),i=o(55376);class d{constructor(t,r){this.offset=t,this.extent=r}}let O=class extends B.Z{constructor(){super(...arguments),this.type="heatmap",this._tileKeyToFeatureSets=new Map}initialize(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])}update(_,t){var r=this;return(0,M.Z)(function*(){const s=t.schema.processors[0];"heatmap"===s.type&&(0,C.Hg)(r._schema,s)&&(_.mesh=!0,r._schema=s)})()}onTileUpdate(_){for(const t of _.removed)this._tileKeyToFeatureSets.delete(t.key.id)}onTileClear(_){return this._tileKeyToFeatureSets.delete(_.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:_.id,data:{clear:!0}})}onTileMessage(_,t,r){var s=this;return(0,M.Z)(function*(){s._tileKeyToFeatureSets.has(_.key.id)||s._tileKeyToFeatureSets.set(_.key.id,new Map);const e=s._tileKeyToFeatureSets.get(_.key.id);if(e&&(0,c.pC)(t.addOrUpdate)&&t.addOrUpdate.hasFeatures&&e.set(t.addOrUpdate.instance,t),t.end){const n=[],U=function L(_){const t=_.key,r=new Map,s=256,e=R.I_,n=_.tileInfoView.tileInfo.isWrappable;return r.set((0,i.M)(t,-1,-1,n).id,new d([-e,-e],[e-s,e-s,e,e])),r.set((0,i.M)(t,0,-1,n).id,new d([0,-e],[0,e-s,e,e])),r.set((0,i.M)(t,1,-1,n).id,new d([e,-e],[0,e-s,s,e])),r.set((0,i.M)(t,-1,0,n).id,new d([-e,0],[e-s,0,e,e])),r.set((0,i.M)(t,1,0,n).id,new d([e,0],[0,0,s,e])),r.set((0,i.M)(t,-1,1,n).id,new d([-e,e],[e-s,0,e,s])),r.set((0,i.M)(t,0,1,n).id,new d([0,e],[0,0,e,s])),r.set((0,i.M)(t,1,1,n).id,new d([e,e],[0,0,s,s])),r}(_);s._tileKeyToFeatureSets.forEach((K,D)=>{if(D===_.key.id)K.forEach(T=>(0,c.yw)(T.addOrUpdate,P=>n.push(P)));else if(U.has(D)){const T=U.get(D),[P,S]=T.offset;K.forEach(w=>(0,c.yw)(w.addOrUpdate,g=>{const F=g.transform(P,S,1,1);n.push(F)}))}});const m=(0,I.QM)(n,s._schema.mesh,512,512);return s.remoteClient.invoke("tileRenderer.onTileData",{tileKey:_.key.id,intensityInfo:m},{...r,transferList:[m.matrix]})}})()}onTileError(_,t,r){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:_.id,error:t},r)}};O=(0,p._)([(0,u.j)("esri.views.2d.layers.features.processors.HeatmapProcessor")],O);const j=O},55376:(v,E,o)=>{function M(p,f,c,y){const a=p.clone(),h=1<<a.level,l=a.col+f,u=a.row+c;return y&&l<0?(a.col=l+h,a.world-=1):l>=h?(a.col=l-h,a.world+=1):a.col=l,a.row=u,a}o.d(E,{M:()=>M})}}]);