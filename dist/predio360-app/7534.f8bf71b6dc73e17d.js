"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[7534],{27369:(F,S,t)=>{t.d(S,{L:()=>n});var r=t(15861),T=t(45205);class n{constructor(){this._serviceMetadatas=new Map,this._itemDatas=new Map}fetchServiceMetadata(f,p){var m=this;return(0,r.Z)(function*(){const i=m._serviceMetadatas.get(f);if(i)return i;const M=yield(0,T.T)(f,p);return m._serviceMetadatas.set(f,M),M})()}fetchItemData(f){var p=this;return(0,r.Z)(function*(){const{id:m}=f;if(!m)return null;const{_itemDatas:i}=p;if(i.has(m))return i.get(m);const M=yield f.fetchData();return i.set(m,M),M})()}fetchCustomParameters(f,p){var m=this;return(0,r.Z)(function*(){const i=yield m.fetchItemData(f);return i&&"object"==typeof i&&(p?p(i):i.customParameters)||null})()}}},39593:(F,S,t)=>{t.d(S,{w:()=>M});var r=t(15861),T=t(24263),n=t(84792),a=t(26584),f=t(10699),p=t(38305),m=t(31099),i=t(55463);function M(o,L){return j.apply(this,arguments)}function j(){return j=(0,r.Z)(function*(o,L){const d=(0,p.Qc)(o);if(!d)throw new a.Z("invalid-url","Invalid scene service url");const y={...L,sceneServerUrl:d.url.path,layerId:d.sublayer??void 0};if(y.sceneLayerItem??=(yield function W(o){return K.apply(this,arguments)}(y)),null==y.sceneLayerItem)return I(y.sceneServerUrl.replace("/SceneServer","/FeatureServer"),y);const g=yield function P(o){return B.apply(this,arguments)}(y);if(!g?.url)throw new a.Z("related-service-not-found","Could not find feature service through portal item relationship");y.featureServiceItem=g;const R=yield I(g.url,y);return R.portalItem=g,R}),j.apply(this,arguments)}function K(){return K=(0,r.Z)(function*(o){const L=(yield Z(o)).serviceItemId;if(!L)return null;const d=new i.default({id:L,apiKey:o.apiKey}),y=yield function l(o){return h.apply(this,arguments)}(o);null!=y&&(d.portal=new m.Z({url:y}));try{return d.load({signal:o.signal})}catch(g){return(0,f.r9)(g),null}}),K.apply(this,arguments)}function Z(o){return u.apply(this,arguments)}function u(){return(u=(0,r.Z)(function*(o){if(o.rootDocument)return o.rootDocument;const L={query:{f:"json",...o.customParameters,token:o.apiKey},responseType:"json",signal:o.signal};try{const d=yield(0,n.Z)(o.sceneServerUrl,L);o.rootDocument=d.data}catch{o.rootDocument={}}return o.rootDocument})).apply(this,arguments)}function h(){return(h=(0,r.Z)(function*(o){const L=T.id?.findServerInfo(o.sceneServerUrl);if(L?.owningSystemUrl)return L.owningSystemUrl;const d=o.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const y=(yield(0,n.Z)(d,{query:{f:"json"},responseType:"json",signal:o.signal})).data.owningSystemUrl;if(y)return y}catch(y){(0,f.r9)(y)}return null})).apply(this,arguments)}function I(o,L){return N.apply(this,arguments)}function N(){return(N=(0,r.Z)(function*(o,L){const d=(0,p.Qc)(o);if(!d)throw new a.Z("invalid-feature-service-url","Invalid feature service url");const y=d.url.path,g=L.layerId;if(null==g)return{serverUrl:y};const R=Z(L),A=L.featureServiceItem?yield L.featureServiceItem.fetchData("json"):null,z=(A?.layers?.[0]||A?.tables?.[0])?.customParameters,$=x=>{const Y={query:{f:"json",...z},responseType:"json",authMode:x,signal:L.signal};return(0,n.Z)(y,Y)},Q=$("anonymous").catch(()=>$("no-prompt")),[J,X]=yield Promise.all([Q,R]),V=X?.layers,G=J.data&&J.data.layers;if(!Array.isArray(G))throw new Error("expected layers array");if(Array.isArray(V)){for(let x=0;x<Math.min(V.length,G.length);x++)if(V[x].id===g)return{serverUrl:y,layerId:G[x].id}}else if(null!=g&&g<G.length)return{serverUrl:y,layerId:G[g].id};throw new Error("could not find matching associated sublayer")})).apply(this,arguments)}function B(){return(B=(0,r.Z)(function*({sceneLayerItem:o,signal:L}){if(!o)return null;try{const d=(yield o.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:L})).find(g=>"Feature Service"===g.type)||null;if(!d)return null;const y=new i.default({portal:d.portal,id:d.id});return yield y.load(),y}catch(d){return(0,f.r9)(d),null}})).apply(this,arguments)}},30164:(F,S,t)=>{t.d(S,{T:()=>T});var r=t(15861);const T={BingMapsLayer:(n=(0,r.Z)(function*(){return(yield t.e(2248).then(t.bind(t,72248))).default}),function(){return n.apply(this,arguments)}),BuildingSceneLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(2964),t.e(2432),t.e(9410),t.e(8592),t.e(676)]).then(t.bind(t,6189))).default});return function(){return n.apply(this,arguments)}}(),CatalogLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(5262),t.e(6072),t.e(4802),t.e(5349),t.e(1601)]).then(t.bind(t,41601))).default});return function(){return n.apply(this,arguments)}}(),CSVLayer:function(){var n=(0,r.Z)(function*(){return(yield t.e(5625).then(t.bind(t,85625))).default});return function(){return n.apply(this,arguments)}}(),DimensionLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(7614)]).then(t.bind(t,17614))).default});return function(){return n.apply(this,arguments)}}(),ElevationLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(5810)]).then(t.bind(t,75810))).default});return function(){return n.apply(this,arguments)}}(),FeatureLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.resolve().then(t.bind(t,80415))).default});return function(){return n.apply(this,arguments)}}(),GeoJSONLayer:function(){var n=(0,r.Z)(function*(){return(yield t.e(2903).then(t.bind(t,72903))).default});return function(){return n.apply(this,arguments)}}(),GeoRSSLayer:function(){var n=(0,r.Z)(function*(){return(yield t.e(6306).then(t.bind(t,96306))).default});return function(){return n.apply(this,arguments)}}(),GroupLayer:function(){var n=(0,r.Z)(function*(){return(yield t.e(5700).then(t.bind(t,55700))).default});return function(){return n.apply(this,arguments)}}(),ImageryLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(5262),t.e(6926),t.e(2863),t.e(5224),t.e(5785)]).then(t.bind(t,65785))).default});return function(){return n.apply(this,arguments)}}(),ImageryTileLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(8594),t.e(6926),t.e(2863),t.e(1423),t.e(5224),t.e(8592),t.e(5821)]).then(t.bind(t,85821))).default});return function(){return n.apply(this,arguments)}}(),IntegratedMeshLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(2432),t.e(7867)]).then(t.bind(t,67867))).default});return function(){return n.apply(this,arguments)}}(),KMLLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(8411)]).then(t.bind(t,38411))).default});return function(){return n.apply(this,arguments)}}(),LineOfSightLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(5628)]).then(t.bind(t,29457))).default});return function(){return n.apply(this,arguments)}}(),LinkChartLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(337),t.e(2507),t.e(774),t.e(6072),t.e(7758),t.e(7689),t.e(8592),t.e(8557)]).then(t.bind(t,98557))).default});return function(){return n.apply(this,arguments)}}(),MapImageLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(5262),t.e(4802),t.e(5485),t.e(8887)]).then(t.bind(t,48887))).default});return function(){return n.apply(this,arguments)}}(),MapNotesLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(9859)]).then(t.bind(t,19859))).default});return function(){return n.apply(this,arguments)}}(),MediaLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(6521)]).then(t.bind(t,29371))).default});return function(){return n.apply(this,arguments)}}(),OGCFeatureLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(9628),t.e(2955)]).then(t.bind(t,36554))).default});return function(){return n.apply(this,arguments)}}(),OpenStreetMapLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(5980)]).then(t.bind(t,71591))).default});return function(){return n.apply(this,arguments)}}(),OrientedImageryLayer:function(){var n=(0,r.Z)(function*(){return(yield t.e(6150).then(t.bind(t,66150))).default});return function(){return n.apply(this,arguments)}}(),PointCloudLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(2432),t.e(7155)]).then(t.bind(t,7155))).default});return function(){return n.apply(this,arguments)}}(),RouteLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(403),t.e(4940)]).then(t.bind(t,84940))).default});return function(){return n.apply(this,arguments)}}(),SceneLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(2964),t.e(5453),t.e(2432),t.e(8592),t.e(7986)]).then(t.bind(t,47986))).default});return function(){return n.apply(this,arguments)}}(),StreamLayer:function(){var n=(0,r.Z)(function*(){return(yield t.e(289).then(t.bind(t,70289))).default});return function(){return n.apply(this,arguments)}}(),SubtypeGroupLayer:function(){var n=(0,r.Z)(function*(){return(yield t.e(1976).then(t.bind(t,81976))).default});return function(){return n.apply(this,arguments)}}(),TileLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(5262),t.e(4802),t.e(5485),t.e(8592),t.e(9735)]).then(t.bind(t,59735))).default});return function(){return n.apply(this,arguments)}}(),IntegratedMesh3DTilesLayer:function(){var n=(0,r.Z)(function*(){return(yield t.e(7037).then(t.bind(t,47037))).default});return function(){return n.apply(this,arguments)}}(),UnknownLayer:function(){var n=(0,r.Z)(function*(){return(yield t.e(6339).then(t.bind(t,56339))).default});return function(){return n.apply(this,arguments)}}(),UnsupportedLayer:function(){var n=(0,r.Z)(function*(){return(yield t.e(6240).then(t.bind(t,16240))).default});return function(){return n.apply(this,arguments)}}(),VectorTileLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(8364),t.e(8592),t.e(193)]).then(t.bind(t,10193))).default});return function(){return n.apply(this,arguments)}}(),VoxelLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(2432),t.e(6007)]).then(t.bind(t,26007))).default});return function(){return n.apply(this,arguments)}}(),WFSLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(9636),t.e(8762)]).then(t.bind(t,98762))).default});return function(){return n.apply(this,arguments)}}(),WMSLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(6894)]).then(t.bind(t,46894))).default});return function(){return n.apply(this,arguments)}}(),WMTSLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(9526)]).then(t.bind(t,69526))).default});return function(){return n.apply(this,arguments)}}(),WebTileLayer:function(){var n=(0,r.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(2585)]).then(t.bind(t,28678))).default});return function(){return n.apply(this,arguments)}}()};var n},73391:(F,S,t)=>{t.d(S,{$O:()=>a,CD:()=>K,H2:()=>W,Ok:()=>p,Q4:()=>i,XX:()=>M,_Y:()=>j,bS:()=>n,uE:()=>m});var r=t(15861),T=t(39593);function n(u){const l={id:u.id,name:u.name};return"Oriented Imagery Layer"===u.type&&(l.layerType="OrientedImageryLayer"),l}function a(u,l,h){return f.apply(this,arguments)}function f(){return(f=(0,r.Z)(function*(u,l,h){if(null==u?.layers||null==u?.tables){const I=yield h.fetchServiceMetadata(l,{customParameters:m(u)?.customParameters});(u=u||{}).layers=u.layers||I?.layers?.map(n),u.tables=u.tables||I?.tables?.map(n)}return u})).apply(this,arguments)}function p(u){const{layers:l,tables:h}=u;return l?.length?l[0].id:h?.length?h[0].id:null}function m(u){if(!u)return null;const{layers:l,tables:h}=u;return l?.length?l[0]:h?.length?h[0]:null}function i(u){return(u?.layers?.length??0)+(u?.tables?.length??0)}function M(u){const l=[];return u?.layers?.forEach(h=>{"SubtypeGroupLayer"===h.layerType&&l.push(h.id)}),l}function j(u){return u?.layers?.filter(({layerType:l})=>"OrientedImageryLayer"===l).map(({id:l})=>l)}function W(u){return u?.layers?.filter(({layerType:l})=>"CatalogLayer"===l).map(({id:l})=>l)}function K(u,l,h){return Z.apply(this,arguments)}function Z(){return(Z=(0,r.Z)(function*(u,l,h){if(!u?.url)return l??{};if(l??={},!l.layers){const P=yield h.fetchServiceMetadata(u.url);l.layers=P.layers?.map(n)}const{serverUrl:I,portalItem:N}=yield(0,T.w)(u.url,{sceneLayerItem:u,customParameters:m(l)?.customParameters}).catch(()=>({serverUrl:null,portalItem:null}));if(null==I)return l.tables=[],l;if(!l.tables&&N){const P=yield N.fetchData();if(P?.tables)l.tables=P.tables.map(n);else{const B=yield h.fetchServiceMetadata(I,{customParameters:m(P)?.customParameters});l.tables=B?.tables?.map(n)}}if(l.tables)for(const P of l.tables)P.url=`${I}/${P.id}`;return l})).apply(this,arguments)}},7534:(F,S,t)=>{t.r(S),t.d(S,{fromItem:()=>j,selectLayerClassPath:()=>u});var r=t(15861),T=t(26584),n=t(39593),a=t(27369),f=t(72469),p=t(30164),m=t(55463),i=t(73391),M=t(37281);function j(e){return W.apply(this,arguments)}function W(){return W=(0,r.Z)(function*(e){!e.portalItem||e.portalItem instanceof m.default||(e={...e,portalItem:new m.default(e.portalItem)});const s=yield function K(e){return Z.apply(this,arguments)}(e.portalItem);return new s.constructor({portalItem:e.portalItem,...s.properties})}),W.apply(this,arguments)}function Z(){return Z=(0,r.Z)(function*(e){yield e.load();const s=new a.L;return function h(e){return I.apply(this,arguments)}(yield u(e,s))}),Z.apply(this,arguments)}function u(e,s){return l.apply(this,arguments)}function l(){return l=(0,r.Z)(function*(e,s){switch(e.type){case"3DTiles Service":return{className:"IntegratedMesh3DTilesLayer"};case"CSV":return{className:"CSVLayer"};case"Feature Collection":return function y(e){return g.apply(this,arguments)}(e);case"Feature Service":return function B(e,s){return o.apply(this,arguments)}(e,s);case"Feed":case"Stream Service":return{className:"StreamLayer"};case"GeoJson":return{className:"GeoJSONLayer"};case"Group Layer":return{className:"GroupLayer"};case"Image Service":return function R(e,s){return A.apply(this,arguments)}(e,s);case"KML":return{className:"KMLLayer"};case"Map Service":return function N(e,s){return P.apply(this,arguments)}(e,s);case"Media Layer":return{className:"MediaLayer"};case"Scene Service":return function L(e,s){return d.apply(this,arguments)}(e,s);case"Vector Tile Service":return{className:"VectorTileLayer"};case"WFS":return{className:"WFSLayer"};case"WMS":return{className:"WMSLayer"};case"WMTS":return{className:"WMTSLayer"};default:throw new T.Z("portal:unknown-item-type","Unknown item type '${type}'",{type:e.type})}}),l.apply(this,arguments)}function I(){return(I=(0,r.Z)(function*(e){const c=p.T[e.className];return{constructor:yield c(),properties:e.properties}})).apply(this,arguments)}function P(){return P=(0,r.Z)(function*(e,s){return(yield function et(e,s){return b.apply(this,arguments)}(e,s))?{className:"TileLayer"}:{className:"MapImageLayer"}}),P.apply(this,arguments)}function o(){return(o=(0,r.Z)(function*(e,s){const c=yield q(e,s);if("object"==typeof c){const{sourceJSON:v,className:D}=c,U={sourceJSON:v};return null!=c.id&&(U.layerId=c.id),{className:D||"FeatureLayer",properties:U}}return{className:"GroupLayer"}})).apply(this,arguments)}function d(){return(d=(0,r.Z)(function*(e,s){const c=yield q(e,s,(0,r.Z)(function*(){try{if(!e.url)return[];const{serverUrl:v}=yield(0,n.w)(e.url,{sceneLayerItem:e});return(yield s.fetchServiceMetadata(v))?.tables??[]}catch{return[]}}));if("object"==typeof c){const v={};let D;if(null!=c.id?(v.layerId=c.id,D=`${e.url}/layers/${c.id}`):D=e.url,e.typeKeywords?.length)for(const E of Object.keys(f.fb))if(e.typeKeywords.includes(E))return{className:f.fb[E]};const U=yield s.fetchServiceMetadata(D,{customParameters:yield s.fetchCustomParameters(e,E=>(0,i.uE)(E)?.customParameters)});return{className:f.fb[U?.layerType]||"SceneLayer",properties:v}}return!1===c&&"Voxel"===(yield s.fetchServiceMetadata(e.url))?.layerType?{className:"VoxelLayer"}:{className:"GroupLayer"}})).apply(this,arguments)}function g(){return(g=(0,r.Z)(function*(e){yield e.load();const s=(0,M._$)(e,"Map Notes"),c=(0,M._$)(e,"Markup");if(s||c)return{className:"MapNotesLayer"};if((0,M._$)(e,"Route Layer"))return{className:"RouteLayer"};const v=yield e.fetchData();return 1===(0,i.Q4)(v)?{className:"FeatureLayer"}:{className:"GroupLayer"}})).apply(this,arguments)}function A(){return(A=(0,r.Z)(function*(e,s){yield e.load();const c=e.typeKeywords?.map(C=>C.toLowerCase())??[];if(c.includes("elevation 3d layer"))return{className:"ElevationLayer"};if(c.includes("tiled imagery"))return{className:"ImageryTileLayer"};const D=(yield s.fetchItemData(e))?.layerType;if("ArcGISTiledImageServiceLayer"===D)return{className:"ImageryTileLayer"};if("ArcGISImageServiceLayer"===D)return{className:"ImageryLayer"};const U=yield s.fetchServiceMetadata(e.url,{customParameters:yield s.fetchCustomParameters(e)}),E=U.cacheType?.toLowerCase(),H=U.capabilities?.toLowerCase().includes("tilesonly");return"map"===E||H?{className:"ImageryTileLayer"}:{className:"ImageryLayer"}})).apply(this,arguments)}function b(){return(b=(0,r.Z)(function*(e,s){const{tileInfo:c}=yield s.fetchServiceMetadata(e.url,{customParameters:yield s.fetchCustomParameters(e)});return c})).apply(this,arguments)}function q(e,s,c){return w.apply(this,arguments)}function w(){return(w=(0,r.Z)(function*(e,s,c){const{url:v,type:D}=e,U="Feature Service"===D;if(!v)return{};if(/\/\d+$/.test(v)){if(U){const C=yield s.fetchServiceMetadata(v,{customParameters:yield s.fetchCustomParameters(e,O=>(0,i.uE)(O)?.customParameters)});if("Oriented Imagery Layer"===C.type)return{id:C.id,className:"OrientedImageryLayer",sourceJSON:C}}return{}}yield e.load();let E=yield s.fetchItemData(e);if(U){const C=yield(0,i.$O)(E,v,s),O=k(C);if("object"==typeof O){const rt=(0,i.XX)(C),at=(0,i._Y)(C),st=(0,i.H2)(C);O.className=null!=O.id&&rt.includes(O.id)?"SubtypeGroupLayer":null!=O.id&&at?.includes(O.id)?"OrientedImageryLayer":null!=O.id&&st?.includes(O.id)?"CatalogLayer":"FeatureLayer"}return O}if("Scene Service"===D&&(E=yield(0,i.CD)(e,E,s)),(0,i.Q4)(E)>0)return k(E);const H=yield s.fetchServiceMetadata(v);return c&&(H.tables=yield c()),k(H)})).apply(this,arguments)}function k(e){return 1===(0,i.Q4)(e)&&{id:(0,i.Ok)(e)}}},45205:(F,S,t)=>{t.d(S,{T:()=>n});var r=t(15861),T=t(84792);function n(f,p){return a.apply(this,arguments)}function a(){return(a=(0,r.Z)(function*(f,p){const{data:m}=yield(0,T.Z)(f,{responseType:"json",query:{f:"json",...p?.customParameters,token:p?.apiKey}});return m})).apply(this,arguments)}}}]);