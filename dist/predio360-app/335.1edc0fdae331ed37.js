"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[335],{80335:($,B,o)=>{o.d(B,{Z:()=>te});var P=o(15861),a=o(17626),j=o(26584),E=o(62208),l=o(32917),p=o(77712),b=(o(90912),o(85931),o(76898)),V=o(84786),D=o(23010),w=o(79216),I=o(19702),W=o(54984),y=o(14517),v=o(10699),S=o(38114),U=o(20477),N=o(88879),G=o(55713),z=o(42930),H=o(65234),J=o(36255);class F{constructor(t){this._controller=t,this._handle=new n(i=>t.schedule(i))}destroy(){this._handle.destroy()}invoke(t,i){var d=this;return t.buffer&&0!==t.buffer.byteLength?(t.options.sourceSpatialReference&&t.options.sourceSpatialReference instanceof H.Z&&(t.options={...t.options,sourceSpatialReference:t.options.sourceSpatialReference.toJSON()}),this._handle.invoke(t,i).then(g=>{let L=0,R=0;const A=function(){var K=(0,P.Z)(function*(q){if(g.spatialReference=H.Z.fromJSON(g.spatialReference),g.fields)for(;L<g.fields.length;)if(g.fields[L]=J.Z.fromJSON(g.fields[L]),L++,q.madeProgress())return d._controller.reschedule(Q=>A(Q));const X=g.spatialReference;for(;R<g.features.length;){const Q=g.features[R];if(++R,Q.uid=N.Z.generateUID(),(0,E.pC)(Q.geometry)&&(Q.geometry.spatialReference=X,r(Q.geometry),q.madeProgress()))return d._controller.reschedule(re=>A(re))}return g});return function(X){return K.apply(this,arguments)}}();return this._controller.schedule(K=>A(K))})):Promise.resolve(null)}}function r(e){switch(e.type){case"polyline":e.paths.reduce((t,i)=>t+i.length,0)<G.DB&&(e.paths=e.paths.map(e.hasZ||e.hasM?t=>t.map(i=>[i[0],i[1],i[2]]):t=>t.map(i=>[i[0],i[1]])));break;case"polygon":e.rings.reduce((t,i)=>t+i.length,0)<G.DB&&(e.rings=e.rings.map(e.hasZ||e.hasM?t=>t.map(i=>[i[0],i[1],i[2]]):t=>t.map(i=>[i[0],i[1]])))}}class n extends z.q{constructor(t){super("PBFDecoderWorker","_parseFeatureQuery",{_parseFeatureQuery:i=>[i.buffer]},t)}}let s=class extends y.Z{constructor(e){super(e)}get queryFeaturesDehydrated(){const e=this.layer.capabilities,t=e&&e.query,d=this.layer.parsedUrl;if(t&&t.supportsFormatPBF){(0,E.Wi)(this._decoder)&&(this._decoder=new F(this.controller));const g={sourceSpatialReference:this.layer.spatialReference?.toJSON()??null,applyTransform:!0,maxStringAttributeLength:1024};return(L,R)=>(0,U.Vn)(d,L,"pbf",this._createRequestOptions(R)).then(A=>((0,v.k_)(R),(0,E.pC)(this._decoder)?this._decoder.invoke({buffer:A.data,options:g},R.signal):Promise.reject((0,v.zE)())))}return(g,L)=>(0,U.JT)(d,g,this.layer.spatialReference,this._createRequestOptions(L)).then(R=>(0,S.PA)(R.data))}queryFeatureCount(e,t){return this.layer.queryFeatureCount(e,t)}destroy(){this._decoder=(0,E.SC)(this._decoder)}_createRequestOptions(e){return{...e,query:{...this.layer.customParameters,token:this.layer.apiKey,...e?.query}}}};(0,a._)([(0,p.Cb)({constructOnly:!0})],s.prototype,"layer",void 0),(0,a._)([(0,p.Cb)({constructOnly:!0})],s.prototype,"controller",void 0),(0,a._)([(0,p.Cb)({readOnly:!0})],s.prototype,"queryFeaturesDehydrated",null),s=(0,a._)([(0,b.j)("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileServiceQuery3D")],s);let u=class extends y.Z{constructor(e){super(e)}queryFeaturesDehydrated(e,t){return this.layer.queryFeatures(e,t)}queryFeatureCount(e,t){return this.layer.queryFeatureCount(e,t)}};(0,a._)([(0,p.Cb)({constructOnly:!0})],u.prototype,"layer",void 0),(0,a._)([(0,p.Cb)({readOnly:!0})],u.prototype,"queryFeaturesDehydrated",null),u=(0,a._)([(0,b.j)("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileServiceMeshQuery3D")],u);let C=class extends y.Z{constructor(e){super(e)}queryFeaturesDehydrated(e,t){return this.layer.queryFeatures(e,t)}};(0,a._)([(0,p.Cb)({constructOnly:!0})],C.prototype,"layer",void 0),C=(0,a._)([(0,b.j)("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileServiceQuery3D")],C);let M=class extends y.Z{constructor(e){super(e)}queryFeaturesDehydrated(e,t){return this.source.queryFeaturesJSON(e,t).then(S.PA,i=>{if(i&&"query-features-json:unsupported"===i.name)return this.layer.queryFeatures(e,t);throw i})}queryFeatureCount(e,t){return this.layer.queryFeatureCount(e,t)}};(0,a._)([(0,p.Cb)({constructOnly:!0})],M.prototype,"layer",void 0),(0,a._)([(0,p.Cb)({constructOnly:!0})],M.prototype,"source",void 0),M=(0,a._)([(0,b.j)("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileClientQuery3D")],M);class f{constructor(t){this._memoryCache=null,this._capabilities=null;const i=t.layerView.layer;this._layerView=t.layerView,this.objectIdField=i.objectIdField,this.globalIdField="globalIdField"in i?i.globalIdField:null,this._returnZ=t.returnZ,this._returnM=t.returnM;const d=this._layerView.view.resourceController;this.query=function h(e,t){return"feature"===e.type&&"feature-layer"===e.source.type?(0,E.pC)(e.infoFor3D)?new u({layer:e}):new s({layer:e,controller:t}):"feature"===e.type&&"memory"===e.source.type||"csv"===e.type||"geojson"===e.type||"oriented-imagery"===e.type||"wfs"===e.type?new M({layer:e,source:e.source}):"ogc-feature"===e.type?new C({layer:e}):null}(i,d.normal),d&&this._memoryCacheEnabled&&(this._memoryCache=d.memoryController.newCache(i.uid))}get _memoryCacheEnabled(){switch(this._layerView.layer.source.type){case"feature-layer":case"ogc-feature":case"oriented-imagery":return!0;case"csv":case"geojson":case"memory":case"wfs":return!1}}destroy(){this._memoryCache=(0,E.SC)(this._memoryCache),this.query.destroy()}createQuery(){const t=this._layerView.layer.createQuery();return t.outFields=this._layerView.availableFields,t.returnZ=this._returnZ,t.returnM=this._returnM,t.outSpatialReference=this.tilingScheme.spatialReference,t}get memoryCache(){return this._memoryCache}get viewingMode(){return this._layerView.view.state.viewingMode}get tilingScheme(){return this._layerView.view.featureTiles.tilingScheme}get scheduler(){const t=this._layerView.view.resourceController;return t?t.scheduler:null}get geometryType(){return this._layerView.layer.geometryType}get fullExtent(){return this._layerView.layer.fullExtent}get tileMaxRecordCount(){return this._layerView.layer.capabilities.query.tileMaxRecordCount}get maxRecordCount(){return this._layerView.layer.capabilities.query.maxRecordCount}get capabilities(){return(0,E.pC)(this._capabilities)||(this._capabilities=(0,W.A)(this._layerView.layer)),this._capabilities}logFetchError(t,i){t.error("#fetchTile()",this._layerView.layer,i&&i.message?i.message:i)}}var c=o(36967),Z=o(41632),x=o(23147),T=o(56482),Y=o(45611),k=o(94421);let O=class extends((0,k.Z)((0,w.R)((0,T.Z)((0,I.A)(Y.Z))))){constructor(e){super(e),this._controllerTotal=0,this._processorTotal=0,this.suspendResumeExtentMode="data"}initialize(){this.handles.add((0,l.YP)(()=>this._updatingRequiredFieldsPromise,e=>this.updatingHandles.addPromise(e),l.tX))}destroy(){this.updatingHandles.removeAll(),this.handles.removeAll(),this._fetcherContext=(0,E.SC)(this._fetcherContext)}get maximumNumberOfFeatures(){return this.controller?.maximumNumberOfFeatures??this._get("maximumNumberOfFeatures")}set maximumNumberOfFeatures(e){this._set("maximumNumberOfFeatures",e),this.controller&&(this.controller.maximumNumberOfFeatures=e)}get maximumNumberOfFeaturesExceeded(){return!!this.controller&&!(this.suspended||!this.controller.maximumNumberOfFeaturesExceeded)}get updatingProgressValue(){let e=0;if(this.controller?.updating){const i=this.controller.updatingRemaining,d=Math.max(this.controller.updatingTotal,this._controllerTotal);d>0&&(e=(d-i)/d,this._controllerTotal=d)}let t=0;if(this.processor?.updating){const i=this.processor.updatingRemaining,d=Math.max(i,this._processorTotal);d>0&&(t=(d-i)/d,this._processorTotal=d)}return.5*(e+t)}get updatePolicy(){if(!this.controller)return x.j.ASYNC;switch(this.controller.mode){case"snapshot":{const e=ee[this.layer.geometryType];return null==e||this.controller.serviceDataCount>e?x.j.ASYNC:x.j.SYNC}case"tiles":return x.j.ASYNC}}get hasZ(){const e=this.layer,t=e.capabilities&&e.capabilities.data;return!(!t||!t.supportsZ)&&("returnZ"in e&&null!=e.returnZ?e.returnZ:t.supportsZ)}get hasM(){const e=this.layer,t=e.capabilities&&e.capabilities.data;return!(!t||!t.supportsM)&&"returnM"in e&&null!=e.returnM&&e.returnM}setVisibility(e,t){this.processor?.setObjectIdVisibility(e,t)}createQuery(){return super.createQuery()}queryFeatures(e,t){const i=()=>super.queryFeatures(e,t);return"mesh"===this.layer.geometryType?this._queryFeaturesMesh(this._ensureQuery(e),i):i()}beforeSetController(e){e.maximumNumberOfFeatures=this.maximumNumberOfFeatures}createController(){this._fetcherContext=new f({layerView:this,returnZ:this.hasZ,returnM:this.hasM});const e=new D.g({layerView:this,context:this._fetcherContext,graphics:new c.g,extent:this.clippingExtent});return this.updatingHandles.add(()=>e.serviceDataExtent,t=>{this.processor&&(this.processor.dataExtent=t)},l.nn),this.handles.add((0,l.YP)(()=>this.suspended,t=>{t?e.suspend():e.resume()},l.tX)),this.updatingHandles.add(()=>this.processor?.displayFeatureLimit,t=>e.displayFeatureLimit=t,l.nn),this.handles.add((0,l.gx)(()=>!this.updating,()=>{this._controllerTotal=0,this._processorTotal=0})),e}doRefresh(e){var t=this;return(0,P.Z)(function*(){e&&!t.suspended&&t.controller&&t.controller.refetch(),t.processor.refreshFilter()})()}getUsedMemory(){return(this.processor?.usedMemory??0)+(this.controller?.memoryForUnusedFeatures??0)}getUnloadedMemory(){const t=this.controller?.expectedFeatureDiff??0,i=this.processor?.loadedFeatures??0;return(this.processor?.unprocessedMemoryEstimate??0)+t*(this.processor?.usedMemoryPerFeature??0)*(i/(i+t))}ignoresMemoryFactor(){return this.controller?.hasMaximumNumberOfFeaturesOverride}_queryFeaturesMesh(e,t){var i=this;return(0,P.Z)(function*(){yield i._validateQueryFeaturesMesh(e);const d=yield t();if(e&&e.outStatistics||(0,E.Wi)(i.graphics3DProcessor))return d;const g=i.layer.objectIdField,L=i.graphics3DProcessor.graphics3DGraphicsByObjectID,R=[];for(const A of d.features)if(A.geometry){const K=L.get(A.attributes[g]);K&&(A.geometry=(0,V.kB)(K.graphic.geometry),R.push(A))}else R.push(A);return d.features=R,d})()}_validateQueryFeaturesMesh(e){var t=this;return(0,P.Z)(function*(){if(!e)return;const i=g=>{throw new j.Z("feature-layer-view:unsupported-query",`Queries on Mesh feature collection layers do not support '${g}'`)},d=["quantizationParameters","geometryPrecision","maxAllowableOffset"];for(const g of d)null!=e[g]&&i(g);"returnM"in e&&e.returnM&&i("returnM"),"returnCentroid"in e&&e.returnCentroid&&i("returnCentroid"),(0,E.pC)(e.outSpatialReference)&&!e.outSpatialReference.equals(t.view.spatialReference)&&i("outSpatialReference")})()}get performanceInfo(){const e=this.controller?.displayFeatureLimit,t=(0,E.pC)(e)?e.averageSymbolComplexity:void 0,i=(0,E.pC)(t)?`f:${t.primitivesPerFeature},v:${t.primitivesPerCoordinate}`:"n/a";return{...this._getResourceInfo(),partial:this.maximumNumberOfFeaturesExceeded,mode:this.controller?.mode??"n/a",symbolComplexity:i,nodes:this.controller?.tileDescriptors.length??0,...this.controller?.debug??{storedFeatures:0,totalVertices:0}}}get test(){return{updatePolicy:this.updatePolicy,controller:this.controller,loadedGraphics:this.controller?.graphics}}};(0,a._)([(0,p.Cb)()],O.prototype,"layer",void 0),(0,a._)([(0,p.Cb)()],O.prototype,"controller",void 0),(0,a._)([(0,p.Cb)()],O.prototype,"_controllerTotal",void 0),(0,a._)([(0,p.Cb)()],O.prototype,"_processorTotal",void 0),(0,a._)([(0,p.Cb)()],O.prototype,"maximumNumberOfFeatures",null),(0,a._)([(0,p.Cb)()],O.prototype,"maximumNumberOfFeaturesExceeded",null),(0,a._)([(0,p.Cb)(Z.q)],O.prototype,"updatingProgress",void 0),(0,a._)([(0,p.Cb)({readOnly:!0})],O.prototype,"updatingProgressValue",null),(0,a._)([(0,p.Cb)({readOnly:!0})],O.prototype,"updatePolicy",null),(0,a._)([(0,p.Cb)({readOnly:!0})],O.prototype,"hasZ",null),(0,a._)([(0,p.Cb)({readOnly:!0})],O.prototype,"hasM",null),(0,a._)([(0,p.Cb)()],O.prototype,"suspendResumeExtentMode",void 0),O=(0,a._)([(0,b.j)("esri.views.3d.layers.FeatureLayerViewBase3D")],O);const ee={point:5e3,polygon:500,polyline:1e3},te=O},56482:($,B,o)=>{o.d(B,{Z:()=>H});var P=o(15861),a=o(17626),j=o(26584),E=o(63290),l=o(62208),p=o(10699),m=o(32917),_=o(77712),D=(o(90912),o(85931),o(76898)),w=o(13812),I=o(2319),W=o(98624),y=o(36630),v=o(59990),S=o(96854),U=o(46679),N=o(10023);const G="esri.views.layers.FeatureLayerView",z=E.Z.getLogger(G),H=J=>{let F=class extends J{constructor(...r){super(...r),this._updatingRequiredFieldsPromise=null,this.filter=null,this.timeExtent=null,this.layer=null,this.requiredFields=[],this.view=null}initialize(){this.handles.add([(0,m.YP)(()=>{const r=this.layer;return[r?.elevationInfo?.featureExpressionInfo,r&&"displayField"in r?r.displayField:null,r&&"timeInfo"in r&&r.timeInfo,r&&"renderer"in r&&r.renderer,r&&"labelingInfo"in r&&r.labelingInfo,r&&"floorInfo"in r&&r.floorInfo,this.filter,this.featureEffect,this.timeExtent]},()=>this._handleRequiredFieldsChange(),m.tX),(0,m.on)(()=>this.view?.floors,"change",()=>this._handleRequiredFieldsChange()),(0,m.on)(()=>{const r=this.layer;return r&&"sublayers"in r?r.sublayers:null},"change",()=>this._handleRequiredFieldsChange())])}get availableFields(){const{layer:r,layer:{fieldsIndex:n},requiredFields:s}=this;return(0,y.Q0)(n,"outFields"in r&&r.outFields?[...(0,y.Lk)(n,r.outFields),...s]:s)}get featureEffect(){return this.layer&&"featureEffect"in this.layer?this.layer.featureEffect:null}set featureEffect(r){this._override("featureEffect",r)}get maximumNumberOfFeatures(){return 0}set maximumNumberOfFeatures(r){z.error("#maximumNumberOfFeatures=","Setting maximum number of features is not supported")}get maximumNumberOfFeaturesExceeded(){return!1}highlight(r){throw new Error("missing implementation")}createQuery(){const r={outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference},n=(0,l.pC)(this.filter)?this.filter.createQuery(r):new S.Z(r);if("feature"===this.layer.type){const s=(0,v.c)(this);(0,l.pC)(s)&&(n.where=n.where?`(${n.where}) AND (${s})`:s)}return(0,l.pC)(this.timeExtent)&&(n.timeExtent=(0,l.pC)(n.timeExtent)?n.timeExtent.intersection(this.timeExtent):this.timeExtent.clone()),n}createAggregateQuery(){return new S.Z({outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference})}queryFeatures(r,n){throw new Error("missing implementation")}queryObjectIds(r,n){throw new Error("missing implementation")}queryFeatureCount(r,n){throw new Error("missing implementation")}queryExtent(r,n){throw new Error("missing implementation")}fetchPopupFeatures(r,n){var s=this;return(0,P.Z)(function*(){const u=s.validateFetchPopupFeatures(n);if(u)throw u;return s.fetchClientPopupFeatures(n)})()}_loadArcadeModules(r){return r.get("expressionInfos.length")||Array.isArray(r.content)&&r.content.some(n=>"expression"===n.type)?(0,U.LC)():Promise.resolve()}_handleRequiredFieldsChange(){const r=this._updateRequiredFields();this._set("_updatingRequiredFieldsPromise",r),r.then(()=>{this._updatingRequiredFieldsPromise===r&&this._set("_updatingRequiredFieldsPromise",null)})}_updateRequiredFields(){var r=this;return(0,P.Z)(function*(){if(!r.layer||!r.view)return;const n="3d"===r.view.type,{layer:s,layer:{fieldsIndex:u,objectIdField:C}}=r,M="renderer"in s&&s.renderer,h="orderBy"in s&&s.orderBy,f="featureReduction"in s?s.featureReduction:null,c=new Set,Z=yield(0,p.as)([M?M.collectRequiredFields(c,u):null,(0,y.Mu)(c,s),n?(0,y.vl)(c,s):null,(0,l.pC)(r.filter)?(0,y.Ll)(c,s,r.filter):null,(0,l.pC)(r.featureEffect)?(0,y.Ll)(c,s,r.featureEffect.filter):null,f?(0,y.ZV)(c,s,f):null,h?(0,y.Qj)(c,s,h):null]);if("timeInfo"in s&&s.timeInfo&&r.timeExtent&&(0,y.gd)(c,s.fieldsIndex,[s.timeInfo.startField,s.timeInfo.endField]),"feature"===s.type&&(s.floorInfo&&(0,y.gd)(c,s.fieldsIndex,[s.floorInfo.floorField]),n&&(0,l.pC)(s.infoFor3D)&&(null==s.globalIdField&&z.error("globalIdField missing on 3DObjectFeatureLayer"),(0,y.gd)(c,s.fieldsIndex,[s.globalIdField]))),"subtype-group"===s.type){(0,y.AB)(c,u,s.subtypeField);const T=s.sublayers.map(Y=>Promise.all([Y.renderer?.collectRequiredFields(c,u),(0,y.Mu)(c,Y)]));yield(0,p.as)(T)}for(const T of Z)T.error&&z.error(T.error);(0,y.AB)(c,u,C),n&&"displayField"in s&&s.displayField&&(0,y.AB)(c,u,s.displayField);const x=Array.from(c).sort();r._set("requiredFields",x)})()}validateFetchPopupFeatures(r){if((0,l.Wi)(r))return null;for(const n of r.clientGraphics??[]){const s=n.layer;if("popupEnabled"in s&&!s.popupEnabled)return new j.Z("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:s});if(n.isAggregate){const u="featureReduction"in s?s.featureReduction:null;if(!(u&&"popupTemplate"in u&&u.popupEnabled&&u.popupTemplate))return new j.Z("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:s})}else if("popupTemplate"in s&&!(0,N.V)(s,r))return new j.Z("featurelayerview:fetchPopupFeatures","Layer does not define a popup template",{layer:s})}}fetchClientPopupFeatures(r){var n=this;return(0,P.Z)(function*(){const s=(0,l.pC)(r)?r.clientGraphics:null;if(!s||0===s.length)return[];const u=new Array(s.length),C=new Map,M=yield n.createPopupQuery(r);for(let h=0;h<s.length;h++){const f=s[h];if(f.isAggregate){u[h]=f;continue}const c=f.layer;if(!("popupEnabled"in c))continue;const Z=(0,y.Lk)(n.layer.fieldsIndex,M.outFields),x=(0,N.V)(c,r);if((0,l.Wi)(x))continue;const T=yield n._loadArcadeModules(x);T&&T.arcadeUtils.hasGeometryOperations(x)||!(0,y.R9)(Z,f)?C.set(f.getObjectId(),{graphic:f,index:h}):u[h]=f}if("stream"===n.layer.type||0===C.size)return u.filter(Boolean);M.objectIds=Array.from(C.keys());try{const h=yield n.layer.queryFeatures(M);for(const f of h.features){const{graphic:{geometry:c},index:Z}=C.get(f.getObjectId());f.geometry||(f.geometry=c),u[Z]=f}}catch{}return u.filter(Boolean)})()}createPopupQuery(r){var n=this;return(0,P.Z)(function*(){const s=n.layer.createQuery(),u=new Set;let C=!1;const M=(0,l.pC)(r)&&r.clientGraphics?r.clientGraphics.map(h=>h.layer):[n.layer];for(const h of M){if(!("popupEnabled"in h))continue;const f=(0,N.V)(h,r);if((0,l.Wi)(f))continue;const c=yield n._loadArcadeModules(f),Z=c&&c.arcadeUtils.hasGeometryOperations(f);C=!("point"!==n.layer.geometryType&&!Z);const x=yield(0,N.e)(n.layer,f);for(const T of x)u.add(T)}if(s.returnGeometry=C,s.returnZ=C,s.returnM=C,s.outFields=Array.from(u),s.outSpatialReference=n.view.spatialReference,"feature"===n.layer.type){const h=(0,v.c)(n);(0,l.pC)(h)&&(s.where=s.where?`(${s.where}) AND (${h})`:h)}return s})()}canResume(){return!(!super.canResume()||(0,l.pC)(this.timeExtent)&&this.timeExtent.isEmpty)}};return(0,a._)([(0,_.Cb)()],F.prototype,"_updatingRequiredFieldsPromise",void 0),(0,a._)([(0,_.Cb)({readOnly:!0})],F.prototype,"availableFields",null),(0,a._)([(0,_.Cb)({type:I.Z})],F.prototype,"featureEffect",null),(0,a._)([(0,_.Cb)({type:W.Z})],F.prototype,"filter",void 0),(0,a._)([(0,_.Cb)(w.qG)],F.prototype,"timeExtent",void 0),(0,a._)([(0,_.Cb)()],F.prototype,"layer",void 0),(0,a._)([(0,_.Cb)({type:Number})],F.prototype,"maximumNumberOfFeatures",null),(0,a._)([(0,_.Cb)({readOnly:!0,type:Boolean})],F.prototype,"maximumNumberOfFeaturesExceeded",null),(0,a._)([(0,_.Cb)({readOnly:!0})],F.prototype,"requiredFields",void 0),(0,a._)([(0,_.Cb)()],F.prototype,"suspended",void 0),(0,a._)([(0,_.Cb)()],F.prototype,"view",void 0),F=(0,a._)([(0,D.j)(G)],F),F}},94421:($,B,o)=>{o.d(B,{Z:()=>b});var P=o(17626),a=o(63290),j=o(10699),E=o(32917),l=o(77712),_=(o(90912),o(85931),o(76898));const b=V=>{let D=class extends V{initialize(){this.handles.add((0,E.on)(()=>this.layer,"refresh",w=>{this.doRefresh(w.dataChanged).catch(I=>{(0,j.D_)(I)||a.Z.getLogger(this.declaredClass).error(I)})}),"RefreshableLayerView")}};return(0,P._)([(0,l.Cb)()],D.prototype,"layer",void 0),D=(0,P._)([(0,_.j)("esri.layers.mixins.RefreshableLayerView")],D),D}},10023:($,B,o)=>{o.d(B,{V:()=>p,e:()=>E});var P=o(15861),a=o(62208),j=o(36630);function E(m){return l.apply(this,arguments)}function l(){return(l=(0,P.Z)(function*(m,_=m.popupTemplate){if((0,a.Wi)(_))return[];const b=yield _.getRequiredFields(m.fieldsIndex),{lastEditInfoEnabled:V}=_,{objectIdField:D,typeIdField:w,globalIdField:I,relationships:W}=m;if(b.includes("*"))return["*"];const y=V?yield(0,j.CH)(m):[],v=(0,j.Q0)(m.fieldsIndex,[...b,...y]);return w&&v.push(w),v&&D&&m.fieldsIndex?.has(D)&&!v.includes(D)&&v.push(D),v&&I&&m.fieldsIndex?.has(I)&&!v.includes(I)&&v.push(I),W&&W.forEach(S=>{const{keyField:U}=S;v&&U&&m.fieldsIndex?.has(U)&&!v.includes(U)&&v.push(U)}),v})).apply(this,arguments)}function p(m,_){return m.popupTemplate?m.popupTemplate:(0,a.pC)(_)&&_.defaultPopupTemplateEnabled&&(0,a.pC)(m.defaultPopupTemplate)?m.defaultPopupTemplate:null}}}]);