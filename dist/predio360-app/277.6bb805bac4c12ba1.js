"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[277],{14259:(Be,$,l)=>{l.d($,{q:()=>U});var d,b,w={};d={get exports(){return w},set exports(g){w=g}},void 0!==(b=function(){function X(m,M,W,Z,F){for(;Z>W;){if(Z-W>600){var V=Z-W+1,k=M-W+1,z=Math.log(V),O=.5*Math.exp(2*z/3),_=.5*Math.sqrt(z*O*(V-O)/V)*(k-V/2<0?-1:1);X(m,M,Math.max(W,Math.floor(M-k*O/V+_)),Math.min(Z,Math.floor(M+(V-k)*O/V+_)),F)}var q=m[M],te=W,S=Z;for(C(m,W,M),F(m[Z],q)>0&&C(m,W,Z);te<S;){for(C(m,te,S),te++,S--;F(m[te],q)<0;)te++;for(;F(m[S],q)>0;)S--}0===F(m[W],q)?C(m,W,S):C(m,++S,Z),S<=M&&(W=S+1),M<=S&&(Z=S-1)}}function C(m,M,W){var Z=m[M];m[M]=m[W],m[W]=Z}function y(m,M){return m<M?-1:m>M?1:0}return function g(m,M,W,Z,F){X(m,M,W||0,Z||m.length-1,F||y)}}())&&(d.exports=b);const U=w},36592:(Be,$,l)=>{l.d($,{Q:()=>u});var d=l(85931),H=l(62208),b=l(77029),w=l(14259);class u{constructor(n=9,s){this._compareMinX=C,this._compareMinY=y,this._toBBox=i=>i,this._maxEntries=Math.max(4,n||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),s&&("function"==typeof s?this._toBBox=s:this._initFormat(s)),this.clear()}destroy(){this.clear(),z.prune(),O.prune(),_.prune(),q.prune()}all(n){this._all(this._data,n)}search(n,s){let i=this._data;const p=this._toBBox;if(V(n,i))for(z.clear();i;){for(let c=0,f=i.children.length;c<f;c++){const x=i.children[c],B=i.leaf?p(x):x;V(n,B)&&(i.leaf?s(x):F(n,B)?this._all(x,s):z.push(x))}i=z.pop()}}collides(n){let s=this._data;const i=this._toBBox;if(!V(n,s))return!1;for(z.clear();s;){for(let p=0,c=s.children.length;p<c;p++){const f=s.children[p],x=s.leaf?i(f):f;if(V(n,x)){if(s.leaf||F(n,x))return!0;z.push(f)}}s=z.pop()}return!1}load(n){if(!n.length)return this;if(n.length<this._minEntries){for(let i=0,p=n.length;i<p;i++)this.insert(n[i]);return this}let s=this._build(n.slice(0,n.length),0,n.length-1,0);if(this._data.children.length)if(this._data.height===s.height)this._splitRoot(this._data,s);else{if(this._data.height<s.height){const i=this._data;this._data=s,s=i}this._insert(s,this._data.height-s.height-1,!0)}else this._data=s;return this}insert(n){return n&&this._insert(n,this._data.height-1),this}clear(){return this._data=new ue([]),this}remove(n){if(!n)return this;let s,i=this._data,p=null,c=0,f=!1;const x=this._toBBox(n);for(_.clear(),q.clear();i||_.length>0;){if(i||(i=(0,H.j0)(_.pop()),p=_.data[_.length-1],c=q.pop()??0,f=!0),i.leaf&&(s=(0,d.cq)(i.children,n,i.children.length,i.indexHint),-1!==s))return i.children.splice(s,1),_.push(i),this._condense(_),this;f||i.leaf||!F(i,x)?p?(c++,i=p.children[c],f=!1):i=null:(_.push(i),q.push(c),c=0,p=i,i=i.children[0])}return this}toJSON(){return this._data}fromJSON(n){return this._data=n,this}_all(n,s){let i=n;for(O.clear();i;){if(!0===i.leaf)for(const p of i.children)s(p);else O.pushArray(i.children);i=O.pop()??null}}_build(n,s,i,p){const c=i-s+1;let f=this._maxEntries;if(c<=f){const I=new ue(n.slice(s,i+1));return U(I,this._toBBox),I}p||(p=Math.ceil(Math.log(c)/Math.log(f)),f=Math.ceil(c/f**(p-1)));const x=new xe([]);x.height=p;const B=Math.ceil(c/f),E=B*Math.ceil(Math.sqrt(f));k(n,s,i,E,this._compareMinX);for(let I=s;I<=i;I+=E){const Y=Math.min(I+E-1,i);k(n,I,Y,B,this._compareMinY);for(let N=I;N<=Y;N+=B){const A=Math.min(N+B-1,Y);x.children.push(this._build(n,N,A,p-1))}}return U(x,this._toBBox),x}_chooseSubtree(n,s,i,p){for(;p.push(s),!0!==s.leaf&&p.length-1!==i;){let c,f=1/0,x=1/0;for(let B=0,E=s.children.length;B<E;B++){const I=s.children[B],Y=m(I),N=W(n,I)-Y;N<x?(x=N,f=Y<f?Y:f,c=I):N===x&&Y<f&&(f=Y,c=I)}s=c||s.children[0]}return s}_insert(n,s,i){const c=i?n:(0,this._toBBox)(n);_.clear();const f=this._chooseSubtree(c,this._data,s,_);for(f.children.push(n),X(f,c);s>=0&&_.data[s].children.length>this._maxEntries;)this._split(_,s),s--;this._adjustParentBBoxes(c,_,s)}_split(n,s){const i=n.data[s],p=i.children.length,c=this._minEntries;this._chooseSplitAxis(i,c,p);const f=this._chooseSplitIndex(i,c,p);if(!f)return void console.log("  Error: assertion failed at PooledRBush._split: no valid split index");const x=i.children.splice(f,i.children.length-f),B=i.leaf?new ue(x):new xe(x);B.height=i.height,U(i,this._toBBox),U(B,this._toBBox),s?n.data[s-1].children.push(B):this._splitRoot(i,B)}_splitRoot(n,s){this._data=new xe([n,s]),this._data.height=n.height+1,U(this._data,this._toBBox)}_chooseSplitIndex(n,s,i){let p,c,f;p=c=1/0;for(let x=s;x<=i-s;x++){const B=g(n,0,x,this._toBBox),E=g(n,x,i,this._toBBox),I=Z(B,E),Y=m(B)+m(E);I<p?(p=I,f=x,c=Y<c?Y:c):I===p&&Y<c&&(c=Y,f=x)}return f}_chooseSplitAxis(n,s,i){const p=n.leaf?this._compareMinX:C,c=n.leaf?this._compareMinY:y;this._allDistMargin(n,s,i,p)<this._allDistMargin(n,s,i,c)&&n.children.sort(p)}_allDistMargin(n,s,i,p){n.children.sort(p);const c=this._toBBox,f=g(n,0,s,c),x=g(n,i-s,i,c);let B=M(f)+M(x);for(let E=s;E<i-s;E++){const I=n.children[E];X(f,n.leaf?c(I):I),B+=M(f)}for(let E=i-s-1;E>=s;E--){const I=n.children[E];X(x,n.leaf?c(I):I),B+=M(x)}return B}_adjustParentBBoxes(n,s,i){for(let p=i;p>=0;p--)X(s.data[p],n)}_condense(n){for(let s=n.length-1;s>=0;s--){const i=n.data[s];if(0===i.children.length)if(s>0){const p=n.data[s-1],c=p.children;c.splice((0,d.cq)(c,i,c.length,p.indexHint),1)}else this.clear();else U(i,this._toBBox)}}_initFormat(n){const s=["return a"," - b",";"];this._compareMinX=new Function("a","b",s.join(n[0])),this._compareMinY=new Function("a","b",s.join(n[1])),this._toBBox=new Function("a","return {minX: a"+n[0]+", minY: a"+n[1]+", maxX: a"+n[2]+", maxY: a"+n[3]+"};")}}function U(h,n){g(h,0,h.children.length,n,h)}function g(h,n,s,i,p){p||(p=new ue([])),p.minX=1/0,p.minY=1/0,p.maxX=-1/0,p.maxY=-1/0;for(let c,f=n;f<s;f++)c=h.children[f],X(p,h.leaf?i(c):c);return p}function X(h,n){h.minX=Math.min(h.minX,n.minX),h.minY=Math.min(h.minY,n.minY),h.maxX=Math.max(h.maxX,n.maxX),h.maxY=Math.max(h.maxY,n.maxY)}function C(h,n){return h.minX-n.minX}function y(h,n){return h.minY-n.minY}function m(h){return(h.maxX-h.minX)*(h.maxY-h.minY)}function M(h){return h.maxX-h.minX+(h.maxY-h.minY)}function W(h,n){return(Math.max(n.maxX,h.maxX)-Math.min(n.minX,h.minX))*(Math.max(n.maxY,h.maxY)-Math.min(n.minY,h.minY))}function Z(h,n){const s=Math.max(h.minX,n.minX),i=Math.max(h.minY,n.minY),p=Math.min(h.maxX,n.maxX),c=Math.min(h.maxY,n.maxY);return Math.max(0,p-s)*Math.max(0,c-i)}function F(h,n){return h.minX<=n.minX&&h.minY<=n.minY&&n.maxX<=h.maxX&&n.maxY<=h.maxY}function V(h,n){return n.minX<=h.maxX&&n.minY<=h.maxY&&n.maxX>=h.minX&&n.maxY>=h.minY}function k(h,n,s,i,p){const c=[n,s];for(;c.length;){const f=(0,H.j0)(c.pop()),x=(0,H.j0)(c.pop());if(f-x<=i)continue;const B=x+Math.ceil((f-x)/i/2)*i;(0,w.q)(h,B,x,f,p),c.push(x,B,B,f)}}const z=new b.Z,O=new b.Z,_=new b.Z,q=new b.Z({deallocator:void 0});class te{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class S extends te{constructor(){super(...arguments),this.height=1,this.indexHint=new d.SO}}class ue extends S{constructor(n){super(),this.children=n,this.leaf=!0}}class xe extends S{constructor(n){super(),this.children=n,this.leaf=!1}}},60277:(Be,$,l)=>{l.r($),l.d($,{default:()=>ft});var d=l(17626),H=l(46160),b=l(26584),w=l(63290),u=l(62208),U=l(99959),g=l(77712),X=l(66656),y=(l(85931),l(68653)),m=l(76898),M=l(99433),W=l(44917),Z=l(552),F=l(49286),V=l(99555),k=l(15861),z=l(84792),O=l(21726),_=l(35948),te=(l(90912),l(61996)),S=l(86810),ue=l(47996),xe=l(14517),h=l(30217),n=l(550),s=l(67831),i=l(84161);const c=(0,l(28093).c)(),f=(0,n.c)(),x=(0,n.c)(),B=(0,n.c)();function E(e,t,o){return(0,i.s)(c,t[0],t[1],1),(0,i.t)(c,c,(0,h.t)(f,o)),0===c[2]?(0,s.s)(e,c[0],c[1]):(0,s.s)(e,c[0]/c[2],c[1]/c[2])}function Y(e,t,o,r,a,v,R,P,j){(0,h.s)(e,t,r,v,o,a,R,1,1,1),(0,i.s)(c,P,j,1),(0,h.a)(f,e);const[G,J,ee]=(0,i.t)(c,c,(0,h.t)(f,f));return(0,h.s)(f,G,0,0,0,J,0,0,0,ee),(0,h.m)(e,f,e)}var N=l(23841),A=l(99770),T=l(72642),Ie=l(37118),ve=l(55915),Se=l(65234),ze=l(79608);l(8314);let je=class extends ze.j{projectOrWarn(e,t){if((0,u.Wi)(e))return e;const{geometry:o,pending:r}=(0,ve.dz)(e,t);return r?null:r||o?o:(w.Z.getLogger(this.declaredClass).warn("geometry could not be projected to the spatial reference",{georeference:this,geometry:e,sourceSpatialReference:e.spatialReference,targetSpatialReference:t}),null)}};je=(0,d._)([(0,m.j)("esri.layers.support.GeoreferenceBase")],je);const Ce=je,We=(0,n.c)(),L=(0,A.a)();let Pe=class extends xe.Z{constructor(){super(...arguments),this.sourcePoint=null,this.mapPoint=null}};(0,d._)([(0,g.Cb)()],Pe.prototype,"sourcePoint",void 0),(0,d._)([(0,g.Cb)({type:T.Z})],Pe.prototype,"mapPoint",void 0),Pe=(0,d._)([(0,m.j)("esri.layers.support.ControlPoint")],Pe);let Q=class extends((0,S.eC)(Ce)){constructor(e){super(e),this.controlPoints=null,this.height=0,this.type="control-points",this.width=0}readControlPoints(e,t){const o=Se.Z.fromJSON(t.spatialReference),r=(0,n.f)(...t.coefficients,1);return e.map(a=>((0,s.s)(L,a.x,a.y),E(L,L,r),{sourcePoint:a,mapPoint:new T.Z({x:L[0],y:L[1],spatialReference:o})}))}writeControlPoints(e,t,o,r){if((0,u.Wi)(this.transform)){const a=new b.Z("web-document-write:invalid-georeference","Invalid 'controlPoints', 'width', 'height' configuration.",{layer:r?.layer,georeference:this});r?.messages?r.messages.push(a):w.Z.getLogger(this.declaredClass).error(a.name,a.message)}else(0,u.pC)(e)&&D(e[0])&&(t.controlPoints=e.map(a=>{const v=(0,u.Wg)(a.sourcePoint);return{x:v.x,y:v.y}}),t.spatialReference=e[0].mapPoint.spatialReference.toJSON(),t.coefficients=this.transform.slice(0,8))}get coords(){if((0,u.Wi)(this.controlPoints))return null;const e=this._updateTransform(We);return(0,u.Wi)(e)||!D(this.controlPoints[0])?null:function Je(e,t,o,r){const a=(0,A.f)(0,o),v=(0,A.f)(0,0),R=(0,A.f)(t,0),P=(0,A.f)(t,o);return E(a,a,e),E(v,v,e),E(R,R,e),E(P,P,e),new Ie.Z({rings:[[a,v,R,P,a]],spatialReference:r})}(e,this.width,this.height,this.controlPoints[0].mapPoint.spatialReference)}set coords(e){if((0,u.Wi)(this.controlPoints)||!D(this.controlPoints[0]))return;const t=this.controlPoints[0].mapPoint.spatialReference;if(e=this.projectOrWarn(e,t),(0,u.Wi)(e))return;const{width:o,height:r}=this,{rings:[[a,v,R,P]]}=e,j={sourcePoint:(0,N.vW)(0,r),mapPoint:new T.Z({x:a[0],y:a[1],spatialReference:t})},G={sourcePoint:(0,N.vW)(0,0),mapPoint:new T.Z({x:v[0],y:v[1],spatialReference:t})},J={sourcePoint:(0,N.vW)(o,0),mapPoint:new T.Z({x:R[0],y:R[1],spatialReference:t})},ee={sourcePoint:(0,N.vW)(o,r),mapPoint:new T.Z({x:P[0],y:P[1],spatialReference:t})};D(j)&&D(G)&&D(J)&&D(ee)&&(Ye(We,j,G,J,ee),this.controlPoints=(0,u.Wg)(this.controlPoints).map(({sourcePoint:ae})=>((0,s.s)(L,ae.x,ae.y),E(L,L,We),{sourcePoint:ae,mapPoint:new T.Z({x:L[0],y:L[1],spatialReference:t})})))}get inverseTransform(){return(0,u.Wi)(this.transform)?null:(0,h.e)((0,n.c)(),this.transform)}get transform(){return this._updateTransform()}toMap(e){if((0,u.Wi)(e)||(0,u.Wi)(this.transform)||(0,u.Wi)(this.controlPoints)||!D(this.controlPoints[0]))return null;(0,s.s)(L,e.x,e.y);const t=this.controlPoints[0].mapPoint.spatialReference;return E(L,L,this.transform),new T.Z({x:L[0],y:L[1],spatialReference:t})}toSource(e){if((0,u.Wi)(e)||(0,u.Wi)(this.inverseTransform)||(0,u.Wi)(this.controlPoints)||!D(this.controlPoints[0]))return null;const t=this.controlPoints[0].mapPoint.spatialReference;return e=e.normalize(),e=(0,ve.dz)(e,t).geometry,(0,u.Wi)(e)?null:((0,s.s)(L,e.x,e.y),E(L,L,this.inverseTransform),(0,N.vW)(L[0],L[1]))}_updateTransform(e){const{controlPoints:t,width:o,height:r}=this;if((0,u.Wi)(t)||!(o>0)||!(r>0))return null;const[a,v,R,P]=t;if(!D(a))return null;const j=a.mapPoint.spatialReference,G=this._projectControlPoint(v,j),J=this._projectControlPoint(R,j),ee=this._projectControlPoint(P,j);if(!(G.valid&&J.valid&&ee.valid&&D(G.controlPoint)))return null;(0,u.Wi)(e)&&(e=(0,n.c)());let ae=null;return ae=D(J.controlPoint)&&D(ee.controlPoint)?Ye(e,a,G.controlPoint,J.controlPoint,ee.controlPoint):D(J.controlPoint)?function Ke(e,t,o,r){return re(ne,se,t),re(oe,ie,o),re(pe,me,r),(0,s.l)(le,ne,oe,.5),(0,s.r)(le,pe,le,Math.PI),(0,s.l)(ce,se,ie,.5),(0,s.r)(ce,me,ce,Math.PI),Le(e,ne,oe,pe,le,se,ie,me,ce)}(e,a,G.controlPoint,J.controlPoint):function Ne(e,t,o){return re(ne,se,t),re(oe,ie,o),(0,s.r)(pe,oe,ne,Ee),(0,s.r)(le,ne,oe,Ee),(0,s.r)(me,ie,se,-Ee),(0,s.r)(ce,se,ie,-Ee),Le(e,ne,oe,pe,le,se,ie,me,ce)}(e,a,G.controlPoint),ae.every(gt=>0===gt)?null:ae}_projectControlPoint(e,t){if(!D(e))return{valid:!0,controlPoint:e};const{sourcePoint:o,mapPoint:r}=e,{geometry:a,pending:v}=(0,ve.dz)(r,t);return v?{valid:!1,controlPoint:null}:v||a?{valid:!0,controlPoint:{sourcePoint:o,mapPoint:a}}:(w.Z.getLogger(this.declaredClass).warn("map point could not be projected to the spatial reference",{georeference:this,controlPoint:e,sourceSpatialReference:r.spatialReference,targetSpatialReference:t}),{valid:!1,controlPoint:null})}};function D(e){return(0,u.pC)(e)&&(0,u.pC)(e.sourcePoint)&&(0,u.pC)(e.mapPoint)}(0,d._)([(0,g.Cb)({type:[Pe],json:{write:{allowNull:!1,isRequired:!0}}})],Q.prototype,"controlPoints",void 0),(0,d._)([(0,y.r)("controlPoints")],Q.prototype,"readControlPoints",null),(0,d._)([(0,M.c)("controlPoints")],Q.prototype,"writeControlPoints",null),(0,d._)([(0,g.Cb)()],Q.prototype,"coords",null),(0,d._)([(0,g.Cb)({json:{write:!0}})],Q.prototype,"height",void 0),(0,d._)([(0,g.Cb)({readOnly:!0})],Q.prototype,"inverseTransform",null),(0,d._)([(0,g.Cb)({readOnly:!0})],Q.prototype,"transform",null),(0,d._)([(0,g.Cb)({json:{write:!0}})],Q.prototype,"width",void 0),Q=(0,d._)([(0,m.j)("esri.layers.support.ControlPointsGeoreference")],Q);const ne=(0,A.a)(),oe=(0,A.a)(),pe=(0,A.a)(),le=(0,A.a)(),se=(0,A.a)(),ie=(0,A.a)(),me=(0,A.a)(),ce=(0,A.a)(),Ee=Math.PI/2;function re(e,t,o){(0,s.s)(e,o.sourcePoint.x,o.sourcePoint.y),(0,s.s)(t,o.mapPoint.x,o.mapPoint.y)}function Ye(e,t,o,r,a){return re(ne,se,t),re(oe,ie,o),re(pe,me,r),re(le,ce,a),Le(e,ne,oe,pe,le,se,ie,me,ce)}const Ge=new Array(8).fill(0),Fe=new Array(8).fill(0);function we(e,t,o,r,a){return e[0]=t[0],e[1]=t[1],e[2]=o[0],e[3]=o[1],e[4]=r[0],e[5]=r[1],e[6]=a[0],e[7]=a[1],e}function Le(e,t,o,r,a,v,R,P,j){return function I(e,t,o){return Y(x,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]),Y(B,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7]),(0,h.m)(e,(0,h.a)(x,x),B),0!==e[8]&&(e[0]/=e[8],e[1]/=e[8],e[2]/=e[8],e[3]/=e[8],e[4]/=e[8],e[5]/=e[8],e[6]/=e[8],e[7]/=e[8],e[8]/=e[8]),e}(e,we(Ge,t,o,r,a),we(Fe,v,R,P,j))}const Xe=Q;let he=class extends Ce{constructor(e){super(e),this.bottomLeft=null,this.bottomRight=null,this.topLeft=null,this.topRight=null,this.type="corners"}get coords(){let{topLeft:e,topRight:t,bottomLeft:o,bottomRight:r}=this;if((0,u.Wi)(e)||(0,u.Wi)(t)||(0,u.Wi)(o)||(0,u.Wi)(r))return null;const a=e.spatialReference;return t=this.projectOrWarn(t,a),o=this.projectOrWarn(o,a),r=this.projectOrWarn(r,a),(0,u.Wi)(t)||(0,u.Wi)(o)||(0,u.Wi)(r)?null:new Ie.Z({rings:[[[o.x,o.y],[e.x,e.y],[t.x,t.y],[r.x,r.y],[o.x,o.y]]],spatialReference:a})}set coords(e){const{topLeft:t}=this;if((0,u.Wi)(t))return;const o=t.spatialReference;if(e=this.projectOrWarn(e,o),(0,u.Wi)(e))return;const{rings:[[r,a,v,R]]}=e;this.bottomLeft=new T.Z({x:r[0],y:r[1],spatialReference:o}),this.topLeft=new T.Z({x:a[0],y:a[1],spatialReference:o}),this.topRight=new T.Z({x:v[0],y:v[1],spatialReference:o}),this.bottomRight=new T.Z({x:R[0],y:R[1],spatialReference:o})}};(0,d._)([(0,g.Cb)()],he.prototype,"coords",null),(0,d._)([(0,g.Cb)({type:T.Z})],he.prototype,"bottomLeft",void 0),(0,d._)([(0,g.Cb)({type:T.Z})],he.prototype,"bottomRight",void 0),(0,d._)([(0,g.Cb)({type:T.Z})],he.prototype,"topLeft",void 0),(0,d._)([(0,g.Cb)({type:T.Z})],he.prototype,"topRight",void 0),he=(0,d._)([(0,m.j)("esri.layers.support.CornersGeoreference")],he);const Qe=he;var $e=l(21286),ke=l(39863),_e=l(2004);let fe=class extends Ce{constructor(e){super(e),this.extent=null,this.rotation=0,this.type="extent-and-rotation"}get coords(){if((0,u.Wi)(this.extent))return null;const{xmin:e,ymin:t,xmax:o,ymax:r,spatialReference:a}=this.extent;let v;if(this.rotation){const{x:R,y:P}=this.extent.center,j=Te(R,P,this.rotation);v=[j(e,t),j(e,r),j(o,r),j(o,t)],v.push(v[0])}else v=[[e,t],[e,r],[o,r],[o,t],[e,t]];return new Ie.Z({rings:[v],spatialReference:a})}set coords(e){if((0,u.Wi)(e)||(0,u.Wi)(this.extent))return;const t=this.extent.spatialReference;if(e=this.projectOrWarn(e,t),(0,u.Wi)(e)||(0,u.Wi)(e.extent))return;const{rings:[[o,r,a]],extent:{center:{x:v,y:R}}}=e,P=(0,$e.BV)(Math.PI/2-Math.atan2(r[1]-o[1],r[0]-o[0])),j=Te(v,R,-P),[G,J]=j(o[0],o[1]),[ee,ae]=j(a[0],a[1]);this.extent=new _e.Z({xmin:G,ymin:J,xmax:ee,ymax:ae,spatialReference:t}),this.rotation=P}};function Te(e,t,o){const r=(0,ke.t)(o),a=Math.cos(r),v=Math.sin(r);return(R,P)=>[a*(R-e)+v*(P-t)+e,a*(P-t)-v*(R-e)+t]}(0,d._)([(0,g.Cb)()],fe.prototype,"coords",null),(0,d._)([(0,g.Cb)({type:_e.Z})],fe.prototype,"extent",void 0),(0,d._)([(0,g.Cb)({type:Number})],fe.prototype,"rotation",void 0),fe=(0,d._)([(0,m.j)("esri.layers.support.ExtentAndRotationGeoreference")],fe);const qe={key:"type",base:Ce,typeMap:{"control-points":Xe,corners:Qe,"extent-and-rotation":fe}};let ge=class extends((0,te.iv)((0,S.eC)(ue.Z))){constructor(){super(...arguments),this.georeference=null,this.opacity=1}readGeoreference(e){return Xe.fromJSON(e)}};(0,d._)([(0,g.Cb)({types:qe,json:{write:!0}})],ge.prototype,"georeference",void 0),(0,d._)([(0,y.r)("georeference")],ge.prototype,"readGeoreference",null),(0,d._)([(0,g.Cb)()],ge.prototype,"opacity",void 0),ge=(0,d._)([(0,m.j)("esri.layers.support.MediaElementBase")],ge);const be=ge;var et=l(61556),Me=l(29840);let de=class extends be{constructor(e){super(e),this.content=null,this.image=null,this.type="image",this.image=null}load(){const e=this.image;if("string"==typeof e){const t=(0,z.default)(e,{responseType:"image"}).then(({data:o})=>{this._set("content",o)});this.addResolvingPromise(t)}else if(e instanceof HTMLImageElement){const t=e.decode().then(()=>{this._set("content",e)});this.addResolvingPromise(t)}else e?this._set("content",e):this.addResolvingPromise(Promise.reject(new b.Z("image-element:invalid-image-type","Invalid image type",{image:e})));return Promise.resolve(this)}readImage(e,t,o){return(0,Me.f)(t.url,o)}writeImage(e,t,o,r){if((0,u.Wi)(e))return;const a=r?.portalItem,v=r?.resources;if(!a||!v)return void("string"==typeof e&&(t[o]=(0,Me.t)(e,r)));const R="string"!=typeof e||(0,O.HK)(e)||(0,O.jc)(e)?null:e;if(R){if(null==(0,Me.i)(R))return void(t[o]=R);const P=(0,Me.t)(R,{...r,verifyItemRelativeUrls:r&&r.verifyItemRelativeUrls?{writtenUrls:r.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},Me.M.NO);if(a&&P&&!(0,O.YP)(P))return v.toKeep.push({resource:a.resourceFromPath(P),compress:!1}),void(t[o]=P)}t[o]="<pending>",v.pendingOperations.push(Ae(e).then(P=>{const j=function nt(e,t){const o=(0,_.D)(),r=`${(0,O.v_)("media",o)}.${(0,et.B)(e)}`;return t.resourceFromPath(r)}(P,a);t[o]=j.itemRelativeUrl,v.toAdd.push({resource:j,content:P,compress:!1,finish:G=>{this.image=G.url}})}))}};(0,d._)([(0,g.Cb)({readOnly:!0})],de.prototype,"content",void 0),(0,d._)([(0,g.Cb)({json:{name:"url",type:String}})],de.prototype,"image",void 0),(0,d._)([(0,y.r)("image",["url"])],de.prototype,"readImage",null),(0,d._)([(0,M.c)("image")],de.prototype,"writeImage",null),(0,d._)([(0,g.Cb)({readOnly:!0,json:{name:"mediaType"}})],de.prototype,"type",void 0),de=(0,d._)([(0,m.j)("esri.layers.support.ImageElement")],de);const Ue=de;function Ae(e){return Ze.apply(this,arguments)}function Ze(){return(Ze=(0,k.Z)(function*(e){if("string"==typeof e){if((0,O.jc)(e)){const{data:t}=yield(0,z.default)(e,{responseType:"blob"});return t}return(0,O.HK)(e)?(0,O.fw)(e):Ae((yield(0,z.default)(e,{responseType:"image"})).data)}return new Promise(t=>function tt(e){if(e instanceof HTMLCanvasElement)return e;const t=e instanceof HTMLImageElement?e.naturalWidth:e.width,o=e instanceof HTMLImageElement?e.naturalHeight:e.height,r=document.createElement("canvas"),a=r.getContext("2d");return r.width=t,r.height=o,e instanceof HTMLImageElement?a.drawImage(e,0,0,e.width,e.height):e instanceof ImageData&&a.putImageData(e,0,0),r}(e).toBlob(t))})).apply(this,arguments)}l(29132);var ot=l(89726),st=l(61885),it=l(80542),rt=l(60330),at=l(10699),lt=l(32917),ct=l(65401),ht=l(11519),dt=l(37053),ut=l(61256),pt=l(17732);let Re=class extends be{constructor(e){super(e),this.content=null,this.type="video"}load(){const e=this.video;if("string"==typeof e){const t=document.createElement("video");t.src=e,t.crossOrigin="anonymous",t.autoplay=!0,t.muted=!0,t.loop=!0,this.addResolvingPromise(this._loadVideo(t).then(()=>{this._set("content",t)}))}else e instanceof HTMLVideoElement?this.addResolvingPromise(this._loadVideo(e).then(()=>{this._set("content",e)})):this.addResolvingPromise(Promise.reject(new b.Z("video-element:invalid-video-type","Invalid video type",{video:e})));return Promise.resolve(this)}set video(e){"not-loaded"===this.loadStatus?this._set("video",e):w.Z.getLogger(this.declaredClass).error("#video","video cannot be changed after the element is loaded.")}_loadVideo(e){return new Promise((t,o)=>{e.oncanplay=()=>{e.oncanplay=null,e.play().then(t,o)},"anonymous"!==e.crossOrigin&&(e.crossOrigin="anonymous",e.src=e.src)})}};(0,d._)([(0,g.Cb)({readOnly:!0})],Re.prototype,"content",void 0),(0,d._)([(0,g.Cb)()],Re.prototype,"video",null),Re=(0,d._)([(0,m.j)("esri.layers.support.VideoElement")],Re);const De=Re,He=H.Z.ofType({key:"type",defaultKeyValue:"image",base:be,typeMap:{image:Ue,video:De}});let ye=class extends(ue.Z.LoadableMixin((0,rt.v)((0,it.p)(st.Z.EventedAccessor)))){constructor(e){super(e),this._index=new ut.H,this._elementViewsMap=new Map,this._elementsIndexes=new Map,this._elementsChangedHandler=t=>{for(const r of t.removed){const a=this._elementViewsMap.get(r);this._elementViewsMap.delete(r),this._index.delete(a),this.handles.remove(a),a.destroy(),this.notifyChange("fullExtent")}const{spatialReference:o}=this;for(const r of t.added){if(this._elementViewsMap.get(r))continue;const a=new pt.L({spatialReference:o,element:r});this._elementViewsMap.set(r,a);const v=(0,lt.YP)(()=>a.coords,()=>this._updateIndexForElement(a,!1));this._updateIndexForElement(a,!0),this.handles.add(v,a)}this._elementsIndexes.clear(),this.elements.forEach((r,a)=>this._elementsIndexes.set(r,a)),this.emit("refresh")},this.elements=new He}load(e){var t=this;return(0,k.Z)(function*(){if((0,at.k_)(e),!t.spatialReference){const o=t.elements.find(r=>(0,u.pC)(r.georeference)&&(0,u.pC)(r.georeference.coords));t._set("spatialReference",o?(0,u.Wg)((0,u.Wg)(o.georeference).coords).spatialReference:Se.Z.WGS84)}return t._elementsChangedHandler({added:t.elements.items,removed:[]}),t.handles.add(t.elements.on("change",t._elementsChangedHandler)),t})()}destroy(){this._index.clear(),this._elementViewsMap.clear(),this._elementsIndexes.clear()}set elements(e){this._set("elements",(0,ot.Z)(e,this._get("elements"),He))}get fullExtent(){if("not-loaded"===this.loadStatus)return null;const e=this._index.fullBounds;return(0,u.Wi)(e)?null:new _e.Z({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:this.spatialReference})}set spatialReference(e){"not-loaded"===this.loadStatus?this._set("spatialReference",e):w.Z.getLogger(this.declaredClass).error("#spatialReference","spatialReference cannot be changed after the source is loaded.")}queryElements(e,t){var o=this;return(0,k.Z)(function*(){yield o.load(),yield(0,ve.iQ)(e.spatialReference,o.spatialReference,null,t);const r=(0,dt.fS)(e.spatialReference,o.spatialReference)?e:(0,ve.iV)(e,o.spatialReference);if(!r)return[];const a=r.normalize(),v=[];for(const R of a)o._index.forEachInBounds((0,ct.oJ)(R),({normalizedCoords:P,element:j})=>{(0,u.pC)(P)&&(0,ht.Nl)(R,P)&&v.push(j)});return v.sort((R,P)=>o._elementsIndexes.get(R)-o._elementsIndexes.get(P)),v})()}_updateIndexForElement(e,t){const o=e.normalizedBounds,r=this._index.has(e),a=(0,u.pC)(o);this._index.delete(e),a&&this._index.set(e,o),this.notifyChange("fullExtent"),t||(r!==a?this.emit("refresh"):this.emit("change",{element:e.element}))}};(0,d._)([(0,g.Cb)()],ye.prototype,"elements",null),(0,d._)([(0,g.Cb)({readOnly:!0})],ye.prototype,"fullExtent",null),(0,d._)([(0,g.Cb)()],ye.prototype,"spatialReference",null),ye=(0,d._)([(0,m.j)("esri.layers.support.LocalMediaElementSource")],ye);const Oe=ye;function Ve(e){return"object"==typeof e&&null!=e&&"type"in e}let K=class extends((0,Z.h)((0,V.M)((0,F.q)((0,U.R)(W.Z))))){constructor(e){super(e),this.effectiveSource=null,this.copyright=null,this.operationalLayerType="MediaLayer",this.spatialReference=null,this.type="media",this.source=new Oe}load(e){const t=this.source;if(!t)return this.addResolvingPromise(Promise.reject(new b.Z("media-layer:source-missing","Set 'MediaLayer.source' before loading the layer."))),Promise.resolve(this);const o=Ve(t)?new Oe({elements:new H.Z([t])}):t;this._set("effectiveSource",o),this.spatialReference&&(o.spatialReference=this.spatialReference);const r=o.load(e).then(()=>{this.spatialReference=o.spatialReference});return this.addResolvingPromise(r),Promise.resolve(this)}destroy(){(0,u.Wg)(this.effectiveSource)?.destroy(),(0,u.Wg)(this.source)?.destroy()}get fullExtent(){return this.loaded?this.effectiveSource.fullExtent:null}set source(e){"not-loaded"===this.loadStatus?this._set("source",e):w.Z.getLogger(this.declaredClass).error("#source","source cannot be changed after the layer is loaded.")}castSource(e){return e?Array.isArray(e)||e instanceof H.Z?new Oe({elements:e}):e:null}readSource(e,t,o){const r="image"===t.mediaType?new Ue:"video"===t.mediaType?new De:null;return r?.read(t,o),r}writeSource(e,t,o,r){e&&Ve(e)&&"image"===e.type?e.write(t,r):r?.messages&&r?.messages?.push(new b.Z("media-layer:unsupported-source","source must be an 'ImageElement'"))}};(0,d._)([(0,g.Cb)({readOnly:!0})],K.prototype,"effectiveSource",void 0),(0,d._)([(0,g.Cb)({type:String})],K.prototype,"copyright",void 0),(0,d._)([(0,g.Cb)({readOnly:!0})],K.prototype,"fullExtent",null),(0,d._)([(0,g.Cb)({type:["MediaLayer"]})],K.prototype,"operationalLayerType",void 0),(0,d._)([(0,g.Cb)({type:["show","hide"]})],K.prototype,"listMode",void 0),(0,d._)([(0,g.Cb)({nonNullable:!0,json:{write:{enabled:!0,allowNull:!1}}})],K.prototype,"source",null),(0,d._)([(0,X.p)("source")],K.prototype,"castSource",null),(0,d._)([(0,y.r)("source",["url"])],K.prototype,"readSource",null),(0,d._)([(0,M.c)("source")],K.prototype,"writeSource",null),(0,d._)([(0,g.Cb)()],K.prototype,"spatialReference",void 0),(0,d._)([(0,g.Cb)({readOnly:!0})],K.prototype,"type",void 0),K=(0,d._)([(0,m.j)("esri.layers.MediaLayer")],K);const ft=K},61256:(Be,$,l)=>{l.d($,{H:()=>X});var d=l(8314),H=l(36592),b=l(65401);const u={minX:0,minY:0,maxX:0,maxY:0};class X{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new H.Q(9,(0,d.Z)("esri-csp-restrictions")?y=>({minX:y[0],minY:y[1],maxX:y[2],maxY:y[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const y=new Array(this._idByBounds.size);let m=0;this._idByBounds.forEach((M,W)=>{y[m++]=W}),this._indexInvalid=!1,this._index.clear(),this._index.load(y)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(y=>this._idByBounds.has(y))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const y=(0,b.cS)();for(const m of this._boundsById.values())m&&(y[0]=Math.min(m[0],y[0]),y[1]=Math.min(m[1],y[1]),y[2]=Math.max(m[2],y[2]),y[3]=Math.max(m[3],y[3]));return y}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(y){const m=this._boundsById.get(y);this._boundsById.delete(y),m&&(this._idByBounds.delete(m),this._indexInvalid||this._index.remove(m))}forEachInBounds(y,m){this._loadIndex(),function g(C,y,m){(function U(C){u.minX=C[0],u.minY=C[1],u.maxX=C[2],u.maxY=C[3]})(y),C.search(u,m)}(this._index,y,M=>m(this._idByBounds.get(M)))}get(y){return this._boundsById.get(y)}has(y){return this._boundsById.has(y)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(y,m){if(!this._indexInvalid){const M=this._boundsById.get(y);M&&(this._index.remove(M),this._idByBounds.delete(M))}this._boundsById.set(y,m),m&&(this._idByBounds.set(m,y),this._indexInvalid||(this._boundsToLoad.push(m),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},61556:(Be,$,l)=>{l.d($,{B:()=>H});var d=l(21726);function H(C){return u[function b(C){return C instanceof Blob?C.type:function w(C){const y=(0,d.Ml)(C);return X[y]||U}(C.url)}(C)]||g}const u={},U="text/plain",g=u[U],X={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const C in X)u[X[C]]=C}}]);