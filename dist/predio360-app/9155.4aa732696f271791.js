"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[9155],{95324:(se,G,c)=>{function O(d){return null!=N(d)||null!=j(d)}function X(d){return D.test(d)}function z(d){return N(d)??j(d)}function j(d){const m=new Date(d);return function Y(d,m){if(Number.isNaN(d.getTime()))return!1;let E=!0;if(Z&&/\d+\W*$/.test(m)){const U=m.match(/[a-zA-Z]{2,}/);if(U){let o=!1,a=0;for(;!o&&a<=U.length;)o=!$.test(U[a]),a++;E=!o}}return E}(m,d)?Number.isNaN(m.getTime())?null:m.getTime()-6e4*m.getTimezoneOffset():null}function N(d){const m=D.exec(d);if(!m?.groups)return null;const E=m.groups,U=+E.year,o=+E.month-1,a=+E.day,M=+(E.hours??"0"),F=+(E.minutes??"0"),w=+(E.seconds??"0");if(M>23||F>59||w>59)return null;const C=E.ms??"0",L=C?+C.padEnd(3,"0").substring(0,3):0;let q;return q=E.isUTC||!E.offsetSign?Date.UTC(U,o,a,M,F,w,L):6e4*("+"===E.offsetSign?-1:1)*(60*+E.offsetHours+ +E.offsetMinutes)+Date.UTC(U,o,a,M,F,w,L),Number.isNaN(q)?null:q}c.d(G,{mu:()=>X,of:()=>O,sG:()=>z});const D=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/,$=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,Z=!Number.isNaN(new Date("technology 10").getTime())},36592:(se,G,c)=>{c.d(G,{Q:()=>j});var O=c(85931),X=c(77029),z=c(14259);class j{constructor(e=9,s){this._compareMinX=$,this._compareMinY=Z,this._toBBox=i=>i,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),s&&("function"==typeof s?this._toBBox=s:this._initFormat(s)),this.clear()}destroy(){this.clear(),F.prune(),w.prune(),C.prune(),L.prune()}all(e){this._all(this._data,e)}search(e,s){let i=this._data;const l=this._toBBox;if(a(e,i))for(F.clear();i;){for(let h=0,_=i.children.length;h<_;h++){const I=i.children[h],T=i.leaf?l(I):I;a(e,T)&&(i.leaf?s(I):o(e,T)?this._all(I,s):F.push(I))}i=F.pop()}}collides(e){let s=this._data;const i=this._toBBox;if(!a(e,s))return!1;for(F.clear();s;){for(let l=0,h=s.children.length;l<h;l++){const _=s.children[l],I=s.leaf?i(_):_;if(a(e,I)){if(s.leaf||o(e,I))return!0;F.push(_)}}s=F.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let i=0,l=e.length;i<l;i++)this.insert(e[i]);return this}let s=this._build(e.slice(0,e.length),0,e.length-1,0);if(this._data.children.length)if(this._data.height===s.height)this._splitRoot(this._data,s);else{if(this._data.height<s.height){const i=this._data;this._data=s,s=i}this._insert(s,this._data.height-s.height-1,!0)}else this._data=s;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new ee([]),this}remove(e){if(!e)return this;let s,i=this._data,l=null,h=0,_=!1;const I=this._toBBox(e);for(C.clear(),L.clear();i||C.length>0;){if(i||(i=C.pop(),l=C.data[C.length-1],h=L.pop()??0,_=!0),i.leaf&&(s=(0,O.cq)(i.children,e,i.children.length,i.indexHint),-1!==s))return i.children.splice(s,1),C.push(i),this._condense(C),this;_||i.leaf||!o(i,I)?l?(h++,i=l.children[h],_=!1):i=null:(C.push(i),L.push(h),h=0,l=i,i=i.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_all(e,s){let i=e;for(w.clear();i;){if(!0===i.leaf)for(const l of i.children)s(l);else w.pushArray(i.children);i=w.pop()??null}}_build(e,s,i,l){const h=i-s+1;let _=this._maxEntries;if(h<=_){const b=new ee(e.slice(s,i+1));return N(b,this._toBBox),b}l||(l=Math.ceil(Math.log(h)/Math.log(_)),_=Math.ceil(h/_**(l-1)));const I=new ie([]);I.height=l;const T=Math.ceil(h/_),A=T*Math.ceil(Math.sqrt(_));M(e,s,i,A,this._compareMinX);for(let b=s;b<=i;b+=A){const R=Math.min(b+A-1,i);M(e,b,R,T,this._compareMinY);for(let H=b;H<=R;H+=T){const re=Math.min(H+T-1,R);I.children.push(this._build(e,H,re,l-1))}}return N(I,this._toBBox),I}_chooseSubtree(e,s,i,l){for(;l.push(s),!0!==s.leaf&&l.length-1!==i;){let h,_=1/0,I=1/0;for(let T=0,A=s.children.length;T<A;T++){const b=s.children[T],R=d(b),H=E(e,b)-R;H<I?(I=H,_=R<_?R:_,h=b):H===I&&R<_&&(_=R,h=b)}s=h||s.children[0]}return s}_insert(e,s,i){const h=i?e:(0,this._toBBox)(e);C.clear();const _=this._chooseSubtree(h,this._data,s,C);for(_.children.push(e),Y(_,h);s>=0&&C.data[s].children.length>this._maxEntries;)this._split(C,s),s--;this._adjustParentBBoxes(h,C,s)}_split(e,s){const i=e.data[s],l=i.children.length,h=this._minEntries;this._chooseSplitAxis(i,h,l);const _=this._chooseSplitIndex(i,h,l);if(!_)return void console.log("  Error: assertion failed at PooledRBush._split: no valid split index");const I=i.children.splice(_,i.children.length-_),T=i.leaf?new ee(I):new ie(I);T.height=i.height,N(i,this._toBBox),N(T,this._toBBox),s?e.data[s-1].children.push(T):this._splitRoot(i,T)}_splitRoot(e,s){this._data=new ie([e,s]),this._data.height=e.height+1,N(this._data,this._toBBox)}_chooseSplitIndex(e,s,i){let l,h,_;l=h=1/0;for(let I=s;I<=i-s;I++){const T=D(e,0,I,this._toBBox),A=D(e,I,i,this._toBBox),b=U(T,A),R=d(T)+d(A);b<l?(l=b,_=I,h=R<h?R:h):b===l&&R<h&&(h=R,_=I)}return _}_chooseSplitAxis(e,s,i){const l=e.leaf?this._compareMinX:$,h=e.leaf?this._compareMinY:Z;this._allDistMargin(e,s,i,l)<this._allDistMargin(e,s,i,h)&&e.children.sort(l)}_allDistMargin(e,s,i,l){e.children.sort(l);const h=this._toBBox,_=D(e,0,s,h),I=D(e,i-s,i,h);let T=m(_)+m(I);for(let A=s;A<i-s;A++){const b=e.children[A];Y(_,e.leaf?h(b):b),T+=m(_)}for(let A=i-s-1;A>=s;A--){const b=e.children[A];Y(I,e.leaf?h(b):b),T+=m(I)}return T}_adjustParentBBoxes(e,s,i){for(let l=i;l>=0;l--)Y(s.data[l],e)}_condense(e){for(let s=e.length-1;s>=0;s--){const i=e.data[s];if(0===i.children.length)if(s>0){const l=e.data[s-1],h=l.children;h.splice((0,O.cq)(h,i,h.length,l.indexHint),1)}else this.clear();else N(i,this._toBBox)}}_initFormat(e){const s=["return a"," - b",";"];this._compareMinX=new Function("a","b",s.join(e[0])),this._compareMinY=new Function("a","b",s.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function N(u,e){D(u,0,u.children.length,e,u)}function D(u,e,s,i,l){l||(l=new ee([])),l.minX=1/0,l.minY=1/0,l.maxX=-1/0,l.maxY=-1/0;for(let h,_=e;_<s;_++)h=u.children[_],Y(l,u.leaf?i(h):h);return l}function Y(u,e){u.minX=Math.min(u.minX,e.minX),u.minY=Math.min(u.minY,e.minY),u.maxX=Math.max(u.maxX,e.maxX),u.maxY=Math.max(u.maxY,e.maxY)}function $(u,e){return u.minX-e.minX}function Z(u,e){return u.minY-e.minY}function d(u){return(u.maxX-u.minX)*(u.maxY-u.minY)}function m(u){return u.maxX-u.minX+(u.maxY-u.minY)}function E(u,e){return(Math.max(e.maxX,u.maxX)-Math.min(e.minX,u.minX))*(Math.max(e.maxY,u.maxY)-Math.min(e.minY,u.minY))}function U(u,e){const s=Math.max(u.minX,e.minX),i=Math.max(u.minY,e.minY),l=Math.min(u.maxX,e.maxX),h=Math.min(u.maxY,e.maxY);return Math.max(0,l-s)*Math.max(0,h-i)}function o(u,e){return u.minX<=e.minX&&u.minY<=e.minY&&e.maxX<=u.maxX&&e.maxY<=u.maxY}function a(u,e){return e.minX<=u.maxX&&e.minY<=u.maxY&&e.maxX>=u.minX&&e.maxY>=u.minY}function M(u,e,s,i,l){const h=[e,s];for(;h.length;){const _=h.pop(),I=h.pop();if(_-I<=i)continue;const T=I+Math.ceil((_-I)/i/2)*i;(0,z.q)(u,T,I,_,l),h.push(I,T,T,_)}}const F=new X.Z,w=new X.Z,C=new X.Z,L=new X.Z({deallocator:void 0});class q{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class te extends q{constructor(){super(...arguments),this.height=1,this.indexHint=new O.SO}}class ee extends te{constructor(e){super(),this.children=e,this.leaf=!0}}class ie extends te{constructor(e){super(),this.children=e,this.leaf=!1}}},61256:(se,G,c)=>{c.d(G,{H:()=>$});var O=c(8314),X=c(36592),z=c(65401);const N={minX:0,minY:0,maxX:0,maxY:0};class ${constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new X.Q(9,(0,O.Z)("esri-csp-restrictions")?d=>({minX:d[0],minY:d[1],maxX:d[2],maxY:d[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const d=new Array(this._idByBounds.size);let m=0;this._idByBounds.forEach((E,U)=>{d[m++]=U}),this._indexInvalid=!1,this._index.clear(),this._index.load(d)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(d=>this._idByBounds.has(d))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const d=(0,z.cS)();for(const m of this._boundsById.values())m&&(d[0]=Math.min(m[0],d[0]),d[1]=Math.min(m[1],d[1]),d[2]=Math.max(m[2],d[2]),d[3]=Math.max(m[3],d[3]));return d}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(d){const m=this._boundsById.get(d);this._boundsById.delete(d),m&&(this._idByBounds.delete(m),this._indexInvalid||this._index.remove(m))}forEachInBounds(d,m){this._loadIndex(),function Y(Z,d,m){(function D(Z){N.minX=Z[0],N.minY=Z[1],N.maxX=Z[2],N.maxY=Z[3]})(d),Z.search(N,m)}(this._index,d,E=>m(this._idByBounds.get(E)))}get(d){return this._boundsById.get(d)}has(d){return this._boundsById.has(d)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(d,m){if(!this._indexInvalid){const E=this._boundsById.get(d);E&&(this._index.remove(E),this._idByBounds.delete(E))}this._boundsById.set(d,m),m&&(this._idByBounds.set(m,d),this._indexInvalid||(this._boundsToLoad.push(m),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},3579:(se,G,c)=>{c.d(G,{Z:()=>E});var O=c(85931),X=c(26584),z=c(61885),j=c(63290),N=c(5548),D=c(65401),Y=c(82054),$=c(61256),Z=c(16983),d=c(92794);const m=(0,N.Ue)();class E{constructor(o){this.geometryInfo=o,this._boundsStore=new $.H,this._featuresById=new Map,this._markedIds=new Set,this.events=new z.Z,this.featureAdapter=d.n}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let o=0;return this._featuresById.forEach(a=>{null!=a.geometry&&a.geometry.coords&&(o+=a.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:o/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(o){if(null==this.fullBounds)return null;const[a,M,F,w]=this.fullBounds;return{xmin:a,ymin:M,xmax:F,ymax:w,spatialReference:(0,Z.S2)(o)}}add(o){this._add(o),this._emitChanged()}addMany(o){for(const a of o)this._add(a);this._emitChanged()}upsertMany(o){const a=o.map(M=>this._upsert(M));return this._emitChanged(),a.filter(O.pC)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(o){const a=this._featuresById.get(o);return a?(this._remove(a),this._emitChanged(),a):null}removeManyById(o){this._boundsStore.invalidateIndex();for(const a of o){const M=this._featuresById.get(a);M&&this._remove(M)}this._emitChanged()}forEachBounds(o,a){for(const M of o){const F=this._boundsStore.get(M.objectId);F&&a((0,N.JR)(m,F))}}getFeature(o){return this._featuresById.get(o)}has(o){return this._featuresById.has(o)}forEach(o){this._featuresById.forEach(a=>o(a))}forEachInBounds(o,a){this._boundsStore.forEachInBounds(o,M=>{a(this._featuresById.get(M))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let o=!1;this._featuresById.forEach((a,M)=>{this._markedIds.has(M)||(o=!0,this._remove(a))}),this._markedIds.clear(),o&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(o){if(!o)return;const a=o.objectId;if(null==a)return void j.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new X.Z("featurestore:invalid-feature","feature id is missing",{feature:o}));const M=this._featuresById.get(a);let F;if(this._markedIds.add(a),M?(o.displayId=M.displayId,F=this._boundsStore.get(a),this._boundsStore.delete(a)):null!=this.onFeatureAdd&&this.onFeatureAdd(o),!o.geometry?.coords?.length)return this._boundsStore.set(a,null),void this._featuresById.set(a,o);F=(0,Y.$)(F??(0,D.Ue)(),o.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=F&&this._boundsStore.set(a,F),this._featuresById.set(a,o)}_upsert(o){const a=o?.objectId;if(null==a)return j.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new X.Z("featurestore:invalid-feature","feature id is missing",{feature:o})),null;const M=this._featuresById.get(a);if(!M)return this._add(o),o;this._markedIds.add(a);const{geometry:F,attributes:w}=o;for(const C in w)M.attributes[C]=w[C];return F&&(M.geometry=F,this._boundsStore.set(a,(0,Y.$)((0,D.Ue)(),F,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),M}_remove(o){null!=this.onFeatureRemove&&this.onFeatureRemove(o);const a=o.objectId;return this._markedIds.delete(a),this._boundsStore.delete(a),this._featuresById.delete(a),o}}},39155:(se,G,c)=>{c.r(G),c.d(G,{default:()=>pe});var O=c(15861),z=(c(29132),c(84792)),j=c(59213),N=c(95324),D=c(26584),Y=c(63290),$=c(10699),Z=c(21726),d=c(55915),m=c(15994),E=c(37053),U=c(46367),o=c(66385),a=c(88071),M=c(3579),F=c(82959),w=c(73771),C=c(75327),L=c(90194);const q=/^\s*"([\S\s]*)"\s*$/,te=/""/g,ee="\n",ie=[","," ",";","|","\t"];function*u(g,r,t){let n=0;for(;n<=g.length;){const p=g.indexOf(r,n),f=g.substring(n,p>-1?p:void 0);n+=f.length+r.length,t&&!f.trim()||(yield f)}}function e(g){const r=g.includes("\r\n")?"\r\n":ee;return u(g,r,!0)}function s(g,r){return u(g,r,!1)}function*l(g,r,t,n=(()=>Object.create(null))){const p=e(g);p.next();let f="",y="",B=0,v=n(),P=0;e:for(const J of p){const W=s(J,t);for(const Q of W)if(f+=y+Q,y="",B+=I(Q),B%2==0){if(B>0){const k=q.exec(f);if(!k){v=n(),P=0,f="",B=0;continue e}v[r[P]]=k[1].replaceAll(te,'"'),P++}else v[r[P]]=f,P++;f="",B=0}else y=t;0===B?(yield v,v=n(),P=0):y=ee}}function h(g,r){const t=_(g,r).filter(p=>null!=p),n=t.map(p=>(0,L.q6)(p));for(let p=n.length-1;p>=0;p--)n[p]||(n.splice(p,1),t.splice(p,1));return{names:n,aliases:t}}function _(g,r){if(!g?.length)return[];const t=[];let n="",p="",f=0;const y=s(g,r);for(const B of y)if(n+=p+B,p="",f+=I(B),f%2==0){if(f>0){const v=q.exec(n);v&&t.push(v[1].replaceAll(te,'"'))}else t.push(n);n="",f=0}else p=r;return t}function I(g){let r=0,t=0;for(t=g.indexOf('"',t);t>=0;)r++,t=g.indexOf('"',t+1);return r}function T(g,r,t){r=(0,L.q6)(r)?.toLowerCase(),t=(0,L.q6)(t)?.toLowerCase();const n=g.map(y=>y.toLowerCase()),p=r?g[n.indexOf(r)]:null,f=t?g[n.indexOf(t)]:null;return{longitudeFieldName:p||g[n.indexOf(re.find(y=>n.includes(y)))],latitudeFieldName:f||g[n.indexOf(H.find(y=>n.includes(y)))]}}function b(g){if(!g.length)return"string";const r=/[^+\-.,0-9]/;return g.map(t=>{if(""!==t){if(!r.test(t)){let n=R(t);if(!isNaN(n))return/[.,]/.test(t)||!Number.isInteger(n)||n>214783647||n<-214783648?"double":"integer";if(t.includes("E")&&(n=Number(t),!Number.isNaN(n)||t.includes(",")&&(t=t.replace(",","."),n=Number(t),!Number.isNaN(n))))return"double"}return(0,N.of)(t)?"date":"string"}}).reduce((t,n)=>void 0===t?n:void 0===n?t:t===n?n:"string"===t||"string"===n?"string":"double"===t||"double"===n?"double":void 0)}const R=function(){const g=(0,C.lt)(),r=new RegExp("^"+g.regexp+"$"),t=new RegExp("["+g.group+"\\s\\xa0]","g"),n=g.factor;return p=>{const f=r.exec(p);if(g.factor=n,!f)return NaN;let y=f[1];if(!f[1]){if(!f[2])return NaN;y=f[2],g.factor*=-1}return y=y.replace(t,"").replace(g.decimal,"."),+y*g.factor}}(),H=["lat","latitude","latitude83","latdecdeg","lat_dd","y","ycenter","point_y"],re=["lon","lng","long","longitude","longitude83","longdecdeg","long_dd","x","xcenter","point_x"];var ae=c(56554),oe=c(60466),le=c(28302),ue=c(65234);const he=(0,ae.bU)("esriGeometryPoint"),ce=["csv"],fe=[0,0];class me{constructor(r,t){this.x=r,this.y=t}}class pe{constructor(){var r=this;this._queryEngine=null,this._snapshotFeatures=function(){var t=(0,O.Z)(function*(n){const p=yield r._fetch(n);return r._createFeatures(p)});return function(n){return t.apply(this,arguments)}}()}destroy(){this._queryEngine?.destroy(),this._queryEngine=null}load(r,t={}){var n=this;return(0,O.Z)(function*(){n._loadOptions=r;const[p]=yield Promise.all([n._fetch(t.signal),n._checkProjection(r?.parsingOptions?.spatialReference)]),f=function _e(g,r){const t=r.parsingOptions||{},n={delimiter:t.delimiter,layerDefinition:null,locationInfo:{latitudeFieldName:t.latitudeField,longitudeFieldName:t.longitudeField}},p=n.layerDefinition={name:(0,Z.vt)(r.url,ce)||"csv",dateFieldsTimeReference:{timeZoneIANA:le.pt},drawingInfo:he,geometryType:"esriGeometryPoint",objectIdField:null,fields:[],timeInfo:t.timeInfo,extent:{xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:t.spatialReference||{wkid:4326}}},f=e(g),y=f.next().value?.trim(),B=f.next().value?.trim();if(!y)throw new D.Z("csv-layer:empty-csv","CSV is empty",{csv:g});const{delimiter:v,locationInfo:P}=function i(g,r,t){g=g.trim(),r=r?.trim();const n=[],p=Array.from(new Set([t?.delimiter,...ie])).filter(y=>null!=y);for(const y of p){const B=_(g,y).length,v=_(r,y).length??B;B>1&&n.push({weight:Math.min(B,v),delimiter:y})}const f=n.sort(({weight:y},{weight:B})=>B-y).map(({delimiter:y})=>y);for(const y of f){const B=T(h(g,y).names,t?.longitudeField,t?.latitudeField);if(B.longitudeFieldName&&B.latitudeFieldName)return{delimiter:y,locationInfo:B}}return{delimiter:f[0],locationInfo:null}}(y,B,t);if(!v)throw new D.Z("csv-layer:invalid-delimiter","Unable to detect the delimiter from CSV",{firstLine:y,secondLine:B,parsingOptions:t});if(!P)throw new D.Z("csv-layer:location-fields-not-found","Unable to identify latitude and longitude fields from the CSV file",{firstLine:y,secondLine:B,parsingOptions:t});n.locationInfo=P,n.delimiter=v;const{names:J,aliases:W}=h(y,v),Q=function A(g,r,t,n,p){const f=[],y=l(g,t,r),B=[];for(const v of y){if(10===B.length)break;B.push(v)}for(let v=0;v<t.length;v++){const P=t[v],J=n[v];if(P===p.longitudeFieldName||P===p.latitudeFieldName)f.push({name:P,type:"esriFieldTypeDouble",alias:J});else{let W;switch(b(B.map(Q=>Q[P]))){case"integer":W="esriFieldTypeInteger";break;case"double":W="esriFieldTypeDouble";break;case"date":W="esriFieldTypeDate";break;default:W="esriFieldTypeString"}f.push({name:P,type:W,alias:J,length:(0,L.ZR)(W)})}}return f}(g,n.delimiter,J,W,n.locationInfo);if(t.fields?.length){const S=new oe.Z(t.fields);for(const x of Q){const V=S.get(x.name);V&&Object.assign(x,V)}}if(!Q.some(S=>"esriFieldTypeOID"===S.type&&(p.objectIdField=S.name,!0))){const S={name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1};p.objectIdField=S.name,Q.unshift(S)}p.fields=Q;const k=new oe.Z(p.fields);if(n.locationInfo&&(n.locationInfo.latitudeFieldName=k.get(n.locationInfo.latitudeFieldName).name,n.locationInfo.longitudeFieldName=k.get(n.locationInfo.longitudeFieldName).name),p.timeInfo){const S=p.timeInfo;if(S.startTimeField){const x=k.get(S.startTimeField);x?(S.startTimeField=x.name,x.type="esriFieldTypeDate"):S.startTimeField=null}if(S.endTimeField){const x=k.get(S.endTimeField);x?(S.endTimeField=x.name,x.type="esriFieldTypeDate"):S.endTimeField=null}if(S.trackIdField){const x=k.get(S.trackIdField);S.trackIdField=x?x.name:null}S.startTimeField||S.endTimeField||(p.timeInfo=null)}return n}(p,r);n._locationInfo=f.locationInfo,n._delimiter=f.delimiter,n._queryEngine=n._createQueryEngine(f);const y=yield n._createFeatures(p);n._queryEngine.featureStore.addMany(y);const{fullExtent:B,timeExtent:v}=yield n._queryEngine.fetchRecomputedExtents();if(f.layerDefinition.extent=B,v){const{start:P,end:J}=v;f.layerDefinition.timeInfo.timeExtent=[P,J]}return f})()}applyEdits(){return(0,O.Z)(function*(){throw new D.Z("csv-layer:editing-not-supported","applyEdits() is not supported on CSVLayer")})()}queryFeatures(r={},t={}){var n=this;return(0,O.Z)(function*(){return yield n._waitSnapshotComplete(),n._queryEngine.executeQuery(r,t.signal)})()}queryFeatureCount(r={},t={}){var n=this;return(0,O.Z)(function*(){return yield n._waitSnapshotComplete(),n._queryEngine.executeQueryForCount(r,t.signal)})()}queryObjectIds(r={},t={}){var n=this;return(0,O.Z)(function*(){return yield n._waitSnapshotComplete(),n._queryEngine.executeQueryForIds(r,t.signal)})()}queryExtent(r={},t={}){var n=this;return(0,O.Z)(function*(){return yield n._waitSnapshotComplete(),n._queryEngine.executeQueryForExtent(r,t.signal)})()}querySnapping(r,t={}){var n=this;return(0,O.Z)(function*(){return yield n._waitSnapshotComplete(),n._queryEngine.executeQueryForSnapping(r,t.signal)})()}refresh(r){var t=this;return(0,O.Z)(function*(){t._loadOptions.customParameters=r,t._snapshotTask?.abort(),t._snapshotTask=(0,j.vr)(t._snapshotFeatures),t._snapshotTask.promise.then(f=>{t._queryEngine.featureStore.clear(),f&&t._queryEngine.featureStore.addMany(f)},f=>{t._queryEngine.featureStore.clear(),(0,$.D_)(f)||Y.Z.getLogger("esri.layers.CSVLayer").error(new D.Z("csv-layer:refresh","An error occurred during refresh",{error:f}))}),yield t._waitSnapshotComplete();const{fullExtent:n,timeExtent:p}=yield t._queryEngine.fetchRecomputedExtents();return{extent:n,timeExtent:p}})()}_waitSnapshotComplete(){var r=this;return(0,O.Z)(function*(){if(r._snapshotTask&&!r._snapshotTask.finished){try{yield r._snapshotTask.promise}catch{}return r._waitSnapshotComplete()}})()}_fetch(r){var t=this;return(0,O.Z)(function*(){const{url:n,customParameters:p}=t._loadOptions;if(!n)throw new D.Z("csv-layer:invalid-source","url not defined");const f=(0,Z.mN)(n);return(yield(0,z.Z)(f.path,{query:{...f.query,...p},responseType:"text",signal:r})).data})()}_createQueryEngine(r){const{objectIdField:t,fields:n,extent:p,timeInfo:f}=r.layerDefinition,y=new M.Z({geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1});return new w.q({fieldsIndex:oe.Z.fromLayerJSON({fields:n,dateFieldsTimeReference:{timeZoneIANA:le.pt}}),geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1,timeInfo:f,objectIdField:t,spatialReference:p.spatialReference||{wkid:4326},cacheSpatialQueries:!0,featureStore:y})}_createFeatures(r){var t=this;return(0,O.Z)(function*(){const{latitudeFieldName:n,longitudeFieldName:p}=t._locationInfo,{objectIdField:f,fieldsIndex:y,spatialReference:B}=t._queryEngine;let v=[];const P=[],J=y.fields.filter(x=>x.name!==f).map(x=>x.name);let W=0;const Q={};for(const x of y.fields)if("esriFieldTypeOID"!==x.type&&"esriFieldTypeGlobalID"!==x.type){const V=(0,L.os)(x);void 0!==V&&(Q[x.name]=V)}const k=l(r,J,t._delimiter,(0,ae.Dm)(Q,f));for(const x of k){const V=t._parseCoordinateValue(x[n]),ne=t._parseCoordinateValue(x[p]);if(null!=ne&&null!=V&&!isNaN(V)&&!isNaN(ne)){x[n]=V,x[p]=ne;for(const K in x)if(K!==n&&K!==p)if(y.isDateField(K))x[K]=(0,N.sG)(x[K]);else if(y.isNumericField(K)){const de=R(x[K]);x[K]=isNaN(de)?null:de}x[f]=W,W++,v.push(new me(ne,V)),P.push(x)}}if(!(0,E.fS)({wkid:4326},B))if((0,E.sS)(B))for(const x of v)[x.x,x.y]=(0,U.hG)(x.x,x.y,fe);else v=(0,d.projectMany)(m.N,v,ue.Z.WGS84,B,null,null);const S=[];for(let x=0;x<v.length;x++){const{x:V,y:ne}=v[x],K=P[x];K[f]=x+1,S.push(new o.u_(new a.Z([],[V,ne]),K,null,K[f]))}return S})()}_parseCoordinateValue(r){if(null==r||""===r)return null;let t=R(r);return(isNaN(t)||Math.abs(t)>181)&&(t=parseFloat(r)),t}_checkProjection(r){return(0,O.Z)(function*(){try{yield(0,F._W)(E.YU,r)}catch{throw new D.Z("csv-layer:projection-not-supported","Projection not supported")}})()}}},56554:(se,G,c)=>{c.d(G,{Dm:()=>$,Hq:()=>Z,MS:()=>d,bU:()=>N});var O=c(8314),X=c(58817),z=c(87757),j=c(24837);function N(m){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===m||"esriGeometryMultipoint"===m?j.I4:"esriGeometryPolyline"===m?j.ET:j.lF}}}const D=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let Y=1;function $(m,E){if((0,O.Z)("esri-csp-restrictions"))return()=>({[E]:null,...m});try{let U=`this.${E} = null;`;for(const a in m)U+=`this${D.test(a)?`.${a}`:`["${a}"]`} = ${JSON.stringify(m[a])};`;const o=new Function(`\n      return class AttributesClass$${Y++} {\n        constructor() {\n          ${U};\n        }\n      }\n    `)();return()=>new o}catch{return()=>({[E]:null,...m})}}function Z(m={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,X.d9)(m)}}]}function d(m,E){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:m},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:E,supportsDelete:E,supportsEditing:E,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:E,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:z.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:E,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}}}]);