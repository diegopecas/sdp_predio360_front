"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[7313],{27313:(K,v,t)=>{t.r(v),t.d(v,{previewCIMSymbol:()=>G});var R=t(15861),s=t(23841),d=t(35909),u=t(57068),W=t(80991),y=t(71131),j=t(34057);const m=new u.CIMSymbolRasterizer(null,!0),r=(0,s.Wz)(y.b_.size),D=(0,s.Wz)(y.b_.maxSize),z=(0,s.Wz)(y.b_.lineWidth),B=1;function G(i){return c.apply(this,arguments)}function c(){return(c=(0,R.Z)(function*(i,e={}){const{node:I,opacity:O,symbolConfig:f}=e,L="object"==typeof f&&"isSquareFill"in f&&f.isSquareFill,w=e.cimOptions||e,l=w.geometryType||(0,W.JW)(i?.data?.symbol),n=function T(i){const e=i?.size;return"number"==typeof e?{width:e,height:e}:{width:null!=e&&"object"==typeof e&&"width"in e?e.width:null,height:null!=e&&"object"==typeof e&&"height"in e?e.height:null}}(e),{feature:b,fieldMap:S}=w;if(null==n.width||null==n.height){const o=yield d.E0.resolveSymbolOverrides(i.data,b,null,S,l);if(!o)return null;(i=i.clone()).data={type:"CIMSymbolReference",symbol:o},i.data.primitiveOverrides=void 0;const E=[];d.B$.fetchResources(o,m.resourceManager,E),E.length>0&&(yield Promise.all(E));const U=d.B$.getEnvelope(o,null,m.resourceManager),P=U?.width,C=U?.height;n.width="esriGeometryPolygon"===l?r:"esriGeometryPolyline"===l?z:null!=P&&isFinite(P)?Math.min(P,D):r,n.height="esriGeometryPolygon"===l?r:null!=C&&isFinite(C)?Math.max(Math.min(C,D),B):r}const p=yield m.rasterizeCIMSymbolAsync(i,b,n,L||"esriGeometryPolygon"!==l?u.GeometryStyle.Preview:u.GeometryStyle.Legend,S,l);if(!p)return null;const{width:A,height:F}=p,_=document.createElement("canvas");_.width=A,_.height=F,_.getContext("2d").putImageData(p,0,0);const g=(0,s.F2)(n.width),M=(0,s.F2)(n.height),a=new Image(g,M);a.src=_.toDataURL(),null!=O&&(a.style.opacity=`${O}`);let h=a;return null!=e.effectView&&(h=(0,j.wh)([[{shape:{type:"image",x:0,y:0,width:g,height:M,src:a.src},fill:null,stroke:null,offset:[0,0]}]],[g,M],{effectView:e.effectView})),I&&h&&I.appendChild(h),h})).apply(this,arguments)}}}]);