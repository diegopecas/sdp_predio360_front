"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[6741],{6741:(Z,P,r)=>{r.r(P),r.d(P,{registerFunctions:()=>X});var c=r(15861),M=r(59318),m=(r(29132),r(37780)),W=r(6729),i=r(25919),a=r(47562),x=r(16309),U=r(21674),O=r(55915),A=r(46367),C=r(31099),G=r(55463),H=r(39636),V=r(33230),w=r(39537),F=r(3892),J=r(77549),N=r(8495),Q=r(77294),K=r(65234);let p=null;function R(){return(R=(0,c.Z)(function*(n){const t=M.Z.geometryServiceUrl??"";if(!t){(0,O.isLoaded)()||(yield(0,O.load)());for(const e of n)e.container[e.indexer]=(0,O.project)(e.container[e.indexer],K.Z.WGS84);return}const o=n.map(e=>e.container[e.indexer]),l=new Q.Z({geometries:o,outSpatialReference:K.Z.WGS84}),_=yield(0,H.i)(t,l);for(let e=0;e<_.length;e++){const s=n[e];s.container[s.indexer]=_[e]}})).apply(this,arguments)}function B(n,t){return v.apply(this,arguments)}function v(){return(v=(0,c.Z)(function*(n,t){const o=new G.default({portal:n,id:t});return yield o.load(),null===p&&(p=yield r.e(7689).then(r.bind(r,77689))),yield p.fetchKnowledgeGraph(o.url)})).apply(this,arguments)}function I(n,t,o,l,_){if(null===n)return null;if((0,a.c)(n)||(0,a.b)(n))return n;if((0,a.k)(n)||(0,a.k)(n))return n.toJSDate();if((0,a.m)(n))return n.toStorageFormat();if((0,a.n)(n))return n.toStorageString();if((0,a.v)(n)){const e={};for(const s of n.keys())e[s]=I(n.field(s),t,o,l,_),e[s]instanceof U.Z&&_.push({container:e,indexer:s});return e}if((0,a.o)(n)){const e=n.map(s=>I(s,t,o,l,_));for(let s=0;s<e.length;s++)e[s]instanceof U.Z&&_.push({container:e,indexer:s});return e}if((0,a.p)(n)){if(n.spatialReference.isWGS84)return n;if(n.spatialReference.isWebMercator&&t)return(0,A.Sx)(n);if(!t||!o)return n;throw new i.aV(l,i.rH.WrongSpatialReference,null)}}function j(n,t){if(!n)return null;const o={};for(const l in n)o[l]=d(n[l],t);return o}function d(n,t){return null===n?null:(0,a.o)(n)?n.map(o=>d(o,t)):n instanceof V.Z?{graphTypeName:n.typeName,id:n.id,graphType:"entity",properties:j(n.properties,t)}:n instanceof F.Z?{graphType:"object",properties:j(n.properties,t)}:n instanceof N.Z?{graphTypeName:n.typeName,id:n.id,graphType:"relationship",originId:n.originId??null,destinationId:n.destinationId??null,properties:j(n.properties,t)}:n instanceof J.Z?{graphType:"path",path:n.path?n.path.map(o=>d(o,t)):null}:(0,a.p)(n)?function $(n,t){if(!n)return n;if(n.spatialReference.isWGS84&&t.spatialReference.isWebMercator)return(0,A.$)(n);if(n.spatialReference.equals(t.spatialReference))return n;throw new i.aV(t,i.rH.WrongSpatialReference,null)}(n,t):(0,a.c)(n)||(0,a.b)(n)||(0,a.a7)(n)?n:null}function X(n){"async"===n.mode&&(n.functions.knowledgegraphbyportalitem=function(t,o){return n.standardFunctionAsync(t,o,(l,_,e)=>{if((0,a.H)(e,2,2,t,o),null===e[0])throw new i.aV(t,i.rH.PortalRequired,o);if(e[0]instanceof m.Z){const E=(0,a.j)(e[1]);let h=null;return h=t.services?.portal?t.services.portal:C.Z.getDefault(),B((0,x._)(e[0],h),E)}if(!1===(0,a.c)(e[0]))throw new i.aV(t,i.rH.InvalidParameter,o);const s=(0,a.j)(e[0]);return B(t.services?.portal??C.Z.getDefault(),s)})},n.signatures.push({name:"knowledgegraphbyportalitem",min:2,max:2}),n.functions.querygraph=function(t,o){return n.standardFunctionAsync(t,o,function(){var l=(0,c.Z)(function*(_,e,s){(0,a.H)(s,2,4,t,o);const E=s[0];if(!(0,a.w)(E))throw new i.aV(t,i.rH.InvalidParameter,o);const h=s[1];if(!(0,a.c)(h))throw new i.aV(t,i.rH.InvalidParameter,o);null===p&&(p=yield r.e(7689).then(r.bind(r,77689)));let L=null;const g=(0,a.K)(s[2],null);if(!(g instanceof W.Z||null===g))throw new i.aV(t,i.rH.InvalidParameter,o);if(g){let u=[];L=I(g,!0,!1,t,u),u=u.filter(f=>!f.container[f.indexer].spatialReference.isWGS84),u.length>0&&(yield function z(n){return R.apply(this,arguments)}(u))}const S=new w.Z({openCypherQuery:h,bindParameters:L});(E?.serviceDefinition?.currentVersion??11.3)>11.2&&(S.outputSpatialReference=t.spatialReference);const Y=(yield p.executeQueryStreaming(E,S)).resultRowsStream.getReader(),T=[];try{for(;;){const{done:u,value:f}=yield Y.read();if(u)break;if((0,a.o)(f))for(const D of f)T.push(d(D,t));else{const D=[];for(const b of f)D.push(d(f[b],t));T.push(D)}}}catch(u){throw u}return W.Z.convertJsonToArcade(T,(0,a.N)(t),!1,!0)});return function(_,e,s){return l.apply(this,arguments)}}())},n.signatures.push({name:"querygraph",min:2,max:4}))}},16309:(Z,P,r)=>{r.d(P,{_:()=>M});var c=r(31099);function M(y,m){return null===y?m:new c.Z({url:y.field("url")})}}}]);