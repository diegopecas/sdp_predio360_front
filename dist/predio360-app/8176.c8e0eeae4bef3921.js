"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[8176],{78176:(R,d,t)=>{t.r(d),t.d(d,{FeatureCollectionSnappingSource:()=>i});var c=t(15861),r=t(17626),O=t(14517),a=t(62208),g=t(10699),u=t(32917),_=t(77712),M=(t(90912),t(85931),t(76898)),f=t(60507),v=t(44725),h=t(9218),C=t(17936),m=t(1520),D=t(83010);let i=class extends O.Z{get availability(){return 1}get updating(){return this.layerSource.updating}get _snappingElevationAligner(){const{view:e}=this,{layer:n}=this.layerSource,o=(0,a.pC)(e)&&"3d"===e.type;if(!o||"subtype-group"===n.type)return(0,C.p)();const s=function(){var l=(0,c.Z)(function*(p,y){return(yield(0,g.Hl)(e.whenLayerView(n),y)).elevationAlignPointsInFeatures(p,y)});return function(y,P){return l.apply(this,arguments)}}();return(0,C.p)(o,{elevationInfo:n.elevationInfo,alignPointsInFeatures:s,spatialReference:e.spatialReference})}get _snappingElevationFilter(){const{view:e}=this,n=(0,a.pC)(e)&&"3d"===e.type&&"subtype-group"!==this.layerSource.layer.type;return(0,m.c)(n)}get _symbologySnappingFetcher(){const{view:e}=this,{layer:n}=this.layerSource;return(0,a.pC)(e)&&"3d"===e.type&&"subtype-group"!==n.type?(0,D.k)(this._symbologySnappingSupported,function(){var o=(0,c.Z)(function*(s,l){const p=yield e.whenLayerView(n);return(0,g.k_)(l),p.queryForSymbologySnapping({candidates:s,spatialReference:e.spatialReference},l)});return function(s,l){return o.apply(this,arguments)}}()):(0,D.k)()}get _symbologySnappingSupported(){return(0,a.pC)(this._layerView3D)&&this._layerView3D.symbologySnappingSupported}initialize(){const{view:e}=this,{layer:n}=this.layerSource;(0,a.pC)(e)&&"3d"===e.type&&"subtype-group"!==n.type&&(e.whenLayerView(n).then(o=>this._layerView3D=o),this.addHandles([e.elevationProvider.on("elevation-change",({context:o})=>{const{elevationInfo:s}=n;(0,f.W_)(o,s)&&this._snappingElevationAligner.notifyElevationSourceChange()}),(0,u.YP)(()=>n.elevationInfo,()=>this._snappingElevationAligner.notifyElevationSourceChange(),u.nn),(0,u.YP)(()=>(0,a.pC)(this._layerView3D)?this._layerView3D.processor?.renderer:null,()=>this._symbologySnappingFetcher.notifySymbologyChange(),u.nn),(0,u.on)(()=>(0,a.WG)(this._layerView3D)?.layer,["edits","apply-edits","graphic-update"],()=>this._symbologySnappingFetcher.notifySymbologyChange())]))}constructor(e){super(e),this.view=null,this._layerView3D=null}refresh(){}fetchCandidates(e,n){var o=this;return(0,c.Z)(function*(){const{layer:s}=o.layerSource,l=s.source;if(!l?.querySnapping)return[];const p=(0,v.ML)(s),y=(0,v.rh)(e,(0,a.Wg)(o.view)?.type??"2d",p),P=yield l.querySnapping(y,{signal:n});(0,g.k_)(n);const E=yield o._snappingElevationAligner.alignCandidates(P.candidates,n);(0,g.k_)(n);const S=yield o._symbologySnappingFetcher.fetch(E,n);(0,g.k_)(n);const A=0===S.length?E:[...E,...S],I=o._snappingElevationFilter.filter(y,A),U=o._getGroundElevation;return I.map(L=>(0,h.X)(L,U))})()}get _getGroundElevation(){return(0,h.g)(this.view)}};(0,r._)([(0,_.Cb)({constructOnly:!0})],i.prototype,"layerSource",void 0),(0,r._)([(0,_.Cb)({constructOnly:!0})],i.prototype,"view",void 0),(0,r._)([(0,_.Cb)()],i.prototype,"_snappingElevationAligner",null),(0,r._)([(0,_.Cb)()],i.prototype,"_snappingElevationFilter",null),(0,r._)([(0,_.Cb)()],i.prototype,"_symbologySnappingFetcher",null),(0,r._)([(0,_.Cb)()],i.prototype,"_layerView3D",void 0),(0,r._)([(0,_.Cb)()],i.prototype,"_symbologySnappingSupported",null),(0,r._)([(0,_.Cb)()],i.prototype,"_getGroundElevation",null),i=(0,r._)([(0,M.j)("esri.views.interactive.snapping.featureSources.FeatureCollectionSnappingSource")],i)}}]);