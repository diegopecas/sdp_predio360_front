"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[2480],{82480:(le,W,g)=>{g.r(W),g.d(W,{registerFunctions:()=>Ee});var x=g(15861),j=g(91365),b=g(37780),A=g(6729),l=g(25919),oe=g(42275),J=g(90512),L=g(20057),ue=g(98362),a=g(47562),fe=g(16309),D=g(52724),R=g(53997),de=g(95896),ce=g(79429),me=g(62074),ye=g(16776),_e=g(57366),$=g(77132),Y=g(83947),K=g(50818),pe=g(10699),F=g(80774),V=g(80415),H=g(36255),q=g(31099);function B(s,n,i){return z.apply(this,arguments)}function z(){return(z=(0,x.Z)(function*(s,n,i){const y=s.getVariables();if(y.length>0){const p=[];for(let e=0;e<y.length;e++){const t={name:y[e]};p.push(yield n.evaluateIdentifier(i,t))}const f={};for(let e=0;e<y.length;e++)f[y[e]]=p[e];return s.parameters=f,s}return s})).apply(this,arguments)}function c(s,n,i=null){for(const y in s)if(y.toLowerCase()===n.toLowerCase())return s[y];return i}function ee(s){if(null===s)return null;const n={type:c(s,"type",""),name:c(s,"name","")};if("range"===n.type)n.range=c(s,"range",[]);else{n.codedValues=[];for(const i of c(s,"codedValues",[]))n.codedValues.push({name:c(i,"name",""),code:c(i,"code",null)})}return n}function G(s){if(null===s)return null;const n={},i=c(s,"wkt",null);null!==i&&(n.wkt=i);const y=c(s,"wkid",null);return null!==y&&(n.wkid=y),n}function ne(s){if(null===s)return null;const n={hasZ:c(s,"hasz",!1),hasM:c(s,"hasm",!1)},i=c(s,"spatialreference",null);i&&(n.spatialReference=G(i));const y=c(s,"x",null);if(null!==y)return n.x=y,n.y=c(s,"y",null),n.hasZ&&(n.z=c(s,"z",null)),n.hasM&&(n.m=c(s,"m",null)),n;const p=c(s,"rings",null);if(null!==p)return n.rings=p,n;const f=c(s,"paths",null);if(null!==f)return n.paths=f,n;const e=c(s,"points",null);if(null!==e)return n.points=e,n;for(const t of["xmin","xmax","ymin","ymax","zmin","zmax","mmin","mmax"]){const o=c(s,t,null);null!==o&&(n[t]=o)}return n}function N(s){return"utc"===s?.toLowerCase()?"UTC":"unknown"===s?.toLowerCase()?"Unknown":s}function Ee(s){"async"===s.mode&&(s.functions.timezone=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,x.Z)(function*(p,f,e){if((0,a.H)(e,1,2,n,i),(0,a.n)(e[0])||(0,a.m)(e[0]))return"Unknown";if((0,a.u)(e[0])){if(yield e[0].load(),1===e.length||null===e[1])return N(e[0].datesInUnknownTimezone?"unknown":e[0].dateFieldsTimeZone);if(!(e[1]instanceof A.Z)||!1===e[1].hasField("type"))throw new l.aV(n,l.rH.InvalidParameter,i);const _=e[1].field("type");if(!1===(0,a.c)(_))throw new l.aV(n,l.rH.InvalidParameter,i);switch((0,a.j)(_).toLowerCase()){case"preferredtimezone":return N(e[0].preferredTimeZone);case"editfieldsinfo":return N(e[0].editFieldsInfo?.timeZone??null);case"timeinfo":return N(e[0].timeInfo?.timeZone??null);case"field":if(e[1].hasField("fieldname")&&(0,a.c)(e[1].field("fieldname")))return N(e[0].fieldTimeZone((0,a.j)(e[1].field("fieldname"))))}throw new l.aV(n,l.rH.InvalidParameter,i)}const t=(0,a.l)(e[0],(0,a.N)(n));if(null===t)return null;const o=t.timeZone;return"system"===o?j.iG.systemTimeZoneCanonicalName:"utc"===o.toLowerCase()?"UTC":"unknown"===o.toLowerCase()?"Unknown":o});return function(p,f,e){return y.apply(this,arguments)}}())},s.functions.sqltimestamp=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,x.Z)(function*(p,f,e){(0,a.H)(e,1,3,n,i);const t=e[0];if((0,a.k)(t)){if(1===e.length)return t.toSQLWithKeyword();if(2===e.length)return t.changeTimeZone((0,a.j)(e[1])).toSQLWithKeyword();throw new l.aV(n,l.rH.InvalidParameter,i)}if((0,a.m)(t))return t.toSQLWithKeyword();if((0,a.u)(t)){if(3!==e.length)throw new l.aV(n,l.rH.InvalidParameter,i);yield t.load();const o=(0,a.j)(e[1]);if((0,a.m)(e[2]))return e[2].toSQLWithKeyword();if(!1===(0,a.k)(e[2]))throw new l.aV(n,l.rH.InvalidParameter,i);const _=t.fieldTimeZone(o);return null===_?e[2].toSQLWithKeyword():e[2].changeTimeZone(_).toSQLWithKeyword()}throw new l.aV(n,l.rH.InvalidParameter,i)});return function(p,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"sqltimestamp",min:2,max:4}),s.functions.featuresetbyid=function(n,i){return s.standardFunctionAsync(n,i,(y,p,f)=>{if((0,a.H)(f,2,4,n,i),f[0]instanceof J.Z){const e=(0,a.j)(f[1]);let t=(0,a.K)(f[2],null);const o=(0,a.h)((0,a.K)(f[3],!0));if(null===t&&(t=["*"]),!1===(0,a.o)(t))throw new l.aV(n,l.rH.InvalidParameter,i);return f[0].featureSetById(e,o,t)}throw new l.aV(n,l.rH.InvalidParameter,i)})},s.signatures.push({name:"featuresetbyid",min:2,max:4}),s.functions.getfeatureset=function(n,i){return s.standardFunctionAsync(n,i,(y,p,f)=>{if((0,a.H)(f,1,2,n,i),(0,a.r)(f[0])){let e=(0,a.K)(f[1],"datasource");return null===e&&(e="datasource"),e=(0,a.j)(e).toLowerCase(),(0,L.convertToFeatureSet)(f[0].fullSchema(),e,n.lrucache,n.interceptor,n.spatialReference)}throw new l.aV(n,l.rH.InvalidParameter,i)})},s.signatures.push({name:"getfeatureset",min:1,max:2}),s.functions.featuresetbyportalitem=function(n,i){return s.standardFunctionAsync(n,i,(y,p,f)=>{if((0,a.H)(f,2,5,n,i),null===f[0])throw new l.aV(n,l.rH.PortalRequired,i);if(f[0]instanceof b.Z){const h=(0,a.j)(f[1]),d=(0,a.j)(f[2]);let r=(0,a.K)(f[3],null);const u=(0,a.h)((0,a.K)(f[4],!0));if(null===r&&(r=["*"]),!1===(0,a.o)(r))throw new l.aV(n,l.rH.InvalidParameter,i);let m=null;return m=n.services?.portal?n.services.portal:q.Z.getDefault(),m=(0,fe._)(f[0],m),(0,L.constructFeatureSetFromPortalItem)(h,d,n.spatialReference,r,u,m,n.lrucache,n.interceptor)}if(!1===(0,a.c)(f[0]))throw new l.aV(n,l.rH.PortalRequired,i);const e=(0,a.j)(f[0]),t=(0,a.j)(f[1]);let o=(0,a.K)(f[2],null);const _=(0,a.h)((0,a.K)(f[3],!0));if(null===o&&(o=["*"]),!1===(0,a.o)(o))throw new l.aV(n,l.rH.InvalidParameter,i);return(0,L.constructFeatureSetFromPortalItem)(e,t,n.spatialReference,o,_,n.services?.portal??q.Z.getDefault(),n.lrucache,n.interceptor)})},s.signatures.push({name:"featuresetbyportalitem",min:2,max:5}),s.functions.featuresetbyname=function(n,i){return s.standardFunctionAsync(n,i,(y,p,f)=>{if((0,a.H)(f,2,4,n,i),f[0]instanceof J.Z){const e=(0,a.j)(f[1]);let t=(0,a.K)(f[2],null);const o=(0,a.h)((0,a.K)(f[3],!0));if(null===t&&(t=["*"]),!1===(0,a.o)(t))throw new l.aV(n,l.rH.InvalidParameter,i);return f[0].featureSetByName(e,o,t)}throw new l.aV(n,l.rH.InvalidParameter,i)})},s.signatures.push({name:"featuresetbyname",min:2,max:4}),s.functions.featureset=function(n,i){return s.standardFunction(n,i,(y,p,f)=>{(0,a.H)(f,1,1,n,i);let e=f[0];const t={layerDefinition:{geometryType:"",objectIdField:"",hasM:!1,hasZ:!1,globalIdField:"",typeIdField:"",fields:[]},featureSet:{geometryType:"",features:[]}};if((0,a.c)(e))e=JSON.parse(e),void 0!==e.layerDefinition?(t.layerDefinition=e.layerDefinition,t.featureSet=e.featureSet,e.layerDefinition.spatialReference&&(t.layerDefinition.spatialReference=e.layerDefinition.spatialReference)):(t.featureSet.features=e.features,t.featureSet.geometryType=e.geometryType,t.layerDefinition.geometryType=t.featureSet.geometryType,t.layerDefinition.objectIdField=e.objectIdFieldName??"",t.layerDefinition.typeIdField=e.typeIdFieldName,t.layerDefinition.globalIdField=e.globalIdFieldName,t.layerDefinition.fields=e.fields,e.spatialReference&&(t.layerDefinition.spatialReference=e.spatialReference));else{if(!(f[0]instanceof A.Z))throw new l.aV(n,l.rH.InvalidParameter,i);{e=JSON.parse(f[0].castToText(!0));const o=c(e,"layerdefinition");if(null!==o){t.layerDefinition.geometryType=c(o,"geometrytype",""),t.featureSet.geometryType=t.layerDefinition.geometryType,t.layerDefinition.globalIdField=c(o,"globalidfield",""),t.layerDefinition.objectIdField=c(o,"objectidfield",""),t.layerDefinition.typeIdField=c(o,"typeidfield",""),t.layerDefinition.hasZ=!0===c(o,"hasz",!1),t.layerDefinition.hasM=!0===c(o,"hasm",!1);const _=c(o,"spatialreference",null);_&&(t.layerDefinition.spatialReference=G(_));for(const d of c(o,"fields",[])){const r={name:c(d,"name",""),alias:c(d,"alias",""),type:c(d,"type",""),nullable:c(d,"nullable",!0),editable:c(d,"editable",!0),length:c(d,"length",null),domain:ee(c(d,"domain"))};t.layerDefinition.fields.push(r)}const h=c(e,"featureset",null);if(h){const d={};for(const r of t.layerDefinition.fields)d[r.name.toLowerCase()]=r.name;for(const r of c(h,"features",[])){const u={},m=c(r,"attributes",{});for(const C in m)u[d[C.toLowerCase()]]=m[C];t.featureSet.features.push({attributes:u,geometry:ne(c(r,"geometry",null))})}}}else{t.layerDefinition.hasZ=!0===c(e,"hasz",!1),t.layerDefinition.hasM=!0===c(e,"hasm",!1),t.layerDefinition.geometryType=c(e,"geometrytype",""),t.featureSet.geometryType=t.layerDefinition.geometryType,t.layerDefinition.objectIdField=c(e,"objectidfieldname",""),t.layerDefinition.typeIdField=c(e,"typeidfieldname","");const _=c(e,"spatialreference",null);_&&(t.layerDefinition.spatialReference=G(_));let h=c(e,"fields",null);if((0,a.o)(h))for(const u of h){const m={name:c(u,"name",""),alias:c(u,"alias",""),type:c(u,"type",""),nullable:c(u,"nullable",!0),editable:c(u,"editable",!0),length:c(u,"length",null),domain:ee(c(u,"domain"))};t.layerDefinition.fields.push(m)}else h=null,t.layerDefinition.fields=h;const d={};for(const u of t.layerDefinition.fields)d[u.name.toLowerCase()]=u.name;let r=c(e,"features",null);if((0,a.o)(r))for(const u of r){const m={},C=c(u,"attributes",{});for(const P in C)m[d[P.toLowerCase()]]=C[P];t.featureSet.features.push({attributes:m,geometry:ne(c(u,"geometry",null))})}else r=null,t.featureSet.features=r}}}if(!1===function De(s){return!!s.layerDefinition&&!!s.featureSet&&!1!==function ge(s,n){for(const i of n)if(i===s)return!0;return!1}(s.layerDefinition.geometryType,["",null,"esriGeometryNull","esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon","esriGeometryMultipoint","esriGeometryEnvelope"])&&!1!==(0,a.o)(s.layerDefinition.fields)&&!1!==(0,a.o)(s.featureSet.features)}(t))throw new l.aV(n,l.rH.InvalidParameter,i);return t.layerDefinition.geometryType||(t.layerDefinition.geometryType="esriGeometryNull"),ye.Z.create(t,n.spatialReference)})},s.signatures.push({name:"featureset",min:1,max:1}),s.functions.filter=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,x.Z)(function*(p,f,e){if((0,a.H)(e,2,2,n,i),(0,a.o)(e[0])||(0,a.q)(e[0])){const t=[];let o=e[0];o instanceof ue.Z&&(o=o.toArray());let _=null;if(!(0,a.i)(e[1]))throw new l.aV(n,l.rH.InvalidParameter,i);_=e[1].createFunction(n);for(const h of o){const d=_(h);(0,pe.y8)(d)?!0===(yield d)&&t.push(h):!0===d&&t.push(h)}return t}if((0,a.u)(e[0])){const t=yield e[0].load(),o=F.WhereClause.create(e[1],t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC),_=o.getVariables();if(_.length>0){const h=[];for(let r=0;r<_.length;r++){const u={name:_[r]};h.push(yield s.evaluateIdentifier(n,u))}const d={};for(let r=0;r<_.length;r++)d[_[r]]=h[r];return o.parameters=d,new R.Z({parentfeatureset:e[0],whereclause:o})}return new R.Z({parentfeatureset:e[0],whereclause:o})}throw new l.aV(n,l.rH.InvalidParameter,i)});return function(p,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"filter",min:2,max:2}),s.functions.orderby=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,x.Z)(function*(p,f,e){if((0,a.H)(e,2,2,n,i),(0,a.u)(e[0])){const t=new _e.Z(e[1]);return new de.Z({parentfeatureset:e[0],orderbyclause:t})}throw new l.aV(n,l.rH.InvalidParameter,i)});return function(p,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"orderby",min:2,max:2}),s.functions.top=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,x.Z)(function*(p,f,e){if((0,a.H)(e,2,2,n,i),(0,a.u)(e[0]))return new ce.Z({parentfeatureset:e[0],topnum:e[1]});if((0,a.o)(e[0]))return(0,a.g)(e[1])>=e[0].length?e[0].slice(0):e[0].slice(0,(0,a.g)(e[1]));if((0,a.q)(e[0]))return(0,a.g)(e[1])>=e[0].length()?e[0].slice(0):e[0].slice(0,(0,a.g)(e[1]));throw new l.aV(n,l.rH.InvalidParameter,i)});return function(p,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"top",min:2,max:2}),s.functions.first=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,x.Z)(function*(p,f,e){if((0,a.H)(e,1,1,n,i),(0,a.u)(e[0])){const t=yield e[0].first(p.abortSignal);if(null!==t){const o=oe.Z.createFromGraphicLikeObject(t.geometry,t.attributes,e[0],n.timeZone);return o._underlyingGraphic=t,o}return t}return(0,a.o)(e[0])?0===e[0].length?null:e[0][0]:(0,a.q)(e[0])?0===e[0].length()?null:e[0].get(0):null});return function(p,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"first",min:1,max:1}),s.functions.attachments=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,x.Z)(function*(p,f,e){(0,a.H)(e,1,2,n,i);const t={minsize:-1,maxsize:-1,types:null,returnMetadata:!1};if(e.length>1)if(e[1]instanceof A.Z){if(e[1].hasField("minsize")&&(t.minsize=(0,a.g)(e[1].field("minsize"))),e[1].hasField("metadata")&&(t.returnMetadata=(0,a.h)(e[1].field("metadata"))),e[1].hasField("maxsize")&&(t.maxsize=(0,a.g)(e[1].field("maxsize"))),e[1].hasField("types")){const o=(0,a.a3)(e[1].field("types"),!1);o.length>0&&(t.types=o)}}else if(null!==e[1])throw new l.aV(n,l.rH.InvalidParameter,i);if((0,a.r)(e[0])){let o=e[0]._layer;return o instanceof V.default&&(o=(0,L.constructFeatureSet)(o,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===o||!1===(0,a.u)(o)?[]:(yield o.load(),o.queryAttachments(e[0].field(o.objectIdField),t.minsize,t.maxsize,t.types,t.returnMetadata))}if(null===e[0])return[];throw new l.aV(n,l.rH.InvalidParameter,i)});return function(p,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"attachments",min:1,max:2}),s.functions.featuresetbyrelationshipname=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,x.Z)(function*(p,f,e){(0,a.H)(e,2,4,n,i);const t=e[0],o=(0,a.j)(e[1]);let _=(0,a.K)(e[2],null);const h=(0,a.h)((0,a.K)(e[3],!0));if(null===_&&(_=["*"]),!1===(0,a.o)(_))throw new l.aV(n,l.rH.InvalidParameter,i);if(null===e[0])return null;if(!(0,a.r)(e[0]))throw new l.aV(n,l.rH.InvalidParameter,i);let d=t._layer;if(d instanceof V.default&&(d=(0,L.constructFeatureSet)(d,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===d||!1===(0,a.u)(d))return null;d=yield d.load();const r=d.relationshipMetaData().filter(T=>T.name===o);if(0===r.length)return null;if(null!=r[0].relationshipTableId&&r[0].relationshipTableId>-1)return(0,L.constructFeatureSetFromRelationship)(d,r[0],t.field(d.objectIdField),d.spatialReference,_,h,n.lrucache,n.interceptor);let u=d.serviceUrl();if(!u)return null;u="/"===u.charAt(u.length-1)?u+r[0].relatedTableId.toString():u+"/"+r[0].relatedTableId.toString();const m=yield(0,L.constructFeatureSetFromUrl)(u,d.spatialReference,_,h,n.lrucache,n.interceptor);yield m.load();let C=m.relationshipMetaData();if(C=C.filter(T=>T.id===r[0].id),!1===t.hasField(r[0].keyField)||null===t.field(r[0].keyField)){const T=yield d.getFeatureByObjectId(t.field(d.objectIdField),[r[0].keyField]);if(T){const w=F.WhereClause.create(C[0].keyField+"= @id",m.getFieldsIndex(),m.dateFieldsTimeZoneDefaultUTC);return w.parameters={id:T.attributes[r[0].keyField]},m.filter(w)}return new me.Z({parentfeatureset:m})}const P=F.WhereClause.create(C[0].keyField+"= @id",m.getFieldsIndex(),m.dateFieldsTimeZoneDefaultUTC);return P.parameters={id:t.field(r[0].keyField)},m.filter(P)});return function(p,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"featuresetbyrelationshipname",min:2,max:4}),s.functions.featuresetbyassociation=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,x.Z)(function*(p,f,e){(0,a.H)(e,2,3,n,i);const t=e[0],o=(0,a.j)((0,a.K)(e[1],"")).toLowerCase(),_=(0,a.c)(e[2])?(0,a.j)(e[2]):null;if(null===e[0])return null;if(!(0,a.r)(e[0]))throw new l.aV(n,l.rH.InvalidParameter,i);let h=t._layer;if(h instanceof V.default&&(h=(0,L.constructFeatureSet)(h,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===h||!1===(0,a.u)(h))return null;yield h.load();const d=h.serviceUrl(),r=yield(0,L.constructAssociationMetaDataFeatureSetFromUrl)(d,n.spatialReference);let u=null,m=null,C=!1;if(null!==_&&""!==_&&void 0!==_){for(const I of r.terminals)I.terminalName===_&&(m=I.terminalId);null===m&&(C=!0)}const P=r.associations.getFieldsIndex(),T=P.get("TOGLOBALID").name,w=P.get("FROMGLOBALID").name,X=P.get("TOTERMINALID").name,k=P.get("FROMTERMINALID").name,S=P.get("FROMNETWORKSOURCEID").name,U=P.get("TONETWORKSOURCEID").name,Z=P.get("ASSOCIATIONTYPE").name,Ie=P.get("ISCONTENTVISIBLE").name,Fe=P.get("OBJECTID").name;for(const I of h.fields)if("global-id"===I.type){u=t.field(I.name);break}let M=null,te=new D.yN(new H.Z({name:"percentalong",alias:"percentalong",type:"double"}),F.WhereClause.create("0",r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC)),ae=new D.yN(new H.Z({name:"side",alias:"side",type:"string"}),F.WhereClause.create("''",r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC));const v="globalid",re="globalId",ie={};for(const I in r.lkp)ie[I]=r.lkp[I].sourceId;const O=new D.TO(new H.Z({name:"classname",alias:"classname",type:"string"}),null,ie);let E="";switch(o){case"midspan":{E=`((${T}='${u}') OR ( ${w}='${u}')) AND (${Z} IN (5))`,O.codefield=F.WhereClause.create(`CASE WHEN (${T}='${u}') THEN ${S} ELSE ${U} END`,r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC);const I=(0,$.JW)(D.Xx.findField(r.associations.fields,w));I.name=v,I.alias=v,M=new D.yN(I,F.WhereClause.create(`CASE WHEN (${w}='${u}') THEN ${T} ELSE ${w} END`,r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC)),te=r.unVersion>=4?new D.$X(D.Xx.findField(r.associations.fields,P.get("PERCENTALONG").name)):new D.yN(new H.Z({name:"percentalong",alias:"percentalong",type:"double"}),F.WhereClause.create("0",r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC));break}case"junctionedge":{E=`((${T}='${u}') OR ( ${w}='${u}')) AND (${Z} IN (4,6))`,O.codefield=F.WhereClause.create(`CASE WHEN (${T}='${u}') THEN ${S} ELSE ${U} END`,r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC);const I=(0,$.JW)(D.Xx.findField(r.associations.fields,w));I.name=v,I.alias=v,M=new D.yN(I,F.WhereClause.create(`CASE WHEN (${w}='${u}') THEN ${T} ELSE ${w} END`,r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC)),ae=new D.yN(new H.Z({name:"side",alias:"side",type:"string"}),F.WhereClause.create(`CASE WHEN (${Z}=4) THEN 'from' ELSE 'to' END`,r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC));break}case"connected":{let I=`${T}='@T'`,se=`${w}='@T'`;null!==m&&(I+=` AND ${X}=@A`,se+=` AND ${k}=@A`),E="(("+I+") OR ("+se+"))",E=(0,a.T)(E,"@T",u??""),I=(0,a.T)(I,"@T",u??""),null!==m&&(I=(0,a.T)(I,"@A",m.toString()),E=(0,a.T)(E,"@A",m.toString())),O.codefield=F.WhereClause.create("CASE WHEN "+I+` THEN ${S} ELSE ${U} END`,r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC);const Q=(0,$.JW)(D.Xx.findField(r.associations.fields,w));Q.name=v,Q.alias=v,M=new D.yN(Q,F.WhereClause.create("CASE WHEN "+I+` THEN ${w} ELSE ${T} END`,r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC));break}case"container":E=`${T}='${u}' AND ${Z} = 2`,null!==m&&(E+=` AND ${X} = `+m.toString()),O.codefield=S,E="( "+E+" )",M=new D.QP(D.Xx.findField(r.associations.fields,w),v,v);break;case"content":E=`(${w}='${u}' AND ${Z} = 2)`,null!==m&&(E+=` AND ${k} = `+m.toString()),O.codefield=U,E="( "+E+" )",M=new D.QP(D.Xx.findField(r.associations.fields,T),v,v);break;case"structure":E=`(${T}='${u}' AND ${Z} = 3)`,null!==m&&(E+=` AND ${X} = `+m.toString()),O.codefield=S,E="( "+E+" )",M=new D.QP(D.Xx.findField(r.associations.fields,w),v,re);break;case"attached":E=`(${w}='${u}' AND ${Z} = 3)`,null!==m&&(E+=` AND ${k} = `+m.toString()),O.codefield=U,E="( "+E+" )",M=new D.QP(D.Xx.findField(r.associations.fields,T),v,re);break;default:throw new l.aV(n,l.rH.InvalidParameter,i)}return C&&(E="1 <> 1"),new D.Xx({parentfeatureset:r.associations,adaptedFields:[new D.$X(D.Xx.findField(r.associations.fields,Fe)),new D.$X(D.Xx.findField(r.associations.fields,Ie)),M,ae,O,te],extraFilter:E?F.WhereClause.create(E,r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC):null})});return function(p,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"featuresetbyassociation",min:2,max:6}),s.functions.groupby=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,x.Z)(function*(p,f,e){if((0,a.H)(e,3,3,n,i),!(0,a.u)(e[0]))throw new l.aV(n,l.rH.InvalidParameter,i);const t=yield e[0].load(),o=[],_=[];let h=!1,d=[];if((0,a.c)(e[1]))d.push(e[1]);else if(e[1]instanceof A.Z)d.push(e[1]);else if((0,a.o)(e[1]))d=e[1];else{if(!(0,a.q)(e[1]))throw new l.aV(n,l.rH.InvalidParameter,i);d=e[1].toArray()}for(const r of d)if((0,a.c)(r)){const u=F.WhereClause.create((0,a.j)(r),t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC),m=!0===(0,Y.y5)(u)?(0,a.j)(r):"%%%%FIELDNAME";o.push({name:m,expression:u}),"%%%%FIELDNAME"===m&&(h=!0)}else{if(!(r instanceof A.Z))throw new l.aV(n,l.rH.InvalidParameter,i);{const u=r.hasField("name")?r.field("name"):"%%%%FIELDNAME",m=r.hasField("expression")?r.field("expression"):"";if("%%%%FIELDNAME"===u&&(h=!0),!u)throw new l.aV(n,l.rH.InvalidParameter,i);o.push({name:u,expression:F.WhereClause.create(m||u,t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC)})}}if(d=[],(0,a.c)(e[2]))d.push(e[2]);else if((0,a.o)(e[2]))d=e[2];else if((0,a.q)(e[2]))d=e[2].toArray();else{if(!(e[2]instanceof A.Z))throw new l.aV(n,l.rH.InvalidParameter,i);d.push(e[2])}for(const r of d){if(!(r instanceof A.Z))throw new l.aV(n,l.rH.InvalidParameter,i);{const u=r.hasField("name")?r.field("name"):"",m=r.hasField("statistic")?r.field("statistic"):"",C=r.hasField("expression")?r.field("expression"):"";if(!u||!m||!C)throw new l.aV(n,l.rH.InvalidParameter,i);_.push({name:u,statistic:m.toLowerCase(),expression:F.WhereClause.create(C,t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC)})}}if(h){const r={};for(const m of t.fields)r[m.name.toLowerCase()]=1;for(const m of o)"%%%%FIELDNAME"!==m.name&&(r[m.name.toLowerCase()]=1);for(const m of _)"%%%%FIELDNAME"!==m.name&&(r[m.name.toLowerCase()]=1);let u=0;for(const m of o)if("%%%%FIELDNAME"===m.name){for(;1===r["field_"+u.toString()];)u++;r["field_"+u.toString()]=1,m.name="FIELD_"+u.toString()}}for(const r of o)yield B(r.expression,s,n);for(const r of _)yield B(r.expression,s,n);return e[0].groupby(o,_)});return function(p,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"groupby",min:3,max:3}),s.functions.distinct=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,x.Z)(function*(p,f,e){if((0,a.u)(e[0])){(0,a.H)(e,2,2,n,i);const t=yield e[0].load(),o=[];let _=[];if((0,a.c)(e[1]))_.push(e[1]);else if(e[1]instanceof A.Z)_.push(e[1]);else if((0,a.o)(e[1]))_=e[1];else{if(!(0,a.q)(e[1]))throw new l.aV(n,l.rH.InvalidParameter,i);_=e[1].toArray()}let h=!1;for(const d of _)if((0,a.c)(d)){const r=F.WhereClause.create((0,a.j)(d),t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC),u=!0===(0,Y.y5)(r)?(0,a.j)(d):"%%%%FIELDNAME";o.push({name:u,expression:r}),"%%%%FIELDNAME"===u&&(h=!0)}else{if(!(d instanceof A.Z))throw new l.aV(n,l.rH.InvalidParameter,i);{const r=d.hasField("name")?d.field("name"):"%%%%FIELDNAME",u=d.hasField("expression")?d.field("expression"):"";if("%%%%FIELDNAME"===r&&(h=!0),!r)throw new l.aV(n,l.rH.InvalidParameter,i);o.push({name:r,expression:F.WhereClause.create(u||r,t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC)})}}if(h){const d={};for(const u of t.fields)d[u.name.toLowerCase()]=1;for(const u of o)"%%%%FIELDNAME"!==u.name&&(d[u.name.toLowerCase()]=1);let r=0;for(const u of o)if("%%%%FIELDNAME"===u.name){for(;1===d["field_"+r.toString()];)r++;d["field_"+r.toString()]=1,u.name="FIELD_"+r.toString()}}for(const d of o)yield B(d.expression,s,n);return e[0].groupby(o,[])}return function he(s,n,i,y){if(1===y.length){if((0,a.o)(y[0]))return(0,K.t)(s,y[0],-1);if((0,a.q)(y[0]))return(0,K.t)(s,y[0].toArray(),-1)}return(0,K.t)(s,y,-1)}("distinct",0,0,e)});return function(p,f,e){return y.apply(this,arguments)}}())}),s.functions.getfeaturesetinfo=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,x.Z)(function*(p,f,e){if((0,a.H)(e,1,1,n,i),!(0,a.u)(e[0]))return null;const t=yield e[0].getFeatureSetInfo();return t?A.Z.convertObjectToArcadeDictionary({layerId:t.layerId,layerName:t.layerName,itemId:t.itemId,serviceLayerUrl:t.serviceLayerUrl,webMapLayerId:t.webMapLayerId??null,webMapLayerTitle:t.webMapLayerTitle??null,className:null,objectClassId:null},(0,a.N)(n),!1,!1):null});return function(p,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"getfeaturesetinfo",min:1,max:1}),s.functions.filterbysubtypecode=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,x.Z)(function*(p,f,e){if((0,a.H)(e,2,2,n,i),(0,a.u)(e[0])){const t=yield e[0].load();if(!(0,a.O)(e[1]))throw new l.aV(n,l.rH.InvalidParameter,i);if(t.subtypeField){const h=F.WhereClause.create(`${t.subtypeField}= ${e[1]}`,t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC);return new R.Z({parentfeatureset:e[0],whereclause:h})}if(null===t.typeIdField||""===t.typeIdField)throw new l.aV(n,l.rH.FeatureSetDoesNotHaveSubtypes,i);const _=F.WhereClause.create(`${t.typeIdField}= ${e[1]}`,t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC);return new R.Z({parentfeatureset:e[0],whereclause:_})}throw new l.aV(n,l.rH.InvalidParameter,i)});return function(p,f,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"filterbysubtypecode",min:2,max:2})}},16309:(le,W,g)=>{g.d(W,{_:()=>j});var x=g(31099);function j(b,A){return null===b?A:new x.Z({url:b.field("url")})}}}]);