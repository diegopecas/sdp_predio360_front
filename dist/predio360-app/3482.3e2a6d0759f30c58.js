"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[3482,7215],{3482:(z,K,F)=>{F.d(K,{Z:()=>P});var d=F(15861),T=F(62074),p=F(47982),R=F(49086),j=F(91510),b=F(77132),C=F(87215);class P extends R.Z{constructor(g){super(g),this._relation="",this._relationGeom=null,this._relationString="",this.declaredClass="esri.arcade.featureset.actions.SpatialFilter",this._relationString=g.relationString,this._parent=g.parentfeatureset,this._maxProcessing=40,this._relation=g.relation,this._relationGeom=g.relationGeom}_getSet(g){var c=this;return(0,d.Z)(function*(){if(null===c._wset){yield c._ensureLoaded();const L=yield c._parent._getFilteredSet("esriSpatialRelRelation"!==c._relation?c._relation:c._relation+":"+c._relationString,c._relationGeom,null,null,g);return c._checkCancelled(g),c._wset=new j.Z(L._candidates.slice(0),L._known.slice(0),L._ordered,c._clonePageDefinition(L.pagesDefinition)),c._wset}return c._wset})()}_isInFeatureSet(g){let c=this._parent._isInFeatureSet(g);return c===b.dj.NotInFeatureSet?c:(c=this._idstates[g],void 0===c?b.dj.Unknown:c)}_getFeature(g,c,L){return this._parent._getFeature(g,c,L)}_getFeatures(g,c,L,I){return this._parent._getFeatures(g,c,L,I)}_featureFromCache(g){return this._parent._featureFromCache(g)}executeSpatialRelationTest(g){var c=this;return(0,d.Z)(function*(){if(null===g.geometry)return!1;switch(c._relation){case"esriSpatialRelEnvelopeIntersects":return(0,C.intersects)((0,b.SV)(c._relationGeom),(0,b.SV)(g.geometry));case"esriSpatialRelIntersects":return(0,C.intersects)(c._relationGeom,g.geometry);case"esriSpatialRelContains":return(0,C.contains)(c._relationGeom,g.geometry);case"esriSpatialRelOverlaps":return(0,C.overlaps)(c._relationGeom,g.geometry);case"esriSpatialRelWithin":return(0,C.within)(c._relationGeom,g.geometry);case"esriSpatialRelTouches":return(0,C.touches)(c._relationGeom,g.geometry);case"esriSpatialRelCrosses":return(0,C.crosses)(c._relationGeom,g.geometry);case"esriSpatialRelRelation":return(0,C.relate)(c._relationGeom,g.geometry,c._relationString??"")}})()}_fetchAndRefineFeatures(g,c,L){var I=this;return(0,d.Z)(function*(){const U=new j.Z([],g,!1,null),E=Math.min(c,g.length);yield I._parent?._getFeatures(U,-1,E,L),I._checkCancelled(L);const S=[];for(let e=0;e<E;e++){const n=I._parent._featureFromCache(g[e]);S.push(yield I.executeSpatialRelationTest(n))}for(let e=0;e<c;e++)I._idstates[g[e]]=!0===S[e]?b.dj.InFeatureSet:b.dj.NotInFeatureSet;return"success"})()}_getFilteredSet(g,c,L,I,U){var E=this;return(0,d.Z)(function*(){yield E._ensureLoaded();const S=yield E._parent._getFilteredSet("esriSpatialRelRelation"!==E._relation?E._relation:E._relation+":"+E._relationString,E._relationGeom,L,I,U);let e;return E._checkCancelled(U),e=null!==c?new j.Z(S._candidates.slice(0).concat(S._known.slice(0)),[],S._ordered,E._clonePageDefinition(S.pagesDefinition)):new j.Z(S._candidates.slice(0),S._known.slice(0),S._ordered,E._clonePageDefinition(S.pagesDefinition)),e})()}_stat(g,c,L,I,U,E,S){var e=this;return(0,d.Z)(function*(){if(""!==L)return{calculated:!1};const n=yield e._parent._stat(g,c,"esriSpatialRelRelation"!==e._relation?e._relation:e._relation+":"+e._relationString,e._relationGeom,U,E,S);return!1===n.calculated?null===U&&""===L&&null===I?e._manualStat(g,c,E,S):{calculated:!1}:n})()}_canDoAggregates(g,c,L,I,U){var E=this;return(0,d.Z)(function*(){return""===L&&null===I&&null!==E._parent&&E._parent._canDoAggregates(g,c,"esriSpatialRelRelation"!==E._relation?E._relation:E._relation+":"+E._relationString,E._relationGeom,U)})()}_getAggregatePagesDataSourceDefinition(g,c,L,I,U,E,S){var e=this;return(0,d.Z)(function*(){if(null===e._parent)throw new p.EN(p.H9.NeverReach);return e._parent._getAggregatePagesDataSourceDefinition(g,c,"esriSpatialRelRelation"!==e._relation?e._relation:e._relation+":"+e._relationString,e._relationGeom,U,E,S)})()}static registerAction(){R.Z._featuresetFunctions.intersects=function(g){return null==g?new T.Z({parentfeatureset:this}):new P({parentfeatureset:this,relation:"esriSpatialRelIntersects",relationGeom:g})},R.Z._featuresetFunctions.envelopeIntersects=function(g){return null==g?new T.Z({parentfeatureset:this}):new P({parentfeatureset:this,relation:"esriSpatialRelEnvelopeIntersects",relationGeom:g})},R.Z._featuresetFunctions.contains=function(g){return null==g?new T.Z({parentfeatureset:this}):new P({parentfeatureset:this,relation:"esriSpatialRelContains",relationGeom:g})},R.Z._featuresetFunctions.overlaps=function(g){return null==g?new T.Z({parentfeatureset:this}):new P({parentfeatureset:this,relation:"esriSpatialRelOverlaps",relationGeom:g})},R.Z._featuresetFunctions.within=function(g){return null==g?new T.Z({parentfeatureset:this}):new P({parentfeatureset:this,relation:"esriSpatialRelWithin",relationGeom:g})},R.Z._featuresetFunctions.touches=function(g){return null==g?new T.Z({parentfeatureset:this}):new P({parentfeatureset:this,relation:"esriSpatialRelTouches",relationGeom:g})},R.Z._featuresetFunctions.crosses=function(g){return null==g?new T.Z({parentfeatureset:this}):new P({parentfeatureset:this,relation:"esriSpatialRelCrosses",relationGeom:g})},R.Z._featuresetFunctions.relate=function(g,c){return null==g?new T.Z({parentfeatureset:this}):new P({parentfeatureset:this,relation:"esriSpatialRelRelation",relationGeom:g,relationString:c})}}getFieldsIndex(){return this._parent.getFieldsIndex()}}},62074:(z,K,F)=>{F.d(K,{Z:()=>b});var d=F(15861),T=F(47982),p=F(49086),R=F(91510),j=F(77132);class b extends p.Z{constructor(P){super(P),this.declaredClass="esri.layers.featureset.sources.Empty",this._maxProcessing=1e3,this._wset=new R.Z([],[],!1,null),this._parent=P.parentfeatureset,this._databaseType=j.Bj.Standardised}_getSet(){var P=this;return(0,d.Z)(function*(){return P._wset})()}optimisePagingFeatureQueries(){}_isInFeatureSet(){return j.dj.NotInFeatureSet}_getFeature(){return(0,d.Z)(function*(){throw new T.EN(T.H9.NeverReach)})()}queryAttachments(){return(0,d.Z)(function*(){return[]})()}_getFeatures(){return(0,d.Z)(function*(){return"success"})()}_featureFromCache(){return null}_fetchAndRefineFeatures(){return(0,d.Z)(function*(){throw new T.EN(T.H9.NeverReach)})()}_getFilteredSet(){return(0,d.Z)(function*(){return new R.Z([],[],!1,null)})()}_stat(P,$,g,c,L,I,U){return this._manualStat(P,$,I,U)}_canDoAggregates(){return(0,d.Z)(function*(){return!1})()}}},49086:(z,K,F)=>{F.d(K,{Z:()=>U});var d=F(15861),T=F(53791),p=F(47982),R=F(42275);class j{constructor(S,e){this._lastId=-1,this._progress=e,this._parent=S}reset(){this._lastId=-1}nextBatchAsArcadeFeatures(S,e){var n=this;return(0,d.Z)(function*(){const a=yield n.nextBatch(S);return null===a?a:a.map(t=>R.Z.createFromGraphicLikeObject(t.geometry,t.attributes,n._parent,e))})()}nextBatch(S){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then(a=>this.nextBatch(S),a=>this.nextBatch(S));const e={returnpromise:null,hasset:!1},n=[];return e.returnpromise=new Promise((a,t)=>{this._parent._getSet(this._progress).then(u=>{const l=u._known;let D=l.length-1;if("GETPAGES"===l[l.length-1]&&(D-=1),this._lastId+S>D&&l.length>0&&"GETPAGES"===l[l.length-1])this._parent._expandPagedSet(u,this._parent._maxQueryRate(),0,0,this._progress).then(O=>{e.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(S).then(a,t)},O=>{e.hasset=!0,this._parent._mainSetInUse=null,t(O)});else{if(D>=this._lastId+S||0===u._candidates.length){for(let O=0;O<S;O++){const Q=O+this._lastId+1;if(Q>=l.length)break;n[O]=l[Q]}return this._lastId+=n.length,0===n.length&&(e.hasset=!0,this._parent._mainSetInUse=null,a([])),void this._parent._getFeatureBatch(n,this._progress).then(O=>{e.hasset=!0,this._parent._mainSetInUse=null,a(O)},O=>{e.hasset=!0,this._parent._mainSetInUse=null,t(O)})}this._parent._refineSetBlock(u,this._parent._maxProcessingRate(),this._progress).then(()=>{e.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(S).then(a,t)},O=>{e.hasset=!0,this._parent._mainSetInUse=null,t(O)})}},u=>{e.hasset=!0,this._parent._mainSetInUse=null,t(u)})}),!1===e.hasset&&(this._parent._mainSetInUse=e.returnpromise,e.hasset=!0),e.returnpromise}next(){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then(e=>this.next(),e=>this.next());const S={returnpromise:null,hasset:!1};return S.returnpromise=new Promise((e,n)=>{this._parent._getSet(this._progress).then(a=>{const t=a._known;this._lastId<t.length-1?"GETPAGES"===t[this._lastId+1]?this._parent._expandPagedSet(a,this._parent._maxQueryRate(),0,0,this._progress).then(u=>(S.hasset=!0,this._parent._mainSetInUse=null,this.next())).then(e,n):(this._lastId+=1,this._parent._getFeature(a,t[this._lastId],this._progress).then(u=>{S.hasset=!0,this._parent._mainSetInUse=null,e(u)},u=>{S.hasset=!0,this._parent._mainSetInUse=null,n(u)})):a._candidates.length>0?this._parent._refineSetBlock(a,this._parent._maxProcessingRate(),this._progress).then(()=>{S.hasset=!0,this._parent._mainSetInUse=null,this.next().then(e,n)},u=>{S.hasset=!0,this._parent._mainSetInUse=null,n(u)}):(S.hasset=!0,this._parent._mainSetInUse=null,e(null))},a=>{S.hasset=!0,this._parent._mainSetInUse=null,n(a)})}),!1===S.hasset&&(this._parent._mainSetInUse=S.returnpromise,S.hasset=!0),S.returnpromise}count(){var S=this;return(0,d.Z)(function*(){if(-1!==S._parent._totalCount)return S._parent._totalCount;const e=yield S._parent._getSet(S._progress),n=yield S._refineAllSets(e);return S._parent._totalCount=n._known.length,S._parent._totalCount})()}_refineAllSets(S){var e=this;return(0,d.Z)(function*(){if(S._known.length>0&&"GETPAGES"===S._known[S._known.length-1])return yield e._parent._expandPagedSet(S,e._parent._maxQueryRate(),0,1,e._progress),e._refineAllSets(S);if(S._candidates.length>0){if("GETPAGES"===S._known[S._candidates.length-1])return yield e._parent._expandPagedSet(S,e._parent._maxQueryRate(),0,2,e._progress),e._refineAllSets(S);const n=yield e._parent._refineSetBlock(S,e._parent._maxProcessingRate(),e._progress);return n._candidates.length>0?e._refineAllSets(n):n}return S})()}}var b=F(91510),C=F(77132),P=F(45333),$=F(10699),g=F(80774),c=F(87215),L=F(65234),I=F(60466);let U=(()=>{class E{constructor(e){this.recentlyUsedQueries=null,this.featureSetQueryInterceptor=null,this._idstates=[],this._parent=null,this._wset=null,this._mainSetInUse=null,this._maxProcessing=200,this._maxQuery=500,this._totalCount=-1,this._databaseType=C.Bj.NotEvaluated,this._databaseTypeProbed=null,this.declaredRootClass="esri.arcade.featureset.support.FeatureSet",this._featureCache=[],this.typeIdField=null,this.types=null,this.subtypeField=null,this.subtypes=null,this.fields=null,this.geometryType="",this.objectIdField="",this.globalIdField="",this.spatialReference=null,this.hasM=!1,this.hasZ=!1,this._transparent=!1,this.loaded=!1,this._loadPromise=null,this._fieldsIndex=null,this.fsetInfo=null,e?.lrucache&&(this.recentlyUsedQueries=e.lrucache),e?.interceptor&&(this.featureSetQueryInterceptor=e.interceptor)}optimisePagingFeatureQueries(e){this._parent&&this._parent.optimisePagingFeatureQueries(e)}_hasMemorySource(){return!0}prop(e,n){return void 0===n?this[e]:(void 0!==this[e]&&(this[e]=n),this)}end(){return null!==this._parent&&!0===this._parent._transparent?this._parent.end():this._parent}_ensureLoaded(){return this.load()}load(){return null===this._loadPromise&&(this._loadPromise=this.loadImpl()),this._loadPromise}loadImpl(){var e=this;return(0,d.Z)(function*(){return!0===e._parent?.loaded?(e._initialiseFeatureSet(),e):(yield e._parent?.load(),e._initialiseFeatureSet(),e)})()}_initialiseFeatureSet(){null!==this._parent?(this.fields=this._parent.fields.slice(0),this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.globalIdField=this._parent.globalIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types,this.subtypeField=this._parent.subtypeField,this.subtypes=this._parent.subtypes):(this.fields=[],this.typeIdField="",this.subtypeField="",this.objectIdField="",this.globalIdField="",this.spatialReference=new L.Z({wkid:4326}),this.geometryType=C.Qk.point)}getField(e,n){let a;return(n=n||this.fields)&&(e=e.toLowerCase(),n.some(t=>(t&&t.name.toLowerCase()===e&&(a=t),!!a))),a}getFieldsIndex(){return null===this._fieldsIndex&&(this._fieldsIndex=I.Z.fromLayer({timeInfo:this.timeInfo,editFieldsInfo:this.editFieldsInfo,dateFieldsTimeZone:this.dateFieldsTimeZone,datesInUnknownTimezone:this.datesInUnknownTimezone,fields:this.fields})),this._fieldsIndex}_maxProcessingRate(){return null!==this._parent?Math.min(this._maxProcessing,this._parent._maxProcessingRate()):Math.min(this._maxProcessing,this._maxQueryRate())}_maxQueryRate(){return null!==this._parent?Math.max(this._maxQuery,this._parent._maxQueryRate()):this._maxQuery}_checkCancelled(e){if(null!=e&&e.aborted)throw new p.EN(p.H9.Cancelled)}nativeCapabilities(){return this._parent.nativeCapabilities()}_canDoAggregates(e,n,a,t,u){var l=this;return(0,d.Z)(function*(){return null!==l._parent&&l._parent._canDoAggregates(e,n,a,t,u)})()}_getAggregatePagesDataSourceDefinition(e,n,a,t,u,l,D){var w=this;return(0,d.Z)(function*(){if(null===w._parent)throw new p.EN(p.H9.NeverReach);return w._parent._getAggregatePagesDataSourceDefinition(e,n,a,t,u,l,D)})()}_getAgregagtePhysicalPage(e,n,a){var t=this;return(0,d.Z)(function*(){if(null===t._parent)throw new p.EN(p.H9.NeverReach);return t._parent._getAgregagtePhysicalPage(e,n,a)})()}databaseType(){var e=this;return(0,d.Z)(function*(){if(e._databaseType===C.Bj.NotEvaluated){if(null!==T.Z.applicationCache){const n=T.Z.applicationCache.getDatabaseType(e._cacheableFeatureSetSourceKey());if(null!==n)return n}if(null!==e._databaseTypeProbed)return e._databaseTypeProbed;try{e._databaseTypeProbed=e._getDatabaseTypeImpl(),null!==T.Z.applicationCache&&T.Z.applicationCache.setDatabaseType(e._cacheableFeatureSetSourceKey(),e._databaseTypeProbed)}catch(n){throw null!==T.Z.applicationCache&&T.Z.applicationCache.clearDatabaseType(e._cacheableFeatureSetSourceKey()),n}return e._databaseTypeProbed}return e._databaseType})()}_getDatabaseTypeImpl(){var e=this;return(0,d.Z)(function*(){const n=[{thetype:C.Bj.SqlServer,testwhere:"(CAST( '2015-01-01' as DATETIME) = CAST( '2015-01-01' as DATETIME)) AND OBJECTID<0"},{thetype:C.Bj.Oracle,testwhere:"(TO_DATE('2003-11-18','YYYY-MM-DD') = TO_DATE('2003-11-18','YYYY-MM-DD')) AND OBJECTID<0"},{thetype:C.Bj.StandardisedNoInterval,testwhere:"(date '2015-01-01 10:10:10' = date '2015-01-01 10:10:10') AND OBJECTID<0"}];for(const a of n)if(!0===(yield e._runDatabaseProbe(a.testwhere)))return a.thetype;return C.Bj.StandardisedNoInterval})()}_cacheableFeatureSetSourceKey(){return"MUSTBESET"}_runDatabaseProbe(e){var n=this;return(0,d.Z)(function*(){if(null!==n._parent)return n._parent._runDatabaseProbe(e);throw new p.EN(p.H9.NotImplemented)})()}isTable(){return this._parent?.isTable()??!1}_featureFromCache(e){if(void 0!==this._featureCache[e])return this._featureCache[e]}_isInFeatureSet(e){return C.dj.Unknown}_getSet(e){throw new p.EN(p.H9.NotImplemented)}_getFeature(e,n,a){var t=this;return(0,d.Z)(function*(){if(t._checkCancelled(a),void 0!==t._featureFromCache(n)||(yield t._getFeatures(e,n,t._maxProcessingRate(),a),t._checkCancelled(a),void 0!==t._featureFromCache(n)))return t._featureFromCache(n);throw new p.EN(p.H9.MissingFeatures)})()}_getFeatureBatch(e,n){var a=this;return(0,d.Z)(function*(){a._checkCancelled(n);const t=new b.Z([],e,!1,null),u=[];yield a._getFeatures(t,-1,e.length,n),a._checkCancelled(n);for(const l of e)void 0!==a._featureFromCache(l)&&u.push(a._featureFromCache(l));return u})()}_getFeatures(e,n,a,t){return(0,d.Z)(function*(){return"success"})()}_getFilteredSet(e,n,a,t,u){throw new p.EN(p.H9.NotImplemented)}_refineSetBlock(e,n,a){var t=this;return(0,d.Z)(function*(){if(!0===t._checkIfNeedToExpandCandidatePage(e,t._maxQueryRate()))return yield t._expandPagedSet(e,t._maxQueryRate(),0,0,a),t._refineSetBlock(e,n,a);t._checkCancelled(a);const u=e._candidates.length;t._refineKnowns(e,n);let l=u-e._candidates.length;if(0===e._candidates.length||l>=n)return e;if(yield t._refineIfParentKnown(e,n-l,a),t._checkCancelled(a),t._refineKnowns(e,n-l),l=u-e._candidates.length,l<n&&e._candidates.length>0){const D=n-l,w=t._prepareFetchAndRefineSet(e._candidates);return yield t._fetchAndRefineFeatures(w,w.length>D?D:e._candidates.length,a),t._checkCancelled(a),t._refineKnowns(e,n-l),e}return e})()}_fetchAndRefineFeatures(e,n,a){return null}_prepareFetchAndRefineSet(e){const n=[];for(let a=0;a<e.length;a++)this._isPhysicalFeature(e[a])&&n.push(e[a]);return n}_isPhysicalFeature(e){return null===this._parent||this._parent._isPhysicalFeature(e)}_refineKnowns(e,n){let a=0,t=null;const u=[];n=this._maxQueryRate();for(let l=0;l<e._candidates.length&&"GETPAGES"!==e._candidates[l];l++){let D=!1;const w=this._candidateIdTransform(e._candidates[l]);w!==e._candidates[l]&&(D=!0);const O=this._isInFeatureSet(w);if(O===C.dj.InFeatureSet)!0===D?e._known.includes(w)||(e._known.push(w),a+=1):(e._known.push(e._candidates[l]),a+=1),null===t?t={start:l,end:l}:t.end===l-1?t.end=l:(u.push(t),t={start:l,end:l});else if(O===C.dj.NotInFeatureSet)null===t?t={start:l,end:l}:t.end===l-1?t.end=l:(u.push(t),t={start:l,end:l}),a+=1;else if(O===C.dj.Unknown&&(a+=1,!0===e._ordered))break;if(a>=n)break}null!==t&&u.push(t);for(let l=u.length-1;l>=0;l--)e._candidates.splice(u[l].start,u[l].end-u[l].start+1)}_refineIfParentKnown(e,n,a){const t=new b.Z([],[],e._ordered,null);return t._candidates=e._candidates.slice(0),this._parent._refineSetBlock(t,n,a)}_candidateIdTransform(e){return this._parent._candidateIdTransform(e)}_checkIfNeedToExpandKnownPage(e,n){if(null===e.pagesDefinition)return!1;let a=0;for(let t=e._lastFetchedIndex;t<e._known.length;t++){if("GETPAGES"===e._known[t])return!0;if(void 0===this._featureCache[e._known[t]]&&(a+=1,a>=n))break}return!1}_checkIfNeedToExpandCandidatePage(e,n){if(null===e.pagesDefinition)return!1;let a=0;for(let t=0;t<e._candidates.length;t++){if("GETPAGES"===e._candidates[t])return!0;if(a+=1,a>=n)break}return!1}_expandPagedSet(e,n,a,t,u){var l=this;return(0,d.Z)(function*(){if(null===l._parent)throw new p.EN(p.H9.NotImplemented);return l._parent._expandPagedSet(e,n,a,t,u)})()}_expandPagedSetFeatureSet(e,n,a,t,u){var l=this;return(0,d.Z)(function*(){if(e._known.length>0&&"GETPAGES"===e._known[e._known.length-1]&&(t=1),0===t&&e._candidates.length>0&&"GETPAGES"===e._candidates[e._candidates.length-1]&&(t=2),0===t)return"finished";const D=yield l._getPage(e,t,u);return a+D<n?l._expandPagedSet(e,n,a+D,0,u):"success"})()}_getPage(e,n,a){var t=this;return(0,d.Z)(function*(){const u=1===n?e._known:e._candidates;if(e.pagesDefinition.internal.set.length>e.pagesDefinition.resultOffset||!0===e.pagesDefinition.internal.fullyResolved){u.length=u.length-1;let l=0;for(let w=0;w<e.pagesDefinition.resultRecordCount&&!(e.pagesDefinition.resultOffset+w>=e.pagesDefinition.internal.set.length);w++)u[u.length]=e.pagesDefinition.internal.set[e.pagesDefinition.resultOffset+w],l++;e.pagesDefinition.resultOffset+=l;let D=!1;return!0===e.pagesDefinition.internal.fullyResolved&&e.pagesDefinition.internal.set.length<=e.pagesDefinition.resultOffset&&(D=!0),!1===D&&u.push("GETPAGES"),l}return yield t._getPhysicalPage(e,n,a),t._getPage(e,n,a)})()}_getPhysicalPage(e,n,a){return null}_clonePageDefinition(e){return null===this._parent?null:this._parent._clonePageDefinition(e)}_first(e){return this.iterator(e).next()}first(e){return this._first(e)}calculateStatistic(e,n,a,t){var u=this;return(0,d.Z)(function*(){yield u._ensureLoaded();let l=yield u._stat(e,n,"",null,null,a,t);return!1===l.calculated&&(l=yield u._manualStat(e,n,a,t)),l.result})()}_manualStat(e,n,a,t){var u=this;return(0,d.Z)(function*(){let l=null;switch(e.toLowerCase()){case"count":return l=yield(0,P.QX)(u,t),{calculated:!0,result:l};case"distinct":return l=yield(0,P.EB)(u,n,a,t),{calculated:!0,result:l};case"avg":case"mean":return l=yield(0,P.J6)(u,n,t),{calculated:!0,result:l};case"stdev":return l=yield(0,P.m)(u,n,t),{calculated:!0,result:l};case"variance":return l=yield(0,P.CA)(u,n,t),{calculated:!0,result:l};case"sum":return l=yield(0,P.Sm)(u,n,t),{calculated:!0,result:l};case"min":return l=yield(0,P.VV)(u,n,t),{calculated:!0,result:l};case"max":return l=yield(0,P.Fp)(u,n,t),{calculated:!0,result:l};default:return{calculated:!0,result:0}}})()}_stat(e,n,a,t,u,l,D){var w=this;return(0,d.Z)(function*(){const O=yield w._parent._stat(e,n,a,t,u,l,D);return!1===O.calculated?null===u&&""===a&&null===t?w._manualStat(e,n,l,D):{calculated:!1}:O})()}_unionAllGeomSelf(e){const n=this.iterator(this._defaultTracker(e)),a=[];return new Promise((t,u)=>{this._unionShapeInBatches(a,n,t,u)})}_unionAllGeom(e){return new Promise((n,a)=>{const t=this.iterator(this._defaultTracker(e));this._unionShapeInBatches([],t,n,a)})}_unionShapeInBatches(e,n,a,t){n.next().then(u=>{try{null!==u&&null!==u.geometry&&e.push(u.geometry),e.length>30||null===u&&e.length>1?(0,c.union)(e).then(l=>{try{null===u?a(l):this._unionShapeInBatches(e=[l],n,a,t)}catch(D){t(D)}},t):null===u?a(1===e.length?e[0]:null):this._unionShapeInBatches(e,n,a,t)}catch(l){t(l)}},t)}iterator(e){return new j(this,e)}intersection(e,n=!1){return E._featuresetFunctions.intersection.bind(this)(e,n)}difference(e,n=!1,a=!0){return E._featuresetFunctions.difference.bind(this)(e,n,a)}symmetricDifference(e,n=!1,a=!0){return E._featuresetFunctions.symmetricDifference.bind(this)(e,n,a)}morphShape(e,n,a="unknown",t=null){return E._featuresetFunctions.morphShape.bind(this)(e,n,a,t)}morphShapeAndAttributes(e,n,a="unknown"){return E._featuresetFunctions.morphShapeAndAttributes.bind(this)(e,n,a)}union(e,n=!1){return E._featuresetFunctions.union.bind(this)(e,n)}intersects(e){return E._featuresetFunctions.intersects.bind(this)(e)}envelopeIntersects(e){return E._featuresetFunctions.envelopeIntersects.bind(this)(e)}contains(e){return E._featuresetFunctions.contains.bind(this)(e)}overlaps(e){return E._featuresetFunctions.overlaps.bind(this)(e)}relate(e,n){return E._featuresetFunctions.relate.bind(this)(e,n)}within(e){return E._featuresetFunctions.within.bind(this)(e)}touches(e){return E._featuresetFunctions.touches.bind(this)(e)}top(e){return E._featuresetFunctions.top.bind(this)(e)}crosses(e){return E._featuresetFunctions.crosses.bind(this)(e)}buffer(e,n,a,t=!0){return E._featuresetFunctions.buffer.bind(this)(e,n,a,t)}filter(e,n=null){return E._featuresetFunctions.filter.bind(this)(e,n)}orderBy(e){return E._featuresetFunctions.orderBy.bind(this)(e)}dissolve(e,n){return E._featuresetFunctions.dissolve.bind(this)(e,n)}groupby(e,n){return E._featuresetFunctions.groupby.bind(this)(e,n)}reduce(e,n=null,a){return new Promise((t,u)=>{this._reduceImpl(this.iterator(this._defaultTracker(a)),e,n,0,t,u,0)})}_reduceImpl(e,n,a,t,u,l,D){try{if(++D>1e3)return void setTimeout(()=>{this._reduceImpl(e,n,a,t,u,l,D=0)});e.next().then(w=>{try{if(null===w)u(a);else{const O=n(a,w,t,this);(0,$.y8)(O)?O.then(Q=>{this._reduceImpl(e,n,Q,t+1,u,l,D)},l):this._reduceImpl(e,n,O,t+1,u,l,D)}}catch(O){l(O)}},l)}catch(w){l(w)}}removeField(e){return E._featuresetFunctions.removeField.bind(this)(e)}addField(e,n,a=null){return E._featuresetFunctions.addField.bind(this)(e,n,a)}sumArea(e,n=!1,a){const t=(0,C.EI)(e);return this.reduce((u,l)=>null===l.geometry?0:n?(0,c.geodesicArea)(l.geometry,t).then(D=>u+D):(0,c.planarArea)(l.geometry,t).then(D=>u+D),0,a)}sumLength(e,n=!1,a){const t=(0,C.Lz)(e);return this.reduce((u,l)=>null===l.geometry?0:n?(0,c.geodesicLength)(l.geometry,t).then(D=>u+D):(0,c.planarLength)(l.geometry,t).then(D=>u+D),0,a)}_substituteVars(e,n){if(null!==n){const a={};for(const t in n)a[t.toLowerCase()]=n[t];e.parameters=a}}distinct(e,n=1e3,a=null,t){var u=this;return(0,d.Z)(function*(){yield u.load();const l=g.WhereClause.create(e,u.getFieldsIndex(),u.dateFieldsTimeZoneDefaultUTC);return u._substituteVars(l,a),u.calculateStatistic("distinct",l,n,u._defaultTracker(t))})()}min(e,n=null,a){var t=this;return(0,d.Z)(function*(){yield t.load();const u=g.WhereClause.create(e,t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC);return t._substituteVars(u,n),t.calculateStatistic("min",u,-1,t._defaultTracker(a))})()}max(e,n=null,a){var t=this;return(0,d.Z)(function*(){yield t.load();const u=g.WhereClause.create(e,t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC);return t._substituteVars(u,n),t.calculateStatistic("max",u,-1,t._defaultTracker(a))})()}avg(e,n=null,a){var t=this;return(0,d.Z)(function*(){yield t.load();const u=g.WhereClause.create(e,t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC);return t._substituteVars(u,n),t.calculateStatistic("avg",u,-1,t._defaultTracker(a))})()}sum(e,n=null,a){var t=this;return(0,d.Z)(function*(){yield t.load();const u=g.WhereClause.create(e,t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC);return t._substituteVars(u,n),t.calculateStatistic("sum",u,-1,t._defaultTracker(a))})()}stdev(e,n=null,a){var t=this;return(0,d.Z)(function*(){yield t.load();const u=g.WhereClause.create(e,t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC);return t._substituteVars(u,n),t.calculateStatistic("stdev",u,-1,t._defaultTracker(a))})()}variance(e,n=null,a){var t=this;return(0,d.Z)(function*(){yield t.load();const u=g.WhereClause.create(e,t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC);return t._substituteVars(u,n),t.calculateStatistic("variance",u,-1,t._defaultTracker(a))})()}count(e){var n=this;return(0,d.Z)(function*(){return yield n.load(),n.calculateStatistic("count",g.WhereClause.create("1",n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC),-1,n._defaultTracker(e))})()}_defaultTracker(e){return e??{aborted:!1}}forEach(e,n){return new Promise((a,t)=>{this._forEachImpl(this.iterator(this._defaultTracker(n)),e,this,a,t,0)})}_forEachImpl(e,n,a,t,u,l){try{if(++l>1e3)return void setTimeout(()=>{this._forEachImpl(e,n,a,t,u,l=0)},0);e.next().then(D=>{try{if(null===D)t(a);else{const w=n(D);null==w?this._forEachImpl(e,n,a,t,u,l):(0,$.y8)(w)?w.then(()=>{try{this._forEachImpl(e,n,a,t,u,l)}catch(O){u(O)}},u):this._forEachImpl(e,n,a,t,u,l)}}catch(w){u(w)}},u)}catch(D){u(D)}}convertToJSON(e){const n={layerDefinition:{geometryType:this.geometryType,fields:[]},featureSet:{features:[],geometryType:this.geometryType}};for(let a=0;a<this.fields.length;a++)n.layerDefinition.fields.push((0,C.Sh)(this.fields[a]));return this.reduce((a,t)=>{const u={geometry:t.geometry?.toJSON(),attributes:{}};for(const l in t.attributes)u.attributes[l]=t.attributes[l];return n.featureSet.features.push(u),1},0,e).then(()=>n)}castToText(e=!1){return"object, FeatureSet"}queryAttachments(e,n,a,t,u){return this._parent.queryAttachments(e,n,a,t,u)}serviceUrl(){return this._parent.serviceUrl()}subtypeMetaData(){return this.subtypeField&&this.subtypes?{subtypeField:this.subtypeField,subtypes:this.subtypes?this.subtypes.map(e=>({name:e.name,code:e.code})):[]}:this.typeIdField?{subtypeField:this.typeIdField,subtypes:this.types?this.types.map(e=>({name:e.name,code:e.id})):[]}:null}relationshipMetaData(){return this._parent.relationshipMetaData()}get gdbVersion(){return this._parent?this._parent.gdbVersion:""}schema(){const e=[];for(const n of this.fields)e.push((0,C.Sh)(n));return{objectIdField:this.objectIdField,globalIdField:this.globalIdField,geometryType:void 0===C.q2[this.geometryType]?"esriGeometryNull":C.q2[this.geometryType],fields:e}}convertToText(e,n){var a=this;return(0,d.Z)(function*(){if("schema"===e)return yield a._ensureLoaded(),JSON.stringify(a.schema());if("featureset"===e){yield a._ensureLoaded();const t=[];yield a.reduce((l,D)=>{const w={geometry:D.geometry?D.geometry.toJSON():null,attributes:D.attributes};return null!==w.geometry&&w.geometry.spatialReference&&delete w.geometry.spatialReference,t.push(w),1},0,n);const u=a.schema();return u.features=t,u.spatialReference=a.spatialReference.toJSON(),JSON.stringify(u)}return a.castToText()})()}getFeatureByObjectId(e,n){return this._parent.getFeatureByObjectId(e,n)}getOwningSystemUrl(){return this._parent.getOwningSystemUrl()}getIdentityUser(){return this._parent.getIdentityUser()}getRootFeatureSet(){return null!==this._parent?this._parent.getRootFeatureSet():this}getDataSourceFeatureSet(){return null!==this._parent?this._parent.getDataSourceFeatureSet():this}castAsJson(e=null){return"keeptype"===e?.featureset?this:"none"===e?.featureset?null:{type:"FeatureSet"}}castAsJsonAsync(e=null,n=null){var a=this;return(0,d.Z)(function*(){if("keeptype"===n?.featureset)return a;if("schema"===n?.featureset)return yield a._ensureLoaded(),JSON.parse(JSON.stringify(a.schema()));if("none"===n?.featureset)return null;yield a._ensureLoaded();const t=[];yield a.reduce((l,D)=>{const w={geometry:D.geometry?!0===n?.keepGeometryType?D.geometry:D.geometry.toJSON():null,attributes:D.attributes};return null!==w.geometry&&w.geometry.spatialReference&&!0!==n?.keepGeometryType&&delete w.geometry.spatialReference,t.push(w),1},0,e);const u=a.schema();return u.features=t,u.spatialReference=!0===n?.keepGeometryType?a.spatialReference:a.spatialReference?.toJSON(),u})()}fieldTimeZone(e){return this.getFieldsIndex().getTimeZone(e)}get preferredTimeZone(){return this._parent?.preferredTimeZone??null}get dateFieldsTimeZone(){return this._parent?.dateFieldsTimeZone??null}get dateFieldsTimeZoneDefaultUTC(){if(this.datesInUnknownTimezone)return"unknown";const e=this.dateFieldsTimeZone??"UTC";return""===e?"UTC":e}get datesInUnknownTimezone(){return this._parent.datesInUnknownTimezone}get editFieldsInfo(){return this._parent?.editFieldsInfo??null}get timeInfo(){return this._parent?.timeInfo??null}set featureSetInfo(e){this.fsetInfo=e}getFeatureSetInfo(){var e=this;return(0,d.Z)(function*(){return e.fsetInfo??(yield e._parent?.getFeatureSetInfo())??null})()}}return E._featuresetFunctions={},E})()},91510:(z,K,F)=>{F.d(K,{Z:()=>d});class d{constructor(p,R,j,b){this._lastFetchedIndex=0,this._ordered=!1,this.pagesDefinition=null,this._candidates=p,this._known=R,this._ordered=j,this.pagesDefinition=b}}},53791:(z,K,F)=>{F.d(K,{Z:()=>d});let d=(()=>{class T{constructor(){this._databaseTypeMetaData={},this._layerInfo={}}clearDatabaseType(R){void 0===this._databaseTypeMetaData[R]&&delete this._databaseTypeMetaData[R]}getDatabaseType(R){return"MUSTBESET"===R||void 0===this._databaseTypeMetaData[R]?null:this._databaseTypeMetaData[R]}setDatabaseType(R,j){this._databaseTypeMetaData[R]=j}getLayerInfo(R){return void 0===this._layerInfo[R]?null:this._layerInfo[R]}setLayerInfo(R,j){this._layerInfo[R]=j}clearLayerInfo(R){void 0!==this._layerInfo[R]&&delete this._layerInfo[R]}}return T.applicationCache=null,T})()},83947:(z,K,F)=>{F.d(K,{$e:()=>g,DT:()=>n,TE:()=>Q,XF:()=>P,av:()=>U,bB:()=>$,fz:()=>L,hq:()=>l,mA:()=>I,vR:()=>e,vn:()=>S,wF:()=>E,y5:()=>D,zR:()=>C});var d=F(91365),T=F(47982),p=F(77132),R=F(29535),j=F(80774),b=F(21837);function C(i,r){return c(i?.parseTree,r,i?.parameters)}function P(i,r,_){return c(i,r,_)}function $(i,r,_,o){return j.WhereClause.create(c(i.parseTree,p.Bj.Standardised,i.parameters,r,_),o,i.timeZone)}function g(i,r,_="AND"){return j.WhereClause.create("(("+C(i,p.Bj.Standardised)+")"+_+"("+C(r,p.Bj.Standardised)+"))",i.fieldsIndex,i.timeZone)}function c(i,r,_,o=null,y=null){let B,Z,m,v;switch(i.type){case"interval":return Q(c(i.value,r,_,o,y),i.qualifier,i.op);case"case-expression":{let f=" CASE ";"simple"===i.format&&(f+=c(i.operand,r,_,o,y));for(let A=0;A<i.clauses.length;A++)f+=" WHEN "+c(i.clauses[A].operand,r,_,o,y)+" THEN "+c(i.clauses[A].value,r,_,o,y);return null!==i.else&&(f+=" ELSE "+c(i.else,r,_,o,y)),f+=" END ",f}case"parameter":{const f=_[i.value.toLowerCase()];if("string"==typeof f)return"'"+_[i.value.toLowerCase()].toString().replaceAll("'","''")+"'";if((0,p.J_)(f)||(0,p.T4)(f))return S(f,r);if((0,p._U)(f))return E(f,r);if((0,p.NP)(f))return I(f,r);if((0,p.$A)(f))return U(f,r);if(f instanceof Array){const A=[];for(let N=0;N<f.length;N++)"string"==typeof f[N]?A.push("'"+f[N].toString().replaceAll("'","''")+"'"):(0,p.J_)(f[N])||(0,p.T4)(f[N])?A.push(S(f[N],r)):(0,p._U)(f[N])?A.push(E(f[N],r)):(0,p.NP)(f[N])?A.push(I(f[N],r)):(0,p.$A)(f[N])?A.push(U(f[N],r)):A.push(f[N].toString());return A}return f.toString()}case"expression-list":Z=[];for(const f of i.value)Z.push(c(f,r,_,o,y));return Z;case"unary-expression":return" ( NOT "+c(i.expr,r,_,o,y)+" ) ";case"binary-expression":switch(i.operator){case"AND":return" ("+c(i.left,r,_,o,y)+" AND "+c(i.right,r,_,o,y)+") ";case"OR":return" ("+c(i.left,r,_,o,y)+" OR "+c(i.right,r,_,o,y)+") ";case"IS":if("null"!==i.right.type)throw new T.eS(T.f.UnsupportedIsRhs);return" ("+c(i.left,r,_,o,y)+" IS NULL )";case"ISNOT":if("null"!==i.right.type)throw new T.eS(T.f.UnsupportedIsRhs);return" ("+c(i.left,r,_,o,y)+" IS NOT NULL )";case"IN":return B=[],"expression-list"===i.right.type?(B=c(i.right,r,_,o,y)," ("+c(i.left,r,_,o,y)+" IN ("+B.join(",")+")) "):(v=c(i.right,r,_,o,y),v instanceof Array?" ("+c(i.left,r,_,o,y)+" IN ("+v.join(",")+")) ":" ("+c(i.left,r,_,o,y)+" IN ("+v+")) ");case"NOT IN":return B=[],"expression-list"===i.right.type?(B=c(i.right,r,_,o,y)," ("+c(i.left,r,_,o,y)+" NOT IN ("+B.join(",")+")) "):(v=c(i.right,r,_,o,y),v instanceof Array?" ("+c(i.left,r,_,o,y)+" NOT IN ("+v.join(",")+")) ":" ("+c(i.left,r,_,o,y)+" NOT IN ("+v+")) ");case"BETWEEN":return m=c(i.right,r,_,o,y)," ("+c(i.left,r,_,o,y)+" BETWEEN "+m[0]+" AND "+m[1]+" ) ";case"NOTBETWEEN":return m=c(i.right,r,_,o,y)," ("+c(i.left,r,_,o,y)+" NOT BETWEEN "+m[0]+" AND "+m[1]+" ) ";case"LIKE":return""!==i.escape?" ("+c(i.left,r,_,o,y)+" LIKE "+c(i.right,r,_,o,y)+" ESCAPE '"+i.escape+"') ":" ("+c(i.left,r,_,o,y)+" LIKE "+c(i.right,r,_,o,y)+") ";case"NOT LIKE":return""!==i.escape?" ("+c(i.left,r,_,o,y)+" NOT LIKE "+c(i.right,r,_,o,y)+" ESCAPE '"+i.escape+"') ":" ("+c(i.left,r,_,o,y)+" NOT LIKE "+c(i.right,r,_,o,y)+") ";case"<>":case"<":case">":case">=":case"<=":case"=":case"*":case"-":case"+":case"/":return" ("+c(i.left,r,_,o,y)+" "+i.operator+" "+c(i.right,r,_,o,y)+") ";case"||":return" ("+c(i.left,r,_,o,y)+" "+(r===p.Bj.SqlServer?"+":i.operator)+" "+c(i.right,r,_,o,y)+") "}throw new T.eS(T.f.UnsupportedOperator,{operator:i.operator});case"null":return"null";case"boolean":return!0===i.value?"1":"0";case"string":return"'"+i.value.toString().replaceAll("'","''")+"'";case"timestamp":return`timestamp '${i.value}'`;case"date":return`date '${i.value}'`;case"time":return`time '${i.value}'`;case"number":return i.value.toString();case"current-time":return e("date"===i.mode,r);case"column-reference":return o?o.toLowerCase()===i.column.toLowerCase()?"("+y+")":!0===i.delimited?`"${i.column.split('"').join('""')}"`:i.column:i.column;case"data-type":return i.value;case"function":{const f=c(i.args,r,_,o,y);return L(i.name,f,r)}}throw new T.eS(T.f.UnsupportedSyntax,{node:i.type})}function L(i,r,_){switch(i.toLowerCase().trim()){case"cos":case"sin":case"tan":case"cosh":case"tanh":case"sinh":case"acos":case"asin":case"atan":case"floor":case"log10":case"log":case"abs":if(1!==r.length)throw new T.eS(T.f.InvalidFunctionParameters,{function:i.toLowerCase().trim()});return`${i.toUpperCase().trim()}(${r[0]})`;case"ceiling":case"ceil":if(1!==r.length)throw new T.eS(T.f.InvalidFunctionParameters,{function:"ceiling"});return"CEILING("+r[0]+")";case"mod":case"power":case"nullif":if(2!==r.length)throw new T.eS(T.f.InvalidFunctionParameters,{function:i.toLowerCase().trim()});return`${i.toUpperCase().trim()}(${r[0]},${r[1]})`;case"round":if(2===r.length)return"ROUND("+r[0]+","+r[1]+")";if(1===r.length)return"ROUND("+r[0]+")";throw new T.eS(T.f.InvalidFunctionParameters,{function:"round"});case"truncate":if(r.length<1||r.length>2)throw new T.eS(T.f.InvalidFunctionParameters,{function:"truncate"});return _===p.Bj.SqlServer?"ROUND("+r[0]+(1===r.length?"0":","+r[1])+",1)":"TRUNCATE("+r[0]+(1===r.length?")":","+r[1]+")");case"char_length":case"len":if(1!==r.length)throw new T.eS(T.f.InvalidFunctionParameters,{function:"char_length"});switch(_){case p.Bj.SqlServer:return"LEN("+r[0]+")";case p.Bj.Oracle:return"LENGTH("+r[0]+")";default:return"CHAR_LENGTH("+r[0]+")"}case"coalesce":case"concat":{if(r.length<1)throw new T.eS(T.f.InvalidFunctionParameters,{function:i.toLowerCase()});let o=i.toUpperCase().trim()+"(";for(let y=0;y<r.length;y++)0!==y&&(o+=","),o+=r[y];return o+=")",o}case"lower":case"lcase":if(1!==r.length)throw new T.eS(T.f.InvalidFunctionParameters,{function:"lower"});return"LOWER("+r[0]+")";case"upper":case"ucase":if(1!==r.length)throw new T.eS(T.f.InvalidFunctionParameters,{function:"upper"});return"UPPER("+r[0]+")";case"substring":{let o="";switch(_){case p.Bj.Oracle:return o="SUBSTR("+r[0]+","+r[1],3===r.length&&(o+=","+r[2]),o+=")",o;case p.Bj.SqlServer:return o=3===r.length?"SUBSTRING("+r[0]+","+r[1]+","+r[2]+")":"SUBSTRING("+r[0]+",  "+r[1]+", LEN("+r[0]+") - "+r[1]+")",o;default:return o="SUBSTRING("+r[0]+" FROM "+r[1],3===r.length&&(o+=" FOR "+r[2]),o+=")",o}}case"extract":return"EXTRACT("+r[0].replaceAll("'","")+" FROM "+r[1]+")";case"cast":{let o="";switch(_){case p.Bj.Oracle:switch(r[1].type){case"date":o="DATE";break;case"float":o="DOUBLE";break;case"integer":o="INTEGER";break;case"real":o="REAL";break;case"smallint":o="SMALLINT";break;case"timestamp":o="TIMESTAMP";break;case"varchar":o="VARCHAR("+r[1].size.toString()+")"}return`CAST(${r[0]} AS ${o})`;case p.Bj.Postgres:switch(r[1].type){case"date":o="DATE";break;case"float":o="DOUBLE PRECISION";break;case"integer":o="INT";break;case"real":o="REAL";break;case"smallint":o="SMALLINT";break;case"timestamp":o="TIMESTAMP";break;case"varchar":o="VARCHAR("+r[1].size.toString()+")"}return`CAST(${r[0]} AS ${o})`;case p.Bj.SqlServer:switch(r[1].type){case"date":o="DATE";break;case"float":o="FLOAT";break;case"integer":o="INT";break;case"real":o="REAL";break;case"smallint":o="SMALLINT";break;case"timestamp":o="DATETIME";break;case"varchar":o="VARCHAR("+r[1].size.toString()+")"}return`CAST(${r[0]} AS ${o})`;default:switch(r[1].type){case"date":o="DATE";break;case"float":o="FLOAT";break;case"integer":o="INTEGER";break;case"real":o="REAL";break;case"smallint":o="SMALLINT";break;case"timestamp":o="TIMESTAMP";break;case"varchar":o="VARCHAR("+r[1].size.toString()+")"}return`CAST(${r[0]} AS ${o})`}}}throw new T.eS(T.f.InvalidFunctionParameters,{function:i})}function I(i,r){const _=i.toDateTime(),o=0===_.hour&&0===_.minute&&0===_.second&&0===_.millisecond;switch(r){case p.Bj.FILEGDB:case p.Bj.Standardised:case p.Bj.StandardisedNoInterval:return o?`date '${_.toFormat("yyyy-LL-dd")}'`:`timestamp '${_.toFormat("yyyy-LL-dd HH:mm:ss")}'`;case p.Bj.Oracle:return o?`TO_DATE('${_.toFormat("yyyy-LL-dd")}','YYYY-MM-DD')`:`TO_DATE('${_.toFormat("yyyy-LL-dd HH:mm:ss")}','YYYY-MM-DD HH24:MI:SS')`;case p.Bj.SqlServer:return`'${_.toFormat(o?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;case p.Bj.PGDB:return`#${_.toFormat(o?"LL-dd-yyyy":"LL-dd-yyyy HH:mm:ss")}#`;case p.Bj.Postgres:return`TIMESTAMP '${_.toFormat(o?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;default:return`timestamp '${_.toFormat("yyyy-LL-dd HH:mm:ss")}'`}}function U(i,r){switch(r){case p.Bj.FILEGDB:case p.Bj.Standardised:case p.Bj.StandardisedNoInterval:return i.toSQLWithKeyword();case p.Bj.Oracle:return`TO_DATE('${i.toFormat("Y-MM-DD")}'`;case p.Bj.SqlServer:return`'${i.toFormat("Y-MM-DD")}'`;case p.Bj.PGDB:return`#${i.toFormat("Y-MM-DD")}#`;case p.Bj.Postgres:return`TIMESTAMP '${i.toFormat("Y-MM-DD")}'`;default:return i.toSQLWithKeyword()}}function E(i,r){switch(i instanceof R.n&&(i=i.toStorageString()),r){case p.Bj.Oracle:return`TO_DATE('${i}', 'HH24:MI:SS')`;case p.Bj.SqlServer:return`'${i}'`;default:return`time '${i}'`}}function S(i,r){return I(d.iG.dateTimeToArcadeDate((0,p.T4)(i)?i:b.ou.fromJSDate(i)),r)}function e(i,r){switch(r){case p.Bj.FILEGDB:case p.Bj.Standardised:case p.Bj.StandardisedNoInterval:case p.Bj.Oracle:return i?"CURRENT_DATE":"CURRENT_TIMESTAMP";case p.Bj.SqlServer:return i?"CAST(GETDATE() AS DATE)":"GETDATE()";default:return i?"CURRENT_DATE":"CURRENT_TIMESTAMP"}}function n(i,r,_={}){const o={},y={},B={esriFieldTypeSmallInteger:"integer",esriFieldTypeInteger:"integer",esriFieldTypeBigInteger:"integer",esriFieldTypeSingle:"double",esriFieldTypeDouble:"double",esriFieldTypeString:"string",esriFieldTypeTimeOnly:"time-only",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimestampOffset:"timestamp-offset",esriFieldTypeDate:"date",esriFieldTypeOID:"integer",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"guid",oid:"integer",long:"integer","small-integer":"integer",integer:"integer","big-integer":"integer",single:"double","time-only":"time-only","date-only":"date-only","timestamp-offset":"timestemp-offset",double:"double",date:"date",guid:"guid","global-id":"guid",string:"string"};for(const Z of r){const m=Z.type?B[Z.type]:void 0;o[Z.name.toLowerCase()]=void 0===m?"":m}for(const Z in _){const m=B[_[Z]];y[Z.toLowerCase()]=void 0===m?"":m}switch(a(o,i.parseTree,i.parameters,y)){case"double":return"double";case"integer":return"integer";case"date":return"date";case"date-only":return"date-only";case"time-only":return"time-only";case"timestamp-offset":return"timestamp-offset";case"string":return"string";case"global-id":case"guid":return"guid"}return""}function a(i,r,_,o){let y;switch(r.type){case"interval":return"integer";case"case-expression":{const B=[];if("simple"===r.format){for(let Z=0;Z<r.clauses.length;Z++)B.push(a(i,r.clauses[Z].value,_,o));null!==r.else&&B.push(a(i,r.else,_,o))}else{for(let Z=0;Z<r.clauses.length;Z++)B.push(a(i,r.else,_,o));null!==r.else&&B.push(a(i,r.else,_,o))}return u(B)}case"parameter":{const B=o[r.value.toLowerCase()];if(void 0===B&&_){const Z=_[r.value.toLowerCase()];if(null==Z)return"";if("string"==typeof Z||Z instanceof String)return"string";if("boolean"==typeof Z)return"boolean";if((0,p.J_)(Z)||(0,p.NP)(Z))return"date";if((0,p.$A)(Z))return"date-only";if((0,p._U)(Z))return"time-only";if("number"==typeof Z)return Z%1==0?"integer":"double"}return void 0===B?"":B}case"expression-list":{const B=[];for(const Z of r.value)B.push(a(i,Z,_,o));return B}case"unary-expression":return"boolean";case"binary-expression":switch(r.operator){case"AND":case"OR":case"IN":case"NOT IN":case"BETWEEN":case"NOTBETWEEN":case"LIKE":case"NOT LIKE":case"<>":case"<":case">":case">=":case"<=":case"=":return"boolean";case"IS":case"ISNOT":if("null"!==r.right.type)throw new T.eS(T.f.UnsupportedIsRhs);return"boolean";case"*":case"-":case"+":case"/":return u([a(i,r.left,_,o),a(i,r.right,_,o)]);case"||":return"string";default:throw new T.eS(T.f.UnsupportedOperator,{operator:r.operator})}case"null":return"";case"boolean":return"boolean";case"string":return"string";case"number":return null===r.value?"":r.value%1==0?"integer":"double";case"date":return"date";case"timestamp":return r.withtimezone?"timestamp-offset":"date";case"time":return"time-only";case"current-time":return"date";case"column-reference":{const B=i[r.column.toLowerCase()];return void 0===B?"":B}case"function":switch(r.name.toLowerCase()){case"cast":switch(r.args?.value[1]?.value.type??""){case"integer":case"smallint":return"integer";case"real":case"float":return"double";case"date":case"timestamp":return!0===r.args?.value[1]?.value?.withtimezone?"timestamp-offset":"date";case"time":return"time-only";case"varchar":return"string";default:return""}case"position":case"extract":case"char_length":case"mod":return"integer";case"round":if(y=a(i,r.args,_,o),y instanceof Array){if(y.length<=0)return"double";y=y[0]}return y;case"sign":return"integer";case"ceiling":case"floor":case"abs":return y=a(i,r.args,_,o),y instanceof Array&&(y=u(y)),"integer"===y||"double"===y?y:"double";case"area":case"length":case"log":case"log10":case"sin":case"cos":case"tan":case"asin":case"acos":case"atan":case"cosh":case"sinh":case"tanh":case"power":return"double";case"substring":case"trim":case"concat":case"lower":case"upper":return"string";case"truncate":return"double";case"nullif":case"coalesce":return y=a(i,r.args,_,o),y instanceof Array?y.length>0?y[0]:"":y}return""}throw new T.eS(T.f.UnsupportedSyntax,{node:r.type})}const t={boolean:1,string:2,integer:3,double:4,date:5};function u(i){if(i){let r="";for(const _ of i)""!==_&&(r=""===r||t[r]<t[_]?_:r);return r}return""}function l(i,r){return w(i.parseTree,r)}function D(i){return"column-reference"===i?.parseTree.type}function w(i,r){if(null==i)return!1;switch(i.type){case"when-clause":return w(i.operand,r)||w(i.value,r);case"case-expression":for(const _ of i.clauses)if(w(_,r))return!0;return!("simple"!==i.format||!w(i.operand,r))||!(null===i.else||!w(i.else,r));case"parameter":case"null":case"boolean":case"date":case"timestamp":case"time":case"string":case"number":return!1;case"expression-list":for(const _ of i.value)if(w(_,r))return!0;return!1;case"unary-expression":return w(i.expr,r);case"binary-expression":return w(i.left,r)||w(i.right,r);case"column-reference":return r.toLowerCase()===i.column.toLowerCase();case"function":return w(i.args,r)}return!1}function O(i){let r="";return r+=i.period.toUpperCase(),r}function Q(i,r,_){let o="";return o="interval-period"===r.type?O(r):O(r.start)+" TO "+O(r.end),"INTERVAL "+_+" "+i+" "+o}},45333:(z,K,F)=>{F.d(K,{CA:()=>l,EB:()=>B,Fp:()=>n,J6:()=>t,QX:()=>r,Sm:()=>Q,VV:()=>S,g3:()=>U,m:()=>w,tj:()=>E});var d=F(15861),T=F(47982),p=F(77132),R=F(83947),j=F(31910),b=F(67398),C=F(29535);function $(m){let v=0;for(let f=0;f<m.length;f++)v+=m[f];return v/m.length}function g(m){const v=$(m);let f=0;for(let A=0;A<m.length;A++)f+=(v-m[A])**2;return f/m.length}function c(m){const v=$(m);let f=0;for(let A=0;A<m.length;A++)f+=(v-m[A])**2;return f/(m.length-1)}function L(m){let v=0;for(let f=0;f<m.length;f++)v+=m[f];return v}function U(m){switch(m.toLowerCase()){case"distinct":return"distinct";case"avg":case"mean":return"avg";case"min":return"min";case"sum":return"sum";case"max":return"max";case"stdev":case"stddev":return"stddev";case"var":case"variance":return"var";case"count":return"count"}return""}function E(m,v,f=1e3){switch(m.toLowerCase()){case"distinct":return function I(m,v){const f=[],A={},N=[];for(let k=0;k<m.length;k++){if(null!=m[k]){const W=m[k];if((0,p.hj)(W)||(0,p.HD)(W))void 0===A[W]&&(f.push(W),A[W]=1);else{let J=!1;for(let G=0;G<N.length;G++)!0===(0,p.tt)(N[G],W)&&(J=!0);!1===J&&(N.push(W),f.push(W))}}if(f.length>=v&&-1!==v)return f}return f}(v,f);case"avg":case"mean":return $(v);case"min":return Math.min.apply(Math,v);case"sum":return L(v);case"max":return Math.max.apply(Math,v);case"stdev":case"stddev":return Math.sqrt(g(v));case"var":case"variance":return g(v);case"count":return v.length}return 0}function S(m,v,f){return e.apply(this,arguments)}function e(){return(e=(0,d.Z)(function*(m,v,f){const A=yield o(m,v,f,!0);return 0===A.length?null:Math.min.apply(Math,A)})).apply(this,arguments)}function n(m,v,f){return a.apply(this,arguments)}function a(){return(a=(0,d.Z)(function*(m,v,f){const A=yield o(m,v,f,!0);return 0===A.length?null:Math.max.apply(Math,A)})).apply(this,arguments)}function t(m,v,f){return u.apply(this,arguments)}function u(){return(u=(0,d.Z)(function*(m,v,f){let A="";v&&!(0,R.y5)(v)&&(A=(0,R.DT)(v,m.fields));const N=yield o(m,v,f,!0);if(0===N.length)return null;const k=$(N);return null===k?k:"integer"===A?function P(m){return m=+m,isFinite(m)?m-m%1||(m<0?-0:0===m?m:0):m}(k):k})).apply(this,arguments)}function l(m,v,f){return D.apply(this,arguments)}function D(){return(D=(0,d.Z)(function*(m,v,f){const A=yield o(m,v,f,!0);return 0===A.length?null:c(A)})).apply(this,arguments)}function w(m,v,f){return O.apply(this,arguments)}function O(){return(O=(0,d.Z)(function*(m,v,f){const A=yield o(m,v,f,!0);return 0===A.length?null:Math.sqrt(c(A))})).apply(this,arguments)}function Q(m,v,f){return i.apply(this,arguments)}function i(){return(i=(0,d.Z)(function*(m,v,f){const A=yield o(m,v,f,!0);return 0===A.length?null:L(A)})).apply(this,arguments)}function r(m,v){return _.apply(this,arguments)}function _(){return(_=(0,d.Z)(function*(m,v){return m.iterator(v).count()})).apply(this,arguments)}function o(m,v,f){return y.apply(this,arguments)}function y(){return(y=(0,d.Z)(function*(m,v,f,A=!1){const N=m.iterator(f),k=[],W={ticker:0};let J=yield N.next();for(;null!==J;){if(W.ticker++,f.aborted)throw new T.EN(T.H9.Cancelled);W.ticker%100==0&&(W.ticker=0,yield new Promise(H=>{setTimeout(H,0)}));const G=v?.calculateValue(J);null===G?!1===A&&(k[k.length]=G):k[k.length]=G instanceof j.u||G instanceof C.n?G.toNumber():G instanceof b.H?G.toMilliseconds():G,J=yield N.next()}return k})).apply(this,arguments)}function B(m,v){return Z.apply(this,arguments)}function Z(){return(Z=(0,d.Z)(function*(m,v,f=1e3,A=null){const N=m.iterator(A),k=[],W={},J={ticker:0};let G=yield N.next();for(;null!==G;){if(J.ticker++,A&&A.aborted)throw new T.EN(T.H9.Cancelled);J.ticker%100==0&&(J.ticker=0,yield new Promise(ee=>{setTimeout(ee,0)}));const H=v?.calculateValue(G);let Y=H;if(H instanceof j.u?Y="!!DATEONLY!!-"+H.toString():H instanceof b.H?Y="!!TSOFFSETONLY!!-"+H.toString():H instanceof C.n?Y="!!TIMEONLY!!-"+H.toString():H instanceof Date&&(Y="!!DATE!!-"+H.toString()),null!=H&&void 0===W[Y]&&(k.push(H),W[Y]=1),k.length>=f&&-1!==f)return k;G=yield N.next()}return k})).apply(this,arguments)}},87215:(z,K,F)=>{F.r(K),F.d(K,{buffer:()=>me,changeDefaultSpatialReferenceTolerance:()=>Oe,clearDefaultSpatialReferenceTolerance:()=>Ze,clip:()=>n,contains:()=>l,convexHull:()=>v,crosses:()=>D,cut:()=>t,densify:()=>we,difference:()=>A,disjoint:()=>_,distance:()=>w,equals:()=>O,extendedSpatialReferenceInfo:()=>e,flipHorizontal:()=>ve,flipVertical:()=>Fe,generalize:()=>De,geodesicArea:()=>Pe,geodesicBuffer:()=>ye,geodesicDensify:()=>xe,geodesicLength:()=>Re,intersect:()=>J,intersectLinesToPoints:()=>Ce,intersects:()=>Q,isSimple:()=>B,nearestCoordinate:()=>Se,nearestVertex:()=>Te,nearestVertices:()=>Ie,offset:()=>ee,overlaps:()=>o,planarArea:()=>be,planarLength:()=>Ae,relate:()=>y,rotate:()=>Ee,simplify:()=>Z,symmetricDifference:()=>k,touches:()=>i,union:()=>H,within:()=>r});var d=F(15861),p=(F(29132),F(97347)),R=F(72642),j=F(91179);function b(s){return Array.isArray(s)?s[0]?.spatialReference:s?.spatialReference}function C(s){return s&&(Array.isArray(s)?s.map(C):s.toJSON?s.toJSON():s)}function P(s){return Array.isArray(s)?s.map(h=>(0,j.im)(h)):(0,j.im)(s)}let g;function c(){return L.apply(this,arguments)}function L(){return(L=(0,d.Z)(function*(){return g||(g=(0,p.bA)("geometryEngineWorker",{strategy:"distributed"})),g})).apply(this,arguments)}function I(s,h){return U.apply(this,arguments)}function U(){return(U=(0,d.Z)(function*(s,h){return(yield c()).invoke("executeGEOperation",{operation:s,parameters:C(h)})})).apply(this,arguments)}function E(s,h){return S.apply(this,arguments)}function S(){return(S=(0,d.Z)(function*(s,h){const x=yield c();return Promise.all(x.broadcast("executeGEOperation",{operation:s,parameters:C(h)}))})).apply(this,arguments)}function e(s){return I("extendedSpatialReferenceInfo",[s])}function n(s,h){return a.apply(this,arguments)}function a(){return(a=(0,d.Z)(function*(s,h){return P(yield I("clip",[b(s),s,h]))})).apply(this,arguments)}function t(s,h){return u.apply(this,arguments)}function u(){return(u=(0,d.Z)(function*(s,h){return P(yield I("cut",[b(s),s,h]))})).apply(this,arguments)}function l(s,h){return I("contains",[b(s),s,h])}function D(s,h){return I("crosses",[b(s),s,h])}function w(s,h,x){return I("distance",[b(s),s,h,x])}function O(s,h){return I("equals",[b(s),s,h])}function Q(s,h){return I("intersects",[b(s),s,h])}function i(s,h){return I("touches",[b(s),s,h])}function r(s,h){return I("within",[b(s),s,h])}function _(s,h){return I("disjoint",[b(s),s,h])}function o(s,h){return I("overlaps",[b(s),s,h])}function y(s,h,x){return I("relate",[b(s),s,h,x])}function B(s){return I("isSimple",[b(s),s])}function Z(s){return m.apply(this,arguments)}function m(){return(m=(0,d.Z)(function*(s){return P(yield I("simplify",[b(s),s]))})).apply(this,arguments)}function v(s){return f.apply(this,arguments)}function f(){return(f=(0,d.Z)(function*(s,h=!1){return P(yield I("convexHull",[b(s),s,h]))})).apply(this,arguments)}function A(s,h){return N.apply(this,arguments)}function N(){return(N=(0,d.Z)(function*(s,h){return P(yield I("difference",[b(s),s,h]))})).apply(this,arguments)}function k(s,h){return W.apply(this,arguments)}function W(){return(W=(0,d.Z)(function*(s,h){return P(yield I("symmetricDifference",[b(s),s,h]))})).apply(this,arguments)}function J(s,h){return G.apply(this,arguments)}function G(){return(G=(0,d.Z)(function*(s,h){return P(yield I("intersect",[b(s),s,h]))})).apply(this,arguments)}function H(s){return Y.apply(this,arguments)}function Y(){return(Y=(0,d.Z)(function*(s,h=null){const x=function $(s,h){let x;return Array.isArray(s)?x=s:(x=[],x.push(s),null!=h&&x.push(h)),x}(s,h);return P(yield I("union",[b(x),x]))})).apply(this,arguments)}function ee(s,h,x,M,V,q){return te.apply(this,arguments)}function te(){return(te=(0,d.Z)(function*(s,h,x,M,V,q){return P(yield I("offset",[b(s),s,h,x,M,V,q]))})).apply(this,arguments)}function me(s,h,x){return ne.apply(this,arguments)}function ne(){return(ne=(0,d.Z)(function*(s,h,x,M=!1){const V=[b(s),s,h,x,M];return P(yield I("buffer",V))})).apply(this,arguments)}function ye(s,h,x,M,V,q){return re.apply(this,arguments)}function re(){return(re=(0,d.Z)(function*(s,h,x,M,V,q){const Le=[b(s),s,h,x,M,V,q];return P(yield I("geodesicBuffer",Le))})).apply(this,arguments)}function Se(s,h){return ae.apply(this,arguments)}function ae(){return(ae=(0,d.Z)(function*(s,h,x=!0){const M=yield I("nearestCoordinate",[b(s),s,h,x]);return{...M,coordinate:R.Z.fromJSON(M.coordinate)}})).apply(this,arguments)}function Te(s,h){return se.apply(this,arguments)}function se(){return(se=(0,d.Z)(function*(s,h){const x=yield I("nearestVertex",[b(s),s,h]);return{...x,coordinate:R.Z.fromJSON(x.coordinate)}})).apply(this,arguments)}function Ie(s,h,x,M){return ie.apply(this,arguments)}function ie(){return(ie=(0,d.Z)(function*(s,h,x,M){return(yield I("nearestVertices",[b(s),s,h,x,M])).map(V=>({...V,coordinate:R.Z.fromJSON(V.coordinate)}))})).apply(this,arguments)}function ue(s){return"xmin"in s?s.center:"x"in s?s:s.extent?.center}function Ee(s,h,x){return oe.apply(this,arguments)}function oe(){return(oe=(0,d.Z)(function*(s,h,x){if(null==s)throw new X;const M=s.spatialReference;if(null==(x=x??ue(s)))throw new X;const V=s.constructor.fromJSON(yield I("rotate",[M,s,h,x]));return V.spatialReference=M,V})).apply(this,arguments)}function ve(s,h){return le.apply(this,arguments)}function le(){return(le=(0,d.Z)(function*(s,h){if(null==s)throw new X;const x=s.spatialReference;if(null==(h=h??ue(s)))throw new X;const M=s.constructor.fromJSON(yield I("flipHorizontal",[x,s,h]));return M.spatialReference=x,M})).apply(this,arguments)}function Fe(s,h){return ce.apply(this,arguments)}function ce(){return(ce=(0,d.Z)(function*(s,h){if(null==s)throw new X;const x=s.spatialReference;if(null==(h=h??ue(s)))throw new X;const M=s.constructor.fromJSON(yield I("flipVertical",[x,s,h]));return M.spatialReference=x,M})).apply(this,arguments)}function De(s,h,x,M){return he.apply(this,arguments)}function he(){return(he=(0,d.Z)(function*(s,h,x,M){return P(yield I("generalize",[b(s),s,h,x,M]))})).apply(this,arguments)}function we(s,h,x){return _e.apply(this,arguments)}function _e(){return(_e=(0,d.Z)(function*(s,h,x){return P(yield I("densify",[b(s),s,h,x]))})).apply(this,arguments)}function xe(s,h,x){return de.apply(this,arguments)}function de(){return(de=(0,d.Z)(function*(s,h,x,M=0){return P(yield I("geodesicDensify",[b(s),s,h,x,M]))})).apply(this,arguments)}function be(s,h){return I("planarArea",[b(s),s,h])}function Ae(s,h){return I("planarLength",[b(s),s,h])}function Pe(s,h,x){return I("geodesicArea",[b(s),s,h,x])}function Re(s,h,x){return I("geodesicLength",[b(s),s,h,x])}function Ce(s,h){return pe.apply(this,arguments)}function pe(){return(pe=(0,d.Z)(function*(s,h){return P(yield I("intersectLinesToPoints",[b(s),s,h]))})).apply(this,arguments)}function Oe(s,h){return fe.apply(this,arguments)}function fe(){return(fe=(0,d.Z)(function*(s,h){yield E("changeDefaultSpatialReferenceTolerance",[s,h])})).apply(this,arguments)}function Ze(s){return ge.apply(this,arguments)}function ge(){return(ge=(0,d.Z)(function*(s){yield E("clearDefaultSpatialReferenceTolerance",[s])})).apply(this,arguments)}class X extends Error{constructor(){super("Illegal Argument Exception")}}}}]);