"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[6673],{8549:(ge,$,g)=>{g.d($,{C:()=>x,b:()=>Z});var M=g(10109),Y=g(33726),j=g(2166),C=g(95285),B=g(69960),K=g(17625),Q=g(22355),k=g(44835),V=g(16396);function Z(I){const y=new Q.kG,{vertex:D,fragment:A}=y;return(0,j.Sv)(D,I),y.attributes.add(V.T.POSITION,"vec3"),y.attributes.add(V.T.UV0,"vec2"),y.varyings.add("vUV","vec2"),I.multipassEnabled&&y.varyings.add("depth","float"),D.code.add(K.H`
    void main(void) {
      vUV = uv0;
      ${I.multipassEnabled?"depth = (view * vec4(position, 1.0)).z;":""}
      gl_Position = proj * view * vec4(position, 1.0);
    }
  `),y.include(M.l,I),A.uniforms.add(new C.A("size",E=>E.size)),A.uniforms.add(new B.N("color1",E=>E.color1)),A.uniforms.add(new B.N("color2",E=>E.color2)),A.include(Y.Y),A.code.add(K.H`
    void main() {
      ${I.multipassEnabled?"terrainDepthTest(depth);":""}
      vec2 uvScaled = vUV / (2.0 * size);

      vec2 uv = fract(uvScaled - 0.25);
      vec2 ab = clamp((abs(uv - 0.5) - 0.25) / fwidth(uvScaled), -0.5, 0.5);
      float fade = smoothstep(0.25, 0.5, max(fwidth(uvScaled.x), fwidth(uvScaled.y)));
      float t = mix(abs(ab.x + ab.y), 0.5, fade);

      fragColor = mix(color2, color1, t);
      ${I.transparencyPassType===k.A.Color?"fragColor = premultiplyAlpha(fragColor);":""}
    }
  `),y}const x=Object.freeze(Object.defineProperty({__proto__:null,build:Z},Symbol.toStringTag,{value:"Module"}))},1437:(ge,$,g)=>{g.d($,{p:()=>V});var M=g(17626),Y=g(54024),j=g(60330),C=g(77712),k=(g(8314),g(63290),g(4619),g(76898));const V=Z=>{let x=class extends((0,j.v)(Z)){constructor(){super(...arguments),this.parent=null,this._userInteractive=!1,this._interactiveViewModelCount=0}get interactive(){return this._interactiveViewModelCount>0||this._userInteractive}set interactive(I){this._userInteractive=I}get updating(){return!1}get visible(){return null==this.parent||this.parent.visible&&!this.parent.suspended}set visible(I){this._overrideIfSome("visible",I)}forceInteractiveForViewModel(){return this._interactiveViewModelCount++,(0,Y.kB)(()=>this._interactiveViewModelCount--)}};return(0,M._)([(0,C.Cb)({constructOnly:!0})],x.prototype,"parent",void 0),(0,M._)([(0,C.Cb)({constructOnly:!0})],x.prototype,"view",void 0),(0,M._)([(0,C.Cb)({type:Boolean})],x.prototype,"interactive",null),(0,M._)([(0,C.Cb)()],x.prototype,"_userInteractive",void 0),(0,M._)([(0,C.Cb)({readOnly:!0})],x.prototype,"updating",null),(0,M._)([(0,C.Cb)()],x.prototype,"visible",null),(0,M._)([(0,C.Cb)()],x.prototype,"_interactiveViewModelCount",void 0),x=(0,M._)([(0,k.j)("esri.views.3d.analysis.AnalysisView3D")],x),x}},86673:(ge,$,g)=>{g.r($),g.d($,{default:()=>qt});var M=g(17626),Y=g(83761),j=g(62208),C=g(77712),K=(g(8314),g(63290)),k=(g(4619),g(76898)),V=g(39691),Z=g(1437),x=g(74554),I=g(32917),y=g(55915),D=g(81863),A=g(21286),E=g(15572),W=g(95470),G=g(15331),S=g(79800),b=g(29302),te=g(1503),oe=g(92383),Me=g(65234),Le=g(1582);function Be(h,r,d,_,v){(0,S.c)(Ee,h),(0,S.g)(De,h,r),(0,Le.S)(Ee,d,Ee,v),(0,Le.S)(De,d,De,v),(0,S.f)(_,De,Ee),(0,S.n)(_,_)}const Ee=(0,b.Ue)(),De=(0,b.Ue)();var fe=g(43668),be=g(90935),it=g(78172),Ke=g(28844),Fe=g(11519),He=g(97126),rt=g(11544),nt=g(44766),ot=g(37118),we=g(16319),Se=g(10049),me=g(98943);function ut(h,r,d){const _=new Se._q;return(0,Se.cA)(_,[h[0],h[1]],[r[0],r[1]],d??Me.Z.WGS84),_.distance}function mt(h,r,d,_){const v=gt;return(0,we.k)(h,_,ae)&&(0,we.k)(r,_,le)&&(0,we.k)(d,_,Te)?(v.setPoint(0,0,ae),v.setPoint(0,1,le),v.setPoint(0,2,Te),Math.abs((0,nt.geodesicArea)(v,"square-meters"))):0}const ae=(0,b.Ue)(),le=(0,b.Ue)(),Te=(0,b.Ue)(),gt=new ot.Z({rings:[[ae,le,Te]],spatialReference:Me.Z.WGS84}),se=(0,b.Ue)();var _t=g(53929),ye=g(16730),vt=g(11915);function je(h){return(0,vt.e)(function Ct(h){const r=new Float64Array(2*h.length);for(let d=0;d<h.length;++d){const _=h[d],v=2*d;r[v]=_[0],r[v+1]=_[1]}return r}(h),[],2)}g(90014),g(66601),(0,b.Ue)(),(0,b.Ue)();class Pt{get numVertices(){return this._length}get hasStagedVertex(){return this._hasCursorPoint}constructor(r,d){this.validMeasurement=!1,this.positionsWorldCoords=[],this.positionsRenderCoords=[],this.positionsProjectedWorldCoords=[],this.positionsFittedRenderCoords=[],this.positionsGeographic=[],this.positionsSpherical=[],this.positionsStereographic=[],this.pathSegmentLengths=[],this.geodesicPathSegmentLengths=[],this.perimeterSegmentLengths=[],this.intersectingSegments=new Set,this.geodesicIntersectingSegments=new Set,this.triangleIndices=null,this.geodesicTriangleIndices=null,this.areaCentroidWorldCoords=(0,b.Ue)(),this.areaCentroidRenderCoords=(0,b.Ue)(),this.geodesicAreaCentroidRenderCoords=(0,b.Ue)(),this.area=null,this.geodesicArea=null,this.pathLength=null,this.geodesicPathLength=null,this.perimeterLength=null,this._length=0,this._centroidRenderCoords=(0,b.Ue)(),this._planeWorldCoords=(0,te.Ue)(),this._worldUp=(0,b.Ue)(),this._worldTangent=(0,b.Ue)(),this._frame=[(0,b.Ue)(),(0,b.Ue)(),(0,b.Ue)()],this._pathVersion=-1,this._hasCursorPoint=!1,this._mode=null,this._tempU=(0,b.Ue)(),this._tempV=(0,b.Ue)(),this._tempVec3=(0,b.Ue)(),this._tempSphere=(0,He.c)(),this._sceneView=r,this.unitNormalizer=d}update(r,d,_,v,P,L){const O=null!=d;return!(this._pathVersion===r.version&&!L&&this._hasCursorPoint===O&&this._mode===P&&r.isValidPolygon||(this._pathVersion=r.version,this._hasCursorPoint=O,this._updateCursorSegmentLength(r,d),this._update(r,d,_,v,P),0))}_update(r,d,_,v,P){const L=this.unitNormalizer,O=this._sceneView.renderSpatialReference,R=this.unitNormalizer.spatialReference;let U=r.numVertices;const w=!(null==d||d.equals(r.lastPoint)||U>2&&d.equals(r.firstPoint));w&&(U+=1);const F=r.polygonIsClosed||!r.polygonIsClosed&&U>2;this._resize(U);const H=(0,D.rS)(_.spatialReference),X=(0,y.canProjectWithoutEngine)(_.spatialReference,H)&&(0,y.canProjectToWGS84ComparableLonLat)(_.spatialReference),{positionsGeographic:T,positionsWorldCoords:ue,positionsRenderCoords:ne,positionsSpherical:ve}=this,Pe=(J,ee)=>{(function Mt(h,r){r.hasZ||(r.z=(0,_t.KO)(h,r,"ground")??0)})(_.elevationProvider,J),(0,fe.K)(J,ue[ee],R),(0,fe.K)(J,ne[ee],O),X&&((0,be.U)(J,T[ee]),(0,fe.K)(J,ve[ee],H),(0,S.n)(ve[ee],ve[ee]))};r.forEachVertexPosition((J,ee)=>Pe(J,ee)),w&&Pe(d,U-1);const re=this._updatePathLengths(F);if(this.pathLength=this._length>1?(0,E.yG)(L.normalizeDistance(re),"meters"):null,X){const J=this._updateGeodesicPathLengths(F,R);this.geodesicPathLength=this._length>1?(0,E.yG)(J,"meters"):null}else this.geodesicPathLength=null;if(this._updateMode(P),!F)return this.area=null,this.geodesicArea=null,this.perimeterLength=null,this.triangleIndices=null,this.geodesicTriangleIndices=null,this.intersectingSegments.clear(),this.geodesicIntersectingSegments.clear(),void(this.validMeasurement=!1);this._updateAreaAndPerimeterLength(_,L,O,R,v),X&&this._updateGeodesicArea(_),this.validMeasurement=!0}getData(){return{validMeasurement:this.validMeasurement,numVertices:this.numVertices,hasStagedVertex:this.hasStagedVertex,positionsWorldCoords:this.positionsWorldCoords,positionsRenderCoords:this.positionsRenderCoords,positionsProjectedWorldCoords:this.positionsProjectedWorldCoords,positionsFittedRenderCoords:this.positionsFittedRenderCoords,positionsGeographic:this.positionsGeographic,positionsSpherical:this.positionsSpherical,positionsStereographic:this.positionsStereographic,pathSegmentLengths:this.pathSegmentLengths,geodesicPathSegmentLengths:this.geodesicPathSegmentLengths,perimeterSegmentLengths:this.perimeterSegmentLengths,intersectingSegments:this.intersectingSegments,geodesicIntersectingSegments:this.geodesicIntersectingSegments,triangleIndices:this.triangleIndices,geodesicTriangleIndices:this.geodesicTriangleIndices,areaCentroidWorldCoords:this.areaCentroidWorldCoords,areaCentroidRenderCoords:this.areaCentroidRenderCoords,geodesicAreaCentroidRenderCoords:this.geodesicAreaCentroidRenderCoords,fittingMode:this.fittingMode,area:this.area,geodesicArea:this.geodesicArea,pathLength:this.pathLength,geodesicPathLength:this.geodesicPathLength,perimeterLength:this.perimeterLength,unitNormalizer:this.unitNormalizer,actualMeasurementMode:this.actualMeasurementMode}}_resize(r){for(r<this._length&&(this.positionsWorldCoords.length=r,this.positionsRenderCoords.length=r,this.positionsProjectedWorldCoords.length=r,this.positionsFittedRenderCoords.length=r,this.positionsGeographic.length=r,this.positionsSpherical.length=r,this.positionsStereographic.length=r,this.pathSegmentLengths.length=r,this.geodesicPathSegmentLengths.length=r,this.perimeterSegmentLengths.length=r,this._length=r);this._length<r;)this.positionsWorldCoords.push((0,b.Ue)()),this.positionsRenderCoords.push((0,b.Ue)()),this.positionsProjectedWorldCoords.push((0,G.Ue)()),this.positionsFittedRenderCoords.push((0,b.Ue)()),this.positionsGeographic.push((0,b.Ue)()),this.positionsSpherical.push((0,b.Ue)()),this.positionsStereographic.push((0,G.Ue)()),this.pathSegmentLengths.push(0),this.geodesicPathSegmentLengths.push(0),this.perimeterSegmentLengths.push(0),++this._length}_updatePathLengths(r){const d=this.positionsWorldCoords,_=this.pathSegmentLengths;let v=0;for(let P=0;P<this._length;++P){const L=_[P]=(0,S.q)(d[P],d[(P+1)%this._length]);(P<this._length-1||r)&&(v+=L)}return v}_updateGeodesicPathLengths(r,d){const _=this.positionsGeographic,v=this.geodesicPathSegmentLengths;let P=0;for(let L=0;L<this._length;++L){const O=v[L]=ut(_[L],_[(L+1)%this._length],d??void 0);(L<this._length-1||r)&&(P+=O)}return P}_updateAreaAndPerimeterLength(r,d,_,v,P){const L=r.renderCoordsHelper,O=this.positionsWorldCoords,R=this.positionsRenderCoords,U=this.positionsProjectedWorldCoords,w=this.positionsFittedRenderCoords,z=this._planeWorldCoords,F=this._centroidRenderCoords;(0,me.$U)(R,F),L.worldUpAtPosition(F,this._worldUp),L.worldBasisAtPosition(F,it.R.X,this._worldTangent),Be(F,this._worldUp,_,this._worldUp,v),Be(F,this._worldTangent,_,this._worldTangent,v),O.length>2&&function lt(h,r){if(h.length<3)throw new Error("need at least 3 points to fit a plane");(0,me.pG)(h[0],h[1],h[2],r)}(O,z),this.fittingMode=this._selectFittingMode(z,O,this._worldUp,P);let H=0;if("horizontal"===this.fittingMode){let re=-1/0;R.forEach((J,ee)=>{const st=L.getAltitude(R[ee]);st>re&&(re=st,H=ee)})}const X=O[H];let T=z,ue=this._worldTangent;"horizontal"===this.fittingMode?T=this._worldUp:"vertical"===this.fittingMode&&(T=this._tempVec3,ue=this._worldUp,(0,me.T)(z,this._worldUp,T)),(0,S.c)(this._frame[2],T),(0,me.T)(ue,T,this._frame[0]),(0,S.b)(this._frame[1],this._frame[0],this._frame[2]),(0,S.F)(this._frame[1],this._frame[1]);const ne=this._tempVec3,ve=this._tempU,Pe=this._tempV;for(let re=0;re<this._length;++re){const J=U[re],ee=w[re];(0,S.f)(ne,O[re],X),(0,W.t8)(J,(0,S.k)(this._frame[0],ne),(0,S.k)(this._frame[1],ne)),(0,S.h)(ve,this._frame[0],J[0]),(0,S.h)(Pe,this._frame[1],J[1]),(0,S.g)(ne,ve,Pe),(0,S.g)(ne,ne,X),(0,Le.S)(ne,v,ee,_)}this.perimeterLength=this._length>0?(0,E.yG)(d.normalizeDistance(this._updatePerimeterLengths()),"meters"):null,(0,me.$U)(w,this.areaCentroidRenderCoords),(0,Le.S)(this.areaCentroidRenderCoords,_,this.areaCentroidWorldCoords,v),this._updateIntersectingSegments(),this.area=0===this.intersectingSegments.size?(0,E.ne)(d.normalizeArea(this._computeArea()),"square-meters"):null}_updateGeodesicArea(r){const{renderCoordsHelper:d,spatialReference:_}=r,{positionsSpherical:v,positionsStereographic:P}=this,L=this._tempVec3,O=function pt(h,r=null,d=!0){const v=(P,L)=>{if(0===L[0]&&0===L[1]&&0===L[2])return!1;for(let O=0;O<P.length;++O)if((0,S.k)(L,P[O])<-1e-6)return!1;return!0};if(0===h.length)return!1;if(1===h.length)return r&&(0,S.c)(r,h[0]),!0;(0,S.s)(se,0,0,0);for(let P=0;P<h.length;++P)(0,S.g)(se,se,h[P]);if((0,S.n)(se,se),v(h,se))return r&&(0,S.c)(r,se),!0;if(!d)return!1;for(let P=0;P<h.length;++P)for(let L=0;L<h.length;++L)if(P!==L&&((0,S.b)(se,h[P],h[L]),(0,S.n)(se,se),v(h,se)))return r&&(0,S.c)(r,se),!0;return!1}(v,L);if(!O)return void(this.geodesicArea=null);const R=this._tempU,U=this._tempV;(0,me._F)(L,R,U);for(let w=0;w<this._length;++w){const z=(0,S.k)(v[w],R),F=(0,S.k)(v[w],U),H=(0,S.k)(v[w],L);(0,W.t8)(P[w],z/H,F/H)}(0,S.h)(L,L,(0,oe.Iu)(_).radius),d.toRenderCoords(L,(0,D.rS)(_),this.geodesicAreaCentroidRenderCoords),this._updateGeodesicIntersectingSegments(),this.geodesicArea=O&&0===this.geodesicIntersectingSegments.size?(0,E.ne)(this._computeGeodesicArea(),"square-meters"):null}_updatePerimeterLengths(){const r=this.positionsProjectedWorldCoords,d=this.perimeterSegmentLengths;let _=0;for(let v=0;v<this._length;++v)_+=d[v]=(0,W.TE)(r[v],r[(v+1)%this._length]);return _}_updateIntersectingSegments(){const r=this.positionsProjectedWorldCoords,d=this.intersectingSegments;d.clear();for(let _=0;_<this._length;++_)for(let v=_+2;v<this._length;++v)(v+1)%this._length!==_&&(0,Fe.UT)(r[_],r[(_+1)%this._length],r[v],r[(v+1)%this._length])&&(d.add(_),d.add(v))}_computeArea(){const r=this.positionsProjectedWorldCoords,d=this.triangleIndices=(0,Ke.mi)(je(r));let _=0;for(let v=0;v<d.length;v+=3)_+=(0,rt.wu)(r[d[v]],r[d[v+1]],r[d[v+2]]);return _}_updateGeodesicIntersectingSegments(){const r=this.positionsStereographic,d=this.geodesicIntersectingSegments;d.clear();for(let _=0;_<this._length;++_)for(let v=_+2;v<this._length;++v)(v+1)%this._length!==_&&(0,Fe.UT)(r[_],r[(_+1)%this._length],r[v],r[(v+1)%this._length])&&(d.add(_),d.add(v))}_computeGeodesicArea(){const r=this.positionsGeographic,_=this.geodesicTriangleIndices=(0,Ke.mi)(je(this.positionsStereographic));let v=0;for(let P=0;P<_.length;P+=3)v+=mt(r[_[P]],r[_[P+1]],r[_[P+2]],Me.Z.WGS84);return v}_selectFittingMode(r,d,_,v){const P=d.map(w=>Math.abs(function ht(h,r){return(0,S.k)(h,r)+h[3]}(r,w))).reduce((w,z)=>Math.max(w,z),0);!function at(h,r){const d=(0,He.g)(r);(0,S.s)(d,0,0,0);for(let v=0;v<h.length;++v)(0,S.g)(d,d,h[v]);(0,S.h)(d,d,1/h.length);let _=0;for(let v=0;v<h.length;++v)_=Math.max(_,(0,S.a)(d,h[v]));r[3]=Math.sqrt(_)}(d,this._tempSphere);const L=P/(2*this._tempSphere[3]);let U="horizontal";return L<v.maxRelativeErrorCoplanar?U="oblique":L<v.maxRelativeErrorAlmostCoplanar&&(U=Math.abs((0,S.k)(_,r))>Math.cos((0,A.Vl)(v.verticalAngleThreshold))?"horizontal":"vertical"),U}_updateCursorSegmentLength(r,d){const _=r.lastPoint;r.isValidPolygon||null==_||null==d?(this.geodesicStagedSegmentLength=null,this.stagedSegmentLength=null):(this.geodesicStagedSegmentLength=(0,E.yG)(function ct(h,r){if(!(0,be.U)(h,ae)||!(0,be.U)(r,le))return 0;const d=new Se._q;return(0,Se.cA)(d,[ae[0],ae[1]],[le[0],le[1]],Me.Z.WGS84),d.distance}(_,d),"meters"),this.stagedSegmentLength=(0,E.yG)(this.unitNormalizer.normalizeDistance(function dt(h,r,d){return(0,fe.K)(h,ae,d)&&(0,fe.K)(r,le,d)?(0,S.q)(ae,le):0}(_,d,this.unitNormalizer.spatialReference)),"meters"))}_updateMode(r){if(r===x.e.Auto){this.actualMeasurementMode="euclidean";let d=0;null!=this.geodesicPathLength&&(d+=this.geodesicPathLength.value),d>Lt&&(this.actualMeasurementMode="geodesic")}else this.actualMeasurementMode=r===x.e.Euclidean?"euclidean":"geodesic";null==this.geodesicPathLength&&(this.actualMeasurementMode="euclidean"),this._mode=r}}const Lt=1e5;var Et=g(68);let _e=class extends Y.Z{constructor(h){super(h)}initialize(){const h=this.view.spatialReference,r=(0,D.rS)(h),d=r===D.GG?D.wY:r,_=!h||(0,y.canProjectWithoutEngine)(h,d)?d:h,v=new Et.D(_);this._measurementDataManager=new Pt(this.view,v),this.addHandles([this.analysisViewData.path.on("change",()=>this._update()),(0,I.YP)(()=>this.analysisViewData.stagedPoint,()=>this._update(),I.Z_),(0,I.YP)(()=>this.analysisViewData.mode,()=>this._update(),I.Z_)]),this._update()}_update(h=!1){const{analysisViewData:r,view:d}=this;this._measurementDataManager.update(r.path,r.stagedPoint,d,{maxRelativeErrorCoplanar:.005,maxRelativeErrorAlmostCoplanar:.01,verticalAngleThreshold:80},r.mode,h)&&(r.measurementData=this._measurementDataManager.getData())}};(0,M._)([(0,C.Cb)({constructOnly:!0})],_e.prototype,"view",void 0),(0,M._)([(0,C.Cb)({constructOnly:!0})],_e.prototype,"analysis",void 0),(0,M._)([(0,C.Cb)({constructOnly:!0})],_e.prototype,"analysisViewData",void 0),_e=(0,M._)([(0,k.j)("esri.views.3d.analysis.AreaMeasurement.support.AreaMeasurementController")],_e);var Dt=g(61885),St=g(72642),xe=g(65401),At=g(54865),Ot=g(50017),Ye=g(466),$e=g(97737);let ie=class extends Dt.Z.EventedAccessor{constructor(h={}){super(h),this._version=0,this._internalGeometryChange=!1,this._extent=(0,xe.cS)()}set areaMeasurement(h){this._set("areaMeasurement",h),null!=h&&null!=this.view&&this._initialize(h,this.view)}set view(h){this._set("view",h),null!=h&&null!=this.areaMeasurement&&this._initialize(this.areaMeasurement,h)}get constructed(){return null!=this.areaMeasurement&&null!=this.view}get version(){return this._version}get isEmptyPolygon(){return!this.constructed||0===this._editGeometry.components.length}get isValidPolygon(){return this.constructed&&this.polygonIsClosed}get extent(){if(this.constructed&&this._editGeometry.components.length>0&&this._editGeometry.components[0].vertices.length>0){const h=(0,xe.cS)(this._extent);return this.forEachVertex(r=>{(0,xe.Ho)(h,r.pos)}),h}return null}get spatialReference(){return this.constructed?this._editGeometry.coordinateHelper.spatialReference:null}_initialize(h,r){this.removeAllHandles(),this.addHandles((0,I.YP)(()=>h.geometry,()=>{this._updateEditGeometryFromModelGeometry(h,r)},I.tX)),this._makeDirty(!0)}_makeDirty(h=!1){this.notifyChange("polygonIsClosed"),this.notifyChange("isValidPolygon"),this.notifyChange("initialized"),this.notifyChange("extent"),h&&this.notifyChange("numVertices")}_updateEditGeometryFromModelGeometry(h,r){if(this._version++,this._internalGeometryChange)return;this.removeHandles("EditGeometry");let d=h.geometry;if(null!=d){const _=(0,y.tryProjectWithZConversion)(d,r.spatialReference);null==_&&(0,At.e)(h,d.spatialReference,K.Z.getLogger(this)),d=_}this._editGeometryOperations=null!=d?$e.c.fromGeometry(d,r.state.viewingMode):new $e.c(new Ye.XE("polygon",(0,Ot.Y6)(!0,!1,r.spatialReference))),this._makeDirty(!0),this.emit("change"),this.addHandles(this._editGeometry.on("change",_=>{this._makeDirty(null!=_.addedVertices||null!=_.removedVertices),this._internalGeometryChange=!0,h.geometry=this.numVertices>0?this._editGeometry.geometry:null,this._internalGeometryChange=!1}),"EditGeometry")}get _editGeometry(){return this._editGeometryOperations.data}get vertices(){const h=[];return this.forEachVertex(r=>{h.push(r)}),h}get numVertices(){return this.constructed&&this._editGeometry.components.length>0?this._editGeometry.components[0].vertices.length:0}get polygonIsClosed(){return this._editGeometry.components.length>0&&this._editGeometry.components[0].isClosed()}get firstPoint(){if(this.constructed&&this._editGeometry.components.length>0){const h=this._editGeometry.components[0].getFirstVertex();if(null!=h)return this._editGeometry.coordinateHelper.vectorToPoint(h.pos)}return null}get lastPoint(){if(this.constructed&&this._editGeometry.components.length>0){const h=this._editGeometry.components[0].getLastVertex();if(null!=h)return this._editGeometry.coordinateHelper.vectorToPoint(h.pos)}return null}getVertex(h){if(!this.constructed||0===this._editGeometry.components.length||0===this._editGeometry.components[0].vertices.length)return null;const r=this._editGeometry.components[0].vertices[0];let d=r;do{if(d.index===h)return d;d=d.rightEdge.rightVertex}while(d!==r&&null!=d);return null}getVertexPositionAsPoint(h){return this._editGeometry.coordinateHelper.vectorToPoint(h.pos)}getVertexPositionAsPointFromIndex(h){return this._editGeometry.coordinateHelper.vectorToPoint(this.getVertex(h).pos)}forEachVertex(h){this.constructed&&this._editGeometry.components.length>0&&this._editGeometry.components[0].iterateVertices(h)}forEachVertexPosition(h){const r=this._editGeometry.coordinateHelper;this.forEachVertex((d,_)=>{r.vectorToPoint(d.pos,Xe),h(Xe,_)})}clear(){null!=this.areaMeasurement&&(this.areaMeasurement.geometry=null)}add(h){if(!this.constructed)return null;if(0===this._editGeometry.components.length){const d=this.view;this._editGeometry.components.push(new Ye.wA(d.spatialReference,d.state.viewingMode))}const r=this._editGeometryOperations.appendVertex(this._editGeometry.coordinateHelper.pointToVector(h));return this.emit("change"),r}close(){if(!this.constructed||0===this._editGeometry.components.length)return null;const h=this._editGeometryOperations.closeComponent(this._editGeometry.components[0]);return this.emit("change"),h}ensureContains(h,r=""){let d=!1;if(this._editGeometry.components.forEach(_=>{_.iterateVertices(v=>{v===h&&(d=!0)})}),!d)throw new Error(`vertex doesnt exist ${r}`);return d}setVertexPosition(h,r){if(!this.constructed)return null;const d=this._editGeometryOperations.setVertexPosition(h,this._editGeometry.coordinateHelper.pointToVector(r));return this.emit("change"),d}equals(h){if(this.numVertices!==h.numVertices)return!1;let r=!0;return this.forEachVertexPosition((d,_)=>{const v=h.getVertexPositionAsPointFromIndex(_);d.equals(v)||(r=!1)}),!!r}};(0,M._)([(0,C.Cb)({value:null})],ie.prototype,"areaMeasurement",null),(0,M._)([(0,C.Cb)({value:null})],ie.prototype,"view",null),(0,M._)([(0,C.Cb)()],ie.prototype,"isEmptyPolygon",null),(0,M._)([(0,C.Cb)()],ie.prototype,"isValidPolygon",null),(0,M._)([(0,C.Cb)()],ie.prototype,"extent",null),(0,M._)([(0,C.Cb)()],ie.prototype,"spatialReference",null),(0,M._)([(0,C.Cb)()],ie.prototype,"numVertices",null),(0,M._)([(0,C.Cb)()],ie.prototype,"polygonIsClosed",null),ie=(0,M._)([(0,k.j)("esri.views.3d.analysis.AreaMeasurement.support.AreaMeasurement3DPathHelper")],ie);const Xe=new St.Z;g(52515);var he=g(78260),Je=g(84600),Qe=g(52113),Rt=g(74741),ke=g(68063),Ce=g(87469),Ae=g(63657),Ut=g(53928),qe=g(94255),Vt=g(41120),de=g(40723),et=g(16396),Ie=g(13934),Gt=g(60881),We=g(5894),bt=g(2770),wt=g(66131),Tt=g(15842),jt=g(651),xt=g(91056),It=g(39114),ze=g(88569),Wt=g(12407),Oe=g(44835),zt=g(8549),Re=g(67969),Ue=g(2078);class Ve extends xt.A{initializeProgram(r){return new Wt.$(r.rctx,Ve.shader.get().build(this.configuration),It.i)}_setPipelineState(r){const d=this.configuration,_=r===Oe.A.NONE,v=r===Oe.A.FrontFace;return(0,Ue.sm)({blending:d.transparent?_?Kt:(0,ze.j7)(r):null,depthTest:{func:(0,ze.Bh)(r)},depthWrite:_?d.writeDepth?Ue.LZ:null:(0,ze.K5)(r),colorWrite:Ue.BK,polygonOffset:_||v?d.polygonOffset?Bt:null:{factor:-1,units:-25}})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}}Ve.shader=new jt.J(zt.C,()=>g.e(2558).then(g.bind(g,2558)));const Bt={factor:0,units:-25},Kt=(0,Ue.wK)(Re.zi.SRC_ALPHA,Re.zi.ONE,Re.zi.ONE_MINUS_SRC_ALPHA,Re.zi.ONE_MINUS_SRC_ALPHA);var pe=g(87601),Ft=g(41528);class ce extends Ft.W{constructor(){super(...arguments),this.transparencyPassType=Oe.A.NONE,this.transparent=!1,this.writeDepth=!0,this.polygonOffset=!1,this.multipassEnabled=!1,this.cullAboveGround=!1}}(0,M._)([(0,pe.o)({count:Oe.A.COUNT})],ce.prototype,"transparencyPassType",void 0),(0,M._)([(0,pe.o)()],ce.prototype,"transparent",void 0),(0,M._)([(0,pe.o)()],ce.prototype,"writeDepth",void 0),(0,M._)([(0,pe.o)()],ce.prototype,"polygonOffset",void 0),(0,M._)([(0,pe.o)()],ce.prototype,"multipassEnabled",void 0),(0,M._)([(0,pe.o)()],ce.prototype,"cullAboveGround",void 0),(0,M._)([(0,pe.o)({constValue:!1})],ce.prototype,"occlusionPass",void 0);class Ht extends Tt.c{constructor(r){super(r,new Zt),this.produces=new Map([[We.r.OPAQUE_MATERIAL,d=>(0,Ie.NM)(d)&&!this.parameters.transparent],[We.r.TRANSPARENT_MATERIAL,d=>(0,Ie.NM)(d)&&this.parameters.transparent&&this.parameters.writeDepth],[We.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL,d=>(0,Ie.NM)(d)&&this.parameters.transparent&&!this.parameters.writeDepth]]),this._configuration=new ce}getConfiguration(r,d){return this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.transparencyPassType=d.transparencyPassType,this._configuration.multipassEnabled=d.multipassEnabled,this._configuration.cullAboveGround=d.multipassTerrain.cullAboveGround,this._configuration}createGLMaterial(r){return new Nt(r)}createBufferWriter(){return new bt.G(wt.W1)}}class Nt extends Gt.Z{beginSlot(r){return this.ensureTechnique(Ve,r)}}class Zt extends de.Mt{constructor(){super(...arguments),this.size=(0,G.al)(1,1),this.color1=(0,te.al)(.75,.75,.75,1),this.color2=(0,te.al)(.5,.5,.5,1),this.transparent=!1,this.writeDepth=!0,this.polygonOffset=!1}}class Yt extends Ut._{constructor(r){super(r),this._checkerBoardMaterial=null,this._renderOccluded=de.yD.OccludeAndTransparent,this._geometry=null,this._size=(0,G.al)(1,1),this._color1=(0,te.al)(1,.5,0,.5),this._color2=(0,te.al)(1,1,1,.5),this.applyProperties(r)}get renderOccluded(){return this._renderOccluded}set renderOccluded(r){r!==this._renderOccluded&&(this._renderOccluded=r,this._updateMaterial())}get geometry(){return this._geometry}set geometry(r){this._geometry=r,this.recreateGeometry()}get size(){return this._size}set size(r){(0,W.JG)(this._size,r),this._updateMaterial()}get color1(){return this._color1}set color1(r){(0,Ae.a)(r,this._color1)||((0,Ae.c)(this._color1,r),this._updateMaterial())}get color2(){return this._color2}set color2(r){(0,Ae.a)(r,this._color2)||((0,Ae.c)(this._color2,r),this._updateMaterial())}_updateMaterial(){null!=this._checkerBoardMaterial&&this._checkerBoardMaterial.setParameters({size:this._size,color1:this._color1,color2:this._color2,renderOccluded:this._renderOccluded})}createExternalResources(){this._checkerBoardMaterial=new Ht({size:this._size,color1:this._color1,color2:this._color2,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:de.yD.OccludeAndTransparent,isDecoration:this.isDecoration})}destroyExternalResources(){this._checkerBoardMaterial=null}forEachExternalMaterial(r){null!=this._checkerBoardMaterial&&r(this._checkerBoardMaterial)}createGeometries(r){if(null==this._geometry||null==this._checkerBoardMaterial)return;const d=$t;(0,Qe.i0)(d,this.transform);const _=this._geometry,v=[],P=(0,b.Ue)();_.position.forEach(R=>{(0,S.f)(P,R,d),v.push(P[0],P[1],P[2])});const L=[];_.uv.forEach(R=>{L.push(R[0],R[1])});const O=new Vt.Z(this._checkerBoardMaterial,[[et.T.POSITION,new qe.a(v,_.triangleIndices,3,!0)],[et.T.UV0,new qe.a(L,_.triangleIndices,2,!0)]]);r.addGeometry(O)}}const $t=(0,b.Ue)();var tt=g(64770),Xt=g(54889),Jt=g(56683),Qt=g(41840);let q=class extends Y.Z{get _parameters(){const{accentColor:h,textColor:r}=this.view.effectiveTheme,d=(0,he.O)(h),_=(0,he.Ch)(h,.5),v=(0,he.Ch)((0,he.mj)(h),.5),P=(0,he.mj)(r,he.K6.Low);return{accentColor:d,transparentAccentColor:_,transparentContrastColor:v,intersectingLineColor:[1,.2,0,1],textColor:r,textBackgroundColor:(0,he.G)(P,.6),textCalloutColor:(0,he.G)(P,.5),pathLineWidth:3,perimeterLineWidth:2,projectionLineWidth:2,projectionLineStippleSize:5,labelDistance:25}}get visible(){return this.analysisViewData.visible}get testData(){return{labels:{area:this._areaLabel,perimeterLength:this._perimeterLengthLabel}}}constructor(h){super(h),this._path=null,this._intersectedPath=null,this._perimeter=null,this._intersectedPerimeter=null,this._projectionLines=null,this._measurementArea=null,this._areaLabel=null,this._perimeterLengthLabel=null,this._pathSegments=[],this._perimeterSegments=[],this._origin=(0,b.Ue)(),this._originTransform=(0,Rt.Ue)(),this.messages=null,this.viewData=kt,this.areaLabel=null,this.perimeterLengthLabel=null,this.loadingMessages=!0}initialize(){const{analysisViewData:h,_parameters:r,view:d}=this;this._path=new Ce.r({view:d,attached:!0,width:r.pathLineWidth,polygonOffset:!0,renderOccluded:de.yD.OccludeAndTransparent,isDecoration:!0}),this._intersectedPath=new Ce.r({view:d,attached:!0,width:r.pathLineWidth,polygonOffset:!0,renderOccluded:de.yD.OccludeAndTransparent,isDecoration:!0}),this._perimeter=new Ce.r({view:d,attached:!0,width:r.perimeterLineWidth,polygonOffset:!0,renderOccluded:de.yD.OccludeAndTransparent,isDecoration:!0}),this._intersectedPerimeter=new Ce.r({view:d,attached:!0,width:r.perimeterLineWidth,color:r.intersectingLineColor,polygonOffset:!0,renderOccluded:de.yD.OccludeAndTransparent,isDecoration:!0}),this._projectionLines=new Ce.r({view:d,attached:!0,width:r.projectionLineWidth,stipplePattern:(0,Xt.z5)(r.projectionLineStippleSize),polygonOffset:!0,renderOccluded:de.yD.OccludeAndTransparent,isDecoration:!0}),this._measurementArea=new Yt({view:d,attached:!0,isDecoration:!0});const _={attached:!0,view:d,isDecoration:!0};this._areaLabel=new ke.K({..._,fontSize:Ge.Large}),this._perimeterLengthLabel=new ke.K({..._,fontSize:Ge.Small}),this.addHandles([(0,I.YP)(()=>[h.mode,this.visible,h.unit,h.measurementData,h.stagedPoint],()=>this._update(),I.tX),(0,I.YP)(()=>d.state?.camera,()=>this._updateLabels(),I.tX),(0,Jt.qe)(()=>this._updateMessageBundle()),(0,I.YP)(()=>this._parameters,({accentColor:v,transparentAccentColor:P,transparentContrastColor:L,textColor:O,textBackgroundColor:R,textCalloutColor:U})=>{const{_path:w,_intersectedPath:z,_perimeter:F,_projectionLines:H,_measurementArea:X,_areaLabel:T,_perimeterLengthLabel:ue}=this;w.color=v,z.color=v,F.color=v,H.color=v,X.color1=P,X.color2=L,T.textColor=O,T.backgroundColor=R,T.calloutColor=U,ue.textColor=O,ue.backgroundColor=R,ue.calloutColor=U},I.nn)]),this._updateMessageBundle()}destroy(){this._measurementArea=(0,j.SC)(this._measurementArea),this._path=(0,j.SC)(this._path),this._intersectedPath=(0,j.SC)(this._intersectedPath),this._perimeter=(0,j.SC)(this._perimeter),this._intersectedPerimeter=(0,j.SC)(this._intersectedPerimeter),this._areaLabel=(0,j.SC)(this._areaLabel),this._perimeterLengthLabel=(0,j.SC)(this._perimeterLengthLabel),this._projectionLines=(0,j.SC)(this._projectionLines),this.set("view",null)}_update(){if(this.destroyed||!this.view.ready||!this.view.renderCoordsHelper)return;const{analysisViewData:{measurementData:h},analysisViewData:r}=this;null!=h&&(this._updateViewData(h,r.path,r.stagedPoint),this._updateOrigin(),this._updatePathSegments(),this._updatePerimeterSegments(),this._updateArea(),this._updateProjectionLines(),this._updateLabels())}_updateViewData(h,r,d){const _=h.validMeasurement,v="geodesic"===h.actualMeasurementMode,P=v?h.geodesicArea:h.area;let L=1;if(P){const R=this._toPreferredAreaUnit(P,this.analysisViewData.unit);L=(0,A.sk)(Math.sqrt(R.value)/Math.sqrt(300)),L*=Math.sqrt((0,ye.En)(1,R.unit,"square-meters")),L/=h.unitNormalizer.normalizeDistance(1)}this._set("viewData",{validMeasurement:_,numVertices:h.numVertices,hasStagedVertex:h.hasStagedVertex,path:r,pathVersion:r.version,stagedPoint:d,measurementData:h,mode:h.actualMeasurementMode,positionsGeographic:h.positionsGeographic,positionsRenderCoords:h.positionsRenderCoords,positionsProjected:h.positionsProjectedWorldCoords,positionsFittedRenderCoords:h.positionsFittedRenderCoords,intersectingSegments:v?h.geodesicIntersectingSegments:h.intersectingSegments,triangleIndices:v?h.geodesicTriangleIndices:h.triangleIndices,fittingMode:h.fittingMode,areaCentroid:v?h.geodesicAreaCentroidRenderCoords:h.areaCentroidRenderCoords,pathLengthLabelSegmentIndex:_?0:r.numVertices-2,perimeterLengthLabelSegmentIndex:0,checkerSize:L})}_updateOrigin(){(0,me.$U)(this.viewData.positionsRenderCoords,this._origin),(0,Qe.vc)(this._originTransform,this._origin),this._measurementArea.transform=this._originTransform,this._projectionLines.transform=this._originTransform}_createSegments(h){const r=this.viewData,d=this.view.renderCoordsHelper.spatialReference,_=r.mode,v=[],P=[],L=[],O=r.numVertices,R=r.validMeasurement?O:O-1;for(let w=0;w<R;++w){const z=r[h][w],F=r[h][(w+1)%O];let H=null;switch(_){case"euclidean":H=new tt.y(z,F);break;case"geodesic":H=new tt.u(z,F,d)}r.intersectingSegments.has(w)?L.push(H):P.push(H),v.push(H)}let U=null;return r.validMeasurement&&r.hasStagedVertex&&R>=2?U=v[v.length-2]:r.hasStagedVertex&&R>=1&&(U=v[v.length-1]),{all:v,nonIntersecting:P,intersecting:L,stagedSegment:U}}_updatePathSegments(){const{visible:h}=this,r=this._createSegments("positionsRenderCoords");this._path.setGeometryFromSegments(r.nonIntersecting,this._origin),this._path.visible=h,this._intersectedPath.setGeometryFromSegments(r.intersecting,this._origin),this._intersectedPath.visible=h,this._pathSegments=r.all}_updatePerimeterSegments(){const h=this.visible&&"euclidean"===this.viewData.mode,r=this._createSegments("positionsFittedRenderCoords");this._perimeter.setGeometryFromSegments(r.nonIntersecting,this._origin),this._perimeter.visible=h,this._intersectedPerimeter.setGeometryFromSegments(r.intersecting,this._origin),this._intersectedPerimeter.visible=h,this._perimeterSegments=r.all}_updateArea(){const h=this.viewData;switch(h.mode){case"euclidean":this._updateAreaEuclidean(h);break;case"geodesic":this._updateAreaGeodesic()}}_updateAreaEuclidean(h){const r=this.visible;h.validMeasurement&&0===h.intersectingSegments.size&&h.triangleIndices?(this._measurementArea.geometry={uv:h.positionsProjected,position:h.positionsFittedRenderCoords,triangleIndices:h.triangleIndices},this._measurementArea.size=[h.checkerSize,h.checkerSize],this._measurementArea.visible=r):this._measurementArea.visible=!1}_updateAreaGeodesic(){this._measurementArea.visible=!1}_updateProjectionLines(){const h=this.viewData,r=this.visible,_=h.numVertices;if(_>0&&h.validMeasurement&&"euclidean"===h.mode){const v=[];for(let P=0;P<_;++P){const L=(0,b.Ue)();(0,S.f)(L,h.positionsRenderCoords[P],this._origin);const O=(0,b.Ue)();(0,S.f)(O,h.positionsFittedRenderCoords[P],this._origin),v.push([L,O])}this._projectionLines.geometry=v,this._projectionLines.visible=r}else this._projectionLines.geometry=null,this._projectionLines.visible=!1}_updateLabels(){if(this.destroyed)return;const{viewData:h}=this,{measurementData:r,mode:d,path:_}=h;if(!_)return;const v=this.visible,P=this._formatAreaLabel(this.messages,"geodesic"===d?r.geodesicArea:r.area,this.analysisViewData.unit);if(null!=P?(this._areaLabel.geometry={type:"point",point:h.areaCentroid},this._areaLabel.text=P,this._areaLabel.visible=h.validMeasurement&&0===h.intersectingSegments.size&&v):this._areaLabel.visible=!1,this._set("areaLabel",P),h.validMeasurement&&0===h.intersectingSegments.size){const L="geodesic"===h.mode,R=this._formatLengthLabel(this.messages,L?r.geodesicPathLength:r.validMeasurement?r.perimeterLength:r.pathLength,this.analysisViewData.unit);this._set("perimeterLengthLabel",R),this._perimeterLengthLabel.distance=this._parameters.labelDistance,this._perimeterLengthLabel.anchor="top",this._perimeterLengthLabel.text=R,this._perimeterLengthLabel.visible=!0;let U=!0;for(let w=0;w<h.numVertices;++w){const z=(h.perimeterLengthLabelSegmentIndex+w)%h.numVertices;if(U=!0,this._perimeterLengthLabel.geometry={type:"segment",segment:L||!r.validMeasurement?this._pathSegments[z]:this._perimeterSegments[z],sampleLocation:"center"},!this._perimeterLengthLabel.overlaps(this._areaLabel))break;U=!1}this._perimeterLengthLabel.visible=U&&v}else this._perimeterLengthLabel.visible=!1}_toPreferredAreaUnit(h,r){return(0,E.nn)(h,this._preferredAreaUnit(h,r))}_preferredAreaUnit(h,r){switch(r){case"metric":return(0,ye.ZI)(h.value,h.unit);case"imperial":return(0,ye.LV)(h.value,h.unit);default:return r}}_preferredLengthUnit(h,r){const d=this._deriveLengthUnitFromAreaUnit(r);switch(d){case"metric":return(0,ye.Y8)(h.value,h.unit);case"imperial":return(0,ye.Q7)(h.value,h.unit);default:return d}}_deriveLengthUnitFromAreaUnit(h){switch(h){case"metric":case"ares":case"hectares":return"metric";case"imperial":case"acres":return"imperial";case"square-inches":return"inches";case"square-feet":return"feet";case"square-yards":return"yards";case"square-miles":return"miles";case"square-us-feet":return"us-feet";case"square-millimeters":return"millimeters";case"square-centimeters":return"centimeters";case"square-decimeters":return"decimeters";case"square-meters":return"meters";case"square-kilometers":return"kilometers"}throw new Error("unhandled area unit")}_formatAreaLabel(h,r,d){return h&&r&&(0,Je.VG)(h,r,this._preferredAreaUnit(r,d))}_formatLengthLabel(h,r,d){return h&&r&&(0,Je.VG)(h,r,this._preferredLengthUnit(r,d))}_updateMessageBundle(){this.loadingMessages=!0,(0,Qt.ME)("esri/core/t9n/Units").then(h=>{this.messages=h,this.view&&this._update()}).finally(()=>{this.loadingMessages=!1})}};var Ge,h;(0,M._)([(0,C.Cb)()],q.prototype,"_parameters",null),(0,M._)([(0,C.Cb)()],q.prototype,"view",void 0),(0,M._)([(0,C.Cb)()],q.prototype,"messages",void 0),(0,M._)([(0,C.Cb)()],q.prototype,"analysis",void 0),(0,M._)([(0,C.Cb)()],q.prototype,"viewData",void 0),(0,M._)([(0,C.Cb)()],q.prototype,"analysisViewData",void 0),(0,M._)([(0,C.Cb)({readOnly:!0})],q.prototype,"areaLabel",void 0),(0,M._)([(0,C.Cb)({readOnly:!0})],q.prototype,"perimeterLengthLabel",void 0),(0,M._)([(0,C.Cb)()],q.prototype,"loadingMessages",void 0),(0,M._)([(0,C.Cb)()],q.prototype,"visible",null),q=(0,M._)([(0,k.j)("esri.views.3d.analysis.AreaMeasurement.support.AreaMeasurementVisualization")],q),(h=Ge||(Ge={}))[h.Small=12]="Small",h[h.Large=16]="Large";const kt={validMeasurement:!1,numVertices:0,hasStagedVertex:!1,path:null,pathVersion:-1,stagedPoint:null,measurementData:null,mode:null,positionsGeographic:null,positionsRenderCoords:null,positionsProjected:null,positionsFittedRenderCoords:null,intersectingSegments:null,triangleIndices:null,fittingMode:null,areaCentroid:null,pathLengthLabelSegmentIndex:null,perimeterLengthLabelSegmentIndex:null,checkerSize:null};let N=class extends((0,Z.p)(Y.Z)){constructor(h){super(h),this.type="area-measurement-view-3d",this.analysis=null,this.measurementData=null,this.lastDraggedVertex=null,this.stagedPoint=null,this.mode=x.e.Auto}initialize(){const{analysis:h,view:r}=this;this.path=new ie({view:r,areaMeasurement:h}),this.analysisVisualization=new q({view:r,analysis:h,analysisViewData:this}),this.analysisController=new _e({view:r,analysis:h,analysisViewData:this})}destroy(){this.analysisController=(0,j.SC)(this.analysisController),this.analysisVisualization=(0,j.SC)(this.analysisVisualization),this.path.destroy()}get updating(){return!!this.analysisVisualization?.loadingMessages}get result(){const{measurementData:h}=this;return null==h?{area:null,mode:null,perimeter:null}:"euclidean"===h.actualMeasurementMode?{area:h.area,perimeter:h.perimeterLength,mode:"euclidean"}:{area:h.geodesicArea,perimeter:h.pathLength,mode:"geodesic"}}get viewData(){return this.analysisVisualization.viewData}get validMeasurement(){return this.path.isValidPolygon}get unit(){return this.analysis.unit??this._defaultUnit}get testData(){return{visualization:this.analysisVisualization,controller:this.analysisController}}};(0,M._)([(0,C.Cb)({readOnly:!0})],N.prototype,"type",void 0),(0,M._)([(0,C.Cb)({constructOnly:!0,nonNullable:!0})],N.prototype,"analysis",void 0),(0,M._)([(0,C.Cb)()],N.prototype,"updating",null),(0,M._)([(0,C.Cb)()],N.prototype,"analysisVisualization",void 0),(0,M._)([(0,C.Cb)()],N.prototype,"analysisController",void 0),(0,M._)([(0,C.Cb)()],N.prototype,"result",null),(0,M._)([(0,C.Cb)()],N.prototype,"measurementData",void 0),(0,M._)([(0,C.Cb)()],N.prototype,"viewData",null),(0,M._)([(0,C.Cb)()],N.prototype,"validMeasurement",null),(0,M._)([(0,C.Cb)()],N.prototype,"path",void 0),(0,M._)([(0,C.Cb)()],N.prototype,"lastDraggedVertex",void 0),(0,M._)([(0,C.Cb)()],N.prototype,"stagedPoint",void 0),(0,M._)([(0,C.Cb)()],N.prototype,"mode",void 0),(0,M._)([(0,C.Cb)()],N.prototype,"unit",null),(0,M._)([(0,C.Cb)(V.Y)],N.prototype,"_defaultUnit",void 0),N=(0,M._)([(0,k.j)("esri.views.3d.analysis.AreaMeasurementAnalysisView3D")],N);const qt=N},54865:(ge,$,g)=>{g.d($,{G:()=>j,e:()=>C});var M=g(55915),Y=g(53929);function j(B,K,Q,k=!1){const V=(0,M.tryProjectWithZConversion)(B,K);return null==V?null:(V.hasZ&&!k||null==Q||(V.z=(0,Y.KO)(Q,V)??0),V)}function C(B,K,Q){Q.warnOnce(`Failed to project analysis geometry (id: '${B.id}'), projection from spatial reference (wkid: '${K.wkid}') to view spatial reference is not supported. Projection may be possible after calling projection.load().`)}},87469:(ge,$,g)=>{g.d($,{r:()=>Z});var M=g(52113),Y=g(74741),j=g(79800),C=g(29302),B=g(1503),K=g(53928),Q=g(79020),k=g(40723),V=g(92222);class Z extends K._{constructor(y,D){super(y),this._hasExternalMaterial=!1,this._hasExternalMaterial=null!=D,this._material=D??new V.U({width:1,color:(0,B.al)(1,0,1,1),stippleOffColor:null,stipplePattern:null,stipplePreferContinuous:!0,isClosed:!1,falloff:0,innerColor:null,innerWidth:1,hasPolygonOffset:!1,renderOccluded:k.yD.OccludeAndTransparent,isDecoration:!!y.isDecoration,writeDepth:!0}),this.applyProperties(y)}setGeometryFromRenderSpacePoint(y,D=1e3){this.geometry=[[[y[0]-D,y[1],y[2]],[y[0]+D,y[1],y[2]]],[[y[0],y[1]-D,y[2]],[y[0],y[1]+D,y[2]]],[[y[0],y[1],y[2]-D],[y[0],y[1],y[2]+D]]]}setGeometryFromExtent(y){const D=this.view.spatialReference,A=(0,C.Ue)(),E=(0,C.Ue)(),W=100,G=[];(0,j.s)(A,y[0],y[1],W),this.view.renderCoordsHelper.toRenderCoords(A,D,E),G.push([E[0],E[1],E[2]]),(0,j.s)(A,y[2],y[1],W),this.view.renderCoordsHelper.toRenderCoords(A,D,E),G.push([E[0],E[1],E[2]]),(0,j.s)(A,y[2],y[3],W),this.view.renderCoordsHelper.toRenderCoords(A,D,E),G.push([E[0],E[1],E[2]]),(0,j.s)(A,y[0],y[3],W),this.view.renderCoordsHelper.toRenderCoords(A,D,E),G.push([E[0],E[1],E[2]]),(0,j.s)(A,y[0],y[1],W),this.view.renderCoordsHelper.toRenderCoords(A,D,E),G.push([E[0],E[1],E[2]]),(0,j.s)(A,y[0],y[1],W),this.view.renderCoordsHelper.toRenderCoords(A,D,E),G.push([E[0],E[1],E[2]]),this.geometry=[G]}setGeometryFromFrustum(y){const D=[];y.lines.forEach(A=>{D.push([A.origin[0],A.origin[1],A.origin[2]]),D.push([A.endpoint[0],A.endpoint[1],A.endpoint[2]])}),this.geometry=[D]}setGeometryFromBoundedPlane(y){const D=[],A=y.origin,E=y.basis1,W=y.basis2,G=.5,S=(0,C.Ue)(),b=(0,C.Ue)(),te=(0,C.Ue)(),oe=(0,C.Ue)();S[0]=A[0]-E[0]*G-W[0]*G,S[1]=A[1]-E[1]*G-W[1]*G,S[2]=A[2]-E[2]*G-W[2]*G,b[0]=A[0]-E[0]*G+W[0]*G,b[1]=A[1]-E[1]*G+W[1]*G,b[2]=A[2]-E[2]*G+W[2]*G,te[0]=A[0]+E[0]*G+W[0]*G,te[1]=A[1]+E[1]*G+W[1]*G,te[2]=A[2]+E[2]*G+W[2]*G,oe[0]=A[0]+E[0]*G-W[0]*G,oe[1]=A[1]+E[1]*G-W[1]*G,oe[2]=A[2]+E[2]*G-W[2]*G,D.push([S[0],S[1],S[2]]),D.push([b[0],b[1],b[2]]),D.push([te[0],te[1],te[2]]),D.push([oe[0],oe[1],oe[2]]),D.push([S[0],S[1],S[2]]),this.geometry=[D]}setGeometryFromSegment(y){const D=y.endRenderSpace;this.transform=(0,M.vc)(x,D);const{points:A}=y.createRenderGeometry(D,this.view.renderCoordsHelper);this.geometry=[A]}setGeometryFromSegments(y,D=C.AG){this.transform=(0,M.vc)(x,D),this.geometry=y.map(A=>A.createRenderGeometry(D,this.view.renderCoordsHelper).points)}getTransformedGeometry(){return null==this._geometry?null:this._geometry.map(y=>y.map(D=>(0,j.e)((0,C.Ue)(),D,this.transform)))}get renderOccluded(){return this._material.parameters.renderOccluded}set renderOccluded(y){this._material.setParameters({renderOccluded:y})}get geometry(){return this._geometry}set geometry(y){this._geometry=y,this.recreateGeometry()}get width(){return this._material.parameters.width}set width(y){this._material.setParameters({width:y})}get color(){return this._material.parameters.color}set color(y){const D=1===y[3];this._material.setParameters({color:(0,B.d9)(y),writeDepth:D})}get innerWidth(){return this._material.parameters.innerWidth}set innerWidth(y){this._material.setParameters({innerWidth:y})}get innerColor(){return this._material.parameters.innerColor}set innerColor(y){this._material.setParameters({innerColor:null!=y?(0,B.d9)(y):null})}get stipplePattern(){return this._material.parameters.stipplePattern}set stipplePattern(y){null!=this._material&&this._material.setParameters({stipplePattern:y})}get stippleOffColor(){return this._material.parameters.stippleOffColor}set stippleOffColor(y){this._material.setParameters({stippleOffColor:null!=y?(0,B.d9)(y):null})}get stipplePreferContinuous(){return this._material.parameters.stipplePreferContinuous}set stipplePreferContinuous(y){this._material.setParameters({stipplePreferContinuous:y})}get falloff(){return this._material.parameters.falloff}set falloff(y){this._material.setParameters({falloff:y})}get polygonOffset(){return this._material.parameters.hasPolygonOffset}set polygonOffset(y){this._material.setParameters({hasPolygonOffset:y})}createExternalResources(){}destroyExternalResources(){}createGeometries(y){for(const D of(0,Q.c)(this.geometry)){const A=(0,Q.Y)(this._material,D);y.addGeometry(A)}}forEachExternalMaterial(y){this._hasExternalMaterial||y(this._material)}}const x=(0,Y.Ue)()},53928:(ge,$,g)=>{g.d($,{_:()=>Q});var M=g(52113),Y=g(74741),j=g(68604),C=g(97272),B=g(23147),K=g(34103);class Q extends j.l{constructor(V){super(V),this._resources=null,this._transform=(0,Y.Ue)()}get object(){return null!=this._resources?this._resources.object:null}get transform(){return this._transform}set transform(V){(0,M.JG)(this._transform,V),null!=this._resources&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(null==this._resources)return;const V=this._resources.object,Z=this.view._stage;Z.removeMany(V.geometries),V.removeAllGeometries(),this.createGeometries(V),V.visible=this.visible,Z.addMany(V.geometries)}createResources(){this.destroyResources();const V=this.view._stage;if(!V)return;const Z=new K.F(V,{pickable:!1,updatePolicy:B.j.SYNC}),x=new C.T({castShadow:!1});x.transformation=this._transform,this.createExternalResources(),this.createGeometries(x),V.addMany(x.geometries),this.forEachExternalMaterial(I=>V.add(I)),V.add(x),Z.add(x),x.visible=this.visible,this._resources={layer:Z,object:x}}destroyResources(){const V=this.view._stage;null!=this._resources&&V&&(V.remove(this._resources.object),this._resources.layer.destroy(),this.forEachExternalMaterial(Z=>{V.remove(Z)}),V.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(V){null!=this._resources&&(this._resources.object.visible=V)}}},68604:(ge,$,g)=>{g.d($,{l:()=>Y});var M=g(32917);class Y{get isDecoration(){return this._isDecoration}set isDecoration(C){this._isDecoration=C}constructor(C){this._isDecoration=!1,this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=C.view,this._handle=(0,M.YP)(()=>C.view.ready,B=>{this._resourcesCreated&&(B?this._createResources():this._destroyResources())})}applyProperties(C){let B=!1;for(const K in C)K in this?"attached"===K?B=C[K]:this[K]=C[K]:console.error("Cannot set unknown property",K);this.attached=B}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(C){C!==this._attached&&this.view._stage&&(this._attached=C,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(C))}onAttachedChange(C){}get visible(){return this._visible}set visible(C){C!==this._visible&&(this._visible=C,this.attached&&this.updateVisibility(C))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}}}]);