"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[676],{6189:(de,U,i)=>{i.r(U),i.d(U,{default:()=>Pe});var m=i(15861),t=i(17626),I=i(46160),j=i(46882),O=i(26584),g=i(58817),d=i(47877),v=i(63290),R=i(99959),A=i(10699),x=i(21726),s=i(77712),F=(i(8314),i(68653)),p=i(76898),c=i(65234),_=i(44917),b=i(49410),T=i(20925),K=i(50085),n=i(65088),a=i(50107),u=i(49286),l=i(6647),f=i(99555),M=i(42432),H=i(39593),B=i(86810),J=i(35948);i(4619);let Z=class extends B.wq{constructor(){super(...arguments),this.type=null}};(0,t._)([(0,s.Cb)({type:String,readOnly:!0,json:{write:!0}})],Z.prototype,"type",void 0),Z=(0,t._)([(0,p.j)("esri.layers.support.BuildingFilterAuthoringInfo")],Z);const z=Z;var L;let S=L=class extends B.wq{constructor(){super(...arguments),this.filterType=null,this.filterValues=null}clone(){return new L({filterType:this.filterType,filterValues:(0,g.d9)(this.filterValues)})}};var N;(0,t._)([(0,s.Cb)({type:String,json:{write:!0}})],S.prototype,"filterType",void 0),(0,t._)([(0,s.Cb)({type:[String],json:{write:!0}})],S.prototype,"filterValues",void 0),S=L=(0,t._)([(0,p.j)("esri.layers.support.BuildingFilterAuthoringInfoType")],S);const be=I.Z.ofType(S);let X=N=class extends B.wq{clone(){return new N({filterTypes:(0,g.d9)(this.filterTypes)})}};var te;(0,t._)([(0,s.Cb)({type:be,json:{write:!0}})],X.prototype,"filterTypes",void 0),X=N=(0,t._)([(0,p.j)("esri.layers.support.BuildingFilterAuthoringInfoBlock")],X);const Ie=I.Z.ofType(X);let W=te=class extends z{constructor(){super(...arguments),this.type="checkbox"}clone(){return new te({filterBlocks:(0,g.d9)(this.filterBlocks)})}};(0,t._)([(0,s.Cb)({type:["checkbox"]})],W.prototype,"type",void 0),(0,t._)([(0,s.Cb)({type:Ie,json:{write:!0}})],W.prototype,"filterBlocks",void 0),W=te=(0,t._)([(0,p.j)("esri.layers.support.BuildingFilterAuthoringInfoCheckbox")],W);const pe=W;let Q=class extends B.wq{};(0,t._)([(0,s.Cb)({readOnly:!0,json:{read:!1}})],Q.prototype,"type",void 0),Q=(0,t._)([(0,p.j)("esri.layers.support.BuildingFilterMode")],Q);const $=Q;var re;let Y=re=class extends ${constructor(){super(...arguments),this.type="solid"}clone(){return new re}};(0,t._)([(0,s.Cb)({type:["solid"],readOnly:!0,json:{write:!0}})],Y.prototype,"type",void 0),Y=re=(0,t._)([(0,p.j)("esri.layers.support.BuildingFilterModeSolid")],Y);const ie=Y;var se,Be=i(55342),Ce=i(61261);let V=se=class extends ${constructor(){super(...arguments),this.type="wire-frame",this.edges=null}clone(){return new se({edges:(0,g.d9)(this.edges)})}};(0,t._)([(0,Be.J)({wireFrame:"wire-frame"})],V.prototype,"type",void 0),(0,t._)([(0,s.Cb)(Ce.Z)],V.prototype,"edges",void 0),V=se=(0,t._)([(0,p.j)("esri.layers.support.BuildingFilterModeWireFrame")],V);const ce=V;var ne;let k=ne=class extends ${constructor(){super(...arguments),this.type="x-ray"}clone(){return new ne}};(0,t._)([(0,s.Cb)({type:["x-ray"],readOnly:!0,json:{write:!0}})],k.prototype,"type",void 0),k=ne=(0,t._)([(0,p.j)("esri.layers.support.BuildingFilterModeXRay")],k);const he=k;var le;const je={nonNullable:!0,types:{key:"type",base:$,typeMap:{solid:ie,"wire-frame":ce,"x-ray":he}},json:{read:e=>{switch(e?.type){case"solid":return ie.fromJSON(e);case"wireFrame":return ce.fromJSON(e);case"x-ray":return he.fromJSON(e);default:return}},write:{enabled:!0,isRequired:!0}}};let D=le=class extends B.wq{constructor(){super(...arguments),this.filterExpression=null,this.filterMode=new ie,this.title=""}clone(){return new le({filterExpression:this.filterExpression,filterMode:(0,g.d9)(this.filterMode),title:this.title})}};var oe;(0,t._)([(0,s.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],D.prototype,"filterExpression",void 0),(0,t._)([(0,s.Cb)(je)],D.prototype,"filterMode",void 0),(0,t._)([(0,s.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],D.prototype,"title",void 0),D=le=(0,t._)([(0,p.j)("esri.layers.support.BuildingFilterBlock")],D);const Fe=I.Z.ofType(D);let w=oe=class extends B.wq{constructor(){super(...arguments),this.description=null,this.filterBlocks=null,this.id=(0,J.DO)(),this.name=null}clone(){return new oe({description:this.description,filterBlocks:(0,g.d9)(this.filterBlocks),id:this.id,name:this.name,filterAuthoringInfo:(0,g.d9)(this.filterAuthoringInfo)})}};(0,t._)([(0,s.Cb)({type:String,json:{write:!0}})],w.prototype,"description",void 0),(0,t._)([(0,s.Cb)({type:Fe,json:{write:{enabled:!0,isRequired:!0}}})],w.prototype,"filterBlocks",void 0),(0,t._)([(0,s.Cb)({types:{key:"type",base:z,typeMap:{checkbox:pe}},json:{read:e=>"checkbox"===e?.type?pe.fromJSON(e):null,write:!0}})],w.prototype,"filterAuthoringInfo",void 0),(0,t._)([(0,s.Cb)({type:String,constructOnly:!0,json:{write:{enabled:!0,isRequired:!0}}})],w.prototype,"id",void 0),(0,t._)([(0,s.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],w.prototype,"name",void 0),w=oe=(0,t._)([(0,p.j)("esri.layers.support.BuildingFilter")],w);const xe=w;var Ee=i(84792),Te=i(47996),Me=i(60330);let C=class extends B.wq{constructor(){super(...arguments),this.fieldName=null,this.modelName=null,this.label=null,this.min=null,this.max=null,this.mostFrequentValues=null,this.subLayerIds=null}};(0,t._)([(0,s.Cb)({type:String})],C.prototype,"fieldName",void 0),(0,t._)([(0,s.Cb)({type:String})],C.prototype,"modelName",void 0),(0,t._)([(0,s.Cb)({type:String})],C.prototype,"label",void 0),(0,t._)([(0,s.Cb)({type:Number})],C.prototype,"min",void 0),(0,t._)([(0,s.Cb)({type:Number})],C.prototype,"max",void 0),(0,t._)([(0,s.Cb)({json:{read:e=>Array.isArray(e)&&(e.every(r=>"string"==typeof r)||e.every(r=>"number"==typeof r))?e.slice():null}})],C.prototype,"mostFrequentValues",void 0),(0,t._)([(0,s.Cb)({type:[Number]})],C.prototype,"subLayerIds",void 0),C=(0,t._)([(0,p.j)("esri.layers.support.BuildingFieldStatistics")],C);let G=class extends(Te.Z.LoadableMixin((0,Me.v)(B.wq))){constructor(){super(...arguments),this.url=null}get fields(){return this.loaded||"loading"===this.loadStatus?this._get("fields"):(v.Z.getLogger(this).error("building summary statistics are not loaded"),null)}load(e){return this.addResolvingPromise(this._fetchService(null!=e?e.signal:null)),Promise.resolve(this)}_fetchService(e){var r=this;return(0,m.Z)(function*(){const o=(yield(0,Ee.Z)(r.url,{query:{f:"json"},responseType:"json",signal:e})).data;r.read(o,{origin:"service"})})()}};(0,t._)([(0,s.Cb)({constructOnly:!0,type:String})],G.prototype,"url",void 0),(0,t._)([(0,s.Cb)({readOnly:!0,type:[C],json:{read:{source:"summary"}}})],G.prototype,"fields",null),G=(0,t._)([(0,p.j)("esri.layers.support.BuildingSummaryStatistics")],G);const ve=G;var q=i(13812),ee=i(60507);const fe=I.Z.ofType(xe),ge=(0,g.d9)(T.Z.sublayersProperty),ae=ge.json?.origins;ae&&(ae["web-scene"]={type:[b.Z],write:{enabled:!0,overridePolicy:()=>({enabled:!1})}},ae["portal-item"]={type:[b.Z],write:{enabled:!0,overridePolicy:()=>({enabled:!1})}});let y=class extends((0,M.Vt)((0,n.Y)((0,u.q)((0,l.I)((0,f.M)((0,R.R)((0,a.N)((0,K.V)(_.Z))))))))){constructor(e){super(e),this.operationalLayerType="BuildingSceneLayer",this.allSublayers=new j.Z({getCollections:()=>[this.sublayers],getChildrenFunction:r=>"building-group"===r.type?r.sublayers:null}),this.sublayers=null,this._sublayerOverrides=null,this.filters=new fe,this.activeFilterId=null,this.summaryStatistics=null,this.outFields=null,this.legendEnabled=!0,this.type="building-scene"}normalizeCtorArgs(e){return"string"==typeof e?{url:e}:e??{}}destroy(){this.allSublayers.destroy()}readSublayers(e,r,o){const h=T.Z.readSublayers(e,r,o);return T.Z.forEachSublayer(h,ue=>ue.layer=this),this._sublayerOverrides&&(this.applySublayerOverrides(h,this._sublayerOverrides),this._sublayerOverrides=null),h}applySublayerOverrides(e,{overrides:r,context:o}){T.Z.forEachSublayer(e,h=>h.read(r.get(h.id),o))}readSublayerOverrides(e,r){const o=new Map;for(const h of e)null!=h&&"object"==typeof h&&"number"==typeof h.id?o.set(h.id,h):r.messages?.push(new O.Z("building-scene-layer:invalid-sublayer-override","Invalid value for sublayer override. Not an object or no id specified.",{value:h}));return{overrides:o,context:r}}writeSublayerOverrides(e,r,o){const h=[];T.Z.forEachSublayer(this.sublayers,ue=>{const me=ue.write({},o);Object.keys(me).length>1&&h.push(me)}),h.length>0&&(r.sublayers=h)}writeUnappliedOverrides(e,r){r.sublayers=[],e.overrides.forEach(o=>{r.sublayers.push((0,g.d9)(o))})}write(e,r){return e=super.write(e,r),!r||"web-scene"!==r.origin&&"portal-item"!==r.origin||(this.sublayers?this.writeSublayerOverrides(this.sublayers,e,r):this._sublayerOverrides&&this.writeUnappliedOverrides(this._sublayerOverrides,e)),e}read(e,r){if(super.read(e,r),r&&("web-scene"===r.origin||"portal-item"===r.origin)&&null!=e&&Array.isArray(e.sublayers)){const o=this.readSublayerOverrides(e.sublayers,r);this.sublayers?this.applySublayerOverrides(this.sublayers,o):this._sublayerOverrides=o}}readSummaryStatistics(e,r){if("string"==typeof r.statisticsHRef){const o=(0,x.v_)(this.parsedUrl?.path,r.statisticsHRef);return new ve({url:o})}return null}set elevationInfo(e){this._set("elevationInfo",e),this._validateElevationInfo()}load(e){const r=null!=e?e.signal:null,o=this.loadFromPortal({supportedTypes:["Scene Service"]},e).catch(A.r9).then(()=>this._fetchService(r)).then(()=>this._fetchAssociatedFeatureService(r));return this.addResolvingPromise(o),Promise.resolve(this)}loadAll(){return(0,d.G)(this,e=>{T.Z.forEachSublayer(this.sublayers,r=>{"building-group"!==r.type&&e(r)}),this.summaryStatistics&&e(this.summaryStatistics)})}saveAs(e,r){var o=this;return(0,m.Z)(function*(){return o._debouncedSaveOperations(M.xp.SAVE_AS,{...r,getTypeKeywords:()=>o._getTypeKeywords(),portalItemLayerType:"building-scene"},e)})()}save(){var e=this;return(0,m.Z)(function*(){const r={getTypeKeywords:()=>e._getTypeKeywords(),portalItemLayerType:"building-scene"};return e._debouncedSaveOperations(M.xp.SAVE,r)})()}validateLayer(e){if(!e.layerType||"Building"!==e.layerType)throw new O.Z("buildingscenelayer:layer-type-not-supported","BuildingSceneLayer does not support this layer type",{layerType:e.layerType})}_getTypeKeywords(){return["Building"]}_fetchAssociatedFeatureService(e){var r=this;return(0,m.Z)(function*(){try{const{portalItem:o}=yield(0,H.w)(`${r.url}/layers/${r.layerId}`,{sceneLayerItem:r.portalItem,customParameters:r.customParameters,apiKey:r.apiKey,signal:e});r.associatedFeatureServiceItem=o}catch(o){v.Z.getLogger(r).warn("Associated feature service item could not be loaded",o)}})()}_validateElevationInfo(){const e=this.elevationInfo,r="Building scene layers";(0,ee.LR)(v.Z.getLogger(this),(0,ee.Uy)(r,"absolute-height",e)),(0,ee.LR)(v.Z.getLogger(this),(0,ee.kf)(r,e))}};(0,t._)([(0,s.Cb)({type:["BuildingSceneLayer"]})],y.prototype,"operationalLayerType",void 0),(0,t._)([(0,s.Cb)({readOnly:!0})],y.prototype,"allSublayers",void 0),(0,t._)([(0,s.Cb)(ge)],y.prototype,"sublayers",void 0),(0,t._)([(0,F.r)("service","sublayers")],y.prototype,"readSublayers",null),(0,t._)([(0,s.Cb)({type:fe,nonNullable:!0,json:{write:!0}})],y.prototype,"filters",void 0),(0,t._)([(0,s.Cb)({type:String,json:{write:!0}})],y.prototype,"activeFilterId",void 0),(0,t._)([(0,s.Cb)({readOnly:!0,type:ve})],y.prototype,"summaryStatistics",void 0),(0,t._)([(0,F.r)("summaryStatistics",["statisticsHRef"])],y.prototype,"readSummaryStatistics",null),(0,t._)([(0,s.Cb)({type:[String],json:{read:!1}})],y.prototype,"outFields",void 0),(0,t._)([(0,s.Cb)(q.vg)],y.prototype,"fullExtent",void 0),(0,t._)([(0,s.Cb)(q.rn)],y.prototype,"legendEnabled",void 0),(0,t._)([(0,s.Cb)({type:["show","hide","hide-children"]})],y.prototype,"listMode",void 0),(0,t._)([(0,s.Cb)((0,q.Lx)(c.Z))],y.prototype,"spatialReference",void 0),(0,t._)([(0,s.Cb)(q.PV)],y.prototype,"elevationInfo",null),(0,t._)([(0,s.Cb)({json:{read:!1},readOnly:!0})],y.prototype,"type",void 0),(0,t._)([(0,s.Cb)()],y.prototype,"associatedFeatureServiceItem",void 0),y=(0,t._)([(0,p.j)("esri.layers.BuildingSceneLayer")],y);const Pe=y},39593:(de,U,i)=>{i.d(U,{w:()=>R});var m=i(15861),t=i(24263),I=i(84792),j=i(26584),O=i(10699),g=i(38305),d=i(31099),v=i(55463);function R(n,a){return A.apply(this,arguments)}function A(){return A=(0,m.Z)(function*(n,a){const u=(0,g.Qc)(n);if(!u)throw new j.Z("invalid-url","Invalid scene service url");const l={...a,sceneServerUrl:u.url.path,layerId:u.sublayer??void 0};if(l.sceneLayerItem??=(yield function x(n){return s.apply(this,arguments)}(l)),null==l.sceneLayerItem)return _(l.sceneServerUrl.replace("/SceneServer","/FeatureServer"),l);const f=yield function T(n){return K.apply(this,arguments)}(l);if(!f?.url)throw new j.Z("related-service-not-found","Could not find feature service through portal item relationship");l.featureServiceItem=f;const M=yield _(f.url,l);return M.portalItem=f,M}),A.apply(this,arguments)}function s(){return s=(0,m.Z)(function*(n){const a=(yield E(n)).serviceItemId;if(!a)return null;const u=new v.default({id:a,apiKey:n.apiKey}),l=yield function p(n){return c.apply(this,arguments)}(n);null!=l&&(u.portal=new d.Z({url:l}));try{return u.load({signal:n.signal})}catch(f){return(0,O.r9)(f),null}}),s.apply(this,arguments)}function E(n){return F.apply(this,arguments)}function F(){return(F=(0,m.Z)(function*(n){if(n.rootDocument)return n.rootDocument;const a={query:{f:"json",...n.customParameters,token:n.apiKey},responseType:"json",signal:n.signal};try{const u=yield(0,I.Z)(n.sceneServerUrl,a);n.rootDocument=u.data}catch{n.rootDocument={}}return n.rootDocument})).apply(this,arguments)}function c(){return(c=(0,m.Z)(function*(n){const a=t.id?.findServerInfo(n.sceneServerUrl);if(a?.owningSystemUrl)return a.owningSystemUrl;const u=n.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const l=(yield(0,I.Z)(u,{query:{f:"json"},responseType:"json",signal:n.signal})).data.owningSystemUrl;if(l)return l}catch(l){(0,O.r9)(l)}return null})).apply(this,arguments)}function _(n,a){return b.apply(this,arguments)}function b(){return(b=(0,m.Z)(function*(n,a){const u=(0,g.Qc)(n);if(!u)throw new j.Z("invalid-feature-service-url","Invalid feature service url");const l=u.url.path,f=a.layerId;if(null==f)return{serverUrl:l};const M=E(a),H=a.featureServiceItem?yield a.featureServiceItem.fetchData("json"):null,B=(H?.layers?.[0]||H?.tables?.[0])?.customParameters,J=P=>{const N={query:{f:"json",...B},responseType:"json",authMode:P,signal:a.signal};return(0,I.Z)(l,N)},ye=J("anonymous").catch(()=>J("no-prompt")),[Z,z]=yield Promise.all([ye,M]),L=z?.layers,S=Z.data&&Z.data.layers;if(!Array.isArray(S))throw new Error("expected layers array");if(Array.isArray(L)){for(let P=0;P<Math.min(L.length,S.length);P++)if(L[P].id===f)return{serverUrl:l,layerId:S[P].id}}else if(null!=f&&f<S.length)return{serverUrl:l,layerId:S[f].id};throw new Error("could not find matching associated sublayer")})).apply(this,arguments)}function K(){return(K=(0,m.Z)(function*({sceneLayerItem:n,signal:a}){if(!n)return null;try{const u=(yield n.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:a})).find(f=>"Feature Service"===f.type)||null;if(!u)return null;const l=new v.default({portal:u.portal,id:u.id});return yield l.load(),l}catch(u){return(0,O.r9)(u),null}})).apply(this,arguments)}},10023:(de,U,i)=>{i.d(U,{V5:()=>O,e7:()=>I,zc:()=>g});var m=i(15861),t=i(90194);function I(d){return j.apply(this,arguments)}function j(){return(j=(0,m.Z)(function*(d,v=d.popupTemplate){if(null==v)return[];const R=yield v.getRequiredFields(d.fieldsIndex),{lastEditInfoEnabled:A}=v,{objectIdField:x,typeIdField:s,globalIdField:E,relationships:F}=d;if(R.includes("*"))return["*"];const p=A?(0,t.CH)(d):[],c=(0,t.Q0)(d.fieldsIndex,[...R,...p]);return s&&c.push(s),c&&x&&d.fieldsIndex?.has(x)&&!c.includes(x)&&c.push(x),c&&E&&d.fieldsIndex?.has(E)&&!c.includes(E)&&c.push(E),F&&F.forEach(_=>{const{keyField:b}=_;c&&b&&d.fieldsIndex?.has(b)&&!c.includes(b)&&c.push(b)}),c})).apply(this,arguments)}function O(d,v){return d.popupTemplate?d.popupTemplate:null!=v&&v.defaultPopupTemplateEnabled&&null!=d.defaultPopupTemplate?d.defaultPopupTemplate:null}function g(d,v){return null!=O(d,{defaultPopupTemplateEnabled:v})}}}]);