"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[7007,5919,5994],{25919:(X,Q,y)=>{var c,a;y.d(Q,{Hy:()=>z,OF:()=>U,TD:()=>B,Tu:()=>E,VO:()=>Z,aV:()=>w,kq:()=>C,rH:()=>c}),(a=c||(c={})).AsyncNotEnabled="AsyncNotEnabled",a.ModulesNotSupported="ModulesNotSupported",a.CircularModules="CircularModules",a.NeverReach="NeverReach",a.UnsupportedHashType="UnsupportedHashType",a.InvalidParameter="InvalidParameter",a.UnexpectedToken="UnexpectedToken",a.Unrecognised="Unrecognised",a.UnrecognisedType="UnrecognisedType",a.MaximumCallDepth="MaximumCallDepth",a.BooleanConditionRequired="BooleanConditionRequired",a.TypeNotAllowedInFeature="TypeNotAllowedInFeature",a.KeyMustBeString="KeyMustBeString",a.WrongNumberOfParameters="WrongNumberOfParameters",a.CallNonFunction="CallNonFunction",a.NoFunctionInTemplateLiteral="NoFunctionInTemplateLiteral",a.NoFunctionInDictionary="NoFunctionInDictionary",a.NoFunctionInArray="NoFunctionInArray",a.AssignModuleFunction="AssignModuleFunction",a.LogicExpressionOrAnd="LogicExpressionOrAnd",a.LogicalExpressionOnlyBoolean="LogicalExpressionOnlyBoolean",a.FuncionNotFound="FunctionNotFound",a.InvalidMemberAccessKey="InvalidMemberAccessKey",a.UnsupportedUnaryOperator="UnsupportUnaryOperator",a.InvalidIdentifier="InvalidIdentifier",a.MemberOfNull="MemberOfNull",a.UnsupportedOperator="UnsupportedOperator",a.Cancelled="Cancelled",a.ModuleAccessorMustBeString="ModuleAccessorMustBeString",a.ModuleExportNotFound="ModuleExportNotFound",a.Immutable="Immutable",a.OutOfBounds="OutOfBounds",a.IllegalResult="IllegalResult",a.FieldNotFound="FieldNotFound",a.PortalRequired="PortalRequired",a.LogicError="LogicError",a.ArrayAccessorMustBeNumber="ArrayAccessMustBeNumber",a.KeyAccessorMustBeString="KeyAccessorMustBeString",a.WrongSpatialReference="WrongSpatialReference";const G={[c.TypeNotAllowedInFeature]:"Feature attributes only support dates, numbers, strings, guids.",[c.LogicError]:"Logic error - {reason}",[c.NeverReach]:"Encountered unreachable logic",[c.AsyncNotEnabled]:"Async Arcade must be enabled for this script",[c.ModuleAccessorMustBeString]:"Module accessor must be a string",[c.ModuleExportNotFound]:"Module has no export with provided identifier",[c.ModulesNotSupported]:"Current profile does not support modules",[c.ArrayAccessorMustBeNumber]:"Array accessor must be a number",[c.FuncionNotFound]:"Function not found",[c.FieldNotFound]:"Key not found - {key}",[c.CircularModules]:"Circular module dependencies are not allowed",[c.Cancelled]:"Execution cancelled",[c.UnsupportedHashType]:"Type not supported in hash function",[c.IllegalResult]:"Value is not a supported return type",[c.PortalRequired]:"Portal is required",[c.InvalidParameter]:"Invalid parameter",[c.WrongNumberOfParameters]:"Call with wrong number of parameters",[c.Unrecognised]:"Unrecognised code structure",[c.UnrecognisedType]:"Unrecognised type",[c.WrongSpatialReference]:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",[c.BooleanConditionRequired]:"Conditions must use booleans",[c.NoFunctionInDictionary]:"Dictionaries cannot contain functions.",[c.NoFunctionInArray]:"Arrays cannot contain functions.",[c.NoFunctionInTemplateLiteral]:"Template Literals do not expect functions by value.",[c.KeyAccessorMustBeString]:"Accessor must be a string",[c.KeyMustBeString]:"Object keys must be a string",[c.Immutable]:"Object is immutable",[c.InvalidParameter]:"Invalid parameter",[c.UnexpectedToken]:"Unexpected token",[c.MemberOfNull]:"Cannot access property of null object",[c.MaximumCallDepth]:"Exceeded maximum function depth",[c.OutOfBounds]:"Out of bounds",[c.InvalidIdentifier]:"Identifier not recognised",[c.FuncionNotFound]:"Function not found",[c.CallNonFunction]:"Expression is not a function",[c.InvalidMemberAccessKey]:"Cannot access value using a key of this type",[c.AssignModuleFunction]:"Cannot assign function to module variable",[c.UnsupportedUnaryOperator]:"Unsupported unary operator",[c.UnsupportedOperator]:"Unsupported operator",[c.LogicalExpressionOnlyBoolean]:"Logical expressions must be boolean",[c.LogicExpressionOrAnd]:"Logical expression can only be combined with || or &&"};class j extends Error{constructor(...h){super(...h)}}class L extends j{constructor(h,u){super(N(u)+h.message,{cause:h}),this.loc=null,Error.captureStackTrace&&Error.captureStackTrace(this,L),u&&u.loc&&(this.loc=u.loc)}}class w extends Error{constructor(h,u,_,g){super("Execution error - "+N(_)+z(G[u],g)),this.loc=null,this.declaredRootClass="esri.arcade.arcadeexecutionerror",Error.captureStackTrace&&Error.captureStackTrace(this,w),_&&_.loc&&(this.loc=_.loc)}}function N(a){return a&&a.loc?`Line : ${a.loc.start?.line}, ${a.loc.start?.column}: `:""}class U extends Error{constructor(h,u,_,g){super("Compilation error - "+N(_)+z(G[u],g)),this.loc=null,this.declaredRootClass="esri.arcade.arcadecompilationerror",Error.captureStackTrace&&Error.captureStackTrace(this,U),_&&_.loc&&(this.loc=_.loc)}}class C extends Error{constructor(){super("Uncompilable code structures"),this.declaredRootClass="esri.arcade.arcadeuncompilableerror",Error.captureStackTrace&&Error.captureStackTrace(this,C)}}function z(a,h){try{if(!h)return a;for(const u in h){let _=h[u];_||(_=""),a=a.replace("{"+u+"}",h[u])}}catch{}return a}function Z(a,h,u){return"esri.arcade.arcadeexecutionerror"===u.declaredRootClass||"esri.arcade.arcadecompilationerror"===u.declaredRootClass?null===u.loc&&h&&h.loc?new L(u,{cause:u}):u:h&&h.loc?new L(u,{cause:u}):u}var B;!function(a){a.UnrecognisedUri="UnrecognisedUri",a.UnsupportedUriProtocol="UnsupportedUriProtocol"}(B||(B={}));const b={[B.UnrecognisedUri]:"Unrecognised uri - {uri}",[B.UnsupportedUriProtocol]:"Unrecognised uri protocol"};class E extends Error{constructor(h,u){super(z(b[h],u)),this.declaredRootClass="esri.arcade.arcademoduleerror",Error.captureStackTrace&&Error.captureStackTrace(this,E)}}},15994:(X,Q,y)=>{y.d(Q,{N:()=>c});const c={convertToGEGeometry:function G(E,x){return null==x?null:E.convertJSONToGeometry(x)},exportPoint:function L(E,x,a){const h=new j(E.getPointX(x),E.getPointY(x),a),u=E.hasZ(x),_=E.hasM(x);return u&&(h.z=E.getPointZ(x)),_&&(h.m=E.getPointM(x)),h},exportPolygon:function N(E,x,a){return new w(E.exportPaths(x),a,E.hasZ(x),E.hasM(x))},exportPolyline:function C(E,x,a){return new U(E.exportPaths(x),a,E.hasZ(x),E.hasM(x))},exportMultipoint:function Z(E,x,a){return new z(E.exportPoints(x),a,E.hasZ(x),E.hasM(x))},exportExtent:function b(E,x,a){const h=E.hasZ(x),u=E.hasM(x),_=new B(E.getXMin(x),E.getYMin(x),E.getXMax(x),E.getYMax(x),a);if(h){const g=E.getZExtent(x);_.zmin=g.vmin,_.zmax=g.vmax}if(u){const g=E.getMExtent(x);_.mmin=g.vmin,_.mmax=g.vmax}return _}};class j{constructor(x,a,h){this.x=x,this.y=a,this.spatialReference=h,this.z=void 0,this.m=void 0}}class w{constructor(x,a,h,u){this.rings=x,this.spatialReference=a,this.hasZ=void 0,this.hasM=void 0,h&&(this.hasZ=h),u&&(this.hasM=u)}}class U{constructor(x,a,h,u){this.paths=x,this.spatialReference=a,this.hasZ=void 0,this.hasM=void 0,h&&(this.hasZ=h),u&&(this.hasM=u)}}class z{constructor(x,a,h,u){this.points=x,this.spatialReference=a,this.hasZ=void 0,this.hasM=void 0,h&&(this.hasZ=h),u&&(this.hasM=u)}}class B{constructor(x,a,h,u,_){this.xmin=x,this.ymin=a,this.xmax=h,this.ymax=u,this.spatialReference=_,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},83308:(X,Q,y)=>{y.d(Q,{y:()=>a,r:()=>_});var c=y(15861),G=y(62208),j=y(27105),L=y(15176),w=y(7848),N=y(37053),U=y(50736),C=y(26072);class z{constructor(e,t,i){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues??!1,this.fieldsIndex=i,this.featureAdapter=t;const n=e.outFields;if(n&&!n.includes("*")){this.outFields=n;let r=0;for(const l of n){const d=(0,U.hr)(l),f=this.fieldsIndex.get(d),v=f?null:(0,U.Jc)(d,i),R=f?f.name:(0,U.nu)(l)||"FIELD_EXP_"+r++;this._fieldDataCache.set(l,{alias:R,clause:v})}}}countDistinctValues(e){return this.returnDistinctValues?(e.forEach(t=>this.getAttributes(t)),this._returnDistinctMap.size):e.length}getAttributes(e){const t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}getFieldValue(e,t,i){const n=i?i.name:t;let r=null;return this._fieldDataCache.has(n)?r=this._fieldDataCache.get(n)?.clause:i||(r=(0,U.Jc)(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:r})),i?this.featureAdapter.getAttribute(e,n):r?.calculateValue(e,this.featureAdapter)}getDataValue(e,t){const i=t.normalizationType,n=t.normalizationTotal;let r=t.field&&this.getFieldValue(e,t.field,this.fieldsIndex.get(t.field));if(t.field2&&(r=`${(0,C.wk)(r)}${t.fieldDelimiter}${(0,C.wk)(this.getFieldValue(e,t.field2,this.fieldsIndex.get(t.field2)))}`,t.field3&&(r=`${r}${t.fieldDelimiter}${(0,C.wk)(this.getFieldValue(e,t.field3,this.fieldsIndex.get(t.field3)))}`)),i&&Number.isFinite(r)){const l="field"===i&&t.normalizationField?this.getFieldValue(e,t.normalizationField,this.fieldsIndex.get(t.normalizationField)):null;r=(0,C.fk)(r,i,l,n)}return r}getExpressionValue(e,t,i,n){const r={attributes:this.featureAdapter.getAttributes(e),layer:{fields:this.fieldsIndex.fields}},l=n.createExecContext(r,i);return n.executeFunction(t,l)}getExpressionValues(e,t,i,n){const r={fields:this.fieldsIndex.fields};return e.map(l=>{const d={attributes:this.featureAdapter.getAttributes(l),layer:r},f=n.createExecContext(d,i);return n.executeFunction(t,f)})}validateItem(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:(0,U.Jc)(t,this.fieldsIndex)}),this._fieldDataCache.get(t)?.clause?.testFeature(e,this.featureAdapter)??!1}validateItems(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:(0,U.Jc)(t,this.fieldsIndex)}),this._fieldDataCache.get(t)?.clause?.testSet(e,this.featureAdapter)??!1}_processAttributesForOutFields(e){const t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);const i={};for(const n of t){const{alias:r,clause:l}=this._fieldDataCache.get(n);i[r]=l?l.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,r)}return i}_processAttributesForDistinctValues(e){if((0,G.Wi)(e)||!this.returnDistinctValues)return e;const t=this.outFields,i=[];if(t)for(const l of t){const{alias:d}=this._fieldDataCache.get(l);i.push(e[d])}else for(const l in e)i.push(e[l]);const n=`${(t||["*"]).join(",")}=${i.join(",")}`;let r=this._returnDistinctMap.get(n)||0;return this._returnDistinctMap.set(n,++r),r>1?null:e}}var _,o,Z=y(82959),B=y(82141),b=y(6185),E=y(36630),x=y(46679);class a{constructor(e,t,i){this.items=e,this.query=t,this.geometryType=i.geometryType,this.hasM=i.hasM,this.hasZ=i.hasZ,this.fieldsIndex=i.fieldsIndex,this.objectIdField=i.objectIdField,this.spatialReference=i.spatialReference,this.featureAdapter=i.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const e=new z(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return e.countDistinctValues(this.items);const{groupByFieldsForStatistics:t,having:i,outStatistics:n}=this.query;if(!t?.length)return 1;const l=new Map,d=new Map,f=new Set;for(const v of n){const{statisticType:R}=v,D="exceedslimit"!==R?v.onStatisticField:void 0;if(!d.has(D)){const P=[];for(const s of t){const m=this._getAttributeValues(e,s,l);P.push(m)}d.set(D,this._calculateUniqueValues(P,e.returnDistinctValues))}const O=d.get(D);for(const P in O){const{data:s,items:m}=O[P],I=s.join(",");i&&!e.validateItems(m,i)||f.add(I)}}return f.size}createQueryResponse(){var e=this;return(0,c.Z)(function*(){let t;if(t=e.query.outStatistics?e.query.outStatistics.some(i=>"exceedslimit"===i.statisticType)?e._createExceedsLimitQueryResponse(e.query):yield e._createStatisticsQueryResponse(e.query):e._createFeatureQueryResponse(e.query),e.query.returnQueryGeometry){const i=e.query.geometry;t.queryGeometry=(0,N.JY)(e.query.outSR)&&!(0,N.fS)(i.spatialReference,e.query.outSR)?(0,b.S2)({spatialReference:e.query.outSR,...(0,Z.iV)(i,i.spatialReference,e.query.outSR)}):(0,b.S2)({spatialReference:e.query.outSR,...i})}return t})()}createSnappingResponse(e,t){const i=this.featureAdapter,n=u(this.hasZ,this.hasM),{point:r,mode:l}=e,d="number"==typeof e.distance?e.distance:e.distance.x,f="number"==typeof e.distance?e.distance:e.distance.y,v={candidates:[]},R="esriGeometryPolygon"===this.geometryType,D=this._getPointCreator(l,this.spatialReference,t),O=new g(null,0),P=new g(null,0),s={x:0,y:0,z:0};for(const m of this.items){const I=i.getGeometry(m);if((0,G.Wi)(I))continue;const{coords:M,lengths:T}=I;if(O.coords=M,P.coords=M,e.types&_.EDGE){let S=0;for(let A=0;A<T.length;A++){const p=T[A];for(let F=0;F<p;F++,S+=n){const V=O;if(V.coordsIndex=S,F!==p-1){const W=P;W.coordsIndex=S+n;const K=s;h(s,r,V,W);const k=(r.x-K.x)/d,Y=(r.y-K.y)/f,J=k*k+Y*Y;J<=1&&v.candidates.push((0,B.p)(i.getObjectId(m),D(K),Math.sqrt(J),D(V),D(W)))}}}}if(e.types&_.VERTEX){const S=R?M.length-n:M.length;for(let A=0;A<S;A+=n){const p=O;p.coordsIndex=A;const F=(r.x-p.x)/d,V=(r.y-p.y)/f,W=F*F+V*V;W<=1&&v.candidates.push((0,B.u)(i.getObjectId(m),D(p),Math.sqrt(W)))}}}return v.candidates.sort((m,I)=>m.distance-I.distance),v}_getPointCreator(e,t,i){const n=(0,G.pC)(i)&&!(0,N.fS)(t,i)?d=>(0,Z.iV)(d,t,i):d=>d,{hasZ:r}=this;return"3d"===e?r?({x:d,y:f,z:v})=>n({x:d,y:f,z:v}):({x:d,y:f})=>n({x:d,y:f,z:0}):({x:d,y:f})=>n({x:d,y:f})}createSummaryStatisticsResponse(e){var t=this;return(0,c.Z)(function*(){const{field:i,valueExpression:n,normalizationField:r,normalizationType:l,normalizationTotal:d,minValue:f,maxValue:v,scale:R}=e,D=t.fieldsIndex.isDateField(i),O=yield t._getDataValues({field:i,valueExpression:n,normalizationField:r,normalizationType:l,normalizationTotal:d,scale:R}),P=(0,C.S5)({normalizationType:l,normalizationField:r,minValue:f,maxValue:v}),s=t.fieldsIndex.get(i),m={value:.5,fieldType:s?.type},I=(0,E.qN)(s)?(0,C.H0)({values:O,supportsNullCount:P,percentileParams:m}):(0,C.i5)({values:O,minValue:f,maxValue:v,useSampleStdDev:!l,supportsNullCount:P,percentileParams:m});return(0,C.F_)(I,D)})()}createUniqueValuesResponse(e){var t=this;return(0,c.Z)(function*(){const{field:i,valueExpression:n,domains:r,returnAllCodedValues:l,scale:d}=e,f=yield t._getDataValues({field:i,field2:e.field2,field3:e.field3,fieldDelimiter:e.fieldDelimiter,valueExpression:n,scale:d}),v=(0,C.eT)(f);return(0,C.Qm)(v,r,l,e.fieldDelimiter)})()}createClassBreaksResponse(e){var t=this;return(0,c.Z)(function*(){const{field:i,valueExpression:n,normalizationField:r,normalizationType:l,normalizationTotal:d,classificationMethod:f,standardDeviationInterval:v,minValue:R,maxValue:D,numClasses:O,scale:P}=e,s=yield t._getDataValues({field:i,valueExpression:n,normalizationField:r,normalizationType:l,normalizationTotal:d,scale:P}),m=(0,C.G2)(s,{field:i,normalizationField:r,normalizationType:l,normalizationTotal:d,classificationMethod:f,standardDeviationInterval:v,minValue:R,maxValue:D,numClasses:O});return(0,C.DL)(m,f)})()}createHistogramResponse(e){var t=this;return(0,c.Z)(function*(){const{field:i,valueExpression:n,normalizationField:r,normalizationType:l,normalizationTotal:d,classificationMethod:f,standardDeviationInterval:v,minValue:R,maxValue:D,numBins:O,scale:P}=e,s=yield t._getDataValues({field:i,valueExpression:n,normalizationField:r,normalizationType:l,normalizationTotal:d,scale:P});return(0,C.oF)(s,{field:i,normalizationField:r,normalizationType:l,normalizationTotal:d,classificationMethod:f,standardDeviationInterval:v,minValue:R,maxValue:D,numBins:O})})()}_sortFeatures(e,t,i){if(e.length>1&&t&&t.length)for(const n of t.reverse()){const r=n.split(" "),l=r[0],d=this.fieldsIndex.get(l),f=!!r[1]&&"desc"===r[1].toLowerCase(),v=(0,C.Lq)(d?.type,f);e.sort((R,D)=>{const O=i(R,l,d),P=i(D,l,d);return v(O,P)})}}_createFeatureQueryResponse(e){const t=this.items,{geometryType:i,hasM:n,hasZ:r,objectIdField:l,spatialReference:d}=this,{outFields:f,outSR:v,quantizationParameters:R,resultRecordCount:D,resultOffset:O,returnZ:P,returnM:s}=e,m=null!=D&&t.length>(O||0)+D,I=f&&(f.includes("*")?[...this.fieldsIndex.fields]:f.map(M=>this.fieldsIndex.get(M)));return{exceededTransferLimit:m,features:this._createFeatures(e,t),fields:I,geometryType:i,hasM:n&&s,hasZ:r&&P,objectIdFieldName:l,spatialReference:(0,b.S2)(v||d),transform:R&&(0,w.vY)(R)||null}}_createFeatures(e,t){const i=new z(e,this.featureAdapter,this.fieldsIndex),{hasM:n,hasZ:r}=this,{orderByFields:l,quantizationParameters:d,returnGeometry:f,returnCentroid:v,maxAllowableOffset:R,resultOffset:D,resultRecordCount:O,returnZ:P=!1,returnM:s=!1}=e,m=r&&P,I=n&&s;let M=[],T=0;const S=[...t];if(this._sortFeatures(S,l,(p,F,V)=>i.getFieldValue(p,F,V)),f||v){const p=(0,w.vY)(d)??void 0;if(f&&!v)for(const F of S)M[T++]={attributes:i.getAttributes(F),geometry:(0,b.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(F),R,p,m,I)};else if(!f&&v)for(const F of S)M[T++]={attributes:i.getAttributes(F),centroid:(0,b.EG)(this,this.featureAdapter.getCentroid(F,this),p)};else for(const F of S)M[T++]={attributes:i.getAttributes(F),centroid:(0,b.EG)(this,this.featureAdapter.getCentroid(F,this),p),geometry:(0,b.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(F),R,p,m,I)}}else for(const p of S){const F=i.getAttributes(p);F&&(M[T++]={attributes:F})}const A=D||0;return null!=O&&(M=M.slice(A,Math.min(M.length,A+O))),M}_createExceedsLimitQueryResponse(e){let t=!1,i=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY;for(const l of e.outStatistics??[])if("exceedslimit"===l.statisticType){i=null!=l.maxPointCount?l.maxPointCount:Number.POSITIVE_INFINITY,n=null!=l.maxRecordCount?l.maxRecordCount:Number.POSITIVE_INFINITY,r=null!=l.maxVertexCount?l.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)t=this.items.length>i;else if(this.items.length>n)t=!0;else{const l=u(this.hasZ,this.hasM),d=this.featureAdapter;t=this.items.reduce((f,v)=>{const R=d.getGeometry(v);return f+((0,G.pC)(R)&&R.coords.length||0)},0)/l>r}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}}_createStatisticsQueryResponse(e){var t=this;return(0,c.Z)(function*(){const i={attributes:{}},n=[],r=new Map,l=new Map,d=new Map,f=new Map,v=new z(e,t.featureAdapter,t.fieldsIndex),R=e.outStatistics,{groupByFieldsForStatistics:D,having:O,orderByFields:P}=e,s=D&&D.length,m=!!s,I=m?D[0]:null,M=m&&!t.fieldsIndex.get(I);for(const S of R??[]){const{outStatisticFieldName:A,statisticType:p}=S,F=S,V="exceedslimit"!==p?S.onStatisticField:void 0,W="percentile_disc"===p||"percentile_cont"===p,K="EnvelopeAggregate"===p||"CentroidAggregate"===p||"ConvexHullAggregate"===p,k=m&&1===s&&(V===I||M)&&"count"===p;if(m){if(!d.has(V)){const J=[];for(const te of D){const ee=t._getAttributeValues(v,te,r);J.push(ee)}d.set(V,t._calculateUniqueValues(J,!K&&v.returnDistinctValues))}const Y=d.get(V);for(const J in Y){const{count:te,data:ee,items:ie,itemPositions:re}=Y[J],se=ee.join(",");if(!O||v.validateItems(ie,O)){const $=f.get(se)||{attributes:{}};if(K){$.aggregateGeometries||($.aggregateGeometries={});const{aggregateGeometries:H,outStatisticFieldName:q}=yield t._getAggregateGeometry(F,ie);$.aggregateGeometries[q]=H}else{let H=null;if(k)H=te;else{const q=t._getAttributeValues(v,V,r),ne=re.map(oe=>q[oe]);H=W&&"statisticParameters"in F?t._getPercentileValue(F,ne):t._getStatisticValue(F,ne,null,v.returnDistinctValues)}$.attributes[A]=H}let ae=0;D.forEach((H,q)=>$.attributes[t.fieldsIndex.get(H)?H:"EXPR_"+ ++ae]=ee[q]),f.set(se,$)}}}else if(K){i.aggregateGeometries||(i.aggregateGeometries={});const{aggregateGeometries:Y,outStatisticFieldName:J}=yield t._getAggregateGeometry(F,t.items);i.aggregateGeometries[J]=Y}else{const Y=t._getAttributeValues(v,V,r);i.attributes[A]=W&&"statisticParameters"in F?t._getPercentileValue(F,Y):t._getStatisticValue(F,Y,l,v.returnDistinctValues)}n.push({name:A,alias:A,type:"esriFieldTypeDouble"})}const T=m?Array.from(f.values()):[i];return t._sortFeatures(T,P,(S,A)=>S.attributes[A]),{fields:n,features:T}})()}_getAggregateGeometry(e,t){var i=this;return(0,c.Z)(function*(){const n=yield Promise.all([y.e(4918),y.e(8592)]).then(y.bind(y,32825)),{statisticType:r,outStatisticFieldName:l}=e,{featureAdapter:d,spatialReference:f,geometryType:v,hasZ:R,hasM:D}=i,O=t.map(m=>(0,b.Op)(v,R,D,d.getGeometry(m))),P=n.convexHull(f,O,!0)[0],s={aggregateGeometries:null,outStatisticFieldName:null};if("EnvelopeAggregate"===r){const m=P?(0,L._w)(P):(0,L.aO)(n.union(f,O));s.aggregateGeometries={...m,spatialReference:f},s.outStatisticFieldName=l||"extent"}else if("CentroidAggregate"===r){const m=P?(0,j.tO)(P):(0,j.$G)((0,L.aO)(n.union(f,O)));s.aggregateGeometries={x:m[0],y:m[1],spatialReference:f},s.outStatisticFieldName=l||"centroid"}else"ConvexHullAggregate"===r&&(s.aggregateGeometries=P,s.outStatisticFieldName=l||"convexHull");return s})()}_getStatisticValue(e,t,i,n){const{onStatisticField:r,statisticType:l}=e;let d=null;return d=i?.has(r)?i.get(r):(0,E.qN)(this.fieldsIndex.get(r))?(0,C.H0)({values:t,returnDistinct:n}):(0,C.i5)({values:n?[...new Set(t)]:t,minValue:null,maxValue:null,useSampleStdDev:!0}),i&&i.set(r,d),d["var"===l?"variance":l]}_getPercentileValue(e,t){const{onStatisticField:i,statisticParameters:n,statisticType:r}=e,{value:l,orderBy:d}=n,f=this.fieldsIndex.get(i);return(0,C.XL)(t,{value:l,orderBy:d,fieldType:f?.type,isDiscrete:"percentile_disc"===r})}_getAttributeValues(e,t,i){if(i.has(t))return i.get(t);const n=this.fieldsIndex.get(t),r=this.items.map(l=>e.getFieldValue(l,t,n));return i.set(t,r),r}_getAttributeDataValues(e,t){return this.items.map(i=>e.getDataValue(i,{field:t.field,field2:t.field2,field3:t.field3,fieldDelimiter:t.fieldDelimiter,normalizationField:t.normalizationField,normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal}))}_getAttributeExpressionValues(e,t,i){var n=this;return(0,c.Z)(function*(){const{arcadeUtils:r}=yield(0,x.LC)(),l=r.createFunction(t),d=i&&r.getViewInfo(i);return e.getExpressionValues(n.items,l,d,r)})()}_calculateUniqueValues(e,t){const i={},n=this.items,r=n.length;for(let l=0;l<r;l++){const d=n[l],f=[];for(const R of e)f.push(R[l]);const v=f.join(",");null==i[v]?i[v]={count:1,data:f,items:[d],itemPositions:[l]}:(t||i[v].count++,i[v].items.push(d),i[v].itemPositions.push(l))}return i}_getDataValues(e){var t=this;return(0,c.Z)(function*(){const i=new z(t.query,t.featureAdapter,t.fieldsIndex),{valueExpression:n,field:r,normalizationField:l,normalizationType:d,normalizationTotal:f,scale:v}=e;return n?t._getAttributeExpressionValues(i,n,n?{viewingMode:"map",scale:v,spatialReference:t.query.outSR||t.spatialReference}:null):t._getAttributeDataValues(i,{field:r,field2:e.field2,field3:e.field3,fieldDelimiter:e.fieldDelimiter,normalizationField:l,normalizationType:d,normalizationTotal:f})})()}}function h(o,e,t,i){const n=i.x-t.x,r=i.y-t.y,f=Math.min(1,Math.max(0,((e.x-t.x)*n+(e.y-t.y)*r)/(n*n+r*r)));o.x=t.x+n*f,o.y=t.y+r*f}function u(o,e){return o?e?4:3:e?3:2}(o=_||(_={}))[o.NONE=0]="NONE",o[o.EDGE=1]="EDGE",o[o.VERTEX=2]="VERTEX";class g{constructor(e,t){this.coords=e,this.coordsIndex=t}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}},50736:(X,Q,y)=>{y.d(Q,{nu:()=>x,hr:()=>E,Jc:()=>B,G3:()=>a,Of:()=>b,z4:()=>Z,hO:()=>z});var c=y(26584),G=y(78498),j=y(10410);const w=new class L{constructor(u,_){this._cache=new G.Z(u),this._invalidCache=new G.Z(_)}get(u,_){const g=`${_.uid}:${u}`,o=this._cache.get(g);if(o)return o;if(void 0!==this._invalidCache.get(g))return null;try{const e=j.WhereClause.create(u,_);return this._cache.put(g,e),e}catch{return this._invalidCache.put(g,null),null}}}(50,500),N="feature-store:unsupported-query",U=" as ",C=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function z(h,u){if(!u)return!0;const _=w.get(u,h);if(!_)throw new c.Z(N,"invalid SQL expression",{where:u});if(!_.isStandardized)throw new c.Z(N,"where clause is not standard",{where:u});return b(h,_.fieldNames,"where clause contains missing fields"),!0}function Z(h,u,_){if(!u)return!0;const g=w.get(u,h);if(!g)throw new c.Z(N,"invalid SQL expression",{having:u});if(!g.isAggregate)throw new c.Z(N,"having does not contain a valid aggregate function",{having:u});if(b(h,g.fieldNames,"having contains missing fields"),!g.getExpressions().every(e=>{const{aggregateType:t,field:i}=e,n=h.get(i)?.name;return _.some(r=>{const{onStatisticField:l,statisticType:d}=r;return h.get(l)?.name===n&&d.toLowerCase().trim()===t})}))throw new c.Z(N,"expressions in having should also exist in outStatistics",{having:u});return!0}function B(h,u){return h?w.get(h,u):null}function b(h,u,_,g=!0){const o=[];for(const e of u)if("*"!==e&&!h.has(e))if(g){const t=E(e);try{const i=B(t,h);if(!i)throw new c.Z(N,"invalid SQL expression",{where:t});if(!i.isStandardized)throw new c.Z(N,"expression is not standard",{clause:i});b(h,i.fieldNames,"expression contains missing fields")}catch(i){const n=i&&i.details;if(n&&(n.clause||n.where))throw i;n&&n.missingFields?o.push(...n.missingFields):o.push(e)}}else o.push(e);if(o.length)throw new c.Z(N,_,{missingFields:o})}function E(h){return h.split(U)[0]}function x(h){return h.split(U)[1]}function a(h,u){const _=u.get(h);return!!_&&!C.has(_.type)}},82959:(X,Q,y)=>{y.d(Q,{_W:()=>B,iV:()=>a,oj:()=>_});var c=y(15861),G=y(62208),j=y(55915),L=y(15994),w=y(37053),N=y(46367);const U=[0,0];function C(g,o){if(!o)return null;if("x"in o){const e={x:0,y:0};return[e.x,e.y]=g(o.x,o.y,U),null!=o.z&&(e.z=o.z),null!=o.m&&(e.m=o.m),e}if("xmin"in o){const e={xmin:0,ymin:0,xmax:0,ymax:0};return[e.xmin,e.ymin]=g(o.xmin,o.ymin,U),[e.xmax,e.ymax]=g(o.xmax,o.ymax,U),o.hasZ&&(e.zmin=o.zmin,e.zmax=o.zmax,e.hasZ=!0),o.hasM&&(e.mmin=o.mmin,e.mmax=o.mmax,e.hasM=!0),e}return"rings"in o?{rings:z(o.rings,g),hasM:o.hasM,hasZ:o.hasZ}:"paths"in o?{paths:z(o.paths,g),hasM:o.hasM,hasZ:o.hasZ}:"points"in o?{points:Z(o.points,g),hasM:o.hasM,hasZ:o.hasZ}:null}function z(g,o){const e=[];for(const t of g)e.push(Z(t,o));return e}function Z(g,o){const e=[];for(const t of g){const i=o(t[0],t[1],[0,0]);e.push(i),t.length>2&&i.push(t[2]),t.length>3&&i.push(t[3])}return e}function B(g,o){return b.apply(this,arguments)}function b(){return(b=(0,c.Z)(function*(g,o){if(!g||!o)return;const e=Array.isArray(g)?g.map(t=>(0,G.pC)(t.geometry)?t.geometry.spatialReference:null).filter(G.pC):[g];yield(0,j.iQ)(e.map(t=>({source:t,dest:o})))})).apply(this,arguments)}const E=C.bind(null,N.hG),x=C.bind(null,N.R6);function a(g,o,e,t){if(!g||(e||(e=o,o=g.spatialReference),!(0,w.JY)(o)||!(0,w.JY)(e)||(0,w.fS)(o,e)))return g;if((0,N.Q8)(o,e)){const i=(0,w.sS)(e)?E(g):x(g);return i.spatialReference=e,i}return(0,j.oj)(L.N,[g],o,e,null,t)[0]}const u=new class h{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}push(o,e,t){var i=this;return(0,c.Z)(function*(){if(!o||!o.length||!e||!t||(0,w.fS)(e,t))return o;const n={geometries:o,inSpatialReference:e,outSpatialReference:t,resolve:null};return i._jobs.push(n),new Promise(r=>{n.resolve=r,null===i._timer&&(i._timer=setTimeout(i._process,10))})})()}_process(){this._timer=null;const o=this._jobs.shift();if(!o)return;const{geometries:e,inSpatialReference:t,outSpatialReference:i,resolve:n}=o;(0,N.Q8)(t,i)?(0,w.sS)(i)?n(e.map(E)):n(e.map(x)):n((0,j.oj)(L.N,e,t,i,null,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function _(g,o,e){return u.push(g,o,e)}},6185:(X,Q,y)=>{y.d(Q,{EG:()=>g,Op:()=>o,S2:()=>D,Up:()=>e,j6:()=>i,vF:()=>x});var c=y(15861),G=y(2076),j=y(62208),L=y(16730),w=y(55915),N=y(15176),U=y(91179),C=y(93555),z=y(37053),Z=y(82054),B=y(88071),b=y(82959);const E=new G.X({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),x=Object.freeze({}),a=new B.Z,h=new B.Z,u=new B.Z,_={esriGeometryPoint:Z.fQ,esriGeometryPolyline:Z.J6,esriGeometryPolygon:Z.eG,esriGeometryMultipoint:Z.Iv};function g(s,m,I,M=s.hasZ,T=s.hasM){if((0,j.Wi)(m))return null;const S=s.hasZ&&M,A=s.hasM&&T;if(I){const p=(0,Z.Nh)(u,m,s.hasZ,s.hasM,"esriGeometryPoint",I,M,T);return(0,Z.fQ)(p,S,A)}return(0,Z.fQ)(m,S,A)}function o(s,m,I,M,T,S,A=m,p=I){const F=m&&A,V=I&&p,W=(0,j.pC)(M)?"coords"in M?M:M.geometry:null;if((0,j.Wi)(W))return null;if(T){let K=(0,Z.zj)(h,W,m,I,s,T,A,p);return S&&(K=(0,Z.Nh)(u,K,F,V,s,S)),_[s]?.(K,F,V)??null}if(S){const K=(0,Z.Nh)(u,W,m,I,s,S,A,p);return _[s]?.(K,F,V)??null}return(0,Z.hY)(a,W,m,I,A,p),_[s]?.(a,F,V)??null}function e(s,m,I){return t.apply(this,arguments)}function t(){return(t=(0,c.Z)(function*(s,m,I){const{outFields:M,orderByFields:T,groupByFieldsForStatistics:S,outStatistics:A}=s;if(M)for(let p=0;p<M.length;p++)M[p]=M[p].trim();if(T)for(let p=0;p<T.length;p++)T[p]=T[p].trim();if(S)for(let p=0;p<S.length;p++)S[p]=S[p].trim();if(A)for(let p=0;p<A.length;p++)A[p].onStatisticField&&(A[p].onStatisticField=A[p].onStatisticField.trim());return s.geometry&&!s.outSR&&(s.outSR=s.geometry.spatialReference),i(s,m,I)})).apply(this,arguments)}function i(s,m,I){return n.apply(this,arguments)}function n(){return n=(0,c.Z)(function*(s,m,I){if(!s)return null;let{where:M}=s;if(s.where=M=M&&M.trim(),(!M||/^1 *= *1$/.test(M)||m&&m===M)&&(s.where=null),!s.geometry)return s;let T=yield function d(s){return f.apply(this,arguments)}(s);if(s.distance=0,s.units=null,"esriSpatialRelEnvelopeIntersects"===s.spatialRel){const{spatialReference:S}=s.geometry;T=(0,N.aO)(T),T.spatialReference=S}if(T){yield(0,b._W)(T.spatialReference,I),T=function l(s,m){const I=s.spatialReference;return r(s,m)&&(0,U.YX)(s)?{spatialReference:I,rings:[[[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin]]]}:s}(T,I);const S=(yield(0,C.aX)((0,U.im)(T)))[0];if((0,j.Wi)(S))throw x;const A="quantizationParameters"in s&&s.quantizationParameters?.tolerance||"maxAllowableOffset"in s&&s.maxAllowableOffset||0,p=A&&r(T,I)?{densificationStep:8*A}:void 0,F=S.toJSON(),V=yield(0,b.iV)(F,F.spatialReference,I,p);if(!V)throw x;V.spatialReference=I,s.geometry=V}return s}),n.apply(this,arguments)}function r(s,m){if(!s)return!1;const I=s.spatialReference;return((0,U.YX)(s)||(0,U.oU)(s)||(0,U.l9)(s))&&!(0,z.fS)(I,m)&&!(0,w.Up)(I,m)}function f(){return f=(0,c.Z)(function*(s){const{distance:m,units:I}=s,M=s.geometry;if(null==m||"vertexAttributes"in M)return M;const T=M.spatialReference,S=I?E.fromJSON(I):(0,L.qE)(T),A=T&&((0,z.sT)(T)||(0,z.sS)(T))?M:yield(0,b._W)(T,z.Zn).then(()=>(0,b.iV)(M,z.Zn));return(yield function v(){return R.apply(this,arguments)}())(A.spatialReference,A,m,S)}),f.apply(this,arguments)}function R(){return(R=(0,c.Z)(function*(){return(yield Promise.all([y.e(4918),y.e(8592)]).then(y.bind(y,32825))).geodesicBuffer})).apply(this,arguments)}function D(s){return s&&O in s?JSON.parse(JSON.stringify(s,P)):s}const O="_geVersion",P=(s,m)=>s!==O?m:void 0}}]);