"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[342],{10342:(S,R,e)=>{e.r(R),e.d(R,{default:()=>J});var u=e(15861),a=e(17626),P=e(26584),m=e(62208),O=e(32917),E=e(77712),o=(e(90912),e(85931),e(76898)),h=e(19702),d=e(50916),g=e(80382),s=e(88879),l=e(13812),r=e(28594),p=e(10023);const D=_=>{let i=class extends _{constructor(){super(...arguments),this._rasterFieldPrefix="Raster.",this.layer=null,this.view=null,this.tileInfo=null}get fullExtent(){return this._getfullExtent()}_getfullExtent(){return this.projectFullExtent(this.view.spatialReference)}get hasTilingEffects(){return this.layer.renderer&&"dynamicRangeAdjustment"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}get datumTransformation(){return(0,r._D)((0,m.Wg)(this.layer.fullExtent),this.view.spatialReference,!0)}supportsSpatialReference(v){return!!this.projectFullExtent(v)}projectFullExtent(v){const I=(0,m.Wg)(this.layer.fullExtent),y=(0,r._D)(I,v,!1);return(0,r.tB)(I,v,y)}fetchPopupFeatures(v,I){var y=this;return(0,u.Z)(function*(){const{layer:M}=y;if(!v)throw new P.Z("imageryTileLayerView:fetchPopupFeatures","Nothing to fetch without area",{layer:M});const{popupEnabled:x}=M,B=(0,p.V)(M,I);if(!x||(0,m.Wi)(B))throw new P.Z("imageryTileLayerView:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:x,popupTemplate:B});const b=[],{value:T,magdirValue:C}=yield M.identify(v,{timeExtent:y.timeExtent});let F="";if(T&&T.length){F="imagery-tile"===M.type&&M.hasStandardTime()&&null!=T[0]?T.map(G=>M.getStandardTimeValue(G)).join(", "):T.join(", ");const A={ObjectId:0};A["Raster.ServicePixelValue"]=F;const Z=M.rasterInfo.attributeTable;if((0,m.pC)(Z)){const{fields:G,features:Q}=Z,V=G.find(({name:j})=>"value"===j.toLowerCase()),z=V?Q.find(j=>String(j.attributes[V.name])===F):null;if(z)for(const j in z.attributes)z.attributes.hasOwnProperty(j)&&(A[y._rasterFieldPrefix+j]=z.attributes[j])}const w=M.rasterInfo.dataType;"vector-magdir"!==w&&"vector-uv"!==w||(A["Raster.Magnitude"]=C?.[0],A["Raster.Direction"]=C?.[1]);const K=new s.Z(y.fullExtent.clone(),null,A);K.layer=M,K.sourceLayer=K.layer,b.push(K)}return b})()}};return(0,a._)([(0,E.Cb)()],i.prototype,"layer",void 0),(0,a._)([(0,E.Cb)(l.qG)],i.prototype,"timeExtent",void 0),(0,a._)([(0,E.Cb)()],i.prototype,"view",void 0),(0,a._)([(0,E.Cb)()],i.prototype,"fullExtent",null),(0,a._)([(0,E.Cb)()],i.prototype,"tileInfo",void 0),(0,a._)([(0,E.Cb)({readOnly:!0})],i.prototype,"hasTilingEffects",null),(0,a._)([(0,E.Cb)()],i.prototype,"datumTransformation",null),i=(0,a._)([(0,o.j)("esri.views.layers.ImageryTileLayerView")],i),i};var L=e(45611),W=e(94421),H=e(94672),N=e(31637);let U=class extends(D((0,W.Z)((0,d.r)((0,h.A)(L.Z))))){constructor(){super(...arguments),this.type="imagery-tile-3d",this.isAlignedMapTile=!0}initialize(){this.layer.increaseRasterJobHandlerUsage(),null==this.fullExtent&&this.addResolvingPromise(Promise.reject(new P.Z("layerview:spatial-reference-incompatible","The layer extent cannot be projected to the view's spatial reference",{layer:this.layer})));const _=(0,O.N1)(()=>this.view?.basemapTerrain?.tilingSchemeLocked).then(()=>{const i=this.view.basemapTerrain.tilingScheme,v=this.layer.tileInfo,I=["png","png24","png32","jpg","mixed"].includes(v.format)&&i.compatibleWith(v);this.isAlignedMapTile=I;const y=I?v:i.toTileInfo();this.tileInfo=y,this.updatingHandles.add(()=>[this.layer.renderer,this.layer.interpolation,this.layer.bandIds,this.layer.multidimensionalDefinition,this.layer.multidimensionalSubset,this.layer.rasterFunction,this.timeExtent],()=>this.refresh())});this.addResolvingPromise(_)}destroy(){this.layer.decreaseRasterJobHandlerUsage(),this.view=null}get _blankTile(){const _=document.createElement("canvas"),i=_.getContext("2d"),[v,I]=this.tileInfo.size;return _.width=v,_.height=I,i.clearRect(0,0,v,I),i.getImageData(0,0,v,I)}get imageFormatIsOpaque(){return"jpg"===this.layer.tileInfo.format}get hasMixedImageFormats(){return"mixed"===this.layer.tileInfo.format}get dataLevelRange(){const i=this.layer.tileInfo.lods;return this.levelRangeFromScaleRange(this.tileInfo.lods[0].scale,i[i.length-1].scale)}_getfullExtent(){return this.projectFullExtent(this.view.basemapTerrain&&(0,m.pC)(this.view.basemapTerrain.spatialReference)?this.view.basemapTerrain.spatialReference:this.view.spatialReference)}fetchTile(_,i,v,I){var y=this;return(0,u.Z)(function*(){const M=y.tileInfo,x=y._canSymbolizeInWebGL(),B={tileInfo:M,requestRawData:x,signal:(0,m.Wg)(I.signal),timeExtent:y.timeExtent,requestAsImageElement:y.isAlignedMapTile},b=yield y.layer.fetchTile(_,i,v,B);if(b instanceof HTMLImageElement)return b;let T=b&&b.pixelBlock;if((0,m.Wi)(T)||!x&&(T=yield y.layer.applyRenderer(b),(0,m.Wi)(T)))return y._blankTile;const C=new g.H([_,i,v],T,M.size[0],M.size[1]);return x?(C.symbolizerRenderer=y.layer.symbolizer.rendererJSON,C.symbolizerParameters=y.layer.symbolizer.generateWebGLParameters(y._getSymbolizerOptions(_)),C.transformGrid=b.transformGrid):C.isRendereredSource=!0,C.interpolation=y.layer.interpolation,C.bandIds=y.layer.bandIds,C})()}_getSymbolizerOptions(_){const i=this.tileInfo.lodAt(_).resolution;return{pixelBlock:null,isGCS:this.view.basemapTerrain&&(0,m.pC)(this.view.basemapTerrain.spatialReference)?this.view.basemapTerrain.spatialReference.isGeographic:this.view.spatialReference.isGeographic,resolution:{x:i,y:i},bandIds:this.layer.bandIds}}ensureSymbolizerParameters(_){this._canSymbolizeInWebGL()&&JSON.stringify(_.symbolizerRenderer)!==JSON.stringify(this.layer.symbolizer.rendererJSON)&&(_.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(_.lij[0])))}createFetchPopupFeaturesQueryGeometry(_,i){return(0,H.K)(_,i,this.view)}refresh(){this.emit("data-changed")}doRefresh(){var _=this;return(0,u.Z)(function*(){_.suspended||_.emit("data-changed")})()}_canSymbolizeInWebGL(){return(0,N.hc)("3d").supportsTextureFloat&&this.layer.symbolizer.canRenderInWebGL}};(0,a._)([(0,E.Cb)({readOnly:!0})],U.prototype,"_blankTile",null),(0,a._)([(0,E.Cb)({readOnly:!0})],U.prototype,"imageFormatIsOpaque",null),(0,a._)([(0,E.Cb)({readOnly:!0})],U.prototype,"hasMixedImageFormats",null),(0,a._)([(0,E.Cb)({readOnly:!0})],U.prototype,"dataLevelRange",null),U=(0,a._)([(0,o.j)("esri.views.3d.layers.ImageryTileLayerView3D")],U);const J=U},19702:(S,R,e)=>{e.d(R,{A:()=>d});var u=e(15861),a=e(17626),P=e(54024),m=e(10699),O=e(32917),E=e(77712),o=(e(90912),e(85931),e(76898)),h=e(36947);const d=g=>{let s=class extends g{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(l){super.postscript(l),(0,h.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}_validateHeightModelInfo(){var l=this;return(0,u.Z)(function*(){const r=new AbortController,p=r.signal;l.handles.add((0,P.kB)(()=>r.abort())),yield(0,O.N1)(()=>l.view.defaultsFromMap?.heightModelInfoReady,p),(0,m.k_)(p);const D=(0,h.Wt)(l.layer,l.view.heightModelInfo,l.supportsHeightUnitConversion);if(D)throw D})()}canResume(){const l=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return super.canResume()&&(!l||!l.minScale||!l.maxScale||l.minScale>=l.maxScale)}getSuspendInfo(){const l=super.getSuspendInfo(),r=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return r&&r.minScale&&r.maxScale&&r.minScale<r.maxScale&&(l.outsideScaleRange=!0),l}};return(0,a._)([(0,E.Cb)()],s.prototype,"view",void 0),(0,a._)([(0,E.Cb)()],s.prototype,"slicePlaneEnabled",void 0),s=(0,a._)([(0,o.j)("esri.views.3d.layers.LayerView3D")],s),s}},45611:(S,R,e)=>{e.d(R,{Z:()=>l});var u=e(17626),a=e(14517),P=e(61885),m=e(80542),O=e(61996),E=e(63290),c=e(62208),f=e(60330),o=e(77712),g=(e(90912),e(85931),e(76898));let s=class extends((0,m.p)((0,O.IG)((0,f.v)(P.Z.EventedMixin(a.Z))))){constructor(r){super(r),this.layer=null,this.parent=null}initialize(){this.when().catch(r=>{if("layerview:create-error"!==r.name){const p=this.layer&&this.layer.id||"no id",D=this.layer&&this.layer.title||"no title";E.Z.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${D}', id: '${p}')`,r)}})}get fullOpacity(){return(0,c.Pt)(this.get("layer.opacity"),1)*(0,c.Pt)(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this.updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){return!0===this.layer?.visible}set visible(r){this._overrideIfSome("visible",r)}canResume(){return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready||!1}getSuspendInfo(){const r=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(r.viewNotReady=!0),this.layer&&this.layer.loaded||(r.layerNotLoaded=!0),this.visible||(r.layerInvisible=!0),r}isUpdating(){return!1}};(0,u._)([(0,o.Cb)()],s.prototype,"fullOpacity",null),(0,u._)([(0,o.Cb)()],s.prototype,"layer",void 0),(0,u._)([(0,o.Cb)()],s.prototype,"parent",void 0),(0,u._)([(0,o.Cb)({readOnly:!0})],s.prototype,"suspended",null),(0,u._)([(0,o.Cb)({readOnly:!0})],s.prototype,"suspendInfo",null),(0,u._)([(0,o.Cb)({readOnly:!0})],s.prototype,"legendEnabled",null),(0,u._)([(0,o.Cb)({type:Boolean,readOnly:!0})],s.prototype,"updating",null),(0,u._)([(0,o.Cb)({readOnly:!0})],s.prototype,"updatingProgress",null),(0,u._)([(0,o.Cb)()],s.prototype,"visible",null),(0,u._)([(0,o.Cb)()],s.prototype,"view",void 0),s=(0,u._)([(0,g.j)("esri.views.layers.LayerView")],s);const l=s},94421:(S,R,e)=>{e.d(R,{Z:()=>o});var u=e(17626),a=e(63290),P=e(10699),m=e(32917),O=e(77712),f=(e(90912),e(85931),e(76898));const o=h=>{let d=class extends h{initialize(){this.handles.add((0,m.on)(()=>this.layer,"refresh",g=>{this.doRefresh(g.dataChanged).catch(s=>{(0,P.D_)(s)||a.Z.getLogger(this.declaredClass).error(s)})}),"RefreshableLayerView")}};return(0,u._)([(0,O.Cb)()],d.prototype,"layer",void 0),d=(0,u._)([(0,f.j)("esri.layers.mixins.RefreshableLayerView")],d),d}},10023:(S,R,e)=>{e.d(R,{V:()=>E,e:()=>m});var u=e(15861),a=e(62208),P=e(36630);function m(c){return O.apply(this,arguments)}function O(){return(O=(0,u.Z)(function*(c,f=c.popupTemplate){if((0,a.Wi)(f))return[];const o=yield f.getRequiredFields(c.fieldsIndex),{lastEditInfoEnabled:h}=f,{objectIdField:d,typeIdField:g,globalIdField:s,relationships:l}=c;if(o.includes("*"))return["*"];const r=h?yield(0,P.CH)(c):[],p=(0,P.Q0)(c.fieldsIndex,[...o,...r]);return g&&p.push(g),p&&d&&c.fieldsIndex?.has(d)&&!p.includes(d)&&p.push(d),p&&s&&c.fieldsIndex?.has(s)&&!p.includes(s)&&p.push(s),l&&l.forEach(D=>{const{keyField:L}=D;p&&L&&c.fieldsIndex?.has(L)&&!p.includes(L)&&p.push(L)}),p})).apply(this,arguments)}function E(c,f){return c.popupTemplate?c.popupTemplate:(0,a.pC)(f)&&f.defaultPopupTemplateEnabled&&(0,a.pC)(c.defaultPopupTemplate)?c.defaultPopupTemplate:null}},94672:(S,R,e)=>{e.d(R,{K:()=>O}),e(29132);var a=e(62208),P=e(16730),m=e(2004);function O(f,o,h,d=new m.Z){let g=0;if("2d"===h.type)g=o*(h.resolution??0);else if("3d"===h.type){const L=h.overlayPixelSizeInMapUnits(f),W=h.basemapSpatialReference;g=(0,a.pC)(W)&&!W.equals(h.spatialReference)?(0,P.c9)(W)/(0,P.c9)(h.spatialReference):o*L}const s=f.x-g,l=f.y-g,r=f.x+g,p=f.y+g,{spatialReference:D}=h;return d.xmin=Math.min(s,r),d.ymin=Math.min(l,p),d.xmax=Math.max(s,r),d.ymax=Math.max(l,p),d.spatialReference=D,d}new m.Z}}]);