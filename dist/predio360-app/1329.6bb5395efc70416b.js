"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[1329],{50017:(K,j,D)=>{D.d(j,{Y6:()=>Y});var Z,I,W=D(67831),g=D(99770),M=D(84161),C=D(28093),N=D(993),z=D(4794),U=D(72642);(I=Z||(Z={}))[I.Z=0]="Z",I[I.M=1]="M";class H{constructor(i){this.spatialReference=i}createVector(){return this._tag((0,g.a)())}pointToVector(i){return this._tag((0,g.f)(i.x,i.y))}arrayToVector(i){return this._tag((0,g.f)(i[0],i[1]))}vectorToArray(i){return[i[0],i[1]]}pointToArray(i){return[i.x,i.y]}vectorToPoint(i,d=new U.Z){return d.x=i[0],d.y=i[1],d.z=void 0,d.m=void 0,d.spatialReference=this.spatialReference,d}arrayToPoint(i,d=new U.Z){return d.x=i[0],d.y=i[1],d.z=void 0,d.m=void 0,d.spatialReference=this.spatialReference,d}vectorToDehydratedPoint(i,d={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}){return d.x=i[0],d.y=i[1],d.z=void 0,d.m=void 0,d.hasZ=!1,d.hasM=!1,d.spatialReference=this.spatialReference,d}lerp(i,d,p,u){return(0,W.l)(u,i,d,p)}addDelta(i,d,p){i[0]+=d,i[1]+=p}distance(i,d){return(0,W.d)(i,d)}getZ(i,d){return d}hasZ(){return!1}getM(i,d){return d}hasM(){return!1}clone(i){return this._tag((0,g.b)(i))}copy(i,d){return(0,W.c)(d,i)}fromXYZ(i){return this._tag((0,g.f)(i[0],i[1]))}toXYZ(i,d=(0,C.c)()){return(0,M.s)(d,i[0],i[1],0)}pointToXYZ(i,d=(0,C.c)()){return(0,M.s)(d,i.x,i.y,0)}equals(i,d){return(0,W.o)(i,d)}_tag(i){return i}}class k{constructor(i,d){this._valueType=i,this.spatialReference=d}createVector(){return this._tag((0,C.c)())}pointToVector(i){return this._tag((0,C.f)(i.x,i.y,this._valueType===Z.Z?i.z:i.m))}arrayToVector(i){return this._tag((0,C.f)(i[0],i[1],i[2]||0))}vectorToArray(i){return[i[0],i[1],i[2]]}pointToArray(i){return this._valueType===Z.Z?[i.x,i.y,i.z]:[i.x,i.y,i.m]}vectorToPoint(i,d=new U.Z){return d.x=i[0],d.y=i[1],d.z=this._valueType===Z.Z?i[2]:void 0,d.m=this._valueType===Z.M?i[2]:void 0,d.spatialReference=this.spatialReference,d}arrayToPoint(i,d=new U.Z){return d.x=i[0],d.y=i[1],d.z=this._valueType===Z.Z?i[2]:void 0,d.m=this._valueType===Z.M?i[2]:void 0,d.spatialReference=this.spatialReference,d}vectorToDehydratedPoint(i,d={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}){const p=this._valueType===Z.Z,u=this._valueType===Z.M;return d.x=i[0],d.y=i[1],d.z=p?i[2]:void 0,d.m=u?i[2]:void 0,d.hasZ=p,d.hasM=u,d.spatialReference=this.spatialReference,d}lerp(i,d,p,u){return(0,M.h)(u,i,d,p)}addDelta(i,d,p,u){i[0]+=d,i[1]+=p,this._valueType===Z.Z&&(i[2]+=u)}distance(i,d){return this._valueType===Z.Z?(0,M.i)(i,d):(0,W.d)(i,d)}getZ(i,d){return this._valueType===Z.Z?i[2]:d}hasZ(){return this._valueType===Z.Z}getM(i,d){return this._valueType===Z.M?i[2]:d}hasM(){return this._valueType===Z.M}clone(i){return this._tag((0,C.d)(i))}copy(i,d){return(0,M.c)(d,i)}fromXYZ(i,d=0,p=0){return this._tag((0,C.f)(i[0],i[1],this._valueType===Z.Z?i.length>2?i[2]:d:p))}toXYZ(i,d=(0,C.c)()){return(0,M.s)(d,i[0],i[1],this._valueType===Z.Z?i[2]:0)}pointToXYZ(i,d=(0,C.c)()){return(0,M.s)(d,i.x,i.y,this._valueType===Z.Z?i.z??0:0)}equals(i,d){return(0,M.F)(i,d)}_tag(i){return i}}class G{constructor(i){this.spatialReference=i}createVector(){return this._tag((0,z.c)())}pointToVector(i){return this._tag((0,z.f)(i.x,i.y,i.z,i.m))}arrayToVector(i){return this._tag((0,z.f)(i[0],i[1],i[2]||0,i[3]||0))}vectorToArray(i){return[i[0],i[1],i[2],i[3]]}pointToArray(i){return[i.x,i.y,i.z,i.m]}vectorToPoint(i,d=new U.Z){return d.x=i[0],d.y=i[1],d.z=i[2],d.m=i[3],d.spatialReference=this.spatialReference,d}arrayToPoint(i,d=new U.Z){return d.x=i[0],d.y=i[1],d.z=i[2],d.m=i[3],d.spatialReference=this.spatialReference,d}vectorToDehydratedPoint(i,d={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}){return d.x=i[0],d.y=i[1],d.z=i[2],d.m=i[3],d.hasZ=!0,d.hasM=!0,d.spatialReference=this.spatialReference,d}lerp(i,d,p,u){return(0,N.l)(u,i,d,p)}addDelta(i,d,p,u){i[0]+=d,i[1]+=p,i[2]+=u}distance(i,d){return(0,M.i)(i,d)}getZ(i){return i[2]}hasZ(){return!0}getM(i){return i[3]}hasM(){return!0}clone(i){return this._tag((0,z.b)(i))}copy(i,d){return(0,N.c)(d,i)}fromXYZ(i,d=0,p=0){return this._tag((0,z.f)(i[0],i[1],i.length>2?i[2]:d,p))}toXYZ(i,d=(0,C.c)()){return(0,M.s)(d,i[0],i[1],i[2])}pointToXYZ(i,d=(0,C.c)()){return(0,M.s)(d,i.x,i.y,i.z??0)}equals(i,d){return(0,N.h)(i,d)}_tag(i){return i}}function Y(I,i,d){return I&&i?new G(d):i?new k(Z.M,d):I?new k(Z.Z,d):new H(d)}},466:(K,j,D)=>{D.d(j,{wA:()=>I,kS:()=>Y,XE:()=>i,Xz:()=>G});var W=D(85931),g=D(61885),M=D(62208),C=D(37118),N=D(55214),z=D(50017),U=D(37053),Z=D(59617);class G{constructor(p){this.component=p,this.leftEdge=null,this.rightEdge=null,this.type="vertex",this.index=null}get pos(){return this._pos}set pos(p){this._pos=p,this.component.unnormalizeVertexPositions()}}class Y{constructor(p,u,m){this.component=p,this.leftVertex=u,this.rightVertex=m,this.type="edge",u.rightEdge=this,m.leftEdge=this}}class I{constructor(p,u){this._spatialReference=p,this._viewingMode=u,this.vertices=[],this.edges=[],this.index=null}unnormalizeVertexPositions(){this.vertices.length<=1||function H(d,p){if(!p.supported)return;let u=1/0,m=-1/0;const E=p.upperBoundX-p.lowerBoundX;d.forEach(x=>{let v=x.pos[0];for(;v<p.lowerBoundX;)v+=E;for(;v>p.upperBoundX;)v-=E;u=Math.min(u,v),m=Math.max(m,v),x.pos[0]=v});const _=m-u;E-_<_&&d.forEach(x=>{x.pos[0]<0&&(x.pos[0]+=E)})}(this.vertices,function k(d,p){const u=(0,U.C5)(d);return p===Z.JY.Global&&u?{supported:!0,lowerBoundX:u.valid[0],upperBoundX:u.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}}(this._spatialReference,this._viewingMode))}updateVertexIndex(p,u){if(0===this.vertices.length)return;const m=this.vertices[0];let E=null,_=p,x=u;do{E=_,E.index=x++,_=E.rightEdge?E.rightEdge.rightVertex:null}while(null!=_&&_!==m);E.leftEdge&&E!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(E),this.vertices.length-1)}getFirstVertex(){return 0===this.vertices.length?null:this.vertices[0]}getLastVertex(){return 0===this.vertices.length?null:this.vertices[this.vertices.length-1]}isClosed(){return this.vertices.length>2&&null!==this.vertices[0].leftEdge}swapVertices(p,u){const m=this.vertices[p];this.vertices[p]=this.vertices[u],this.vertices[u]=m}iterateVertices(p){if(0===this.vertices.length)return;const u=this.vertices[0];let m=u;do{p(m,m.index),m=(0,M.pC)(m.rightEdge)?m.rightEdge.rightVertex:null}while(m!==u&&null!=m)}}class i extends g.Z{constructor(p,u){super(),this.type=p,this.coordinateHelper=u,this._geometry=null,this._dirty=!0,this.components=[]}get geometry(){if(this._dirty){switch(this.type){case"point":this._geometry=this._toPoint();break;case"polyline":this._geometry=this._toPolyline();break;case"polygon":this._geometry=this._toPolygon()}this._dirty=!1}return this._geometry}get spatialReference(){return this.coordinateHelper.spatialReference}notifyChanges(p){this._dirty=!0,this.emit("change",p)}_toPoint(){return 0===this.components.length||0===this.components[0].vertices.length?null:this.coordinateHelper.vectorToPoint(this.components[0].vertices[0].pos)}_toPolyline(){const p=[],u=this.coordinateHelper.vectorToArray;for(const m of this.components){if(m.vertices.length<1)continue;const E=[];let _=m.vertices.find(v=>null==v.leftEdge);const x=_;do{E.push(u(_.pos)),_=_.rightEdge?_.rightEdge.rightVertex:null}while(_&&_!==x);p.push(E)}return new N.Z({paths:p,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}_toPolygon(){const p=[],u=this.coordinateHelper.vectorToArray;for(const m of this.components){if(m.vertices.length<1)continue;const E=[],_=m.vertices[0];let x=_;const v=x;do{E.push(u(x.pos)),x=(0,M.pC)(x.rightEdge)?x.rightEdge.rightVertex:null}while(x&&x!==v);m.isClosed()&&E.push(u(_.pos)),p.push(E)}return new C.Z({rings:p,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}static fromGeometry(p,u){const m=p.spatialReference,E=(0,z.Y6)(p.hasZ,p.hasM,m),_=new i(p.type,E);switch(p.type){case"polygon":{const x=p.rings;for(let v=0;v<x.length;++v){const A=x[v],T=new I(m,u);T.index=v;const X=A.length>2&&(0,W.fS)(A[0],A[A.length-1]),O=X?A.length-1:A.length;for(let R=0;R<O;++R){const w=E.arrayToVector(A[R]),L=new G(T);T.vertices.push(L),L.pos=w,L.index=R}const S=T.vertices.length-1;for(let R=0;R<S;++R){const P=new Y(T,T.vertices[R],T.vertices[R+1]);T.edges.push(P)}if(X){const R=new Y(T,T.vertices[T.vertices.length-1],T.vertices[0]);T.edges.push(R)}_.components.push(T)}break}case"polyline":{const x=p.paths;for(let v=0;v<x.length;++v){const A=x[v],T=new I(m,u);T.index=v;const X=A.length;for(let S=0;S<X;++S){const R=E.arrayToVector(A[S]),w=new G(T);T.vertices.push(w),w.pos=R,w.index=S}const O=T.vertices.length-1;for(let S=0;S<O;++S){const L=new Y(T,T.vertices[S],T.vertices[S+1]);T.edges.push(L)}_.components.push(T)}break}case"point":{const x=new I(m,u);x.index=0;const v=new G(x);v.index=0,v.pos=E.pointToVector(p),x.vertices.push(v),_.components.push(x);break}}return _}}},97737:(K,j,D)=>{D.d(j,{c:()=>L});var C,P,U,W=D(61885),g=D(62208),M=D(466);(P=C||(C={}))[P.NEW_STEP=0]="NEW_STEP",P[P.ACCUMULATE_STEPS=1]="ACCUMULATE_STEPS";class N{constructor(e,h,l){this._editGeometry=e,this._component=h,this._pos=l,this._addedVertex=null,this._originalEdge=null,this._left=null,this._right=null}apply(){let e="redo";(0,g.Wi)(this._addedVertex)&&(e="apply",this._addedVertex=new M.Xz(this._component));const h=this._component.getLastVertex();if((0,g.Wi)(h))this._component.vertices.push(this._addedVertex),this._addedVertex.pos=this._pos,this._addedVertex.index=0;else{let l=null;h.rightEdge&&(this._originalEdge=h.rightEdge,l=this._originalEdge.rightVertex,this._component.edges.splice(this._component.edges.indexOf(this._originalEdge),1)),this._component.vertices.push(this._addedVertex),this._addedVertex.pos=this._pos,(0,g.Wi)(this._left)&&(this._left=new M.kS(this._component,h,this._addedVertex)),this._component.edges.push(this._left),h.rightEdge=this._left,(0,g.pC)(this._originalEdge)&&(0,g.pC)(l)&&((0,g.Wi)(this._right)&&(this._right=new M.kS(this._component,this._addedVertex,l)),this._component.edges.push(this._right),l.leftEdge=this._right),this._component.updateVertexIndex(this._addedVertex,h.index+1)}this._editGeometry.notifyChanges({operation:e,addedVertices:[this._addedVertex]})}undo(){(0,g.Wi)(this._addedVertex)||(this._component.vertices.splice(this._component.vertices.indexOf(this._addedVertex),1),(0,g.pC)(this._left)&&(this._component.edges.splice(this._component.edges.indexOf(this._left),1),this._left.leftVertex.rightEdge=null),(0,g.pC)(this._right)&&(this._component.edges.splice(this._component.edges.indexOf(this._right),1),this._right.rightVertex.leftEdge=null),(0,g.pC)(this._originalEdge)&&(this._component.edges.push(this._originalEdge),this._originalEdge.leftVertex.rightEdge=this._originalEdge,this._originalEdge.rightVertex.leftEdge=this._originalEdge),(0,g.pC)(this._left)?this._component.updateVertexIndex(this._left.leftVertex,this._left.leftVertex.index):this._component.updateVertexIndex(this._addedVertex,0),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this._addedVertex]}))}accumulate(){return!1}}class z{constructor(e,h,l){this._editGeometry=e,this._vertices=h,this.operation=l,this._undone=!1}apply(){this._vertices.forEach(e=>this.operation.apply(e)),this._editGeometry.components.forEach(e=>e.unnormalizeVertexPositions()),this._editGeometry.notifyChanges({operation:this._undone?"redo":"apply",updatedVertices:this._vertices})}undo(){this._vertices.forEach(e=>this.operation.undo(e)),this._editGeometry.notifyChanges({operation:"undo",updatedVertices:this._vertices}),this._undone=!0}canAccumulate(e){if(this._undone||e._vertices.length!==this._vertices.length)return!1;for(let h=0;h<e._vertices.length;++h)if(e._vertices[h]!==this._vertices[h])return!1;return this.operation.canAccumulate(e.operation)}accumulate(e){return!!(e instanceof z&&this.canAccumulate(e))&&(this._vertices.forEach(h=>this.operation.accumulate(h,e.operation)),this.operation.accumulateParams(e.operation),this._editGeometry.components.forEach(h=>h.unnormalizeVertexPositions()),this._editGeometry.notifyChanges({operation:"apply",updatedVertices:this._vertices}),!0)}}!function(P){P[P.CUMULATIVE=0]="CUMULATIVE",P[P.REPLACE=1]="REPLACE"}(U||(U={}));class Z{constructor(e,h,l=0){this._editGeometry=e,this._vertices=h,this._minNumberOfVertices=l,this.removedVertices=null}apply(){let e="redo";if(null==this.removedVertices){const h=this.removedVertices=[];this._vertices.forEach(l=>{const y=this._removeVertex(l);(0,g.pC)(y)&&h.push(y)}),e="apply"}else this.removedVertices.forEach(h=>{this._removeVertex(h.removedVertex)});this._editGeometry.notifyChanges({operation:e,removedVertices:this._vertices})}undo(){this.removedVertices?.forEach(e=>{this._undoRemoveVertex(e)}),this._editGeometry.notifyChanges({operation:"undo",addedVertices:this._vertices})}accumulate(){return!1}_removeVertex(e){const h=e.component;if(h.vertices.length<=this._minNumberOfVertices)return null;const l={removedVertex:e,createdEdge:null},y=e.leftEdge,V=e.rightEdge;return h.vertices.splice(h.vertices.indexOf(e),1),y&&(h.edges.splice(h.edges.indexOf(y),1),y.leftVertex.rightEdge=null),V&&(h.edges.splice(h.edges.indexOf(V),1),V.rightVertex.leftEdge=null),0===e.index&&V&&this._vertices.length>0&&h.swapVertices(h.vertices.indexOf(V.rightVertex),0),y&&V&&(l.createdEdge=new M.kS(h,y.leftVertex,V.rightVertex),h.edges.push(l.createdEdge)),V&&h.updateVertexIndex(V.rightVertex,V.rightVertex.index-1),l}_undoRemoveVertex(e){const h=e.removedVertex,l=e.removedVertex.component,y=h.leftEdge,V=h.rightEdge;e.createdEdge&&l.edges.splice(l.edges.indexOf(e.createdEdge),1),l.vertices.push(h),y&&(l.edges.push(y),y.leftVertex.rightEdge=y),V&&(l.edges.push(V),V.rightVertex.leftEdge=V),l.updateVertexIndex(h,h.index)}}class H{constructor(e,h,l){this._editGeometry=e,this._edge=h,this._t=l,this.createdVertex=null,this._left=null,this._right=null}apply(){let e="redo";const h=this._edge,l=h.component,y=h.leftVertex,V=h.rightVertex;l.edges.splice(l.edges.indexOf(h),1),(0,g.Wi)(this.createdVertex)&&(e="apply",this.createdVertex=new M.Xz(h.component)),l.vertices.push(this.createdVertex),this.createdVertex.pos=this._editGeometry.coordinateHelper.lerp(h.leftVertex.pos,h.rightVertex.pos,this._t,this._editGeometry.coordinateHelper.createVector()),(0,g.Wi)(this._left)&&(this._left=new M.kS(l,y,this.createdVertex)),this._left.leftVertex.leftEdge?l.edges.push(this._left):l.edges.unshift(this._left),y.rightEdge=this._left,(0,g.Wi)(this._right)&&(this._right=new M.kS(l,this.createdVertex,V)),l.edges.push(this._right),V.leftEdge=this._right,l.updateVertexIndex(this.createdVertex,y.index+1),this._editGeometry.notifyChanges({operation:e,addedVertices:[this.createdVertex]})}undo(){if((0,g.Wi)(this.createdVertex)||(0,g.Wi)(this._left)||(0,g.Wi)(this._right))return null;const e=this._edge,h=e.component,V=this.createdVertex.leftEdge?.leftVertex,B=this.createdVertex.rightEdge?.rightVertex;h.vertices.splice(h.vertices.indexOf(this.createdVertex),1),h.edges.splice(h.edges.indexOf(this._left),1),h.edges.splice(h.edges.indexOf(this._right),1),this._edge.leftVertex.leftEdge?h.edges.push(this._edge):h.edges.unshift(this._edge),V&&(V.rightEdge=e),B&&(B.leftEdge=e),V&&h.updateVertexIndex(V,V.index),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this.createdVertex]})}accumulate(){return!1}}class k{constructor(e,h,l){this._editGeometry=e,this._vertex=h,this._pos=l}apply(){const e=(0,g.Wi)(this._originalPosition);e&&(this._originalPosition=this._vertex.pos),this._apply(e?"apply":"redo")}undo(){this._vertex.pos=(0,g.Wg)(this._originalPosition),this._editGeometry.notifyChanges({operation:"undo",updatedVertices:[this._vertex]})}accumulate(e){return e instanceof k&&e._vertex===this._vertex&&(this._pos=e._pos,this._apply("apply"),!0)}_apply(e){this._vertex.pos=this._pos,this._editGeometry.components.forEach(h=>h.unnormalizeVertexPositions()),this._editGeometry.notifyChanges({operation:e,updatedVertices:[this._vertex]})}}var G=D(85931);class Y{constructor(e,h){this._editGeometry=e,this._component=h,this._createdEdge=null}apply(){let e="redo";if((0,g.Wi)(this._createdEdge)){e="apply";const h=this._component.getFirstVertex(),l=this._component.getLastVertex();if(this._component.isClosed()||this._component.vertices.length<3||(0,g.Wi)(h)||(0,g.Wi)(l))return;this._createdEdge=new M.kS(this._component,l,h)}this._createdEdge.leftVertex.rightEdge=this._createdEdge,this._createdEdge.rightVertex.leftEdge=this._createdEdge,this._component.edges.push(this._createdEdge),this._editGeometry.notifyChanges({operation:e})}undo(){(0,g.Wi)(this._createdEdge)||((0,G.Od)(this._component.edges,this._createdEdge),this._createdEdge.leftVertex.rightEdge=null,this._createdEdge.rightVertex.leftEdge=null,this._editGeometry.notifyChanges({operation:"undo"}))}accumulate(){return!1}}class I{constructor(e,h,l,y){this._helper=e,this.dx=h,this.dy=l,this.dz=y}_move(e,h,l,y){this._helper.addDelta(e.pos,h,l,y)}apply(e){this._move(e,this.dx,this.dy,this.dz)}undo(e){this._move(e,-this.dx,-this.dy,-this.dz)}canAccumulate(e){return e instanceof I}accumulate(e,h){this._move(e,h.dx,h.dy,h.dz)}accumulateParams(e){this.dx+=e.dx,this.dy+=e.dy,this.dz+=e.dz}}var i=D(21286),d=D(67831),p=D(99770),u=D(84161),m=D(28093),E=D(90014),_=D(34054),x=D(396);class v{get plane(){return this._plane}get requiresSplitEdgeLeft(){return!this._left.isOriginalDirection}get requiresSplitEdgeRight(){return!this._right.isOriginalDirection}get edgeDirection(){return this._edgeDirection}constructor(e,h,l,y=0,V=O.IMMEDIATE){this._helper=e,this._planeType=h,this._edge=l,this.distance=y,this._plane=(0,E.Ue)(),this._offsetPlane=(0,E.Ue)(),this._minDistance=-1/0,this._maxDistance=1/0,this._selectedArrow=1,V===O.IMMEDIATE&&this._initialize()}_initialize(){this._initializeNeighbors(),this._initializePlane(),this._initializeDistanceConstraints()}_initializeNeighbors(){const e=this._toXYZ(this._edge.leftVertex.pos),h=this._toXYZ(this._edge.leftVertex.leftEdge?.leftVertex?.pos),l=this._toXYZ(this._edge.rightVertex.pos),y=this._toXYZ(this._edge.rightVertex.rightEdge?.rightVertex?.pos);this._edgeDirection=(0,u.r)((0,m.c)(),e,l),this._left=this._computeNeighbor(e,h,this._edgeDirection),this._right=this._computeNeighbor(l,y,this._edgeDirection)}_toXYZ(e){return(0,g.pC)(e)?this._helper.toXYZ(e):null}_pointToXYZ(e){return this._toXYZ(this._helper.pointToVector(e))}_computeNeighbor(e,h,l){if((0,g.Wi)(h))return{start:e,end:h,direction:(0,m.f)(-l[1],l[0],0),isOriginalDirection:!0};const y=(0,u.r)((0,m.c)(),e,h),V=!this._passesBisectingAngleThreshold(y,l);return{start:e,end:h,direction:V?this._bisectVectorsPerpendicular(l,y):y,isOriginalDirection:!V}}_passesBisectingAngleThreshold(e,h){const l=Math.abs((0,_.EU)(h,e));return l>=A&&l<=Math.PI-A}_bisectVectorsPerpendicular(e,h){const l=(0,u.e)(e,h)<0?e:(0,u.o)((0,m.c)(),e),y=Math.abs((0,u.e)(l,h));if(!(y<T||y>1-T))return this._bisectDirection(l,h);const V=(0,u.f)((0,m.c)(),l,[0,0,1]);return(0,u.n)(V,V)}_bisectDirection(e,h){const l=(0,u.a)((0,m.c)(),e,h);return(0,u.n)(l,l)}_initializePlane(){const e=this._computeNormalDirection(this._left),h=this._computeNormalDirection(this._right);(0,u.e)(e,h)<0&&(0,u.o)(h,h),(0,E.Yq)(this._left.start,this._bisectDirection(e,h),this._plane)}_computeNormalDirection(e){const h=(0,u.f)((0,m.c)(),e.direction,this._edgeDirection);(0,u.n)(h,h);const l=(0,u.f)((0,m.c)(),this._edgeDirection,h);return this._planeType===X.XY&&(l[2]=0),(0,u.n)(l,l)}_initializeDistanceConstraints(){(0,g.pC)(this._left.end)&&!this.requiresSplitEdgeLeft&&this._updateDistanceConstraint((0,E.jH)(this._plane,this._left.end)),(0,g.pC)(this._right.end)&&!this.requiresSplitEdgeRight&&this._updateDistanceConstraint((0,E.jH)(this._plane,this._right.end)),this._updateIntersectDistanceConstraint(this._plane)}_updateDistanceConstraint(e){e<=0&&(this._minDistance=Math.max(this._minDistance,e)),e>=0&&(this._maxDistance=Math.min(this._maxDistance,e))}_updateIntersectDistanceConstraint(e){const h=(0,E.mJ)(e),l=this._edgeDirection,y=(0,u.a)((0,m.c)(),this._left.start,this._left.direction),V=(0,u.a)((0,m.c)(),this._right.start,this._right.direction),B=this._pointInBasis2D((0,p.a)(),h,l,this._left.start),b=this._pointInBasis2D((0,p.a)(),h,l,y),Q=this._pointInBasis2D((0,p.a)(),h,l,this._right.start),$=this._pointInBasis2D((0,p.a)(),h,l,V),[J]=(0,x.dU)({start:b,end:B,type:x.SP.LINE},{start:$,end:Q,type:x.SP.LINE});if(!J)return;const F=(0,d.a)((0,p.a)(),B,b);(0,d.f)(F,F);const q=(0,d.a)((0,p.a)(),J,b),ee=(0,d.h)(F,q),te=(0,u.a)((0,m.c)(),y,(0,u.g)((0,m.c)(),this._left.direction,-ee)),ie=(0,E.jH)(e,te);this._updateDistanceConstraint(ie)}_pointInBasis2D(e,h,l,y){return e[0]=(0,_.SR)(h,y),e[1]=(0,_.SR)(l,y),e}_offset(e,h){Number.isFinite(this._minDistance)&&(h=Math.max(this._minDistance,h)),Number.isFinite(this._maxDistance)&&(h=Math.min(this._maxDistance,h)),(0,E.JG)(this._offsetPlane,this._plane),this._offsetPlane[3]-=h;const l=(V,B,b)=>(0,g.pC)(B)&&(0,E.fn)(this._offsetPlane,V,(0,u.a)((0,m.c)(),V,B),b),y=(0,m.c)();(e===this._edge.leftVertex?l(this._left.start,this._left.direction,y):l(this._right.start,this._right.direction,y))&&this._helper.copy(this._helper.fromXYZ(y,void 0,this._helper.getM(e.pos)),e.pos)}selectArrowFromStartPoint(e){this._selectedArrow=(0,E.Ac)(this.plane,this._pointToXYZ(e))?1:-1}get selectedArrow(){return this._selectedArrow}signedDistanceToPoint(e){return(0,E.jH)(this.plane,this._pointToXYZ(e))}apply(e){this._offset(e,this.distance)}undo(e){this._offset(e,0)}canAccumulate(e){return e instanceof v&&this._edge.leftVertex.index===e._edge.leftVertex.index&&this._edge.rightVertex.index===e._edge.rightVertex.index&&this._edge.component===e._edge.component&&this._maybeEqualsVec3(this._left.direction,e._left.direction)&&this._maybeEqualsVec3(this._right.direction,e._right.direction)&&(0,u.F)((0,E.mJ)(this._plane),(0,E.mJ)(e._plane))}accumulate(e,h){this._offset(e,this._plane[3]-h._plane[3]+h.distance)}accumulateParams(e){this.distance=e.distance-e._plane[3]+this._plane[3]}clone(){const e=new v(this._helper,this._planeType,this._edge,this.distance,O.DEFERRED);return(0,E.JG)(e._plane,this._plane),(0,E.JG)(e._offsetPlane,this._offsetPlane),e._maxDistance=this._maxDistance,e._minDistance=this._minDistance,e._left=this._cloneNeighbor(this._left),e._right=this._cloneNeighbor(this._right),e._edgeDirection=(0,u.c)((0,m.c)(),this._edgeDirection),e}_maybeEqualsVec3(e,h){return(0,g.Wi)(e)&&(0,g.Wi)(h)||(0,g.pC)(e)&&(0,g.pC)(h)&&(0,u.F)(e,h)}_cloneNeighbor({start:e,end:h,direction:l,isOriginalDirection:y}){return{start:(0,u.c)((0,m.c)(),e),end:(0,g.pC)(h)?(0,u.c)((0,m.c)(),h):null,direction:(0,u.c)((0,m.c)(),l),isOriginalDirection:y}}}const A=(0,i.Vl)(15),T=.001;var X,O;(function(P){P[P.XYZ=0]="XYZ",P[P.XY=1]="XY"})(X||(X={})),function(P){P[P.IMMEDIATE=0]="IMMEDIATE",P[P.DEFERRED=1]="DEFERRED"}(O||(O={}));class S{constructor(e,h,l=U.CUMULATIVE){this.origin=e,this.angle=h,this._accumulationType=l}_rotate(e,h){(0,d.r)(e.pos,e.pos,this.origin,h)}apply(e){this._rotate(e,this.angle)}undo(e){this._rotate(e,-this.angle)}canAccumulate(e){return e instanceof S&&(0,G.fS)(this.origin,e.origin)}accumulate(e,h){this._rotate(e,h._accumulationType===U.REPLACE?h.angle-this.angle:h.angle)}accumulateParams(e){this.angle=e._accumulationType===U.REPLACE?e.angle:this.angle+e.angle}}class R{constructor(e,h,l,y,V=U.CUMULATIVE){this.origin=e,this.axis1=h,this.factor1=l,this.factor2=y,this._accumulationType=V,this.axis2=(0,p.f)(h[1],-h[0])}_scale(e,h,l){(0,d.u)(e.pos,e.pos,this.origin,this.axis1,h),(0,d.u)(e.pos,e.pos,this.origin,this.axis2,l)}apply(e){this._scale(e,this.factor1,this.factor2)}undo(e){this._scale(e,1/this.factor1,1/this.factor2)}canAccumulate(e){return e instanceof R&&(0,G.fS)(this.origin,e.origin)&&(0,G.fS)(this.axis1,e.axis1)}accumulate(e,h){h._accumulationType===U.REPLACE?this._scale(e,h.factor1/this.factor1,h.factor2/this.factor2):this._scale(e,h.factor1,h.factor2)}accumulateParams(e){const h=e._accumulationType===U.REPLACE;this.factor1=h?e.factor1:this.factor1*e.factor1,this.factor2=h?e.factor2:this.factor2*e.factor2}}class w{constructor(){this._operations=[],this._closed=!1}close(){this._closed=!0}apply(){for(const e of this._operations)e.apply()}undo(){for(let e=this._operations.length-1;e>=0;e--)this._operations[e].undo()}accumulate(e){if(this._closed)return!1;const h=this._operations.length?this._operations[this._operations.length-1]:null;return h&&h.accumulate(e)||(this._operations.push(e),e.apply()),!0}}class L extends W.Z{constructor(e){super(),this.data=e,this._undoStack=[],this._redoStack=[],this._listener=this.data.on("change",h=>{h.addedVertices&&this.emit("vertex-add",{type:"vertex-add",vertices:h.addedVertices,operation:h.operation}),h.removedVertices&&this.emit("vertex-remove",{type:"vertex-remove",vertices:h.removedVertices,operation:h.operation}),h.updatedVertices&&this.emit("vertex-update",{type:"vertex-update",vertices:h.updatedVertices,operation:h.operation})})}destroy(){this._listener.remove()}splitEdge(e,h){return this._apply(new H(this.data,e,h))}updateVertices(e,h,l=C.ACCUMULATE_STEPS){return this._apply(new z(this.data,e,h),l)}moveVertices(e,h,l,y,V=C.ACCUMULATE_STEPS){return this.updateVertices(e,new I(this.data.coordinateHelper,h,l,y),V)}scaleVertices(e,h,l,y,V,B=C.ACCUMULATE_STEPS,b=U.CUMULATIVE){return this.updateVertices(e,new R(h,l,y,V,b),B)}rotateVertices(e,h,l,y=C.ACCUMULATE_STEPS,V=U.CUMULATIVE){return this.updateVertices(e,new S(h,l,V),y)}removeVertices(e){return this._apply(new Z(this.data,e,this._minNumVerticesPerType))}appendVertex(e){return 0===this.data.components.length?null:this._apply(new N(this.data,this.data.components[0],e))}setVertexPosition(e,h){return this._apply(new k(this.data,e,h))}offsetEdge(e,h,l,y=C.ACCUMULATE_STEPS){return this.updateVertices([h.leftVertex,h.rightVertex],new v(this.data.coordinateHelper,e,h,l),y)}closeComponent(e){return this.data.components.includes(e)?this._apply(new Y(this.data,e)):null}canRemoveVertex(){return this.data.components[0].vertices.length>this._minNumVerticesPerType}createUndoGroup(){const e=new w;return this._apply(e),{remove:()=>e.close()}}undo(){if(this._undoStack.length>0){const e=this._undoStack.pop();return e.undo(),this._redoStack.push(e),e}return null}redo(){if(this._redoStack.length>0){const e=this._redoStack.pop();return e.apply(),this._undoStack.push(e),e}return null}get canUndo(){return this._undoStack.length>0}get canRedo(){return this._redoStack.length>0}get lastOperation(){return this._undoStack.length>0?this._undoStack[this._undoStack.length-1]:null}get _minNumVerticesPerType(){switch(this.data.type){case"point":return 1;case"polyline":return 2;case"polygon":return 3;default:return 0}}_apply(e,h=C.ACCUMULATE_STEPS){return h!==C.NEW_STEP&&!(0,g.Wi)(this.lastOperation)&&this.lastOperation.accumulate(e)||(e.apply(),this._undoStack.push(e),this._redoStack=[]),e}static fromGeometry(e,h){return new L(M.XE.fromGeometry(e,h))}}},396:(K,j,D)=>{D.d(j,{SP:()=>i,dU:()=>Y,k0:()=>U,xO:()=>H}),D(21286);var i,_,g=D(67831),M=D(99770);function C(_,x){return _[0]*x[1]-_[1]*x[0]}function U(_,x,v,A,T=v){return(0,g.a)(p,A,v),(0,g.a)(m,x,T),function z(_,x,v){const A=(0,g.h)(v,x)/(0,g.v)(v);(0,g.b)(_,v,A)}(E,m,p),(0,g.j)(_,T,E)}function H(_,x,v,A){(0,g.a)(p,x,v);const T=A/(0,g.i)(p);return(0,g.w)(_,v,p,T)}function Y(_,x){const v=_.start,T=x.start,X=x.end,O=(0,g.a)(p,_.end,v),S=(0,g.a)(u,X,T),R=C(O,S);if(Math.abs(R)<=d)return[];const w=(0,g.a)(m,v,T),L=C(S,w)/R,P=C(O,w)/R;if(L>=0){if(P>=0||x.type===i.LINE)return[(0,g.w)(E,v,O,L)]}else if(_.type===i.LINE&&(P>=0||x.type===i.LINE))return[(0,g.w)(E,v,O,L)];return[]}(_=i||(i={}))[_.RAY=0]="RAY",_[_.LINE=1]="LINE";const d=1e-6,p=(0,M.a)(),u=(0,M.a)(),m=(0,M.a)(),E=(0,M.a)()},66601:(K,j,D)=>{D.d(j,{m:()=>M});var W=D(55915),g=D(81863);function M(C){const N=(0,g.rS)(C),z=N===g.GG?g.wY:N;return(0,W.Up)(C,z)?z:C}}}]);