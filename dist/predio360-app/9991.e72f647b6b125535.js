"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[9991,5611],{19702:(U,g,e)=>{e.d(g,{A:()=>v});var u=e(15861),E=e(17626),I=e(54024),m=e(10699),D=e(32917),n=e(77712),S=(e(8314),e(63290),e(4619),e(76898)),y=e(36947);const v=l=>{let c=class extends l{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(a){super.postscript(a),(0,y.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}_validateHeightModelInfo(){var a=this;return(0,u.Z)(function*(){const _=new AbortController,o=_.signal;a.addHandles((0,I.kB)(()=>_.abort())),yield(0,D.N1)(()=>a.view.defaultsFromMap?.heightModelInfoReady,o),(0,m.k_)(o);const M=(0,y.Wt)(a.layer,a.view.heightModelInfo,a.supportsHeightUnitConversion);if(M)throw M})()}canResume(){const a=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return super.canResume()&&(!a?.minScale||!a.maxScale||a.minScale>=a.maxScale)}getSuspendInfo(){const a=super.getSuspendInfo(),_=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return _&&_.minScale&&_.maxScale&&_.minScale<_.maxScale&&(a.outsideScaleRange=!0),a}};return(0,E._)([(0,n.Cb)()],c.prototype,"view",void 0),(0,E._)([(0,n.Cb)()],c.prototype,"slicePlaneEnabled",void 0),c=(0,E._)([(0,S.j)("esri.views.3d.layers.LayerView3D")],c),c}},19991:(U,g,e)=>{e.r(g),e.d(g,{default:()=>j});var r,s,u=e(15861),E=e(17626),m=(e(29132),e(26584)),D=e(63290),n=e(32917),d=e(77712),S=(e(8314),e(4619),e(76898)),y=e(79800),v=e(29302),l=e(1582),c=e(5548),a=e(37053),_=e(19702),o=e(691),M=e(46196),A=e(40465),b=e(45611),V=e(93579),R=e(65234);(s=r||(r={}))[s.API=1]="API",s[s.VerboseAPI=2]="VerboseAPI",s[s.Error=3]="Error";const O=(0,v.Ue)(),w=(0,v.Ue)();let T=class extends((0,A.i)((0,_.A)(b.Z))){constructor(){super(...arguments),this._suspendedHandle=null,this._usedMemory=0,this._futureMemory=0,this.type="voxel-3d",this.slicePlaneEnabled=!1,this._wasmLayerId=-1,this.ignoresMemoryFactor=!0,this._dbgFlags=new Set}get baseUrl(){return this.layer.parsedUrl?.path??""}get wasmLayerId(){return this._wasmLayerId}initialize(){if(this._dbgFlags.add(r.Error),"local"!==this.view.viewingMode)throw new m.Z("voxel:unsupported-viewingMode","Voxel layers support local viewingMode only.",{});if(!this.view._stage.renderView.renderingContext.capabilities.colorBufferFloat?.textureFloat)throw new m.Z("voxel:missing-color-buffer-float","Voxel layers require the WebGL2 extension EXT_color_buffer_float",{});if(!(0,a.fS)(this.layer.spatialReference,this.view.spatialReference))throw new m.Z("layerview:spatial-reference-incompatible","The spatial reference of this scene layer is incompatible with the spatial reference of the view",{});const t=this.layer.currentVariableId,p=this.layer.getVolume(t),P=this.layer.getVariable(t);if(null!=p&&null!=P){const C=p.zDimension;if(C>1){const K=p.dimensions[0].size*p.dimensions[1].size*p.dimensions[C].size;let B=1;switch(P.renderingFormat.type){case"Int16":case"UInt16":B=2;break;case"Int32":case"UInt32":case"Float32":B=4}this._futureMemory=B*K}}const f=(0,o.JF)(this).then(W=>{this._wasmLayerId=W,this._suspendedHandle=(0,n.YP)(()=>this.suspended,i=>{const C=(0,o.$L)(this.view);C&&C.setEnabled(this,!i)},n.nn),this.addHandles([(0,n.YP)(()=>this.layer.renderMode,i=>this._pushRenderModeToWasm(i)),(0,n.YP)(()=>this.layer.currentVariableId,i=>this._pushCurrentVariableIdToWasm(i)),(0,n.YP)(()=>this.layer.getSections(),i=>this._pushSectionsToWasm(i)),(0,n.YP)(()=>this.layer.getVariableStyles(),i=>this._pushVariableStylesToWasm(i)),(0,n.YP)(()=>this.layer.getVolumeStyles(),i=>this._pushVolumeStylesToWasm(i)),(0,n.YP)(()=>this.layer.enableDynamicSections,i=>this._pushEnableDynamicSectionsToWasm(i)),(0,n.YP)(()=>this.layer.enableIsosurfaces,i=>this._pushEnableIsosurfacesToWasm(i)),(0,n.YP)(()=>this.layer.enableSections,i=>this._pushEnableSectionsToWasm(i)),(0,n.YP)(()=>this.layer.enableSlices,i=>this._pushEnableSlicesToWasm(i)),(0,n.YP)(()=>this.slicePlaneEnabled,i=>this._pushAnalysisSliceToWasm(i,this.view.slicePlane)),(0,n.YP)(()=>this.view.slicePlane,i=>this._pushAnalysisSliceToWasm(this.slicePlaneEnabled,i)),(0,n.YP)(()=>this.layer.minScale,i=>this._onScaleUpdated(this.view.scale,i,this.layer.maxScale),n.nn),(0,n.YP)(()=>this.layer.maxScale,i=>this._onScaleUpdated(this.view.scale,this.layer.minScale,i),n.nn),(0,n.YP)(()=>this.view.scale,i=>this._onScaleUpdated(i,this.layer.minScale,this.layer.maxScale),n.nn)])}).catch(W=>{if((0,o.mq)(this),this._wasmLayerId=-1,-1===W)throw new m.Z("voxel:addLayer-failure","The voxel layer description was invalid.",{});if(-2===W)throw new m.Z("voxel:addLayer-failure","The voxel layer web assembly module failed to download.",{})});this.addResolvingPromise(f)}destroy(){(0,o.mq)(this),this._suspendedHandle&&(this._suspendedHandle.remove(),this._suspendedHandle=null)}isUpdating(){const s=(0,o.$L)(this.view);return!(this._wasmLayerId<0||null==s)&&s.isUpdating(this._wasmLayerId)}updatingFlagChanged(){this.notifyChange("updating")}get usedMemory(){return this._usedMemory}get unloadedMemory(){return this._futureMemory}get performanceInfo(){return new M.W(this.usedMemory)}whenGraphicBounds(s,t){const p=s.attributes["Voxel.WorldPosition"];if(p){const P=(0,c.cS)(),f=JSON.parse(p);if((0,l.S)(f,this.view.renderSpatialReference,w,this.view.spatialReference||R.Z.WGS84))return(0,c.pp)(P,w),Promise.resolve({boundingBox:P,screenSpaceObjects:[]})}return Promise.reject()}setUsedMemory(s){this._usedMemory=s,this._futureMemory=0}captureFrustum(){(0,o.$L)(this.view)?.captureFrustum()}toggleFullVolumeExtentDraw(){(0,o.$L)(this.view)?.toggleFullVolumeExtentDraw(this)}getLayerTimes(){return(0,o.$L)(this.view)?.getLayerTimes(this)??[]}getCurrentLayerTimeIndex(){return(0,o.$L)(this.view)?.getCurrentLayerTimeIndex(this)??0}_pushRenderModeToWasm(s){const t=(0,o.$L)(this.view);this._dbg(r.VerboseAPI,"VoxelLayerView3D._pushRenderModeToWasm() called, "+(t?"have WASM":"don't have WASM!!!")),t?.setRenderMode(this,s)||this._dbg(r.Error,"VoxelLayerView3D._pushRenderModeToWasm() failed!")}_pushSectionsToWasm(s){const t=(0,o.$L)(this.view);this._dbg(r.VerboseAPI,"VoxelLayerView3D._pushSectionsToWasm() called, "+(t?"have WASM":"don't have WASM!!!")),t?.setStaticSections(this,s)||this._dbg(r.Error,"VoxelLayerView3D._pushSectionsToWasm() failed!")}_pushCurrentVariableIdToWasm(s){const t=(0,o.$L)(this.view);this._dbg(r.VerboseAPI,"VoxelLayerView3D._pushCurrentVariableIdToWasm() called!, "+(t?"have WASM":"don't have WASM!!!")),t?.setCurrentVariable(this,s)||this._dbg(r.Error,"VoxelLayerView3D._pushCurrentVariableIdToWasm() failed!")}_pushVariableStylesToWasm(s){const t=(0,o.$L)(this.view);this._dbg(r.VerboseAPI,"VoxelLayerView3D._pushVariableStylesToWasm() called, "+(t?"have WASM":"don't have WASM!!!")),t?.setVariableStyles(this,s)||this._dbg(r.Error,"VoxelLayerView3D._pushVariableStylesToWasm() failed!")}_accountForEnableSlices(s,t){const p=t??this.layer.enableSlices;for(let P=0;P<s.length;++P){const f=s[P];for(const W of f.slices)W.enabled=W.enabled&&p}}_pushVolumeStylesToWasm(s){const t=(0,o.$L)(this.view);this._dbg(r.VerboseAPI,"VoxelLayerView3D._pushVolumeStylesToWasm() called, "+(t?"have WASM":"don't have WASM!!!")),t&&(this._accountForEnableSlices(s,null),t.setVolumeStyles(this,s)||this._dbg(r.Error,"VoxelLayerView3D._pushVolumeStylesToWasm() failed!"))}_pushAnalysisSliceToWasm(s,t){const p=(0,o.$L)(this.view);this._dbg(r.VerboseAPI,"VoxelLayerView3D._pushAnalysisSliceToWasm() called, "+(p?"have WASM":"don't have WASM!!!"));let P=!1;if(p){if(t){const f=t.origin;(0,y.b)(O,t.basis1,t.basis2),(0,y.n)(O,O),P=p.setAnalysisSlice(this,s,f,O)}else(0,y.s)(O,0,0,1),P=p.setAnalysisSlice(this,!1,O,O);P||this._dbg(r.Error,"VoxelLayerView3D._pushAnalysisSliceToWasm() failed!")}}_pushEnableDynamicSectionsToWasm(s){const t=(0,o.$L)(this.view);this._dbg(r.VerboseAPI,"VoxelLayerView3D._pushEnableDynamicSectionsToWasm() called, "+(t?"have WASM":"don't have WASM!!!")),t?.setEnableDynamicSections(this,s)||this._dbg(r.Error,"VoxelLayerView3D._pushEnableDynamicSectionsToWasm() failed!")}_pushEnableSlicesToWasm(s){const t=(0,o.$L)(this.view);if(this._dbg(r.VerboseAPI,"VoxelLayerView3D._pushEnableSlicesToWasm() called, "+(t?"have WASM":"don't have WASM!!!")),t){const p=this.layer.getVolumeStyles();this._accountForEnableSlices(p,s),t.setVolumeStyles(this,p)||this._dbg(r.Error,"VoxelLayerView3D._pushEnableSlicesToWasm() failed!")}}_pushEnableIsosurfacesToWasm(s){const t=(0,o.$L)(this.view);this._dbg(r.VerboseAPI,"VoxelLayerView3D._pushEnableIsosurfacesToWasm() called, "+(t?"have WASM":"don't have WASM!!!")),t?.setEnableIsosurfaces(this,s)||this._dbg(r.Error,"VoxelLayerView3D._pushEnableIsosurfacesToWasm() failed!")}_pushEnableSectionsToWasm(s){const t=(0,o.$L)(this.view);this._dbg(r.VerboseAPI,"VoxelLayerView3D._pushEnableSectionsToWasm() called, "+(t?"have WASM":"don't have WASM!!!")),t?.setEnableSections(this,s)||this._dbg(r.Error,"VoxelLayerView3D._pushEnableSectionsToWasm() failed!")}_onScaleUpdated(s,t,p){const P=(0,V.rs)(s,t,p),f=(0,o.$L)(this.view);f&&f.setIsInScaleRange(this,P)}whenGraphicAttributes(s,t){return(0,u.Z)(function*(){return s})()}_dbg(s,t){this._dbgFlags.has(s)&&(s===r.Error?D.Z.getLogger(this).error(t):D.Z.getLogger(this).warn(t))}};(0,E._)([(0,d.Cb)()],T.prototype,"layer",void 0),(0,E._)([(0,d.Cb)()],T.prototype,"baseUrl",null),(0,E._)([(0,d.Cb)({type:Boolean})],T.prototype,"slicePlaneEnabled",void 0),T=(0,E._)([(0,S.j)("esri.views.3d.layers.VoxelLayerView3D")],T);const j=T},40465:(U,g,e)=>{e.d(g,{i:()=>S});var u=e(15861),E=e(17626),I=e(26584),d=(e(63290),e(8314),e(4619),e(76898)),h=e(90194),L=e(10023);const S=y=>{let v=class extends y{_validateFetchPopupFeatures(l){const{layer:c}=this,{popupEnabled:a}=c;if(!a)throw new I.Z("scenelayerview3d:fetchPopupFeatures","Popups are disabled",{layer:c});if(!(0,L.V5)(c,l))throw new I.Z("scenelayerview3d:fetchPopupFeatures","Layer does not define a popup template",{layer:c})}prepareFetchPopupFeatures(l){return(0,u.Z)(function*(){})()}fetchPopupFeaturesFromGraphics(l,c){var a=this;return(0,u.Z)(function*(){if(a._validateFetchPopupFeatures(c),0===l.length)return[];const _="scene"===a.layer.type&&null!=a.layer.associatedLayer?a.layer.associatedLayer:a.layer;let o=[];"fieldsIndex"in a.layer&&(o=(0,h.Lk)(a.layer.fieldsIndex,yield(0,L.e7)(_,(0,L.V5)(a.layer,c)))),yield a.prepareFetchPopupFeatures(o);const M=new Set,A=[],b=[];for(const r of l)(0,h.Gm)(o,r,M)?b.push(r):A.push(r);if(0===b.length)return A;const V=new Map;for(let r=0;r<l.length;r++)V.set(l[r].getObjectId()??0,r);const R=yield a.whenGraphicAttributes(b,[...M]).catch(()=>b).then(r=>A.concat(r));return R.sort((r,O)=>{const w=r.getObjectId()??0,T=V.get(w)??0,j=O.getObjectId()??0;return T-(V.get(j)??0)}),R})()}};return v=(0,E._)([(0,d.j)("esri.views.3d.layers.support.PopupSceneLayerView")],v),v}},45611:(U,g,e)=>{e.d(g,{Z:()=>c});var u=e(17626),E=e(83761),I=e(61885),m=e(61996),D=e(63290),n=e(62208),d=e(60330),h=e(77712),y=(e(8314),e(4619),e(76898)),v=e(11426);let l=class extends((0,m.IG)((0,d.v)(I.Z.EventedMixin(E.Z)))){constructor(a){super(a),this._updatingHandles=new v.R,this.layer=null,this.parent=null}initialize(){this.when().catch(a=>{if("layerview:create-error"!==a.name){const _=this.layer&&this.layer.id||"no id",o=this.layer?.title||"no title";D.Z.getLogger(this).error("#resolve()",`Failed to resolve layer view (layer title: '${o}', id: '${_}')`,a)}})}destroy(){this._updatingHandles=(0,n.SC)(this._updatingHandles)}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){return!0===this.layer?.visible}set visible(a){this._overrideIfSome("visible",a)}canResume(){return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready||!1}getSuspendInfo(){const a=this.parent?.suspended?this.parent.suspendInfo:{};return this.view?.ready||(a.viewNotReady=!0),this.layer&&this.layer.loaded||(a.layerNotLoaded=!0),this.visible||(a.layerInvisible=!0),a}isUpdating(){return!1}};(0,u._)([(0,h.Cb)()],l.prototype,"fullOpacity",null),(0,u._)([(0,h.Cb)()],l.prototype,"layer",void 0),(0,u._)([(0,h.Cb)()],l.prototype,"parent",void 0),(0,u._)([(0,h.Cb)({readOnly:!0})],l.prototype,"suspended",null),(0,u._)([(0,h.Cb)({readOnly:!0})],l.prototype,"suspendInfo",null),(0,u._)([(0,h.Cb)({readOnly:!0})],l.prototype,"legendEnabled",null),(0,u._)([(0,h.Cb)({type:Boolean,readOnly:!0})],l.prototype,"updating",null),(0,u._)([(0,h.Cb)({readOnly:!0})],l.prototype,"updatingProgress",null),(0,u._)([(0,h.Cb)()],l.prototype,"visible",null),(0,u._)([(0,h.Cb)()],l.prototype,"view",void 0),l=(0,u._)([(0,y.j)("esri.views.layers.LayerView")],l);const c=l},10023:(U,g,e)=>{e.d(g,{V5:()=>D,e7:()=>I,zc:()=>n});var u=e(15861),E=e(90194);function I(d){return m.apply(this,arguments)}function m(){return(m=(0,u.Z)(function*(d,h=d.popupTemplate){if(null==h)return[];const L=yield h.getRequiredFields(d.fieldsIndex),{lastEditInfoEnabled:S}=h,{objectIdField:y,typeIdField:v,globalIdField:l,relationships:c}=d;if(L.includes("*"))return["*"];const a=S?(0,E.CH)(d):[],_=(0,E.Q0)(d.fieldsIndex,[...L,...a]);return v&&_.push(v),_&&y&&d.fieldsIndex?.has(y)&&!_.includes(y)&&_.push(y),_&&l&&d.fieldsIndex?.has(l)&&!_.includes(l)&&_.push(l),c&&c.forEach(o=>{const{keyField:M}=o;_&&M&&d.fieldsIndex?.has(M)&&!_.includes(M)&&_.push(M)}),_})).apply(this,arguments)}function D(d,h){return d.popupTemplate?d.popupTemplate:null!=h&&h.defaultPopupTemplateEnabled&&null!=d.defaultPopupTemplate?d.defaultPopupTemplate:null}function n(d,h){return null!=D(d,{defaultPopupTemplateEnabled:h})}}}]);