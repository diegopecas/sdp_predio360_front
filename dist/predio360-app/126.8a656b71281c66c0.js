"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[126],{50126:(W,Z,o)=>{o.d(Z,{Z:()=>fe});var b=o(15861),a=o(17626),O=o(26584),u=o(62208),m=o(32917),n=o(77712),x=(o(90912),o(85931),o(76898)),A=o(84786),E=o(23010),I=o(78448),R=o(19702),V=o(54984),w=o(14517),F=o(10699),L=o(38114),D=o(20477),$=o(88879),G=o(55713),J=o(42930),q=o(65234),X=o(36255);class k{constructor(r){this._controller=r,this._handle=new te(e=>r.schedule(e))}destroy(){this._handle.destroy()}invoke(r,e){var i=this;return r.buffer&&0!==r.buffer.byteLength?(r.options.sourceSpatialReference&&r.options.sourceSpatialReference instanceof q.Z&&(r.options={...r.options,sourceSpatialReference:r.options.sourceSpatialReference.toJSON()}),this._handle.invoke(r,e).then(s=>{let l=0,c=0;const h=function(){var d=(0,b.Z)(function*(y){if(s.spatialReference=q.Z.fromJSON(s.spatialReference),s.fields)for(;l<s.fields.length;)if(s.fields[l]=X.Z.fromJSON(s.fields[l]),l++,y.madeProgress())return i._controller.reschedule(C=>h(C));const p=s.spatialReference;for(;c<s.features.length;){const C=s.features[c];if(++c,C.uid=$.Z.generateUID(),(0,u.pC)(C.geometry)&&(C.geometry.spatialReference=p,ee(C.geometry),y.madeProgress()))return i._controller.reschedule(M=>h(M))}return s});return function(p){return d.apply(this,arguments)}}();return this._controller.schedule(d=>h(d))})):Promise.resolve(null)}}function ee(t){switch(t.type){case"polyline":t.paths.reduce((r,e)=>r+e.length,0)<G.DB&&(t.paths=t.paths.map(t.hasZ||t.hasM?r=>r.map(e=>[e[0],e[1],e[2]]):r=>r.map(e=>[e[0],e[1]])));break;case"polygon":t.rings.reduce((r,e)=>r+e.length,0)<G.DB&&(t.rings=t.rings.map(t.hasZ||t.hasM?r=>r.map(e=>[e[0],e[1],e[2]]):r=>r.map(e=>[e[0],e[1]])))}}class te extends J.q{constructor(r){super("PBFDecoderWorker","_parseFeatureQuery",{_parseFeatureQuery:e=>[e.buffer]},r)}}let T=class extends w.Z{constructor(t){super(t)}get queryFeaturesDehydrated(){const t=this.layer.capabilities,r=t&&t.query,i=this.layer.parsedUrl;if(r&&r.supportsFormatPBF){(0,u.Wi)(this._decoder)&&(this._decoder=new k(this.controller));const s={sourceSpatialReference:this.layer.spatialReference?.toJSON()??null,applyTransform:!0,maxStringAttributeLength:1024};return(l,c)=>(0,D.Vn)(i,l,"pbf",this._createRequestOptions(c)).then(h=>((0,F.k_)(c),(0,u.pC)(this._decoder)?this._decoder.invoke({buffer:h.data,options:s},c.signal):Promise.reject((0,F.zE)())))}return(s,l)=>(0,D.JT)(i,s,this.layer.spatialReference,this._createRequestOptions(l)).then(c=>(0,L.PA)(c.data))}queryFeatureCount(t,r){return this.layer.queryFeatureCount(t,r)}destroy(){this._decoder=(0,u.SC)(this._decoder)}_createRequestOptions(t){return{...t,query:{...this.layer.customParameters,token:this.layer.apiKey,...t?.query}}}};(0,a._)([(0,n.Cb)({constructOnly:!0})],T.prototype,"layer",void 0),(0,a._)([(0,n.Cb)({constructOnly:!0})],T.prototype,"controller",void 0),(0,a._)([(0,n.Cb)({readOnly:!0})],T.prototype,"queryFeaturesDehydrated",null),T=(0,a._)([(0,x.j)("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileServiceQuery3D")],T);let S=class extends w.Z{constructor(t){super(t)}queryFeaturesDehydrated(t,r){return this.layer.queryFeatures(t,r)}queryFeatureCount(t,r){return this.layer.queryFeatureCount(t,r)}};(0,a._)([(0,n.Cb)({constructOnly:!0})],S.prototype,"layer",void 0),(0,a._)([(0,n.Cb)({readOnly:!0})],S.prototype,"queryFeaturesDehydrated",null),S=(0,a._)([(0,x.j)("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileServiceMeshQuery3D")],S);let N=class extends w.Z{constructor(t){super(t)}queryFeaturesDehydrated(t,r){return this.layer.queryFeatures(t,r)}};(0,a._)([(0,n.Cb)({constructOnly:!0})],N.prototype,"layer",void 0),N=(0,a._)([(0,x.j)("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileServiceQuery3D")],N);let j=class extends w.Z{constructor(t){super(t)}queryFeaturesDehydrated(t,r){return this.source.queryFeaturesJSON(t,r).then(L.PA,e=>{if(e&&"query-features-json:unsupported"===e.name)return this.layer.queryFeatures(t,r);throw e})}queryFeatureCount(t,r){return this.layer.queryFeatureCount(t,r)}};(0,a._)([(0,n.Cb)({constructOnly:!0})],j.prototype,"layer",void 0),(0,a._)([(0,n.Cb)({constructOnly:!0})],j.prototype,"source",void 0),j=(0,a._)([(0,x.j)("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileClientQuery3D")],j);class se{constructor(r){this._memoryCache=null,this._capabilities=null;const e=r.layerView.layer;this._layerView=r.layerView,this.objectIdField=e.objectIdField,this.globalIdField="globalIdField"in e?e.globalIdField:null,this._returnZ=r.returnZ,this._returnM=r.returnM;const i=this._layerView.view.resourceController;this.query=function re(t,r){return"feature"===t.type&&"feature-layer"===t.source.type?(0,u.pC)(t.infoFor3D)?new S({layer:t}):new T({layer:t,controller:r}):"feature"===t.type&&"memory"===t.source.type||"csv"===t.type||"geojson"===t.type||"oriented-imagery"===t.type||"wfs"===t.type?new j({layer:t,source:t.source}):"ogc-feature"===t.type?new N({layer:t}):null}(e,i.normal),i&&this._memoryCacheEnabled&&(this._memoryCache=i.memoryController.newCache(e.uid))}get _memoryCacheEnabled(){switch(this._layerView.layer.source.type){case"feature-layer":case"ogc-feature":case"oriented-imagery":return!0;case"csv":case"geojson":case"memory":case"wfs":return!1}}destroy(){this._memoryCache=(0,u.SC)(this._memoryCache),this.query.destroy()}createQuery(){const r=this._layerView.layer.createQuery();return r.outFields=this._layerView.availableFields,r.returnZ=this._returnZ,r.returnM=this._returnM,r.outSpatialReference=this.tilingScheme.spatialReference,r}get memoryCache(){return this._memoryCache}get viewingMode(){return this._layerView.view.state.viewingMode}get tilingScheme(){return this._layerView.view.featureTiles.tilingScheme}get scheduler(){const r=this._layerView.view.resourceController;return r?r.scheduler:null}get geometryType(){return this._layerView.layer.geometryType}get fullExtent(){return this._layerView.layer.fullExtent}get tileMaxRecordCount(){return this._layerView.layer.capabilities.query.tileMaxRecordCount}get maxRecordCount(){return this._layerView.layer.capabilities.query.maxRecordCount}get capabilities(){return(0,u.pC)(this._capabilities)||(this._capabilities=(0,V.A)(this._layerView.layer)),this._capabilities}logFetchError(r,e){r.error("#fetchTile()",this._layerView.layer,e&&e.message?e.message:e)}}var ie=o(36967),oe=o(41632),U=o(23147),ae=o(63290),ne=o(13812),le=o(2319),ue=o(98624),f=o(36630),K=o(59990),z=o(96854),de=o(46679),Q=o(10023);const H="esri.views.layers.FeatureLayerView",B=ae.Z.getLogger(H),pe=t=>{let r=class extends t{constructor(...e){super(...e),this._updatingRequiredFieldsPromise=null,this.filter=null,this.timeExtent=null,this.layer=null,this.requiredFields=[],this.view=null}initialize(){this.handles.add([(0,m.YP)(()=>{const e=this.layer;return[e?.elevationInfo?.featureExpressionInfo,e&&"displayField"in e?e.displayField:null,e&&"timeInfo"in e&&e.timeInfo,e&&"renderer"in e&&e.renderer,e&&"labelingInfo"in e&&e.labelingInfo,e&&"floorInfo"in e&&e.floorInfo,this.filter,this.featureEffect,this.timeExtent]},()=>this._handleRequiredFieldsChange(),m.tX),(0,m.on)(()=>this.view?.floors,"change",()=>this._handleRequiredFieldsChange()),(0,m.on)(()=>{const e=this.layer;return e&&"sublayers"in e?e.sublayers:null},"change",()=>this._handleRequiredFieldsChange())])}get availableFields(){const{layer:e,layer:{fieldsIndex:i},requiredFields:s}=this;return(0,f.Q0)(i,"outFields"in e&&e.outFields?[...(0,f.Lk)(i,e.outFields),...s]:s)}get featureEffect(){return this.layer&&"featureEffect"in this.layer?this.layer.featureEffect:null}set featureEffect(e){this._override("featureEffect",e)}get maximumNumberOfFeatures(){return 0}set maximumNumberOfFeatures(e){B.error("#maximumNumberOfFeatures=","Setting maximum number of features is not supported")}get maximumNumberOfFeaturesExceeded(){return!1}highlight(e){throw new Error("missing implementation")}createQuery(){const e={outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference},i=(0,u.pC)(this.filter)?this.filter.createQuery(e):new z.Z(e);if("feature"===this.layer.type){const s=(0,K.c)(this);(0,u.pC)(s)&&(i.where=i.where?`(${i.where}) AND (${s})`:s)}return(0,u.pC)(this.timeExtent)&&(i.timeExtent=(0,u.pC)(i.timeExtent)?i.timeExtent.intersection(this.timeExtent):this.timeExtent.clone()),i}createAggregateQuery(){return new z.Z({outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference})}queryFeatures(e,i){throw new Error("missing implementation")}queryObjectIds(e,i){throw new Error("missing implementation")}queryFeatureCount(e,i){throw new Error("missing implementation")}queryExtent(e,i){throw new Error("missing implementation")}fetchPopupFeatures(e,i){var s=this;return(0,b.Z)(function*(){const l=s.validateFetchPopupFeatures(i);if(l)throw l;return s.fetchClientPopupFeatures(i)})()}_loadArcadeModules(e){return e.get("expressionInfos.length")||Array.isArray(e.content)&&e.content.some(i=>"expression"===i.type)?(0,de.LC)():Promise.resolve()}_handleRequiredFieldsChange(){const e=this._updateRequiredFields();this._set("_updatingRequiredFieldsPromise",e),e.then(()=>{this._updatingRequiredFieldsPromise===e&&this._set("_updatingRequiredFieldsPromise",null)})}_updateRequiredFields(){var e=this;return(0,b.Z)(function*(){if(!e.layer||!e.view)return;const i="3d"===e.view.type,{layer:s,layer:{fieldsIndex:l,objectIdField:c}}=e,h="renderer"in s&&s.renderer,d="orderBy"in s&&s.orderBy,y="featureReduction"in s?s.featureReduction:null,p=new Set,C=yield(0,F.as)([h?h.collectRequiredFields(p,l):null,(0,f.Mu)(p,s),i?(0,f.vl)(p,s):null,(0,u.pC)(e.filter)?(0,f.Ll)(p,s,e.filter):null,(0,u.pC)(e.featureEffect)?(0,f.Ll)(p,s,e.featureEffect.filter):null,y?(0,f.ZV)(p,s,y):null,d?(0,f.Qj)(p,s,d):null]);if("timeInfo"in s&&s.timeInfo&&e.timeExtent&&(0,f.gd)(p,s.fieldsIndex,[s.timeInfo.startField,s.timeInfo.endField]),"feature"===s.type&&(s.floorInfo&&(0,f.gd)(p,s.fieldsIndex,[s.floorInfo.floorField]),i&&(0,u.pC)(s.infoFor3D)&&(null==s.globalIdField&&B.error("globalIdField missing on 3DObjectFeatureLayer"),(0,f.gd)(p,s.fieldsIndex,[s.globalIdField]))),"subtype-group"===s.type){(0,f.AB)(p,l,s.subtypeField);const _=s.sublayers.map(Y=>Promise.all([Y.renderer?.collectRequiredFields(p,l),(0,f.Mu)(p,Y)]));yield(0,F.as)(_)}for(const _ of C)_.error&&B.error(_.error);(0,f.AB)(p,l,c),i&&"displayField"in s&&s.displayField&&(0,f.AB)(p,l,s.displayField);const M=Array.from(p).sort();e._set("requiredFields",M)})()}validateFetchPopupFeatures(e){if((0,u.Wi)(e))return null;for(const i of e.clientGraphics??[]){const s=i.layer;if("popupEnabled"in s&&!s.popupEnabled)return new O.Z("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:s});if(i.isAggregate){const l="featureReduction"in s?s.featureReduction:null;if(!(l&&"popupTemplate"in l&&l.popupEnabled&&l.popupTemplate))return new O.Z("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:s})}else if("popupTemplate"in s&&!(0,Q.V)(s,e))return new O.Z("featurelayerview:fetchPopupFeatures","Layer does not define a popup template",{layer:s})}}fetchClientPopupFeatures(e){var i=this;return(0,b.Z)(function*(){const s=(0,u.pC)(e)?e.clientGraphics:null;if(!s||0===s.length)return[];const l=new Array(s.length),c=new Map,h=yield i.createPopupQuery(e);for(let d=0;d<s.length;d++){const y=s[d];if(y.isAggregate){l[d]=y;continue}const p=y.layer;if(!("popupEnabled"in p))continue;const C=(0,f.Lk)(i.layer.fieldsIndex,h.outFields),M=(0,Q.V)(p,e);if((0,u.Wi)(M))continue;const _=yield i._loadArcadeModules(M);_&&_.arcadeUtils.hasGeometryOperations(M)||!(0,f.R9)(C,y)?c.set(y.getObjectId(),{graphic:y,index:d}):l[d]=y}if("stream"===i.layer.type||0===c.size)return l.filter(Boolean);h.objectIds=Array.from(c.keys());try{const d=yield i.layer.queryFeatures(h);for(const y of d.features){const{graphic:{geometry:p},index:C}=c.get(y.getObjectId());y.geometry||(y.geometry=p),l[C]=y}}catch{}return l.filter(Boolean)})()}createPopupQuery(e){var i=this;return(0,b.Z)(function*(){const s=i.layer.createQuery(),l=new Set;let c=!1;const h=(0,u.pC)(e)&&e.clientGraphics?e.clientGraphics.map(d=>d.layer):[i.layer];for(const d of h){if(!("popupEnabled"in d))continue;const y=(0,Q.V)(d,e);if((0,u.Wi)(y))continue;const p=yield i._loadArcadeModules(y),C=p&&p.arcadeUtils.hasGeometryOperations(y);c=!("point"!==i.layer.geometryType&&!C);const M=yield(0,Q.e)(i.layer,y);for(const _ of M)l.add(_)}if(s.returnGeometry=c,s.returnZ=c,s.returnM=c,s.outFields=Array.from(l),s.outSpatialReference=i.view.spatialReference,"feature"===i.layer.type){const d=(0,K.c)(i);(0,u.pC)(d)&&(s.where=s.where?`(${s.where}) AND (${d})`:d)}return s})()}canResume(){return!(!super.canResume()||(0,u.pC)(this.timeExtent)&&this.timeExtent.isEmpty)}};return(0,a._)([(0,n.Cb)()],r.prototype,"_updatingRequiredFieldsPromise",void 0),(0,a._)([(0,n.Cb)({readOnly:!0})],r.prototype,"availableFields",null),(0,a._)([(0,n.Cb)({type:le.Z})],r.prototype,"featureEffect",null),(0,a._)([(0,n.Cb)({type:ue.Z})],r.prototype,"filter",void 0),(0,a._)([(0,n.Cb)(ne.qG)],r.prototype,"timeExtent",void 0),(0,a._)([(0,n.Cb)()],r.prototype,"layer",void 0),(0,a._)([(0,n.Cb)({type:Number})],r.prototype,"maximumNumberOfFeatures",null),(0,a._)([(0,n.Cb)({readOnly:!0,type:Boolean})],r.prototype,"maximumNumberOfFeaturesExceeded",null),(0,a._)([(0,n.Cb)({readOnly:!0})],r.prototype,"requiredFields",void 0),(0,a._)([(0,n.Cb)()],r.prototype,"suspended",void 0),(0,a._)([(0,n.Cb)()],r.prototype,"view",void 0),r=(0,a._)([(0,x.j)(H)],r),r};var ce=o(45611),ye=o(94421);let v=class extends((0,ye.Z)((0,I.R)(pe((0,R.A)(ce.Z))))){constructor(t){super(t),this._controllerTotal=0,this._processorTotal=0,this.suspendResumeExtentMode="data"}initialize(){this.handles.add((0,m.YP)(()=>this._updatingRequiredFieldsPromise,t=>this.updatingHandles.addPromise(t),m.tX))}destroy(){this.updatingHandles.removeAll(),this.handles.removeAll(),this._fetcherContext=(0,u.SC)(this._fetcherContext)}get maximumNumberOfFeatures(){return this.controller?.maximumNumberOfFeatures??this._get("maximumNumberOfFeatures")}set maximumNumberOfFeatures(t){this._set("maximumNumberOfFeatures",t),this.controller&&(this.controller.maximumNumberOfFeatures=t)}get maximumNumberOfFeaturesExceeded(){return!!this.controller&&!(this.suspended||!this.controller.maximumNumberOfFeaturesExceeded)}get updatingProgressValue(){let t=0;if(this.controller?.updating){const e=this.controller.updatingRemaining,i=Math.max(this.controller.updatingTotal,this._controllerTotal);i>0&&(t=(i-e)/i,this._controllerTotal=i)}let r=0;if(this.processor?.updating){const e=this.processor.updatingRemaining,i=Math.max(e,this._processorTotal);i>0&&(r=(i-e)/i,this._processorTotal=i)}return.5*(t+r)}get updatePolicy(){if(!this.controller)return U.j.ASYNC;switch(this.controller.mode){case"snapshot":{const t=he[this.layer.geometryType];return null==t||this.controller.serviceDataCount>t?U.j.ASYNC:U.j.SYNC}case"tiles":return U.j.ASYNC}}get hasZ(){const t=this.layer,r=t.capabilities&&t.capabilities.data;return!(!r||!r.supportsZ)&&("returnZ"in t&&null!=t.returnZ?t.returnZ:r.supportsZ)}get hasM(){const t=this.layer,r=t.capabilities&&t.capabilities.data;return!(!r||!r.supportsM)&&"returnM"in t&&null!=t.returnM&&t.returnM}setVisibility(t,r){this.processor?.setObjectIdVisibility(t,r)}createQuery(){return super.createQuery()}queryFeatures(t,r){const e=()=>super.queryFeatures(t,r);return"mesh"===this.layer.geometryType?this._queryFeaturesMesh(this._ensureQuery(t),e):e()}beforeSetController(t){t.maximumNumberOfFeatures=this.maximumNumberOfFeatures}createController(){this._fetcherContext=new se({layerView:this,returnZ:this.hasZ,returnM:this.hasM});const t=new E.g({layerView:this,context:this._fetcherContext,graphics:new ie.g,extent:this.clippingExtent});return this.updatingHandles.add(()=>t.serviceDataExtent,r=>{this.processor&&(this.processor.dataExtent=r)},m.nn),this.handles.add((0,m.YP)(()=>this.suspended,r=>{r?t.suspend():t.resume()},m.tX)),this.updatingHandles.add(()=>this.processor?.displayFeatureLimit,r=>t.displayFeatureLimit=r,m.nn),this.handles.add((0,m.gx)(()=>!this.updating,()=>{this._controllerTotal=0,this._processorTotal=0})),t}doRefresh(t){var r=this;return(0,b.Z)(function*(){t&&!r.suspended&&r.controller&&r.controller.refetch(),r.processor.refreshFilter()})()}getUsedMemory(){return(this.processor?.usedMemory??0)+(this.controller?.memoryForUnusedFeatures??0)}getUnloadedMemory(){const r=this.controller?.expectedFeatureDiff??0,e=this.processor?.loadedFeatures??0;return(this.processor?.unprocessedMemoryEstimate??0)+r*(this.processor?.usedMemoryPerFeature??0)*(e/(e+r))}ignoresMemoryFactor(){return this.controller?.hasMaximumNumberOfFeaturesOverride}_queryFeaturesMesh(t,r){var e=this;return(0,b.Z)(function*(){yield e._validateQueryFeaturesMesh(t);const i=yield r();if(t&&t.outStatistics||(0,u.Wi)(e.graphics3DProcessor))return i;const s=e.layer.objectIdField,l=e.graphics3DProcessor.graphics3DGraphicsByObjectID,c=[];for(const h of i.features)if(h.geometry){const d=l.get(h.attributes[s]);d&&(h.geometry=(0,A.kB)(d.graphic.geometry),c.push(h))}else c.push(h);return i.features=c,i})()}_validateQueryFeaturesMesh(t){var r=this;return(0,b.Z)(function*(){if(!t)return;const e=s=>{throw new O.Z("feature-layer-view:unsupported-query",`Queries on Mesh feature collection layers do not support '${s}'`)},i=["quantizationParameters","geometryPrecision","maxAllowableOffset"];for(const s of i)null!=t[s]&&e(s);"returnM"in t&&t.returnM&&e("returnM"),"returnCentroid"in t&&t.returnCentroid&&e("returnCentroid"),(0,u.pC)(t.outSpatialReference)&&!t.outSpatialReference.equals(r.view.spatialReference)&&e("outSpatialReference")})()}get performanceInfo(){const t=this.controller?.displayFeatureLimit,r=(0,u.pC)(t)?t.averageSymbolComplexity:void 0,e=(0,u.pC)(r)?`f:${r.primitivesPerFeature},v:${r.primitivesPerCoordinate}`:"n/a";return{...this._getResourceInfo(),partial:this.maximumNumberOfFeaturesExceeded,mode:this.controller?.mode??"n/a",symbolComplexity:e,nodes:this.controller?.tileDescriptors.length??0,...this.controller?.debug??{storedFeatures:0,totalVertices:0}}}get test(){return{updatePolicy:this.updatePolicy,controller:this.controller,loadedGraphics:this.controller?.graphics}}};(0,a._)([(0,n.Cb)()],v.prototype,"layer",void 0),(0,a._)([(0,n.Cb)()],v.prototype,"controller",void 0),(0,a._)([(0,n.Cb)()],v.prototype,"_controllerTotal",void 0),(0,a._)([(0,n.Cb)()],v.prototype,"_processorTotal",void 0),(0,a._)([(0,n.Cb)()],v.prototype,"maximumNumberOfFeatures",null),(0,a._)([(0,n.Cb)()],v.prototype,"maximumNumberOfFeaturesExceeded",null),(0,a._)([(0,n.Cb)(oe.q)],v.prototype,"updatingProgress",void 0),(0,a._)([(0,n.Cb)({readOnly:!0})],v.prototype,"updatingProgressValue",null),(0,a._)([(0,n.Cb)({readOnly:!0})],v.prototype,"updatePolicy",null),(0,a._)([(0,n.Cb)({readOnly:!0})],v.prototype,"hasZ",null),(0,a._)([(0,n.Cb)({readOnly:!0})],v.prototype,"hasM",null),(0,a._)([(0,n.Cb)()],v.prototype,"suspendResumeExtentMode",void 0),v=(0,a._)([(0,x.j)("esri.views.3d.layers.FeatureLayerViewBase3D")],v);const he={point:5e3,polygon:500,polyline:1e3},fe=v},94421:(W,Z,o)=>{o.d(Z,{Z:()=>x});var b=o(17626),a=o(63290),O=o(10699),u=o(32917),m=o(77712),P=(o(90912),o(85931),o(76898));const x=A=>{let E=class extends A{initialize(){this.handles.add((0,u.on)(()=>this.layer,"refresh",I=>{this.doRefresh(I.dataChanged).catch(R=>{(0,O.D_)(R)||a.Z.getLogger(this.declaredClass).error(R)})}),"RefreshableLayerView")}};return(0,b._)([(0,m.Cb)()],E.prototype,"layer",void 0),E=(0,b._)([(0,P.j)("esri.layers.mixins.RefreshableLayerView")],E),E}},10023:(W,Z,o)=>{o.d(Z,{V:()=>n,e:()=>u});var b=o(15861),a=o(62208),O=o(36630);function u(g){return m.apply(this,arguments)}function m(){return(m=(0,b.Z)(function*(g,P=g.popupTemplate){if((0,a.Wi)(P))return[];const x=yield P.getRequiredFields(g.fieldsIndex),{lastEditInfoEnabled:A}=P,{objectIdField:E,typeIdField:I,globalIdField:R,relationships:V}=g;if(x.includes("*"))return["*"];const w=A?yield(0,O.CH)(g):[],F=(0,O.Q0)(g.fieldsIndex,[...x,...w]);return I&&F.push(I),F&&E&&g.fieldsIndex?.has(E)&&!F.includes(E)&&F.push(E),F&&R&&g.fieldsIndex?.has(R)&&!F.includes(R)&&F.push(R),V&&V.forEach(L=>{const{keyField:D}=L;F&&D&&g.fieldsIndex?.has(D)&&!F.includes(D)&&F.push(D)}),F})).apply(this,arguments)}function n(g,P){return g.popupTemplate?g.popupTemplate:(0,a.pC)(P)&&P.defaultPopupTemplateEnabled&&(0,a.pC)(g.defaultPopupTemplate)?g.defaultPopupTemplate:null}}}]);