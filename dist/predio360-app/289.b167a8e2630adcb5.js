"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[289],{70289:(me,b,t)=>{t.r(b),t.d(b,{default:()=>le});var g,m=t(15861),n=t(17626),U=(t(29132),t(73281)),E=(t(4832),t(68387),t(96794),t(69747),t(40425),t(69357),t(40342),t(73640),t(33474)),R=t(32088),A=t(84792),D=t(79608),y=t(26584),N=t(54024),M=t(58817),V=t(63290),w=t(99959),x=t(10699),o=t(77712),j=t(90912),T=t(68653),P=t(76898),h=t(71774),G=t(44917),J=t(65088),z=t(552),Y=t(50107),Q=t(35126),$=t(33491),W=t(49286),B=t(6647),H=t(30346),K=t(99555),X=t(97941),d=t(13812),k=t(26331),q=t(36255),_=t(55911),f=t(90194),ee=t(170),te=t(62667),re=t(86810);t(8314),t(4619);let p=g=class extends re.wq{constructor(){super(...arguments),this.age=null,this.ageReceived=null,this.displayCount=null,this.maxObservations=1}clone(){return new g({age:this.age,ageReceived:this.ageReceived,displayCount:this.displayCount,maxObservations:this.maxObservations})}};(0,n._)([(0,o.Cb)({type:Number,json:{write:!0}})],p.prototype,"age",void 0),(0,n._)([(0,o.Cb)({type:Number,json:{write:!0}})],p.prototype,"ageReceived",void 0),(0,n._)([(0,o.Cb)({type:Number,json:{write:!0}})],p.prototype,"displayCount",void 0),(0,n._)([(0,o.Cb)({type:Number,json:{write:!0}})],p.prototype,"maxObservations",void 0),p=g=(0,n._)([(0,P.j)("esri.layers.support.PurgeOptions")],p);const F=p;var ne=t(39683),oe=t(96854),ie=t(49430),se=t(82706),v=t(20885),O=t(65234),ae=t(2004);const Z=(0,_.v)();function L(r,e){return new y.Z("layer:unsupported",`Layer (${r.title}, ${r.id}) of type '${r.declaredClass}' ${e}`,{layer:r})}let i=class extends((0,$.M)((0,Q.b)((0,z.h)((0,X.n)((0,K.M)((0,H.Q)((0,J.Y)((0,W.q)((0,B.I)((0,w.R)((0,Y.N)((0,D.J)(G.Z))))))))))))){constructor(...r){var e;super(...r),e=this,this.copyright=null,this.definitionExpression=null,this.displayField=null,this.elevationInfo=null,this.fields=null,this.fieldsIndex=null,this.geometryDefinition=null,this.geometryType=null,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.maxReconnectionAttempts=0,this.maxReconnectionInterval=20,this.maxScale=0,this.minScale=0,this.objectIdField=null,this.operationalLayerType="ArcGISStreamLayer",this.outFields=["*"],this.popupEnabled=!0,this.popupTemplate=null,this.purgeOptions=new F,this.refreshInterval=0,this.screenSizePerspectiveEnabled=!0,this.sourceJSON=null,this.spatialReference=O.Z.WGS84,this.type="stream",this.url=null,this.updateInterval=300,this.useViewTime=!0,this.webSocketUrl=null,this._debouncedSaveOperations=(0,x.Ds)(function(){var s=(0,m.Z)(function*(a,l,c){const{save:S,saveAs:C}=yield Promise.all([t.e(8592),t.e(2697)]).then(t.bind(t,49668));switch(a){case v.x.SAVE:return S(e,l);case v.x.SAVE_AS:return C(e,c,l)}});return function(a,l,c){return s.apply(this,arguments)}}())}normalizeCtorArgs(r,e){return"string"==typeof r?{url:r,...e}:r}load(r){if(!("WebSocket"in globalThis))return this.addResolvingPromise(Promise.reject(new y.Z("stream-layer:websocket-unsupported","WebSocket is not supported in this browser. StreamLayer will not have real-time connection with the stream service."))),Promise.resolve(this);const e=null!=r?r.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Stream Service","Feed"]},r).catch(x.r9).then(()=>this._fetchService(e))),Promise.resolve(this)}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(r){const e=this._normalizeFeatureReduction(r);this._set("featureReduction",e)}set renderer(r){(0,f.YN)(r,this.fieldsIndex),this._set("renderer",r)}readRenderer(r,e,s){const a=(e=e.layerDefinition||e).drawingInfo?.renderer;if(a){const l=(0,E.a)(a,e,s)||void 0;return l||V.Z.getLogger(this).error("Failed to create renderer",{rendererDefinition:e.drawingInfo.renderer,layer:this,context:s}),l}return(0,k.Ob)(e,s)}connect(r){var e=this;return(0,m.Z)(function*(){const[{createConnection:s}]=yield Promise.all([Promise.all([t.e(5262),t.e(901)]).then(t.bind(t,20901)),e.load()]),a=e.geometryType?h.M.toJSON(e.geometryType):null,{customParameters:l=null,definitionExpression:c=null,geometryDefinition:S=null,maxReconnectionAttempts:C=0,maxReconnectionInterval:de=20,spatialReference:pe=e.spatialReference}=r||e.createConnectionParameters(),u=s(e.parsedUrl,e.spatialReference,pe,a,c,S,C,de,l??void 0),ye=(0,N.AL)([e.on("send-message-to-socket",I=>u.sendMessageToSocket(I)),e.on("send-message-to-client",I=>u.sendMessageToClient(I))]);return u.once("destroy",ye.remove),u})()}createConnectionParameters(){return{spatialReference:this.spatialReference,customParameters:this.customParameters,definitionExpression:this.definitionExpression,geometryDefinition:this.geometryDefinition,maxReconnectionAttempts:this.maxReconnectionAttempts,maxReconnectionInterval:this.maxReconnectionInterval}}createPopupTemplate(r){return(0,ie.eZ)(this,r)}createQuery(){const r=new oe.Z;return r.returnGeometry=!0,r.outFields=["*"],r.where=this.definitionExpression||"1=1",r}getFieldDomain(r,e){if(!this.fields)return null;let s=null;return this.fields.some(a=>(a.name===r&&(s=a.domain),!!s)),s}getField(r){return this.fieldsIndex.get(r)}serviceSupportsSpatialReference(r){return!0}sendMessageToSocket(r){this.emit("send-message-to-socket",r)}sendMessageToClient(r){this.emit("send-message-to-client",r)}save(r){var e=this;return(0,m.Z)(function*(){return e._debouncedSaveOperations(v.x.SAVE,r)})()}saveAs(r,e){var s=this;return(0,m.Z)(function*(){return s._debouncedSaveOperations(v.x.SAVE_AS,e,r)})()}write(r,e){const s=e?.messages;return this.webSocketUrl?(s?.push(L(this,"using a custom websocket connection cannot be written to web scenes and web maps")),null):this.parsedUrl?super.write(r,e):(s?.push(L(this,"using a client-side only connection without a url cannot be written to web scenes and web maps")),null)}_fetchService(r){var e=this;return(0,m.Z)(function*(){if(!e.webSocketUrl&&e.parsedUrl){if(!e.sourceJSON){const{data:s}=yield(0,A.Z)(e.parsedUrl.path,{query:{f:"json",...e.customParameters,...e.parsedUrl.query},responseType:"json",signal:r});e.sourceJSON=s}}else{if(!e.timeInfo?.trackIdField)throw new y.Z("stream-layer:missing-metadata","The stream layer trackIdField must be specified.");if(!e.objectIdField){const s=e.fields.find(a=>"oid"===a.type)?.name;if(!s)throw new y.Z("stream-layer:missing-metadata","The stream layer objectIdField must be specified.");e.objectIdField=s}if(!e.fields)throw new y.Z("stream-layer:missing-metadata","The stream layer fields must be specified.");if(e.fields.some(s=>s.name===e.objectIdField)||e.fields.push(new q.Z({name:e.objectIdField,alias:e.objectIdField,type:"oid"})),!e.geometryType)throw new y.Z("stream-layer:missing-metadata","The stream layer geometryType must be specified.");e.webSocketUrl&&(e.url=e.webSocketUrl)}return e.read(e.sourceJSON,{origin:"service",portalItem:e.portalItem,portal:e.portalItem?.portal,url:e.parsedUrl}),(0,f.YN)(e.renderer,e.fieldsIndex),(0,f.UF)(e.timeInfo,e.fieldsIndex),e.objectIdField||(e.objectIdField="__esri_stream_id__"),(0,ne.y)(e,{origin:"service"})})()}};(0,n._)([(0,o.Cb)({type:String})],i.prototype,"copyright",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],i.prototype,"defaultPopupTemplate",null),(0,n._)([(0,o.Cb)({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],i.prototype,"definitionExpression",void 0),(0,n._)([(0,o.Cb)({type:String})],i.prototype,"displayField",void 0),(0,n._)([(0,o.Cb)({type:se.Z})],i.prototype,"elevationInfo",void 0),(0,n._)([(0,o.Cb)({json:{origins:{"web-map":{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-scene":{read:!1,write:!1}}}})],i.prototype,"featureReduction",null),(0,n._)([(0,o.Cb)(Z.fields)],i.prototype,"fields",void 0),(0,n._)([(0,o.Cb)(Z.fieldsIndex)],i.prototype,"fieldsIndex",void 0),(0,n._)([(0,o.Cb)({type:ae.Z,json:{name:"layerDefinition.definitionGeometry",write:!0}})],i.prototype,"geometryDefinition",void 0),(0,n._)([(0,o.Cb)({type:h.M.apiValues,json:{read:{reader:h.M.read}}})],i.prototype,"geometryType",void 0),(0,n._)([(0,o.Cb)(d.iR)],i.prototype,"labelsVisible",void 0),(0,n._)([(0,o.Cb)({type:[ee.Z],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:te.r},write:!0}})],i.prototype,"labelingInfo",void 0),(0,n._)([(0,o.Cb)(d.rn)],i.prototype,"legendEnabled",void 0),(0,n._)([(0,o.Cb)({type:["show","hide"],json:{origins:{"portal-item":{read:!1,write:!1}}}})],i.prototype,"listMode",void 0),(0,n._)([(0,o.Cb)({type:j.z8})],i.prototype,"maxReconnectionAttempts",void 0),(0,n._)([(0,o.Cb)({type:j.z8})],i.prototype,"maxReconnectionInterval",void 0),(0,n._)([(0,o.Cb)(d.u1)],i.prototype,"maxScale",void 0),(0,n._)([(0,o.Cb)(d.rO)],i.prototype,"minScale",void 0),(0,n._)([(0,o.Cb)({type:String})],i.prototype,"objectIdField",void 0),(0,n._)([(0,o.Cb)({value:"ArcGISStreamLayer",type:["ArcGISStreamLayer"]})],i.prototype,"operationalLayerType",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],i.prototype,"outFields",void 0),(0,n._)([(0,o.Cb)(d.C_)],i.prototype,"popupEnabled",void 0),(0,n._)([(0,o.Cb)({type:U.Z,json:{name:"popupInfo",write:!0}})],i.prototype,"popupTemplate",void 0),(0,n._)([(0,o.Cb)({type:F})],i.prototype,"purgeOptions",void 0),(0,n._)([(0,o.Cb)({json:{read:!1,write:!1}})],i.prototype,"refreshInterval",void 0),(0,n._)([(0,o.Cb)({types:R.A,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{name:"layerDefinition.drawingInfo.renderer",types:R.o,write:!0}},write:{target:"layerDefinition.drawingInfo.renderer"}}})],i.prototype,"renderer",null),(0,n._)([(0,T.r)("service","renderer",["drawingInfo.renderer","defaultSymbol"]),(0,T.r)("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],i.prototype,"readRenderer",null),(0,n._)([(0,o.Cb)((()=>{const r=(0,M.d9)(d.YI);return r.json.origins["portal-item"]={read:!1,write:!1},r})())],i.prototype,"screenSizePerspectiveEnabled",void 0),(0,n._)([(0,o.Cb)()],i.prototype,"sourceJSON",void 0),(0,n._)([(0,o.Cb)({type:O.Z,json:{origins:{service:{read:{source:"spatialReference"}}}}})],i.prototype,"spatialReference",void 0),(0,n._)([(0,o.Cb)({json:{read:!1}})],i.prototype,"type",void 0),(0,n._)([(0,o.Cb)(d.HQ)],i.prototype,"url",void 0),(0,n._)([(0,o.Cb)({type:Number})],i.prototype,"updateInterval",void 0),(0,n._)([(0,o.Cb)({json:{read:!1,write:!1}})],i.prototype,"useViewTime",void 0),(0,n._)([(0,o.Cb)({type:String})],i.prototype,"webSocketUrl",void 0),i=(0,n._)([(0,P.j)("esri.layers.StreamLayer")],i);const le=i}}]);