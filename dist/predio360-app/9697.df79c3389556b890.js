"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[9697,5611],{91241:(L,M,e)=>{e.r(M),e.d(M,{default:()=>B});var o=e(15861),p=e(17626),g=e(26584),y=e(32917),m=e(77712),d=(e(8314),e(63290),e(4619),e(76898)),E=e(28594),l=e(19702),P=e(50916),n=e(31498),u=e(12374),s=e(45611),_=e(94421),I=e(94672),O=e(31637);let T=class extends((0,u.Z)((0,_.Z)((0,P.r)((0,l.A)(s.Z))))){constructor(){super(...arguments),this.type="imagery-tile-3d",this.isAlignedMapTile=!0}initialize(){this.layer.increaseRasterJobHandlerUsage(),null==this.fullExtent&&this.addResolvingPromise(Promise.reject(new g.Z("layerview:spatial-reference-incompatible","The layer extent cannot be projected to the view's spatial reference",{layer:this.layer})));const i=(0,y.N1)(()=>this.view?.basemapTerrain?.tilingSchemeLocked).then(()=>{const c=this.view.basemapTerrain.tilingScheme,h=this.layer.tileInfo,f=["png","png24","png32","jpg","mixed"].includes(h.format)&&c.compatibleWith(h);this.isAlignedMapTile=f;const D=f?h:c.toTileInfo();this.tileInfo=D,this._updatingHandles.add(()=>[this.layer.renderer,this.layer.interpolation,this.layer.bandIds,this.layer.multidimensionalDefinition,this.layer.multidimensionalSubset,this.layer.rasterFunction,this.timeExtent],()=>this.refresh())});this.addResolvingPromise(i)}destroy(){this.layer.decreaseRasterJobHandlerUsage(),this.view=null}get _blankTile(){const i=document.createElement("canvas"),c=i.getContext("2d"),[h,f]=this.tileInfo.size;return i.width=h,i.height=f,c.clearRect(0,0,h,f),c.getImageData(0,0,h,f)}get imageFormatIsOpaque(){return"jpg"===this.layer.tileInfo.format}get hasMixedImageFormats(){return"mixed"===this.layer.tileInfo.format}get dataLevelRange(){const i=this.layer.tileInfo,c=this.tileInfo.lodAt(0)?.scale,h=this.layer.tileInfo.lodAt(i.lods.length-1)?.scale;return this.levelRangeFromScaleRange(c,h)}_getfullExtent(){return(0,E.lK)(this.layer.serviceRasterInfo,null!=this.view.basemapTerrain?.spatialReference?this.view.basemapTerrain.spatialReference:this.view.spatialReference)}fetchTile(i,c,h,f){var D=this;return(0,o.Z)(function*(){const A=D.tileInfo,W=D._canSymbolizeInWebGL(),b={tileInfo:A,requestRawData:W,signal:f.signal,timeExtent:D.timeExtent,requestAsImageElement:D.isAlignedMapTile,noClip:!1},{layer:C}=D,U=yield C.fetchTile(i,c,h,b);if(U instanceof HTMLImageElement)return U;let j=U?.pixelBlock;if(null==j||!W&&(j=yield C.applyRenderer(U),null==j))return D._blankTile;const R=new n.H([i,c,h],j,A.size[0],A.size[1]);return W?(R.symbolizerRenderer=C.symbolizer.rendererJSON,R.symbolizerParameters=C.symbolizer.generateWebGLParameters(D._getSymbolizerOptions(i)),R.transformGrid=U.transformGrid,R.bandIds=C.bandIds):(R.isRendereredSource=!0,R.bandIds=null),R.interpolation=C.interpolation,R})()}_getSymbolizerOptions(i){const c=this.tileInfo.lodAt(i).resolution;return{pixelBlock:null,isGCS:null!=this.view.basemapTerrain?.spatialReference?this.view.basemapTerrain.spatialReference.isGeographic:this.view.spatialReference.isGeographic,resolution:{x:c,y:c},bandIds:this.layer.bandIds}}ensureSymbolizerParameters(i){this._canSymbolizeInWebGL()&&JSON.stringify(i.symbolizerRenderer)!==JSON.stringify(this.layer.symbolizer.rendererJSON)&&(i.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(i.lij[0])))}createFetchPopupFeaturesQueryGeometry(i,c){return(0,I.K)(i,c,this.view)}refresh(){this.emit("data-changed")}doRefresh(){var i=this;return(0,o.Z)(function*(){i.suspended||i.emit("data-changed")})()}_canSymbolizeInWebGL(){const i=(0,O.h)(),{symbolizer:c}=this.layer,h=c.lookup?.colormapLut?.indexedColormap;return c.canRenderInWebGL&&!(h&&h.length>4*(i.maxTextureSize||4906))&&!this.layer.rasterFunction?.hasClipFunction}};(0,p._)([(0,m.Cb)({readOnly:!0})],T.prototype,"_blankTile",null),(0,p._)([(0,m.Cb)({readOnly:!0})],T.prototype,"imageFormatIsOpaque",null),(0,p._)([(0,m.Cb)({readOnly:!0})],T.prototype,"hasMixedImageFormats",null),(0,p._)([(0,m.Cb)({readOnly:!0})],T.prototype,"dataLevelRange",null),T=(0,p._)([(0,d.j)("esri.views.3d.layers.ImageryTileLayerView3D")],T);const B=T},19702:(L,M,e)=>{e.d(M,{A:()=>P});var o=e(15861),p=e(17626),g=e(54024),y=e(10699),m=e(32917),v=e(77712),E=(e(8314),e(63290),e(4619),e(76898)),l=e(36947);const P=n=>{let u=class extends n{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(s){super.postscript(s),(0,l.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}_validateHeightModelInfo(){var s=this;return(0,o.Z)(function*(){const _=new AbortController,I=_.signal;s.addHandles((0,g.kB)(()=>_.abort())),yield(0,m.N1)(()=>s.view.defaultsFromMap?.heightModelInfoReady,I),(0,y.k_)(I);const O=(0,l.Wt)(s.layer,s.view.heightModelInfo,s.supportsHeightUnitConversion);if(O)throw O})()}canResume(){const s=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return super.canResume()&&(!s?.minScale||!s.maxScale||s.minScale>=s.maxScale)}getSuspendInfo(){const s=super.getSuspendInfo(),_=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return _&&_.minScale&&_.maxScale&&_.minScale<_.maxScale&&(s.outsideScaleRange=!0),s}};return(0,p._)([(0,v.Cb)()],u.prototype,"view",void 0),(0,p._)([(0,v.Cb)()],u.prototype,"slicePlaneEnabled",void 0),u=(0,p._)([(0,E.j)("esri.views.3d.layers.LayerView3D")],u),u}},45611:(L,M,e)=>{e.d(M,{Z:()=>u});var o=e(17626),p=e(83761),g=e(61885),y=e(61996),m=e(63290),v=e(62208),r=e(60330),a=e(77712),l=(e(8314),e(4619),e(76898)),P=e(11426);let n=class extends((0,y.IG)((0,r.v)(g.Z.EventedMixin(p.Z)))){constructor(s){super(s),this._updatingHandles=new P.R,this.layer=null,this.parent=null}initialize(){this.when().catch(s=>{if("layerview:create-error"!==s.name){const _=this.layer&&this.layer.id||"no id",I=this.layer?.title||"no title";m.Z.getLogger(this).error("#resolve()",`Failed to resolve layer view (layer title: '${I}', id: '${_}')`,s)}})}destroy(){this._updatingHandles=(0,v.SC)(this._updatingHandles)}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){return!0===this.layer?.visible}set visible(s){this._overrideIfSome("visible",s)}canResume(){return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready||!1}getSuspendInfo(){const s=this.parent?.suspended?this.parent.suspendInfo:{};return this.view?.ready||(s.viewNotReady=!0),this.layer&&this.layer.loaded||(s.layerNotLoaded=!0),this.visible||(s.layerInvisible=!0),s}isUpdating(){return!1}};(0,o._)([(0,a.Cb)()],n.prototype,"fullOpacity",null),(0,o._)([(0,a.Cb)()],n.prototype,"layer",void 0),(0,o._)([(0,a.Cb)()],n.prototype,"parent",void 0),(0,o._)([(0,a.Cb)({readOnly:!0})],n.prototype,"suspended",null),(0,o._)([(0,a.Cb)({readOnly:!0})],n.prototype,"suspendInfo",null),(0,o._)([(0,a.Cb)({readOnly:!0})],n.prototype,"legendEnabled",null),(0,o._)([(0,a.Cb)({type:Boolean,readOnly:!0})],n.prototype,"updating",null),(0,o._)([(0,a.Cb)({readOnly:!0})],n.prototype,"updatingProgress",null),(0,o._)([(0,a.Cb)()],n.prototype,"visible",null),(0,o._)([(0,a.Cb)()],n.prototype,"view",void 0),n=(0,o._)([(0,l.j)("esri.views.layers.LayerView")],n);const u=n},94421:(L,M,e)=>{e.d(M,{Z:()=>d});var o=e(17626),p=e(63290),g=e(10699),y=e(32917),a=(e(8314),e(4619),e(26584),e(76898));const d=E=>{let l=class extends E{initialize(){this.addHandles((0,y.on)(()=>this.layer,"refresh",P=>{this.doRefresh(P.dataChanged).catch(n=>{(0,g.D_)(n)||p.Z.getLogger(this).error(n)})}),"RefreshableLayerView")}};return l=(0,o._)([(0,a.j)("esri.layers.mixins.RefreshableLayerView")],l),l}},10023:(L,M,e)=>{e.d(M,{V5:()=>m,e7:()=>g,zc:()=>v});var o=e(15861),p=e(90194);function g(r){return y.apply(this,arguments)}function y(){return(y=(0,o.Z)(function*(r,a=r.popupTemplate){if(null==a)return[];const d=yield a.getRequiredFields(r.fieldsIndex),{lastEditInfoEnabled:E}=a,{objectIdField:l,typeIdField:P,globalIdField:n,relationships:u}=r;if(d.includes("*"))return["*"];const s=E?(0,p.CH)(r):[],_=(0,p.Q0)(r.fieldsIndex,[...d,...s]);return P&&_.push(P),_&&l&&r.fieldsIndex?.has(l)&&!_.includes(l)&&_.push(l),_&&n&&r.fieldsIndex?.has(n)&&!_.includes(n)&&_.push(n),u&&u.forEach(I=>{const{keyField:O}=I;_&&O&&r.fieldsIndex?.has(O)&&!_.includes(O)&&_.push(O)}),_})).apply(this,arguments)}function m(r,a){return r.popupTemplate?r.popupTemplate:null!=a&&a.defaultPopupTemplateEnabled&&null!=r.defaultPopupTemplate?r.defaultPopupTemplate:null}function v(r,a){return null!=m(r,{defaultPopupTemplateEnabled:a})}},94672:(L,M,e)=>{e.d(M,{K:()=>y}),e(29132);var p=e(16730),g=e(2004);function y(r,a,d,E=new g.Z){let l=0;if("2d"===d.type)l=a*(d.resolution??0);else if("3d"===d.type){const I=d.overlayPixelSizeInMapUnits(r),O=d.basemapSpatialReference;l=null==O||O.equals(d.spatialReference)?a*I:(0,p.c9)(O)/(0,p.c9)(d.spatialReference)}const P=r.x-l,n=r.y-l,u=r.x+l,s=r.y+l,{spatialReference:_}=d;return E.xmin=Math.min(P,u),E.ymin=Math.min(n,s),E.xmax=Math.max(P,u),E.ymax=Math.max(n,s),E.spatialReference=_,E}new g.Z}}]);