"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[138],{65389:(ut,W,l)=>{l.d(W,{Z:()=>z});var D=l(62208);class z{constructor(L){this.size=0,this._start=0,this.maxSize=L,this._buffer=new Array(L)}get entries(){return this._buffer}enqueue(L){if(this.size===this.maxSize){const v=this._buffer[this._start];return this._buffer[this._start]=L,this._start=(this._start+1)%this.maxSize,v}return this._buffer[(this._start+this.size++)%this.maxSize]=L,null}dequeue(){if(0===this.size)return null;const L=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,L}peek(){return 0===this.size?null:this._buffer[this._start]}find(L){if(0===this.size)return null;for(const v of this._buffer)if((0,D.pC)(v)&&L(v))return v;return null}clear(L){let v=this.dequeue();for(;(0,D.pC)(v);)L&&L(v),v=this.dequeue()}}},88547:(ut,W,l)=>{l.d(W,{Z:()=>P});var D=l(17626),z=l(14517),L=(l(26584),l(80542)),v=l(8314),R=(l(63290),l(62208)),U=l(7074),f=l(77712),X=(l(90912),l(85931),l(76898)),ct=l(23841),$=l(39351),E=l(21286),H=l(42797);class rt{constructor(a,u,m){this._debugMap=new Map,this._width=a*m,this._height=u*m,this._pixelRatio=m;const g=Math.ceil(this._width/1),w=Math.ceil(this._height/1);this._cols=g,this._rows=w,this._cells=H.p.create(g*w)}insertMetrics(a){const u=this._hasCollision(a);return 0===u&&this._markMetrics(a),u}getCellId(a,u){return a+u*this._cols}has(a){return this._cells.has(a)}hasRange(a,u){return this._cells.hasRange(a,u)}set(a){this._cells.set(a)}setRange(a,u){this._cells.setRange(a,u)}_collide(a,u,m,g){const w=a-m/2,x=u-g/2,A=w+m,B=x+g;if(A<0||B<0||w>this._width||x>this._height)return 1;const ft=(0,E.uZ)(Math.floor(w/1),0,this._cols),pt=(0,E.uZ)(Math.floor(x/1),0,this._rows),gt=(0,E.uZ)(Math.ceil(A/1),0,this._cols),nt=(0,E.uZ)(Math.ceil(B/1),0,this._rows);for(let ot=pt;ot<=nt;ot++)for(let dt=ft;dt<=gt;dt++){const vt=this.getCellId(dt,ot);if(this.has(vt))return 2}return 0}_mark(a,u,m,g,w){const x=a-m/2,A=u-g/2,B=x+m,ft=A+g,pt=(0,E.uZ)(Math.floor(x/1),0,this._cols),gt=(0,E.uZ)(Math.floor(A/1),0,this._rows),nt=(0,E.uZ)(Math.ceil(B/1),0,this._cols),ot=(0,E.uZ)(Math.ceil(ft/1),0,this._rows);for(let dt=gt;dt<=ot;dt++)for(let vt=pt;vt<=nt;vt++){const St=this.getCellId(vt,dt);this._debugMap.set(St,w),this.set(St)}return!1}_hasCollision(a){const u=a.id;let m=0,g=0;a.save();do{const w=a.boundsCount;m+=w;for(let x=0;x<w;x++){const A=a.boundsComputedAnchorX(x),B=a.boundsComputedAnchorY(x),ft=(a.boundsWidth(x)+2)*this._pixelRatio,pt=(a.boundsHeight(x)+2)*this._pixelRatio;switch(this._collide(A,B,ft,pt)){case 2:return 2;case 1:g++}}}while(a.peekId()===u&&a.next());return a.restore(),m===g?1:0}_markMetrics(a){const u=a.id;a.save();do{const m=a.boundsCount;for(let g=0;g<m;g++){const w=a.boundsComputedAnchorX(g),x=a.boundsComputedAnchorY(g),A=(a.boundsWidth(g)+2)*this._pixelRatio,B=(a.boundsHeight(g)+2)*this._pixelRatio;this._mark(w,x,A,B,a.id)}}while(a.peekId()===u&&a.next());a.restore()}}var lt=l(21254),Y=l(86971);const Mt=Math.PI;function st(d,a){switch(a.transformationType){case Y.hL.Additive:return function Tt(d,a){return d+(k(a.minSize,d)||a.minDataValue)}(d,a);case Y.hL.Constant:return function Ct(d,a){const u=d.stops;let m=u&&u.length&&u[0].size;return null==m&&(m=d.minSize),k(m,a)}(a,d);case Y.hL.ClampedLinear:return function J(d,a){const u=a.minDataValue,m=a.maxDataValue,g=(d-u)/(m-u),w=k(a.minSize,d),x=k(a.maxSize,d);return d<=u?w:d>=m?x:w+g*(x-w)}(d,a);case Y.hL.Proportional:return function Dt(d,a){const u=d/a.minDataValue,m=k(a.minSize,d),g=k(a.maxSize,d);let w=null;return w=u*m,(0,E.uZ)(w,m,g)}(d,a);case Y.hL.Stops:return function xt(d,a){const[u,m,g]=function zt(d,a){if(!a)return;let u=0,m=a.length-1;return a.some((g,w)=>d<g?(m=w,!0):(u=w,!1)),[u,m,(d-a[u])/(a[m]-a[u])]}(d,a.cache.ipData);if(u===m)return k(a.stops[u].size,d);{const w=k(a.stops[u].size,d);return w+(k(a.stops[m].size,d)-w)*g}}(d,a);case Y.hL.RealWorldSize:return function bt(d,a){const u=lt.a[a.valueUnit],m=k(a.minSize,d),g=k(a.maxSize,d),{valueRepresentation:w}=a;let x=null;return x="area"===w?2*Math.sqrt(d/Mt)/u:"radius"===w||"distance"===w?2*d/u:d/u,(0,E.uZ)(x,m,g)}(d,a);case Y.hL.Identity:return d;case Y.hL.Unknown:return null}}function k(d,a){return"number"==typeof d?d:st(a,d)}function _t(d,a){const u=[];d.forEachTile(m=>u.push(m)),u.sort((m,g)=>m.instanceId-g.instanceId),u.forEach(m=>{(0,R.pC)(m.labelMetrics)&&m.isReady&&a(m,m.labelMetrics.getCursor())})}function it(d){return a=>(0,ct.F2)(st(a,d))}function r(d,a){if(!function j(d){return d.layer&&("feature"===d.layer.type||"csv"===d.layer.type||"geojson"===d.layer.type||"ogc-feature"===d.layer.type||"stream"===d.layer.type||"subtype-group"===d.layer.type||"wfs"===d.layer.type)}(a))return;const m=a.layer.geometryType,g=!function ht(d){for(const a of d){const m=[...a.labelingInfo||[],...("featureReduction"in a&&a.featureReduction&&"labelingInfo"in a.featureReduction?a.featureReduction:void 0)?.labelingInfo||[]];if(a.labelsVisible&&m.length&&m.some(g=>"none"===g.deconflictionStrategy))return!0}return!1}("subtype-group"===a.layer.type?a.layer.sublayers.items:[a.layer]),w={};if("subtype-group"!==a.layer.type){if("heatmap"===a.tileRenderer?.type)return;const B=function at(d){const a=null!=d&&"visualVariables"in d&&d.visualVariables;if(!a)return null;for(const u of a)if("size"===u.type)return it(u);return null}(a.layer.renderer);w[0]=B}const x=a.tileRenderer;(0,R.Wi)(x)||d.push({tileRenderer:x,vvEvaluators:w,deconflictionEnabled:g,geometryType:m,visible:a.layer.visible&&!a.suspended})}class h{run(a,u,m){const g=[];for(let w=a.length-1;w>=0;w--)r(g,a[w]);this._transformMetrics(g),this._runCollision(g,u,m)}_runCollision(a,u,m){const[g,w]=u.state.size,x=new rt(g,w,u.pixelRatio);for(const{tileRenderer:A,deconflictionEnabled:B,visible:ft}of a){const pt=A.featuresView.attributeView;B?ft?(this._prepare(A),this._collideVisible(x,A,m),this._collideInvisible(x,A)):_t(A,(gt,nt)=>{for(;nt.nextId();)pt.setLabelMinZoom(nt.id,255)}):_t(A,(gt,nt)=>{for(;nt.nextId();)pt.setLabelMinZoom(nt.id,0),ft&&x.insertMetrics(nt)})}}_isFiltered(a,u,m){const g=u.getFilterFlags(a),w=!m.hasFilter||!!(g&$.Zd),x=(0,R.Wi)(m.featureEffect)||m.featureEffect.excludedLabelsVisible||!!(g&$.iV);return!(w&&x)}_prepare(a){const u=a.featuresView.attributeView,m=new Set;_t(a,(g,w)=>{for(;w.nextId();)if(!m.has(w.id)){if(m.add(w.id),this._isFiltered(w.id,u,a.layerView)){u.setLabelMinZoom(w.id,254);continue}0!==u.getLabelMinZoom(w.id)?u.setLabelMinZoom(w.id,255):u.setLabelMinZoom(w.id,0)}})}_collideVisible(a,u,m){const g=u.featuresView.attributeView,w=new Set;_t(u,(x,A)=>{for(;A.nextId();)if(!w.has(A.id))if(x.key.level===m){if(0===g.getLabelMinZoom(A.id))switch(a.insertMetrics(A)){case 1:break;case 2:g.setLabelMinZoom(A.id,254),w.add(A.id);break;case 0:g.setLabelMinZoom(A.id,0),w.add(A.id)}}else g.setLabelMinZoom(A.id,254)})}_collideInvisible(a,u){const m=u.featuresView.attributeView,g=new Set;_t(u,(w,x)=>{for(;x.nextId();)if(!g.has(x.id)&&255===m.getLabelMinZoom(x.id))switch(a.insertMetrics(x)){case 1:break;case 2:m.setLabelMinZoom(x.id,255),g.add(x.id);break;case 0:m.setLabelMinZoom(x.id,0),g.add(x.id)}})}_transformMetrics(a){for(const{tileRenderer:u,geometryType:m,vvEvaluators:g}of a)_t(u,(w,x)=>{const A=u.featuresView.attributeView,B=w.transforms.labelMat2d;B[4]=Math.round(B[4]),B[5]=Math.round(B[5]);const ft="polyline"===m;for(;x.next();){const pt=x.boundsCount,gt=x.anchorX,nt=x.anchorY;let ot=x.size;const dt=g[0];if((0,R.pC)(dt)){const Q=dt(A.getVVSize(x.id));ot=isNaN(Q)||null==Q||Q===1/0?ot:Q}const vt=x.directionX*(ot/2),St=x.directionY*(ot/2);for(let Q=0;Q<pt;Q++){let Pt=gt,p=x.anchorY;if(ft){let t=Pt+x.boundsX(Q)+vt,e=p+x.boundsY(Q)+St;t=B[0]*t+B[2]*e+B[4],e=B[1]*t+B[3]*e+B[5],x.setBoundsComputedAnchorX(Q,Math.floor(t)),x.setBoundsComputedAnchorY(Q,Math.floor(e))}else{Pt=B[0]*gt+B[2]*nt+B[4],p=B[1]*gt+B[3]*nt+B[5];const t=Pt+x.boundsX(Q)+vt,e=p+x.boundsY(Q)+St;x.setBoundsComputedAnchorX(Q,t),x.setBoundsComputedAnchorY(Q,e)}}}})}}let b=class extends((0,L.p)(z.Z)){constructor(d){super(d),this._applyVisibilityPassThrottled=(0,U.P)(this._applyVisibilityPass,32,this),this.lastUpdateId=-1,this.updateRequested=!1,this.view=null}initialize(){this.collisionEngine=new h}destroy(){this.collisionEngine=null,this._applyVisibilityPassThrottled=(0,R.hw)(this._applyVisibilityPassThrottled)}get updating(){return(0,v.Z)("esri-2d-log-updating")&&console.log(`Updating LabelManager ${this.updateRequested}:\n-> updateRequested: ${this.updateRequested}`),this.updateRequested}update(d){this._applyVisibilityPassThrottled(d)}viewChange(){this.requestUpdate()}requestUpdate(){this.updateRequested||(this.updateRequested=!0,this.view?.requestUpdate())}processUpdate(d){this._set("updateParameters",d),this.updateRequested&&(this.updateRequested=!1,this.update(d))}_applyVisibilityPass(d){const a=this.view;if(a)try{const u=a.featuresTilingScheme.getClosestInfoForScale(d.state.scale).level;this.collisionEngine.run(a.allLayerViews.items,d,u)}catch{}}};(0,D._)([(0,f.Cb)()],b.prototype,"updateRequested",void 0),(0,D._)([(0,f.Cb)({readOnly:!0})],b.prototype,"updateParameters",void 0),(0,D._)([(0,f.Cb)()],b.prototype,"updating",null),(0,D._)([(0,f.Cb)()],b.prototype,"view",void 0),b=(0,D._)([(0,X.j)("esri.views.2d.layers.labels.LabelManager")],b);const P=b},31656:(ut,W,l)=>{l.d(W,{w:()=>v});const D={background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform lowp sampler2D u_texture;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord = mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos = mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color = texture2D(u_texture, samplePos);\ngl_FragColor = u_opacity * color;\n#else\ngl_FragColor = u_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a < 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor = v_id;\n#endif\n}","background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\nuniform mediump vec4 u_tlbr;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\n#endif\nvoid main() {\ngl_Position = vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\nv_tileTextureCoord = (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\nv_tlbr             = u_tlbr / u_mosaicSize.xyxy;\n#endif\n#ifdef ID\nv_id = u_id / 255.0;\n#endif\n}"},circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float dist = length(v_offset);\nmediump float alpha = smoothstep(0.0, -v_blur, dist - 1.0);\nlowp float color_mix_ratio = v_stroke_width < 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\ngl_FragColor = alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\nif (gl_FragColor.a < 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor = v_id;\n#endif\n}","circle.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n#pragma main\nv_color = color * opacity;\nv_stroke_color = stroke_color * stroke_opacity;\nv_stroke_width = stroke_width;\nv_radius = radius;\nv_blur = max(blur, u_antialiasingWidth / (radius + stroke_width));\nmediump vec2 offset = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\nv_offset = offset;\n#ifdef ID\nv_id = u_id / 255.0;\n#endif\nmediump vec3 pos = u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\ngl_Position = vec4(pos.xy, u_depth, 1.0);\n}"},fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha = color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor = color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord = fract(v_tileTextureCoord);\nmediump vec2 samplePos = mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color = texture2D(u_texture, samplePos);\ngl_FragColor = v_color[3] * color;\n#else\ngl_FragColor = v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a < 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor = v_id;\n#endif\n}","fill.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\n#include <util/util.glsl>\nuniform mediump vec2 u_mosaicSize;\nuniform mediump float u_patternFactor;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvoid main()\n{\n#pragma main\nv_color = color * opacity;\n#ifdef ID\nv_id = u_id / 255.0;\n#endif\n#ifdef PATTERN\nfloat patternWidth = nextPOT(tlbr.z - tlbr.x);\nfloat patternHeight = nextPOT(tlbr.w - tlbr.y);\nfloat scaleX = 1.0 / (patternWidth * u_patternFactor);\nfloat scaleY = 1.0 / (patternHeight * u_patternFactor);\nmat3 patterMat = mat3(scaleX, 0.0,    0.0,\n0.0,    -scaleY, 0.0,\n0.0,    0.0,    1.0);\nv_tileTextureCoord = (patterMat * vec3(a_pos, 1.0)).xy;\nv_tlbr             = tlbr / u_mosaicSize.xyxy;\n#endif\nvec3 pos = u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\ngl_Position = vec4(pos.xy, u_depth, 1.0);\n}"},icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump flaot v_halo_width;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include <util/encoding.glsl>\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha = color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor = color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\nlowp vec4 fillPixelColor = v_color;\nfloat d = rgba2float(texture2D(u_texture, v_tex)) - 0.5;\nconst float softEdgeRatio = 0.248062016;\nfloat size = max(v_size.x, v_size.y);\nfloat dist = d * softEdgeRatio * size;\nfillPixelColor *= clamp(0.5 - dist, 0.0, 1.0);\nif (v_halo_width > 0.25) {\nlowp vec4 outlinePixelColor = u_outlineColor;\nconst float outlineLimitRatio = (16.0 / 86.0);\nfloat clampedOutlineSize = softEdgeRatio * min(v_halo_width, outlineLimitRatio * max(v_size.x, v_size.y));\noutlinePixelColor *= clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\ngl_FragColor = v_opacity * mixColors(fillPixelColor, outlinePixelColor);\n}\nelse {\ngl_FragColor = v_opacity * fillPixelColor;\n}\n#else\nlowp vec4 texColor = texture2D(u_texture, v_tex);\ngl_FragColor = v_opacity * texColor;\n#endif\n#ifdef ID\nif (gl_FragColor.a < 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor = v_id;\n#endif\n}","icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump float v_halo_width;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION = 1.0 / 8.0;\nconst float C_256_TO_RAD = 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD = 3.14159265359 / 180.0;\nconst float tileCoordRatio = 1.0 / 8.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nv_color = color;\nv_opacity = opacity;\n#ifdef SDF\nv_halo_width = halo_width;\n#endif\nfloat modded = mod(a_opacityInfo, 128.0);\nfloat targetOpacity = (a_opacityInfo - modded) / 128.0;\nfloat startOpacity = modded / 127.0;\nfloat interpolatedOpacity = clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_opacity *= interpolatedOpacity;\nmediump float a_angle         = a_levelInfo[1];\nmediump float a_minLevel      = a_levelInfo[2];\nmediump float a_maxLevel      = a_levelInfo[3];\nmediump vec2 a_tex            = a_texAngleRange.xy;\nmediump float delta_z = 0.0;\nmediump float rotated = mod(a_angle + u_mapRotation, 256.0);\ndelta_z += (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\ndelta_z += 1.0 - step(a_minLevel, u_level);\ndelta_z += step(a_maxLevel, u_level);\ndelta_z += step(v_opacity, 0.0);\nvec2 offset = C_OFFSET_PRECISION * a_vertexOffset;\nv_size = abs(offset);\n#ifdef SDF\noffset = (120.0 / 86.0) * offset;\n#endif\nmediump vec3 pos = u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\ngl_Position = vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef ID\nv_id = u_id / 255.0;\n#endif\nv_tex = a_tex.xy / u_mosaicSize;\n}"},line:{"line.frag":"precision lowp float;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#if defined (PATTERN) || defined(SDF)\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\nuniform sampler2D u_texture;\nuniform mediump float u_antialiasing;\n#endif\n#ifdef SDF\n#include <util/encoding.glsl>\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float fragDist = length(v_normal) * v_lineHalfWidth;\nlowp float alpha = clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\nmediump float relativeTexX = fract(v_accumulatedDistance / (v_patternSize.x * v_widthRatio));\nmediump float relativeTexY = 0.5 + v_normal.y * v_lineHalfWidth / (v_patternSize.y * v_widthRatio);\nmediump vec2 texCoord = mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nlowp vec4 color = texture2D(u_texture, texCoord);\ngl_FragColor = alpha * v_color[3] * color;\n#elif defined(SDF)\nmediump float relativeTexX = fract((v_accumulatedDistance * 0.5) / (v_patternSize.x * v_widthRatio));\nmediump float relativeTexY =  0.5 + 0.25 * v_normal.y;\nmediump vec2 texCoord = mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d = rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist = d * (v_lineHalfWidth + u_antialiasing / 2.0);\ngl_FragColor = alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n#else\ngl_FragColor = alpha * v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a < 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor = v_id;\n#endif\n}","line.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_extrude_offset;\nattribute vec4 a_dir_normal;\nattribute vec2 a_accumulatedDistance;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump float u_zoomFactor;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale = 1.0 / 31.0;\nconst mediump float tileCoordRatio = 8.0;\n#if defined (SDF)\nconst mediump float sdfPatternHalfWidth = 15.5;\n#endif\n#if defined (PATTERN) || defined(SDF)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\nvoid main()\n{\n#pragma main\nv_color = color * opacity;\nv_blur = blur + u_antialiasing;\nv_normal = a_dir_normal.zw * scale;\n#if defined (PATTERN) || defined(SDF)\nv_tlbr          = tlbr / u_mosaicSize.xyxy;\nv_patternSize   = vec2(tlbr.z - tlbr.x, tlbr.y - tlbr.w);\n#if defined (PATTERN)\nv_widthRatio = width / v_patternSize.y;\n#else\nv_widthRatio = width / sdfPatternHalfWidth / 2.0;\n#endif\n#endif\nv_lineHalfWidth = (width + u_antialiasing) * 0.5;\nmediump vec2 dir = a_dir_normal.xy * scale;\nmediump vec2 offset_ = a_extrude_offset.zw * scale * offset;\nmediump vec2 dist = v_lineHalfWidth * scale * a_extrude_offset.xy;\nmediump vec3 pos = u_dvsMat3 * vec3(a_pos + offset_ * tileCoordRatio / u_zoomFactor, 1.0) + u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\ngl_Position = vec4(pos.xy, u_depth, 1.0);\n#if defined (PATTERN) || defined(SDF)\nv_accumulatedDistance = a_accumulatedDistance.x * u_zoomFactor / tileCoordRatio + dot(dir, dist + offset_);\n#endif\n#ifdef ID\nv_id = u_id / 255.0;\n#endif\n}"},outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist = abs(v_normal.y);\nlowp float alpha = smoothstep(1.0, 0.0, dist);\ngl_FragColor = alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a < 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor = v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale = 1.0 / 15.0;\nvoid main()\n{\n#pragma main\nv_color = color * opacity;\n#ifdef ID\nv_id = u_id / 255.0;\n#endif\nv_normal = a_xnormal;\nmediump vec2 dist = u_outline_width * scale * a_offset;\nmediump vec3 pos = u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\ngl_Position = vec4(pos.xy, u_depth, 1.0);\n}"},text:{"text.frag":"uniform lowp sampler2D u_texture;\nvarying lowp vec2 v_tex;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist = texture2D(u_texture, v_tex).a;\nmediump float alpha = smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist);\ngl_FragColor = alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a < 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor = v_id;\n#endif\n}","text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying lowp vec2 v_tex;\nconst float offsetPrecision = 1.0 / 8.0;\nconst mediump float edgePos = 0.75;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale = 1.0 / 24.0;\nconst float sdfPixel = 3.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nif (u_halo > 0.5)\n{\nv_color = halo_color * opacity;\nhalo_width *= sdfPixel;\nhalo_blur *= sdfPixel;\n}\nelse\n{\nv_color = color * opacity;\nhalo_width = 0.0;\nhalo_blur = 0.0;\n}\nfloat modded = mod(a_opacityInfo, 128.0);\nfloat targetOpacity = (a_opacityInfo - modded) / 128.0;\nfloat startOpacity = modded / 127.0;\nfloat interpolatedOpacity = clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_color *= interpolatedOpacity;\nmediump float a_angle       = a_levelInfo[1];\nmediump float a_minLevel    = a_levelInfo[2];\nmediump float a_maxLevel    = a_levelInfo[3];\nmediump vec2 a_tex          = a_texAngleRange.xy;\nmediump float a_visMinAngle    = a_texAngleRange.z;\nmediump float a_visMaxAngle    = a_texAngleRange.w;\nmediump float delta_z = 0.0;\nmediump float angle = mod(a_angle + u_mapRotation, 256.0);\nif (a_visMinAngle < a_visMaxAngle)\n{\ndelta_z += (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) + (1.0 - step(a_visMinAngle, angle)));\n}\nelse\n{\ndelta_z += (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) * (1.0 - step(a_visMinAngle, angle)));\n}\ndelta_z += 1.0 - step(a_minLevel, u_level);\ndelta_z += step(a_maxLevel, u_level);\ndelta_z += step(v_color[3], 0.0);\nv_tex = a_tex.xy / u_mosaicSize;\n#ifdef ID\nv_id = u_id / 255.0;\n#endif\nv_edgeDistance = edgePos - halo_width / size;\nv_edgeWidth = (u_antialiasingWidth + halo_blur) / size;\nmediump vec3 pos = u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\ngl_Position = vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},util:{"encoding.glsl":"const vec4 rgba2float_factors = vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}","util.glsl":"float nextPOT(in float x) {\nreturn pow(2.0, ceil(log2(abs(x))));\n}"}},L=new(l(7423).B)(function G(y){let R=D;return y.split("/").forEach(U=>{R&&(R=R[U])}),R});function v(y){return L.resolveIncludes(y)}},2172:(ut,W,l)=>{l.d(W,{Q:()=>R,g:()=>v});var D=l(8314),z=l(62208),G=l(31823);const L=(0,D.Z)("esri-2d-log-allocations");class v{constructor(f,C){this._array=f,this._pool=C}get array(){return this._array}get length(){return this._array.length}static create(f,C){const S=C.acquire(f);return new v(S,C)}expand(f){const C=this._pool.acquire(f);C.set(this._array),this._pool.release(this._array),this._array=C}destroy(){this._pool.release(this._array)}set(f,C){this._array.set(f._array,C)}slice(){const f=this._pool.acquire(this._array.byteLength);return f.set(this._array),new v(f,this._pool)}}class y{constructor(){this._data=new ArrayBuffer(y.BYTE_LENGTH),this._freeList=new G.m({start:0,end:this._data.byteLength})}static get BYTE_LENGTH(){return 64e6}get buffer(){return this._data}allocate(f){const C=this._freeList.firstFit(f);return(0,z.Wi)(C)?null:new Uint32Array(this._data,C,f/Uint32Array.BYTES_PER_ELEMENT)}free(f){this._freeList.free(f.byteOffset,f.byteLength)}}class R{constructor(){this._bytesAllocated=0,this._pages=[],this._pagesByBuffer=new Map,this._addPage()}destroy(){this._pages=[],this._pagesByBuffer=null}get _bytesTotal(){return this._pages.length*y.BYTE_LENGTH}acquire(f){if(this._bytesAllocated+=f,L&&console.log(`Allocating ${f}, (${this._bytesAllocated} / ${this._bytesTotal})`),f>y.BYTE_LENGTH)return new Uint32Array(f/Uint32Array.BYTES_PER_ELEMENT);for(const C of this._pages){const S=C.allocate(f);if((0,z.pC)(S))return S}return(0,z.s3)(this._addPage().allocate(f),"Expected to allocate page")}release(f){this._bytesAllocated-=f.byteLength,L&&console.log(`Freeing ${f.byteLength}, (${this._bytesAllocated} / ${this._bytesTotal})`);const C=this._pagesByBuffer.get(f.buffer);C&&C.free(f)}_addPage(){const f=new y;return this._pages.push(f),this._pagesByBuffer.set(f.buffer,f),f}}},22796:(ut,W,l)=>{l.d(W,{Q:()=>R});var D=l(65389),z=l(61885),G=l(8314),L=l(62208),v=l(46593);const y=(0,G.Z)("esri-2d-profiler");class R{constructor(f,C){if(this._events=new z.Z,this._entries=new Map,this._timings=new D.Z(10),this._currentContainer=null,this._currentPass=null,this._currentBrush=null,this._currentSummary=null,!y)return;this._ext=(0,v.mO)(f.gl,{}),this._debugOutput=C;const S=f.gl;if(this.enableCommandLogging)for(const X in S)if("function"==typeof S[X]){const ct=S[X],$=X.includes("draw");S[X]=(...E)=>(this._events.emit("command",{container:this._currentContainer,pass:this._currentPass,brush:this._currentBrush,method:X,args:E,isDrawCommand:$}),this._currentSummary&&(this._currentSummary.commands++,$&&this._currentSummary.drawCommands++),ct.apply(S,E))}}get enableCommandLogging(){return!("object"==typeof y&&y.disableCommands)}recordContainerStart(f){y&&(this._currentContainer=f)}recordContainerEnd(){y&&(this._currentContainer=null)}recordPassStart(f){y&&(this._currentPass=f,this._initSummary())}recordPassEnd(){y&&(this._currentPass=null,this._emitSummary())}recordBrushStart(f){y&&(this._currentBrush=f)}recordBrushEnd(){y&&(this._currentBrush=null)}recordStart(f){if(y&&(0,L.pC)(this._ext)){if(this._entries.has(f)){const S=this._entries.get(f),X=this._ext.resultAvailable(S.query),ct=this._ext.disjoint();if(X&&!ct){const $=this._ext.getResult(S.query)/1e6;let E=0;if((0,L.pC)(this._timings.enqueue($))){const F=this._timings.entries,K=F.length;let I=0;for(const tt of F)I+=tt;E=I/K}const H=$.toFixed(2),V=E?E.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed(`Frame report for ${f}, ${H} ms (${V} last 10 avg)\n${S.commandsLen} Commands (${S.drawCommands} draw)`),console.log("RenderPass breakdown: "),console.table(S.summaries),console.log("Commands: ",S.commands),console.groupEnd()):console.log(`Frame report for ${f}, ${H} ms (${V} last 10 avg)`),this._debugOutput.innerHTML=`${H} (${V})`}for(const $ of S.handles)$.remove();this._ext.deleteQuery(S.query),this._entries.delete(f)}const C={name:f,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(C.handles.push(this._events.on("command",S=>{C.commandsLen++,C.commands.push(S),S.isDrawCommand&&C.drawCommands++})),C.handles.push(this._events.on("summary",S=>{C.summaries.push(S)}))),this._ext.beginTimeElapsed(C.query),this._entries.set(f,C)}}recordEnd(f){y&&(0,L.pC)(this._ext)&&this._entries.has(f)&&this._ext.endTimeElapsed()}_initSummary(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})}_emitSummary(){this.enableCommandLogging&&this._currentSummary&&this._events.emit("summary",this._currentSummary)}}},44884:(ut,W,l)=>{l.d(W,{Z:()=>Pt});var D=l(15861),z=l(59318),G=l(84792),L=l(986),v=l(26584),y=l(17002),R=l(63290),U=l(21286),f=l(62208),C=l(10699),S=l(23841),X=l(67831),ct=l(9545),$=l(32837),E=l(39351),H=l(39406),V=l(8314),F=l(84439);class K{constructor(t,e){this._width=0,this._height=0,this._free=[],this._width=t,this._height=e,this._free.push(new F.Z(0,0,t,e))}get width(){return this._width}get height(){return this._height}allocate(t,e){if(t>this._width||e>this._height)return new F.Z;let i=null,o=-1;for(let s=0;s<this._free.length;++s){const n=this._free[s];t<=n.width&&e<=n.height&&(null===i||n.y<=i.y&&n.x<=i.x)&&(i=n,o=s)}return null===i?new F.Z:(this._free.splice(o,1),i.width<i.height?(i.width>t&&this._free.push(new F.Z(i.x+t,i.y,i.width-t,e)),i.height>e&&this._free.push(new F.Z(i.x,i.y+e,i.width,i.height-e))):(i.width>t&&this._free.push(new F.Z(i.x+t,i.y,i.width-t,i.height)),i.height>e&&this._free.push(new F.Z(i.x,i.y+e,t,i.height-e))),new F.Z(i.x,i.y,t,e))}release(t){for(let e=0;e<this._free.length;++e){const i=this._free[e];if(i.y===t.y&&i.height===t.height&&i.x+i.width===t.x)i.width+=t.width;else if(i.x===t.x&&i.width===t.width&&i.y+i.height===t.y)i.height+=t.height;else if(t.y===i.y&&t.height===i.height&&t.x+t.width===i.x)i.x=t.x,i.width+=t.width;else{if(t.x!==i.x||t.width!==i.width||t.y+t.height!==i.y)continue;i.y=t.y,i.height+=t.height}this._free.splice(e,1),this.release(t)}this._free.push(t)}}var I=l(67969),tt=l(55086);const lt=p=>Math.floor(p/256);class k{constructor(t,e,i){this.width=0,this.height=0,this._dirties=[],this._glyphData=[],this._currentPage=0,this._glyphCache={},this._textures=[],this._rangePromises=new Map,this.width=t,this.height=e,this._glyphSource=i,this._binPack=new K(t-4,e-4),this._glyphData.push(new Uint8Array(t*e)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph()}dispose(){this._binPack=null;for(const t of this._textures)t&&t.dispose();this._textures.length=0,this._glyphData.length=0}_initDecorationGlyph(){const t=[117,149,181,207,207,181,149,117],e=[];for(let o=0;o<t.length;o++){const s=t[o];for(let n=0;n<11;n++)e.push(s)}const i={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(e)};this._recordGlyph(i)}getGlyphItems(t,e,i){var o=this;return(0,D.Z)(function*(){const s=o._getGlyphCache(t);return yield o._fetchRanges(t,e,i),e.map(n=>o._getMosaicItem(s,t,n))})()}bind(t,e,i,o){const s=this._getTexture(t,i);s.setSamplingMode(e),this._dirties[i]&&(s.setData(this._glyphData[i]),this._dirties[i]=!1),t.bindTexture(s,o)}_getGlyphCache(t){return this._glyphCache[t]||(this._glyphCache[t]={}),this._glyphCache[t]}_getTexture(t,e){return this._textures[e]||(this._textures[e]=new tt.x(t,{pixelFormat:I.VI.ALPHA,dataType:I.Br.UNSIGNED_BYTE,width:this.width,height:this.height},new Uint8Array(this.width*this.height))),this._textures[e]}_invalidate(){this._dirties[this._currentPage]=!0}_fetchRanges(t,e,i){var o=this;return(0,D.Z)(function*(){const s=function Y(p){const t=new Set;for(const e of p)t.add(lt(e));return t}(e),n=[];s.forEach(c=>{n.push(o._fetchRange(t,c,i))}),yield Promise.all(n)})()}_fetchRange(t,e,i){var o=this;return(0,D.Z)(function*(){if(!(e>256))return function Mt(p,t,e){return p.has(t)||p.set(t,e().then(()=>{p.delete(t)}).catch(i=>{p.delete(t),(0,C.H9)(i)})),p.get(t)}(o._rangePromises,t+e,()=>o._glyphSource.getRange(t,e,i))})()}_getMosaicItem(t,e,i){if(!t[i]){const o=this._glyphSource.getGlyph(e,i);if(!o||!o.metrics)return p=i,{rect:new F.Z(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,top:0},code:p,sdf:!0};const s=this._recordGlyph(o);t[i]={rect:s,page:this._currentPage,metrics:o.metrics,code:i,sdf:!0},this._invalidate()}var p;return t[i]}_recordGlyph(t){const e=t.metrics;let i;if(0===e.width)i=new F.Z(0,0,0,0);else{const s=e.width+6,n=e.height+6;i=this._binPack.allocate(s,n),i.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph(),this._binPack=new K(this.width-4,this.height-4),i=this._binPack.allocate(s,n));const c=this._glyphData[this._currentPage],M=t.bitmap;let T,Z;if(M)for(let O=0;O<n;O++){T=s*O,Z=this.width*(i.y+O)+i.x;for(let N=0;N<s;N++)c[Z+N]=M[T+N]}(0,V.Z)("esri-glyph-debug")&&this._showDebugPage(c)}return i}_showDebugPage(t){const e=document.createElement("canvas"),i=e.getContext("2d"),o=new ImageData(this.width,this.height),s=o.data;e.width=this.width,e.height=this.height,e.style.border="1px solid black";for(let n=0;n<t.length;++n)s[4*n+0]=t[n],s[4*n+1]=0,s[4*n+2]=0,s[4*n+3]=255;i.putImageData(o,0,0),document.body.appendChild(e)}}var Tt=l(24192);class Ct{constructor(t){for(this._metrics=[],this._bitmaps=[];t.next();)switch(t.tag()){case 1:{const e=t.getMessage();for(;e.next();)switch(e.tag()){case 3:{const i=e.getMessage();let o,s,n,c,M,T,Z;for(;i.next();)switch(i.tag()){case 1:o=i.getUInt32();break;case 2:s=i.getBytes();break;case 3:n=i.getUInt32();break;case 4:c=i.getUInt32();break;case 5:M=i.getSInt32();break;case 6:T=i.getSInt32();break;case 7:Z=i.getUInt32();break;default:i.skip()}i.release(),o&&(this._metrics[o]={width:n,height:c,left:M,top:T,advance:Z},this._bitmaps[o]=s);break}default:e.skip()}e.release();break}default:t.skip()}}getMetrics(t){return this._metrics[t]}getBitmap(t){return this._bitmaps[t]}}class J{constructor(){this._ranges=[]}getRange(t){return this._ranges[t]}addRange(t,e){this._ranges[t]=e}}class Dt{constructor(t){this._glyphInfo={},this._baseURL=t}getRange(t,e,i){const o=this._getFontStack(t);if(o.getRange(e))return Promise.resolve();const s=256*e,n=s+255,c=this._baseURL.replace("{fontstack}",t).replace("{range}",s+"-"+n);return(0,G.default)(c,{responseType:"array-buffer",...i}).then(M=>{o.addRange(e,new Ct(new Tt.Z(new Uint8Array(M.data),new DataView(M.data))))})}getGlyph(t,e){const i=this._getFontStack(t);if(!i)return;const o=Math.floor(e/256);if(o>256)return;const s=i.getRange(o);return s?{metrics:s.getMetrics(e),bitmap:s.getBitmap(e)}:void 0}_getFontStack(t){let e=this._glyphInfo[t];return e||(e=this._glyphInfo[t]=new J),e}}var xt=l(36161);const bt=1e20;class zt{constructor(t){this._svg=null,this.size=t;const e=document.createElement("canvas");e.width=e.height=t,this._context=e.getContext("2d"),this._gridOuter=new Float64Array(t*t),this._gridInner=new Float64Array(t*t),this._f=new Float64Array(t),this._d=new Float64Array(t),this._z=new Float64Array(t+1),this._v=new Int16Array(t)}dispose(){this._context=this._gridOuter=this._gridInner=this._f=this._d=this._z=this._v=null,this._svg&&(document.body.removeChild(this._svg),this._svg=null)}draw(t,e,i=31){this._initSVG();const o=this.createSVGString(t);return new Promise((s,n)=>{const c=new Image;c.src="data:image/svg+xml; charset=utf8, "+encodeURIComponent(o),c.onload=()=>{c.onload=null,this._context.clearRect(0,0,this.size,this.size),this._context.drawImage(c,0,0,this.size,this.size);const T=this._context.getImageData(0,0,this.size,this.size),Z=new Uint8Array(this.size*this.size*4);for(let O=0;O<this.size*this.size;O++){const N=T.data[4*O+3]/255;this._gridOuter[O]=1===N?0:0===N?bt:Math.max(0,.5-N)**2,this._gridInner[O]=1===N?bt:0===N?0:Math.max(0,N-.5)**2}this._edt(this._gridOuter,this.size,this.size),this._edt(this._gridInner,this.size,this.size);for(let O=0;O<this.size*this.size;O++)(0,xt.I)(.5-(this._gridOuter[O]-this._gridInner[O])/(2*i),Z,4*O);s(Z)};const M=e&&e.signal;M&&(0,C.fu)(M,()=>n((0,C.zE)()))})}_initSVG(){if(!this._svg){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("style","position: absolute;"),t.setAttribute("width","0"),t.setAttribute("height","0"),t.setAttribute("aria-hidden","true"),t.setAttribute("role","presentation"),document.body.appendChild(t),this._svg=t}return this._svg}createSVGString(t){const e=this._initSVG(),i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d",t),e.appendChild(i);const o=i.getBBox(),s=o.width/o.height,n=this.size/2;let c,M,T,Z;s>1?(M=c=n/o.width,T=this.size/4,Z=n-n*(1/s)/2):(c=M=n/o.height,T=n-n*s/2,Z=this.size/4),i.setAttribute("style",`transform: matrix(${c}, 0, 0, ${M}, ${-o.x*c+T}, ${-o.y*M+Z})`);const yt=`<svg style="fill:red;" height="${this.size}" width="${this.size}" xmlns="http://www.w3.org/2000/svg">${e.innerHTML}</svg>`;return e.removeChild(i),yt}_edt(t,e,i){const o=this._f,s=this._d,n=this._v,c=this._z;for(let M=0;M<e;M++){for(let T=0;T<i;T++)o[T]=t[T*e+M];this._edt1d(o,s,n,c,i);for(let T=0;T<i;T++)t[T*e+M]=s[T]}for(let M=0;M<i;M++){for(let T=0;T<e;T++)o[T]=t[M*e+T];this._edt1d(o,s,n,c,e);for(let T=0;T<e;T++)t[M*e+T]=Math.sqrt(s[T])}}_edt1d(t,e,i,o,s){i[0]=0,o[0]=-bt,o[1]=+bt;for(let n=1,c=0;n<s;n++){let M=(t[n]+n*n-(t[i[c]]+i[c]*i[c]))/(2*n-2*i[c]);for(;M<=o[c];)c--,M=(t[n]+n*n-(t[i[c]]+i[c]*i[c]))/(2*n-2*i[c]);c++,i[c]=n,o[c]=M,o[c+1]=+bt}for(let n=0,c=0;n<s;n++){for(;o[c+1]<n;)c++;e[n]=(n-i[c])*(n-i[c])+t[i[c]]}}}var Et=l(43289);function et(p){return p&&"static"===p.type}class mt{constructor(t,e,i=0){this._mosaicPages=[],this._maxItemSize=0,this._currentPage=0,this._pageWidth=0,this._pageHeight=0,this._mosaicRects=new Map,this._spriteCopyQueue=[],this.pixelRatio=1,(t<=0||e<=0)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!"),this._pageWidth=t,this._pageHeight=e,i>0&&(this._maxItemSize=i),this.pixelRatio=window.devicePixelRatio||1,this._binPack=new K(this._pageWidth,this._pageHeight);const o=Math.floor(this._pageWidth),s=Math.floor(this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(o*s)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}getWidth(t){return t>=this._mosaicPages.length?-1:this._mosaicPages[t].size[0]}getHeight(t){return t>=this._mosaicPages.length?-1:this._mosaicPages[t].size[1]}getPageTexture(t){return t<this._mosaicPages.length?this._mosaicPages[t].texture:null}has(t){return this._mosaicRects.has(t)}get itemCount(){return this._mosaicRects.size}getSpriteItem(t){return this._mosaicRects.get(t)}addSpriteItem(t,e,i,o,s,n,c=1){if(this._mosaicRects.has(t))return this._mosaicRects.get(t);let M,T,Z;if(et(i)?[M,T,Z]=this._allocateImage(e[0],e[1]):(M=new F.Z(0,0,e[0],e[1]),T=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:i,size:[e[0]+2*E.fL,e[1]+2*E.fL],dirty:!0,texture:void 0})),M.width<=0||M.height<=0)return null;const O={rect:M,width:e[0],height:e[1],sdf:s,simplePattern:n,pixelRatio:c,page:T};return this._mosaicRects.set(t,O),et(i)&&this._copy({rect:M,spriteSize:e,spriteData:i.data,page:T,pageSize:Z,repeat:o,sdf:s}),O}hasItemsToProcess(){return 0!==this._spriteCopyQueue.length}processNextItem(){const t=this._spriteCopyQueue.pop();t&&this._copy(t)}getSpriteItems(t){const e={};for(const i of t)e[i]=this.getSpriteItem(i);return e}getMosaicItemPosition(t){const e=this.getSpriteItem(t),i=e&&e.rect;if(!i)return null;i.width=e.width,i.height=e.height;const n=E.fL,c=this._mosaicPages[e.page];return{size:[e.width,e.height],tl:[(i.x+n)/c[0],(i.y+n)/c[1]],br:[(i.x+n+e.width)/c[0],(i.y+n+e.height)/c[1]],page:e.page}}bind(t,e,i=0,o=0){const s=this._mosaicPages[i],n=s.mosaicsData;let c=s.texture;c||(c=function _t(p,t){return new tt.x(p,{pixelFormat:I.VI.RGBA,dataType:I.Br.UNSIGNED_BYTE,width:t[0],height:t[1]},null)}(t,s.size),s.texture=c),c.setSamplingMode(e),et(n)?(t.bindTexture(c,o),s.dirty&&(c.setData(new Uint8Array(n.data.buffer)),c.generateMipmap())):(n.data.bindFrame(t,c,o),c.generateMipmap()),s.dirty=!1}static _copyBits(t,e,i,o,s,n,c,M,T,Z,O){let N=o*e+i,yt=M*n+c;if(O){yt-=n;for(let q=-1;q<=Z;q++,N=((q+Z)%Z+o)*e+i,yt+=n)for(let wt=-1;wt<=T;wt++)s[yt+wt]=t[N+(wt+T)%T]}else for(let q=0;q<Z;q++){for(let wt=0;wt<T;wt++)s[yt+wt]=t[N+wt];N+=e,yt+=n}}_copy(t){if(t.page>=this._mosaicPages.length)return;const e=this._mosaicPages[t.page],i=e.mosaicsData;if(!et(e.mosaicsData))throw new v.Z("mapview-invalid-resource","unsuitable data type!");const o=t.spriteData,s=i.data;s&&o||console.error("Source or target images are uninitialized!"),mt._copyBits(o,t.spriteSize[0],0,0,s,t.pageSize[0],t.rect.x+E.fL,t.rect.y+E.fL,t.spriteSize[0],t.spriteSize[1],t.repeat),e.dirty=!0}_allocateImage(t,e){t+=2*E.fL,e+=2*E.fL;const i=Math.max(t,e);if(this._maxItemSize&&this._maxItemSize<i){const s=2**Math.ceil((0,Et.k3)(t)),n=2**Math.ceil((0,Et.k3)(e)),c=new F.Z(0,0,t,e);return this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(s*n)},size:[s,n],dirty:!0,texture:void 0}),[c,this._mosaicPages.length-1,[s,n]]}const o=this._binPack.allocate(t,e);if(o.width<=0){const s=this._mosaicPages[this._currentPage];return!s.dirty&&et(s.mosaicsData)&&(s.mosaicsData.data=null),this._currentPage=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new K(this._pageWidth,this._pageHeight),this._allocateImage(t,e)}return[o,this._currentPage,[this._pageWidth,this._pageHeight]]}dispose(){this._binPack=null;for(const t of this._mosaicPages){const e=t.texture;e&&e.dispose();const i=t.mosaicsData;et(i)||i.data.destroy()}this._mosaicPages=null,this._mosaicRects.clear()}}var j=l(87526),it=l(27422),at=l(57932),ht=l(7547),r=l(24002);function h(p){return(0,it.HA)(p.frameDurations.reduce((t,e)=>t+e,0))}function d(p,t){const{width:e,height:i,getFrame:o}=p,s=p.frameDurations.slice(),n=s.pop();return s.push((0,it.HA)(n+t)),{frameDurations:s,getFrame:o,width:e,height:i}}class a{constructor(t,e,i,o){this._animation=t,this._repeatType=i,this._onFrameData=o,this._direction=1,this._currentFrame=0,this.timeToFrame=this._animation.frameDurations[this._currentFrame];let s=0;for(;e>s;)s+=this.timeToFrame,this.nextFrame();const n=this._animation.getFrame(this._currentFrame);this._onFrameData(n)}nextFrame(){if(this._currentFrame+=this._direction,this._direction>0){if(this._currentFrame===this._animation.frameDurations.length)switch(this._repeatType){case ht.of.None:this._currentFrame-=this._direction;break;case ht.of.Loop:this._currentFrame=0;break;case ht.of.Oscillate:this._currentFrame-=this._direction,this._direction=-1}}else if(-1===this._currentFrame)switch(this._repeatType){case ht.of.None:this._currentFrame-=this._direction;break;case ht.of.Loop:this._currentFrame=this._animation.frameDurations.length-1;break;case ht.of.Oscillate:this._currentFrame-=this._direction,this._direction=1}this.timeToFrame=this._animation.frameDurations[this._currentFrame];const t=this._animation.getFrame(this._currentFrame);this._onFrameData(t)}}const g=document.createElement("canvas"),w=g.getContext("2d");class A{constructor(t,e,i,o){this._animation=t,this._frameData=null,this.frameCount=this._animation.frameDurations.length,this.width=this._animation.width,this.height=this._animation.height,this._playHandle=function m(p,t,e,i){const o=null==t.playAnimation||t.playAnimation,s=function u(p,t,e,i){let o,{repeatType:s}=t;if(null==s&&(s=ht.of.Loop),!0===t.reverseAnimation&&(p=function _(p){const{width:t,height:e}=p;return{frameDurations:p.frameDurations.reverse(),getFrame:i=>p.getFrame(p.frameDurations.length-1-i),width:t,height:e}}(p)),null!=t.duration&&(p=function b(p,t){const{width:e,height:i,getFrame:o}=p,s=t/h(p);return{frameDurations:p.frameDurations.map(n=>(0,it.HA)(n*s)),getFrame:o,width:e,height:i}}(p,(0,it.HA)(1e3*t.duration))),null!=t.repeatDelay){const n=1e3*t.repeatDelay;s===ht.of.Loop?p=d(p,(0,it.HA)(n)):s===ht.of.Oscillate&&(p=function P(p,t){const{width:e,height:i,getFrame:o}=p,s=p.frameDurations.slice(),n=s.shift();return s.unshift((0,it.HA)(n+t)),{frameDurations:s,getFrame:o,width:e,height:i}}(d(p,(0,it.HA)(n/2)),(0,it.HA)(n/2)))}if(null!=t.startTimeOffset)o=(0,it.HA)(1e3*t.startTimeOffset);else if(null!=t.randomizeStartTime){const n=(0,r.$)(e),T=(0,r.f)(n,null!=t.randomizeStartSeed?t.randomizeStartSeed:82749913);o=(0,it.HA)(T*h(p))}else o=(0,it.HA)(0);return new a(p,o,s,i)}(p,t,e,i);let n,c=s.timeToFrame;return function M(){n=o?setTimeout(()=>{s.nextFrame(),c=s.timeToFrame,M()},c):void 0}(),{remove:()=>{o&&clearTimeout(n)}}}(this._animation,i,o,n=>{this._frameData=n,e.requestRender()})}destroy(){this._playHandle.remove()}bindFrame(t,e,i){t.bindTexture(e,i),(0,f.Wi)(this._frameData)||(e.updateData(0,E.fL,E.fL,this._frameData.width,this._frameData.height,this._frameData),this._frameData=null)}}var B=l(84450),pt=l(71251);const gt=(0,ct.c)(),nt="arial-unicode-ms-regular",dt=R.Z.getLogger("esri.views.2d.engine.webgl.TextureManager");function vt(p,t){const e=Math.round((0,S.F2)(t)*window.devicePixelRatio);return Math.min(p,e*(e>=128?2:4))}const St=(p,t,e)=>dt.error(new v.Z(p,t,e));class Q{static fromMosaic(t,e){return new Q(t,e.page,e.sdf)}constructor(t,e,i){this.mosaicType=t,this.page=e,this.sdf=i}}class Pt{constructor(t,e,i){var o;this._requestRender=t,this.resourceManager=e,this._allowNonPowerOfTwo=i,this._invalidFontsMap=new Map,this._sdfConverter=new zt(126),this._bindingInfos=new Array,this._hashToBindingIndex=new Map,this._ongoingRasterizations=new Map,this._imageRequestQueue=new pt.e({concurrency:10,process:(o=(0,D.Z)(function*(s,n){(0,C.k_)(n);try{return yield(0,G.default)(s,{responseType:"image",signal:n})}catch(c){throw(0,C.D_)(c)?c:new v.Z("mapview-invalid-resource",`Could not fetch requested resource at ${s}`,c)}}),function(n,c){return o.apply(this,arguments)})}),this._spriteMosaic=new mt(2048,2048,500),this._glyphSource=new Dt(`${z.Z.fontsUrl}/{fontstack}/{range}.pbf`),this._glyphMosaic=new k(1024,1024,this._glyphSource),this._rasterizer=new $.Z(e)}dispose(){this._spriteMosaic.dispose(),this._glyphMosaic.dispose(),this._rasterizer.dispose(),this._sdfConverter.dispose(),this._spriteMosaic=null,this._glyphMosaic=null,this._sdfConverter=null,this._hashToBindingIndex.clear(),this._hashToBindingIndex=null,this._bindingInfos=null,this._ongoingRasterizations.clear(),this._ongoingRasterizations=null,this._imageRequestQueue.clear(),this._imageRequestQueue=null}get sprites(){return this._spriteMosaic}get glyphs(){return this._glyphMosaic}rasterizeItem(t,e,i,o){var s=this;return(0,D.Z)(function*(){if((0,f.Wi)(t))return St("mapview-null-resource","Unable to rasterize null resource"),null;switch(t.type){case"text":case"esriTS":{const n=yield s._rasterizeText(t,i,o);return n.forEach(c=>s._setTextureBinding(H.Un.GLYPH,c)),{glyphMosaicItems:n}}default:{if((0,j.Ll)(t))return St("mapview-invalid-type",`MapView does not support symbol type: ${t.type}`,t),null;const n=yield s._rasterizeSpriteSymbol(t,e,o);return(0,B.ok)(n)&&n&&s._setTextureBinding(H.Un.SPRITE,n),{spriteMosaicItem:n}}}})()}bindTextures(t,e,i,o=!1){if(0===i.textureBinding)return;const s=this._bindingInfos[i.textureBinding-1],n=s.page,c=o?I.cw.LINEAR_MIPMAP_LINEAR:I.cw.LINEAR;switch(s.mosaicType){case H.Un.SPRITE:{const M=this.sprites.getWidth(n),T=this.sprites.getHeight(n),Z=(0,X.s)(gt,M,T);return this._spriteMosaic.bind(t,c,n,E.D3),e.setUniform1i("u_texture",E.D3),void e.setUniform2fv("u_mosaicSize",Z)}case H.Un.GLYPH:{const Z=(0,X.s)(gt,this.glyphs.width,this.glyphs.height);return this._glyphMosaic.bind(t,c,n,E.Al),e.setUniform1i("u_texture",E.Al),void e.setUniform2fv("u_mosaicSize",Z)}default:dt.error("mapview-texture-manager",`Cannot handle unknown type ${s.mosaicType}`)}}_hashMosaic(t,e){return 1|t<<1|(e.sdf?1:0)<<2|e.page<<3}_setTextureBinding(t,e){const i=this._hashMosaic(t,e);if(!this._hashToBindingIndex.has(i)){const o=Q.fromMosaic(t,e);this._hashToBindingIndex.set(i,this._bindingInfos.length+1),this._bindingInfos.push(o)}e.textureBinding=this._hashToBindingIndex.get(i)}_rasterizeText(t,e,i){var o=this;return(0,D.Z)(function*(){let s,n;if("cim"in t)s=t.fontName,n=t.text;else{const T=t;s=(0,y.Yc)(T.font),n=T.text}const c=o._invalidFontsMap.has(s),M=e||(0,j.Jq)((0,L.E)(n)[0]);try{return yield o._glyphMosaic.getGlyphItems(c?nt:s,M,i)}catch{return St("mapview-invalid-resource",`Couldn't find font ${s}. Falling back to Arial Unicode MS Regular`),o._invalidFontsMap.set(s,!0),o._glyphMosaic.getGlyphItems(nt,M,i)}})()}_rasterizeSpriteSymbol(t,e,i){var o=this;return(0,D.Z)(function*(){if((0,j.Gg)(t))return;const s=function ft(p){switch(p.type){case"esriSMS":return`${p.style}.${p.path}`;case"esriSLS":return`${p.style}.${p.cap}`;case"esriSFS":return`${p.style}`;case"esriPFS":case"esriPMS":return p.imageData?`${p.imageData}${p.width}${p.height}`:`${p.url}${p.width}${p.height}`;default:return"mosaicHash"in p?p.mosaicHash:JSON.stringify(p)}}(t);if(o._spriteMosaic.has(s))return o._spriteMosaic.getSpriteItem(s);if((0,j.sG)(t)||(0,j.HX)(t)&&!(0,j.yP)(t))return o._handleAsyncResource(s,t,i);const c=o._rasterizer.rasterizeJSONResource(t,E.XD);if(c){const{size:M,image:T,sdf:Z,simplePattern:O,rasterizationScale:N}=c;return o._addItemToMosaic(s,M,{type:"static",data:T},(0,j.js)(t),Z,O,N)}return new v.Z("TextureManager","unrecognized or null rasterized image")})()}_handleAsyncResource(t,e,i){var o=this;return(0,D.Z)(function*(){if(o._ongoingRasterizations.has(t))return o._ongoingRasterizations.get(t);let s;s=(0,j.sG)(e)?o._handleSVG(e,t,i):o._handleImage(e,t,i),o._ongoingRasterizations.set(t,s);try{yield s,o._ongoingRasterizations.delete(t)}catch{o._ongoingRasterizations.delete(t)}return s})()}_handleSVG(t,e,i){var o=this;return(0,D.Z)(function*(){const n=yield o._sdfConverter.draw(t.path,i);return o._addItemToMosaic(e,[126,126],{type:"static",data:new Uint32Array(n.buffer)},!1,!0,!0)})()}_handleGIFOrPNG(t,e,i){var o=this;return(0,D.Z)(function*(){const s=(0,j.Gr)(t);yield o.resourceManager.fetchResource(s,i);let n=o.resourceManager.getResource(s);if((0,f.Wi)(n))return new v.Z("mapview-invalid-resource",`Could not fetch requested resource at ${s}.`);let c=n.width,M=n.height;if(n instanceof HTMLImageElement){"esriPMS"===t.type&&(c=Math.round(vt(n.width,(0,j.Ub)(t))),M=Math.round(n.height*(c/n.width)));const N="cim"in t?t.cim.colorSubstitutions:void 0,{size:yt,sdf:q,image:wt}=o._rasterizer.rasterizeImageResource(c,M,n,N);return o._addItemToMosaic(e,yt,{type:"static",data:wt},(0,j.js)(t),q,!1)}o._allowNonPowerOfTwo||(c=(0,U.fp)(n.width+2*E.fL)-2*E.fL,M=(0,U.fp)(n.height+2*E.fL)-2*E.fL),c===n.width&&M===n.height||(n=function x(p,t,e){g.width=t,g.height=e;const i=[],o=p.frameDurations.length;for(let s=0;s<o;s++){const n=p.getFrame(s);w.clearRect(0,0,t,e),n instanceof ImageData?w.drawImage((0,at.E0)(n),0,0,t,e):w.drawImage(n,0,0,t,e),i.push(w.getImageData(0,0,t,e))}return{width:t,height:e,frameDurations:p.frameDurations,getFrame:s=>i[s]}}(n,c,M));const O=new A(n,o._requestRender,t.animatedSymbolProperties||{},t.objectId);return o._addItemToMosaic(e,[O.width,O.height],{type:"animated",data:O},(0,j.js)(t),!1,!1)})()}_handleImage(t,e,i){var o=this;return(0,D.Z)(function*(){if((0,j.DQ)(t)||(0,j.iw)(t))return o._handleGIFOrPNG(t,e,i);const s=(0,j.Gr)(t);try{let n;const c=o.resourceManager.getResource(s);if((0,f.pC)(c)&&c instanceof HTMLImageElement)n=c;else{const{data:q}=yield o._imageRequestQueue.push(s,{...i});n=q}if((0,j.TB)(s))if("width"in t&&"height"in t)n.width=(0,S.F2)(t.width),n.height=(0,S.F2)(t.height);else if("cim"in t){const q=t.cim;n.width=(0,S.F2)(q.width??q.scaleX*q.size),n.height=(0,S.F2)(q.size)}if(!n.width||!n.height)return null;let M=n.width,T=n.height;"esriPMS"===t.type&&(M=Math.round(vt(n.width,(0,j.Ub)(t))),T=Math.round(n.height*(M/n.width)));const Z="cim"in t?t.cim.colorSubstitutions:void 0,{size:O,sdf:N,image:yt}=o._rasterizer.rasterizeImageResource(M,T,n,Z);return o._addItemToMosaic(e,O,{type:"static",data:yt},(0,j.js)(t),N,!1)}catch(n){if(!(0,C.D_)(n))return new v.Z("mapview-invalid-resource",`Could not fetch requested resource at ${s}. ${n.message}`)}})()}_addItemToMosaic(t,e,i,o,s,n,c){return this._spriteMosaic.addSpriteItem(t,e,i,o,s,n,c)}}},31823:(ut,W,l)=>{l.d(W,{a:()=>z,m:()=>G});var D=l(62208);class z{constructor(v){if(this.next=null,!Array.isArray(v))return void(this.data=v);this.data=v[0];let y=this;for(let R=1;R<v.length;R++)y.next=new z([v[R]]),y=y.next}*values(){let v=this;for(;v;)yield v.data,v=v.next}forEach(v){let y=this;for(;y;)v(y.data),y=y.next}find(v){return v(this.data)?this:this.next?.find(v)}max(v,y=this){const R=v(this.data)>v(y.data)?this:y;return this.next?this.next.max(v,R):R}remove(v,y=null){return this===v?y?(y.next=this.next,y):this.next:this.next?.remove(v,this)??null}get last(){return this.next?this.next.last:this}}class G{constructor(v){this._head=null,(0,D.Wi)(v)||(this._head=new z(v))}get head(){return this._head}maxAvailableSpace(){if((0,D.Wi)(this._head))return 0;const v=this._head.max(y=>y.end-y.start);return v.data.end-v.data.start}firstFit(v){if((0,D.Wi)(this._head))return null;let y=null,R=this._head;for(;R;){const U=R.data.end-R.data.start;if(U===v)return y?y.next=R.next:this._head=R.next,R.data.start;if(U>v){const f=R.data.start;return R.data.start+=v,f}y=R,R=R.next}return null}free(v,y){const R=v+y;if((0,D.Wi)(this._head)){const S=new z({start:v,end:R});return void(this._head=S)}if(R<=this._head.data.start){if(R===this._head.data.start)return void(this._head.data.start-=y);const S=new z({start:v,end:R});return S.next=this._head,void(this._head=S)}let U=this._head,f=U.next;for(;f;){if(f.data.start>=R){if(U.data.end===v)return U.data.end+=y,U.data.end===f.data.start?(U.data.end+=f.data.end-f.data.start,void(U.next=f.next)):void 0;if(f.data.start===R)return void(f.data.start-=y);const S=new z({start:v,end:R});return S.next=U.next,void(U.next=S)}U=f,f=f.next}if(v===U.data.end)return void(U.data.end+=y);const C=new z({start:v,end:R});U.next=C}}},23282:(ut,W,l)=>{l.d(W,{k:()=>ct});var D=l(26584),z=l(63290),G=l(62208),L=l(39406),v=l(50392),y=l(37977);const U=$=>`#define ${($=>$.replace("-","_").toUpperCase())($)}\n`;function f($){return{attributes:new Map([["a_pos",0],["a_tex",1]]),shaders:{vertexShader:U($)+(0,y.w)("blend/blend.vert"),fragmentShader:U($)+(0,y.w)("blend/blend.frag")}}}var C=l(67969),S=l(55086);const X=z.Z.getLogger("esri.views.2d.engine.webgl.effects.blendEffects.BlendEffect");class ct{constructor(){this._size=[0,0]}dispose(E){this._backBufferTexture=(0,G.M2)(this._backBufferTexture),this._quad=(0,G.M2)(this._quad)}draw(E,H,V,F,K){const{context:I,drawPhase:tt}=E;if(this._setupShader(I),F&&"normal"!==F&&tt!==L.jx.LABEL)return void this._drawBlended(E,H,V,F,K);const rt=f("normal"),lt=I.programCache.acquire(rt.shaders.vertexShader,rt.shaders.fragmentShader,rt.attributes);if(!lt)return void X.error(new D.Z("mapview-BlendEffect",'Error creating shader program for blend mode "normal"'));I.useProgram(lt),H.setSamplingMode(V),I.bindTexture(H,0),lt.setUniform1i("u_layerTexture",0),lt.setUniform1f("u_opacity",K),I.setBlendingEnabled(!0),I.setBlendFunction(C.zi.ONE,C.zi.ONE_MINUS_SRC_ALPHA);const Y=this._quad;Y.draw(),Y.unbind(),lt.dispose()}_drawBlended(E,H,V,F,K){const{context:I,state:tt,pixelRatio:rt,inFadeTransition:lt}=E,{size:Y}=tt,Mt=I.getBoundFramebufferObject();let st,k;if((0,G.pC)(Mt)){const xt=Mt.descriptor;st=xt.width,k=xt.height}else st=Math.round(rt*Y[0]),k=Math.round(rt*Y[1]);this._createOrResizeTexture(E,st,k);const Tt=this._backBufferTexture;Mt.copyToTexture(0,0,st,k,0,0,Tt),I.setStencilTestEnabled(!1),I.setStencilWriteMask(0),I.setBlendingEnabled(!0),I.setDepthTestEnabled(!1),I.setDepthWriteEnabled(!1);const Ct=f(F),J=I.programCache.acquire(Ct.shaders.vertexShader,Ct.shaders.fragmentShader,Ct.attributes);if(!J)return void X.error(new D.Z("mapview-BlendEffect",`Error creating shader program for blend mode ${F}`));I.useProgram(J),Tt.setSamplingMode(V),I.bindTexture(Tt,0),J.setUniform1i("u_backbufferTexture",0),H.setSamplingMode(V),I.bindTexture(H,1),J.setUniform1i("u_layerTexture",1),J.setUniform1f("u_opacity",K),J.setUniform1f("u_inFadeOpacity",lt?1:0),I.setBlendFunction(C.zi.ONE,C.zi.ZERO);const Dt=this._quad;Dt.draw(),Dt.unbind(),J.dispose(),I.setBlendFunction(C.zi.ONE,C.zi.ONE_MINUS_SRC_ALPHA)}_setupShader(E){this._quad||(this._quad=new v.Z(E,[-1,-1,1,-1,-1,1,1,1]))}_createOrResizeTexture(E,H,V){const{context:F}=E;null!==this._backBufferTexture&&H===this._size[0]&&V===this._size[1]||(this._backBufferTexture?this._backBufferTexture.resize(H,V):this._backBufferTexture=new S.x(F,{target:C.No.TEXTURE_2D,pixelFormat:C.VI.RGBA,internalFormat:C.VI.RGBA,dataType:C.Br.UNSIGNED_BYTE,wrapMode:C.e8.CLAMP_TO_EDGE,samplingMode:C.cw.LINEAR,flipped:!1,width:H,height:V}),this._size[0]=H,this._size[1]=V)}}},35903:(ut,W,l)=>{l.d(W,{Q:()=>z});var D=l(37977);const z={shaders:{vertexShader:(0,D.w)("bitBlit/bitBlit.vert"),fragmentShader:(0,D.w)("bitBlit/bitBlit.frag")},attributes:new Map([["a_pos",0],["a_tex",1]])}},8017:(ut,W,l)=>{l.d(W,{C:()=>z,y:()=>G});var D=l(37977);const z={shaders:{vertexShader:(0,D.w)("highlight/textured.vert"),fragmentShader:(0,D.w)("highlight/highlight.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])},G={shaders:{vertexShader:(0,D.w)("highlight/textured.vert"),fragmentShader:(0,D.w)("highlight/blur.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])}},18142:(ut,W,l)=>{l.d(W,{F:()=>L,c:()=>G});var D=l(37977),z=l(94299);const G={shaders:{vertexShader:(0,D.w)("magnifier/magnifier.vert"),fragmentShader:(0,D.w)("magnifier/magnifier.frag")},attributes:new Map([["a_pos",0]])};function L(v){return(0,z.H)(v,G)}},60233:(ut,W,l)=>{l.d(W,{H:()=>z});var D=l(37977);const z={shaders:{vertexShader:(0,D.w)("stencil/stencil.vert"),fragmentShader:(0,D.w)("stencil/stencil.frag")},attributes:new Map([["a_pos",0]])}},69709:(ut,W,l)=>{l.d(W,{Z:()=>ht});var D=l(15861),z=l(17626),G=l(19389),L=l(14517),v=l(62208),y=l(77712),f=(l(90912),l(85931),l(76898)),C=l(72642),S=l(24926),X=l(23841),ct=l(18547);const $="esri-zoom-box",E={container:`${$}__container`,overlay:`${$}__overlay`,background:`${$}__overlay-background`,box:`${$}__outline`};let V=class extends L.Z{constructor(r){super(r),this._container=null,this._overlay=null,this._backgroundShape=null,this._boxShape=null,this._box={x:0,y:0,width:0,height:0},this._rafId=null,this._handles=null,this._redraw=this._redraw.bind(this)}destroy(){this.view=null}set view(r){this._handles&&this._handles.forEach(h=>{h.remove()}),this._handles=null,this._destroyOverlay(),this._set("view",r),r&&(r.on("drag",["Shift"],h=>this._handleDrag(h,1),ct.f.INTERNAL),r.on("drag",["Shift","Ctrl"],h=>this._handleDrag(h,-1),ct.f.INTERNAL))}_start(){this._createContainer(),this._createOverlay(),this.navigation.begin()}_update(r,h,_,b){this._box.x=r,this._box.y=h,this._box.width=_,this._box.height=b,this._rafId||(this._rafId=requestAnimationFrame(this._redraw))}_end(r,h,_,b,P){const d=this.view,a=d.toMap((0,X.vW)(r+.5*_,h+.5*b));let u=Math.max(_/d.width,b/d.height);-1===P&&(u=1/u),this._destroyOverlay(),this.navigation.end(),d.goTo({center:a,scale:d.scale*u})}_updateBox(r,h,_,b){const P=this._boxShape;P.setAttributeNS(null,"x",""+r),P.setAttributeNS(null,"y",""+h),P.setAttributeNS(null,"width",""+_),P.setAttributeNS(null,"height",""+b),P.setAttributeNS(null,"class",E.box)}_updateBackground(r,h,_,b){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(r,h,_,b,this.view.width,this.view.height))}_createContainer(){const r=document.createElement("div");r.className=E.container,this.view.root.appendChild(r),this._container=r}_createOverlay(){const r=this.view.width,h=this.view.height,_=document.createElementNS("http://www.w3.org/2000/svg","path");_.setAttributeNS(null,"d","M 0 0 L "+r+" 0 L "+r+" "+h+" L 0 "+h+" Z"),_.setAttributeNS(null,"class",E.background);const b=document.createElementNS("http://www.w3.org/2000/svg","rect"),P=document.createElementNS("http://www.w3.org/2000/svg","svg");P.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),P.setAttributeNS(null,"class",E.overlay),P.appendChild(_),P.appendChild(b),this._container.appendChild(P),this._backgroundShape=_,this._boxShape=b,this._overlay=P}_destroyOverlay(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container),this._container=this._backgroundShape=this._boxShape=this._overlay=null}_toSVGPath(r,h,_,b,P,d){const a=r+_,u=h+b;return"M 0 0 L "+P+" 0 L "+P+" "+d+" L 0 "+d+" ZM "+r+" "+h+" L "+r+" "+u+" L "+a+" "+u+" L "+a+" "+h+" Z"}_handleDrag(r,h){const _=r.x,b=r.y,P=r.origin.x,d=r.origin.y;let a,u,m,g;switch(_>P?(a=P,m=_-P):(a=_,m=P-_),b>d?(u=d,g=b-d):(u=b,g=d-b),r.action){case"start":this._start();break;case"update":this._update(a,u,m,g);break;case"end":this._end(a,u,m,g,h)}r.stopPropagation()}_redraw(){if(!this._rafId||(this._rafId=null,!this._overlay))return;const{x:r,y:h,width:_,height:b}=this._box;this._updateBox(r,h,_,b),this._updateBackground(r,h,_,b),this._rafId=requestAnimationFrame(this._redraw)}};(0,z._)([(0,y.Cb)()],V.prototype,"navigation",void 0),(0,z._)([(0,y.Cb)()],V.prototype,"view",null),V=(0,z._)([(0,f.j)("esri.views.2d.navigation.ZoomBox")],V);const F=V;l(29132);var I=l(32917),tt=l(84161),rt=l(28093),lt=l(88500);let Y=class extends L.Z{constructor(r){super(r),this.animationTime=0,this.momentumEstimator=new lt.G(500,6,.92),this.momentum=null,this.tmpMomentum=(0,rt.c)(),this.momentumFinished=!1,this.viewpoint=new G.Z({targetGeometry:new C.Z,scale:0,rotation:0}),this._previousDrag=null,(0,I.gx)(()=>this.momentumFinished,()=>this.navigation.stop())}begin(r,h){this.navigation.begin(),this.momentumEstimator.reset(),this.addToEstimator(h),this._previousDrag=h}update(r,h){this.addToEstimator(h);let _=h.center.x,b=h.center.y;const P=this._previousDrag;_=P?P.center.x-_:-_,b=P?b-P.center.y:b,r.viewpoint=(0,S.Rx)(this.viewpoint,r.viewpoint,[_||0,b||0]),this._previousDrag=h}end(r,h){this.addToEstimator(h),this.momentum=r.navigation.momentumEnabled?this.momentumEstimator.evaluateMomentum():null,this.animationTime=0,this.momentum&&this.onAnimationUpdate(r),this._previousDrag=null,this.navigation.end()}addToEstimator(r){const h=r.center.x,_=r.center.y,b=(0,X.s1)(-h,_),P=(0,rt.f)(-h,_,0);this.momentumEstimator.add(b,P,.001*r.timestamp)}onAnimationUpdate(r){this.navigation.animationManager?.animateContinous(r.viewpoint,(h,_)=>{const{momentum:b,animationTime:P,tmpMomentum:d}=this,a=.001*_;if(!(this.momentumFinished=!b||b.isFinished(P))){const u=b.valueDelta(P,a);(0,tt.g)(d,b.direction,u),(0,S.Rx)(h,h,d),r.constraints.constrainByGeometry(h)}this.animationTime+=a})}stopMomentumNavigation(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())}};(0,z._)([(0,y.Cb)()],Y.prototype,"momentumFinished",void 0),(0,z._)([(0,y.Cb)()],Y.prototype,"viewpoint",void 0),(0,z._)([(0,y.Cb)()],Y.prototype,"navigation",void 0),Y=(0,z._)([(0,f.j)("esri.views.2d.navigation.actions.Pan")],Y);const Mt=Y;var st=l(67831),k=l(99770),Tt=l(6532),Ct=l(35843);let J=class extends L.Z{constructor(r){super(r),this._animationTime=0,this._momentumFinished=!1,this._previousAngle=0,this._previousRadius=0,this._previousCenter=null,this._rotationMomentumEstimator=new Tt.y(.6,.15,.95),this._rotationDirection=1,this._startAngle=0,this._startRadius=0,this._updateTimestamp=null,this._zoomDirection=1,this._zoomMomentumEstimator=new Ct.D,this._zoomOnly=null,this.zoomMomentum=null,this.rotateMomentum=null,this.viewpoint=new G.Z({targetGeometry:new C.Z,scale:0,rotation:0}),this.addHandles((0,I.gx)(()=>this._momentumFinished,()=>this.navigation.stop()))}begin(r,h){this.navigation.begin(),this._rotationMomentumEstimator.reset(),this._zoomMomentumEstimator.reset(),this._zoomOnly=null,this._previousAngle=this._startAngle=h.angle,this._previousRadius=this._startRadius=h.radius,this._previousCenter=h.center,this._updateTimestamp=null,r.constraints.rotationEnabled&&this.addToRotateEstimator(0,h.timestamp),this.addToZoomEstimator(h,1)}update(r,h){null===this._updateTimestamp&&(this._updateTimestamp=h.timestamp);const _=h.angle,b=h.radius,P=h.center,d=Math.abs(180*(_-this._startAngle)/Math.PI),a=Math.abs(b-this._startRadius),u=this._startRadius/b;if(this._previousRadius&&this._previousCenter){const m=b/this._previousRadius;let g=180*(_-this._previousAngle)/Math.PI;this._rotationDirection=g>=0?1:-1,this._zoomDirection=m>=1?1:-1,r.constraints.rotationEnabled?(null===this._zoomOnly&&h.timestamp-this._updateTimestamp>200&&(this._zoomOnly=a-d>0),null===this._zoomOnly||this._zoomOnly?g=0:this.addToRotateEstimator(_-this._startAngle,h.timestamp)):g=0,this.addToZoomEstimator(h,u),this.navigation.setViewpoint([P.x,P.y],1/m,g,[this._previousCenter.x-P.x,P.y-this._previousCenter.y])}this._previousAngle=_,this._previousRadius=b,this._previousCenter=P}end(r){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum(),this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum(),this._animationTime=0,(this.rotateMomentum||this.zoomMomentum)&&this.onAnimationUpdate(r),this.navigation.end()}addToRotateEstimator(r,h){this._rotationMomentumEstimator.add(r,.001*h)}addToZoomEstimator(r,h){this._zoomMomentumEstimator.add(h,.001*r.timestamp)}canZoomIn(r){const _=r.constraints.effectiveMaxScale;return 0===_||r.scale>_}canZoomOut(r){const _=r.constraints.effectiveMinScale;return 0===_||r.scale<_}onAnimationUpdate(r){this.navigation.animationManager?.animateContinous(r.viewpoint,(h,_)=>{const b=!this.canZoomIn(r)&&this._zoomDirection>1||!this.canZoomOut(r)&&this._zoomDirection<1,P=!this.rotateMomentum||this.rotateMomentum.isFinished(this._animationTime),d=b||!this.zoomMomentum||this.zoomMomentum.isFinished(this._animationTime),a=.001*_;if(this._momentumFinished=P&&d,!this._momentumFinished){const u=this.rotateMomentum?Math.abs(this.rotateMomentum.valueDelta(this._animationTime,a))*this._rotationDirection*180/Math.PI:0;let m=this.zoomMomentum?Math.abs(this.zoomMomentum.valueDelta(this._animationTime,a)):1;const g=(0,k.a)(),w=(0,k.a)();if(this._previousCenter){(0,st.s)(g,this._previousCenter.x,this._previousCenter.y),(0,S.Dq)(w,r.size,r.padding),(0,st.j)(g,g,w);const{constraints:x,scale:A}=r,B=A*m;m<1&&!x.canZoomInTo(B)?(m=A/x.effectiveMaxScale,this.zoomMomentum=null,this.rotateMomentum=null):m>1&&!x.canZoomOutTo(B)&&(m=A/x.effectiveMinScale,this.zoomMomentum=null,this.rotateMomentum=null),(0,S.UZ)(h,r.viewpoint,m,u,g,r.size),r.constraints.constrainByGeometry(h)}}this._animationTime+=a})}stopMomentumNavigation(){(this.rotateMomentum||this.zoomMomentum)&&(this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop())}};(0,z._)([(0,y.Cb)()],J.prototype,"_momentumFinished",void 0),(0,z._)([(0,y.Cb)()],J.prototype,"viewpoint",void 0),(0,z._)([(0,y.Cb)()],J.prototype,"navigation",void 0),J=(0,z._)([(0,f.j)("esri.views.2d.navigation.actions.Pinch")],J);const Dt=J,xt=(0,k.a)(),bt=(0,k.a)();let zt=class extends L.Z{constructor(r){super(r),this._previousCenter=(0,k.a)(),this.viewpoint=new G.Z({targetGeometry:new C.Z,scale:0,rotation:0})}begin(r,h){this.navigation.begin(),(0,st.s)(this._previousCenter,h.center.x,h.center.y)}update(r,h){const{state:{size:_,padding:b}}=r;(0,st.s)(xt,h.center.x,h.center.y),(0,S.ni)(bt,_,b),r.viewpoint=(0,S.$H)(this.viewpoint,r.state.paddedViewState.viewpoint,(0,S.dI)(bt,this._previousCenter,xt)),(0,st.c)(this._previousCenter,xt)}end(){this.navigation.end()}};(0,z._)([(0,y.Cb)()],zt.prototype,"viewpoint",void 0),(0,z._)([(0,y.Cb)()],zt.prototype,"navigation",void 0),zt=(0,z._)([(0,f.j)("esri.views.2d.actions.Rotate")],zt);const Et=zt,_t=new G.Z({targetGeometry:new C.Z}),j=[0,0];let at=class extends L.Z{constructor(r){super(r),this._endTimer=null,this._lastEventTimestamp=null,this.animationManager=null,this.interacting=!1}initialize(){this.pan=new Mt({navigation:this}),this.rotate=new Et({navigation:this}),this.pinch=new Dt({navigation:this}),this.zoomBox=new F({view:this.view,navigation:this})}destroy(){this.pan=(0,v.SC)(this.pan),this.rotate=(0,v.SC)(this.rotate),this.pinch=(0,v.SC)(this.pinch),this.zoomBox=(0,v.SC)(this.zoomBox),this.animationManager=null}begin(){this._set("interacting",!0)}end(){this._lastEventTimestamp=performance.now(),this._startTimer(250)}zoom(r,h=this._getDefaultAnchor()){var _=this;return(0,D.Z)(function*(){if(_.stop(),_.begin(),_.view.constraints.snapToZoom&&_.view.constraints.effectiveLODs)return r<1?_.zoomIn(h):_.zoomOut(h);_.setViewpoint(h,r,0,[0,0])})()}zoomIn(r){var h=this;return(0,D.Z)(function*(){const _=h.view,b=_.constraints.snapToNextScale(_.scale);return h._zoomToScale(b,r)})()}zoomOut(r){var h=this;return(0,D.Z)(function*(){const _=h.view,b=_.constraints.snapToPreviousScale(_.scale);return h._zoomToScale(b,r)})()}setViewpoint(r,h,_,b){this.begin(),this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,r,h,_,b),this.end()}setViewpointImmediate(r,h=0,_=[0,0],b=this._getDefaultAnchor()){this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,b,r,h,_)}continousRotateClockwise(){const r=this.get("view.viewpoint");this.animationManager?.animateContinous(r,h=>{(0,S.$H)(h,h,-1)})}continousRotateCounterclockwise(){const r=this.get("view.viewpoint");this.animationManager?.animateContinous(r,h=>{(0,S.$H)(h,h,1)})}resetRotation(){this.view.rotation=0}continousPanLeft(){this._continuousPan([-10,0])}continousPanRight(){this._continuousPan([10,0])}continousPanUp(){this._continuousPan([0,10])}continousPanDown(){this._continuousPan([0,-10])}stop(){this.pan.stopMomentumNavigation(),this.animationManager?.stop(),this.end(),null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null,this._set("interacting",!1))}_continuousPan(r){this.animationManager?.animateContinous(this.view.viewpoint,_=>{(0,S.Rx)(_,_,r),this.view.constraints.constrainByGeometry(_)})}_startTimer(r){return null!==this._endTimer||(this._endTimer=setTimeout(()=>{this._endTimer=null;const h=performance.now()-(this._lastEventTimestamp??0);h<250?this._endTimer=this._startTimer(h):this._set("interacting",!1)},r)),this._endTimer}_getDefaultAnchor(){const{size:r,padding:{left:h,right:_,top:b,bottom:P}}=this.view;return j[0]=.5*(r[0]-_+h),j[1]=.5*(r[1]-P+b),j}_zoomToScale(r,h=this._getDefaultAnchor()){var _=this;return(0,D.Z)(function*(){const{view:b}=_,{constraints:P,scale:d,viewpoint:a,size:u,padding:m}=b,g=P.canZoomInTo(r),w=P.canZoomOutTo(r);if(!(r<d&&!g||r>d&&!w))return(0,S.gG)(_t,a,r/d,0,h,u,m),P.constrainByGeometry(_t),b.goTo(_t,{animate:!0})})()}_scaleRotateTranslateViewpoint(r,h,_,b,P){const{view:d}=this,{size:a,padding:u,constraints:m,scale:g,viewpoint:w}=d,x=g*_,A=m.canZoomInTo(x),B=m.canZoomOutTo(x);return(_<1&&!A||_>1&&!B)&&(_=1),(0,S.Rx)(w,w,P),(0,S.gG)(r,w,_,b,h,a,u),m.constrainByGeometry(r)}};(0,z._)([(0,y.Cb)()],at.prototype,"animationManager",void 0),(0,z._)([(0,y.Cb)({type:Boolean,readOnly:!0})],at.prototype,"interacting",void 0),(0,z._)([(0,y.Cb)()],at.prototype,"pan",void 0),(0,z._)([(0,y.Cb)()],at.prototype,"pinch",void 0),(0,z._)([(0,y.Cb)()],at.prototype,"rotate",void 0),(0,z._)([(0,y.Cb)()],at.prototype,"view",void 0),(0,z._)([(0,y.Cb)()],at.prototype,"zoomBox",void 0),at=(0,z._)([(0,f.j)("esri.views.2d.navigation.MapViewNavigation")],at);const ht=at}}]);