"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[6344],{84537:(re,$,l)=>{l.d($,{VF:()=>V,Uf:()=>Te});var w=l(15861),p=l(17626),Z=l(88879),z=l(14517),G=l(46160),W=l(26584),E=l(8314),S=l(88159),C=l(62208),I=l(10699),R=l(32917),T=l(16730),y=l(77712),L=l(90912),O=(l(85931),l(76898)),H=l(2004),N=l(83137),D=l(59990);function X(r,e){return e?"xoffset"in e&&e.xoffset?Math.max(r,Math.abs(e.xoffset)):"yoffset"in e&&e.yoffset?Math.max(r,Math.abs(e.yoffset||0)):r:r}function ne(r,e){return"number"==typeof r?r:r&&r.stops&&r.stops.length?function fe(r){let e=0,s=0;for(let o=0;o<r.length;o++){const i=r[o].size;"number"==typeof i&&(e+=i,s++)}return e/s}(r.stops):e}function se(r){const e=r&&r.renderer,s="touch"===(r&&r.event&&r.event.pointerType)?9:6;if(!e)return s;const o="visualVariables"in e?function de(r,e){if(!e)return r;const s=e.filter(f=>"size"===f.type).map(f=>{const{maxSize:b,minSize:u}=f;return(ne(b,r)+ne(u,r))/2});let o=0;const i=s.length;if(0===i)return r;for(let f=0;f<i;f++)o+=s[f];const a=Math.floor(o/i);return Math.max(a,r)}(s,e.visualVariables):s;if("simple"===e.type)return X(o,e.symbol);if("unique-value"===e.type){let i=o;return e.uniqueValueInfos?.forEach(a=>{i=X(i,a.symbol)}),i}if("class-breaks"===e.type){let i=o;return e.classBreakInfos.forEach(a=>{i=X(i,a.symbol)}),i}return o}var ce=l(84792),he=l(93555),Y=l(2618),me=l(95737),ie=l(91179),ge=l(13410);const oe=r=>r.spatialReference.wkid||JSON.stringify(r.spatialReference);var _,Ee=l(29132),Ce=l(97478),ae=l(86810),Oe=l(65234);let v=_=class extends ae.wq{static from(r){return(0,L.TJ)(_,r)}constructor(r){super(r),this.dpi=96,this.floors=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=null,this.height=400,this.layerIds=null,this.layerOption="top",this.mapExtent=null,this.maxAllowableOffset=null,this.returnFieldName=!0,this.returnGeometry=!1,this.returnM=!1,this.returnUnformattedValues=!0,this.returnZ=!1,this.spatialReference=null,this.sublayers=null,this.timeExtent=null,this.tolerance=null,this.width=400}};(0,p._)([(0,y.Cb)({type:Number,json:{write:!0}})],v.prototype,"dpi",void 0),(0,p._)([(0,y.Cb)()],v.prototype,"floors",void 0),(0,p._)([(0,y.Cb)({type:String,json:{write:!0}})],v.prototype,"gdbVersion",void 0),(0,p._)([(0,y.Cb)({types:Ee.qM,json:{read:ie.im,write:!0}})],v.prototype,"geometry",void 0),(0,p._)([(0,y.Cb)({type:Number,json:{write:!0}})],v.prototype,"geometryPrecision",void 0),(0,p._)([(0,y.Cb)({type:Number,json:{write:!0}})],v.prototype,"height",void 0),(0,p._)([(0,y.Cb)({type:[Number],json:{write:!0}})],v.prototype,"layerIds",void 0),(0,p._)([(0,y.Cb)({type:["top","visible","all","popup"],json:{write:!0}})],v.prototype,"layerOption",void 0),(0,p._)([(0,y.Cb)({type:H.Z,json:{write:!0}})],v.prototype,"mapExtent",void 0),(0,p._)([(0,y.Cb)({type:Number,json:{write:!0}})],v.prototype,"maxAllowableOffset",void 0),(0,p._)([(0,y.Cb)({type:Boolean,json:{write:!0}})],v.prototype,"returnFieldName",void 0),(0,p._)([(0,y.Cb)({type:Boolean,json:{write:!0}})],v.prototype,"returnGeometry",void 0),(0,p._)([(0,y.Cb)({type:Boolean,json:{write:!0}})],v.prototype,"returnM",void 0),(0,p._)([(0,y.Cb)({type:Boolean,json:{write:!0}})],v.prototype,"returnUnformattedValues",void 0),(0,p._)([(0,y.Cb)({type:Boolean,json:{write:!0}})],v.prototype,"returnZ",void 0),(0,p._)([(0,y.Cb)({type:Oe.Z,json:{write:!0}})],v.prototype,"spatialReference",void 0),(0,p._)([(0,y.Cb)()],v.prototype,"sublayers",void 0),(0,p._)([(0,y.Cb)({type:Ce.Z,json:{write:!0}})],v.prototype,"timeExtent",void 0),(0,p._)([(0,y.Cb)({type:Number,json:{write:!0}})],v.prototype,"tolerance",void 0),(0,p._)([(0,y.Cb)({type:Number,json:{write:!0}})],v.prototype,"width",void 0),v=_=(0,p._)([(0,O.j)("esri.rest.support.IdentifyParameters")],v);const le=v;var Pe=l(68653),Se=l(99433),Ie=l(71774);let A=class extends ae.wq{constructor(r){super(r),this.displayFieldName=null,this.feature=null,this.layerId=null,this.layerName=null}readFeature(r,e){return Z.Z.fromJSON({attributes:{...e.attributes},geometry:{...e.geometry}})}writeFeature(r,e){if(!r)return;const{attributes:s,geometry:o}=r;s&&(e.attributes={...s}),(0,C.pC)(o)&&(e.geometry=o.toJSON(),e.geometryType=Ie.P.toJSON(o.type))}};(0,p._)([(0,y.Cb)({type:String,json:{write:!0}})],A.prototype,"displayFieldName",void 0),(0,p._)([(0,y.Cb)({type:Z.Z})],A.prototype,"feature",void 0),(0,p._)([(0,Pe.r)("feature",["attributes","geometry"])],A.prototype,"readFeature",null),(0,p._)([(0,Se.c)("feature")],A.prototype,"writeFeature",null),(0,p._)([(0,y.Cb)({type:Number,json:{write:!0}})],A.prototype,"layerId",void 0),(0,p._)([(0,y.Cb)({type:String,json:{write:!0}})],A.prototype,"layerName",void 0),A=(0,p._)([(0,O.j)("esri.rest.support.IdentifyResult")],A);const Re=A;function k(){return(k=(0,w.Z)(function*(r,e,s){const o=(e=function Fe(r){return le.from(r)}(e)).geometry?[e.geometry]:[],i=(0,Y.en)(r);return i.path+="/identify",(0,he.aX)(o).then(a=>{const f=function ve(r,e){const{dpi:s,gdbVersion:o,geometry:i,geometryPrecision:a,height:f,layerOption:b,mapExtent:u,maxAllowableOffset:h,returnFieldName:c,returnGeometry:d,returnUnformattedValues:m,returnZ:x,spatialReference:g,timeExtent:F,tolerance:j,width:P}=r.toJSON(),{dynamicLayers:U,layerDefs:J,layerIds:Q}=function be(r){const{mapExtent:e,floors:s,width:o,sublayers:i,layerIds:a,layerOption:f,gdbVersion:b}=r,u=i?.find(g=>null!=g.layer)?.layer?.serviceSublayers,h="popup"===f,c={},d=(0,N.yZ)({extent:e,width:o,spatialReference:e?.spatialReference}),m=[],x=g=>{if(g.visible&&(0===d||(0===g.minScale||d<=g.minScale)&&(0===g.maxScale||d>=g.maxScale)))if(g.sublayers)g.sublayers.forEach(x);else{if(!1===a?.includes(g.id)||h&&(!g.popupTemplate||!g.popupEnabled))return;m.unshift(g)}};if(i?.forEach(x),i&&!m.length)c.layerIds=[];else{const g=(0,ge.FN)(m,u,b),F=m.map(j=>{const P=(0,D.f)(s,j);return j.toExportImageJSON(P)});if(g)c.dynamicLayers=JSON.stringify(F);else{if(i){let P=m.map(({id:U})=>U);a&&(P=P.filter(U=>a.includes(U))),c.layerIds=P}else a?.length&&(c.layerIds=a);const j=function xe(r,e){const s=!!r?.length,o=e.filter(i=>null!=i.definitionExpression||s&&null!=i.floorInfo);return o.length?o.map(i=>{const a=(0,D.f)(r,i),f=(0,me._)(a,i.definitionExpression);return{id:i.id,definitionExpression:(0,C.Pt)(f,void 0)}}):null}(s,m);if((0,C.pC)(j)&&j.length){const P={};for(const U of j)U.definitionExpression&&(P[U.id]=U.definitionExpression);Object.keys(P).length&&(c.layerDefs=JSON.stringify(P))}}}return c}(r),ye=e&&(0,C.pC)(e.geometry)?e.geometry:null,M={geometryPrecision:a,maxAllowableOffset:h,returnFieldName:c,returnGeometry:d,returnUnformattedValues:m,returnZ:x,tolerance:j},B=ye&&ye.toJSON()||i;if(M.imageDisplay=`${P},${f},${s}`,o&&(M.gdbVersion=o),B&&(delete B.spatialReference,M.geometry=JSON.stringify(B),M.geometryType=(0,ie.Ji)(B)),g?M.sr=g.wkid||JSON.stringify(g):B&&B.spatialReference?M.sr=oe(B):u&&u.spatialReference&&(M.sr=oe(u)),M.time=F?[F.start,F.end].join(","):null,u){const{xmin:Ve,ymin:Le,xmax:De,ymax:Je}=u;M.mapExtent=`${Ve},${Le},${De},${Je}`}return J&&(M.layerDefs=J),U&&!J&&(M.dynamicLayers=U),M.layers="popup"===b?"visible":b,Q&&!U&&(M.layers+=`:${Q.join(",")}`),M}(e,{geometry:a&&a[0]}),b=(0,Y.cv)({...i.query,f:"json",...f}),u=(0,Y.lA)(b,s);return(0,ce.default)(i.path,u).then(we).then(h=>function Me(r,e){if(!e?.length)return r;const s=new Map;e.forEach(function o(i){s.set(i.id,i),i.sublayers&&i.sublayers.forEach(o)});for(const i of r.results)i.feature.sourceLayer=s.get(i.layerId);return r}(h,e.sublayers))})})).apply(this,arguments)}function we(r){const e=r.data;return e.results=e.results||[],e.exceededTransferLimit=Boolean(e.exceededTransferLimit),e.results=e.results.map(s=>Re.fromJSON(s)),e}var Ue=l(46679),ue=l(57213),pe=l(10023);let q=null;function Te(r,e){return"tile"===e.type||"map-image"===e.type}let V=class extends z.Z{constructor(r){var e;super(r),e=this,this._featuresResolutions=new WeakMap,this.highlightGraphics=null,this.highlightGraphicUpdated=null,this.updateHighlightedFeatures=(0,I.Ds)(function(){var s=(0,w.Z)(function*(o){e.destroyed||e.updatingHandles.addPromise(e._updateHighlightedFeaturesGeometries(o).catch(()=>{}))});return function(o){return s.apply(this,arguments)}}())}initialize(){const r=e=>{this.updatingHandles.addPromise(this._updateHighlightedFeaturesSymbols(e).catch(()=>{})),this.updateHighlightedFeatures(this._highlightGeometriesResolution)};this.addHandles([(0,R.on)(()=>this.highlightGraphics,"change",e=>r(e.added),{onListenerAdd:e=>r(e)})])}fetchPopupFeatures(r,e){var s=this;return(0,w.Z)(function*(){const{layerView:{layer:o,view:{scale:i}}}=s;if(!r)throw new W.Z("fetchPopupFeatures:invalid-area","Nothing to fetch without area",{layer:o});const a=function Ze(r,e,s){const o=[],i=a=>{if(a.visible&&(0===a.minScale||e<=a.minScale)&&(0===a.maxScale||e>=a.maxScale))if(a.sublayers)a.sublayers.forEach(i);else if(a.popupEnabled){const u=(0,pe.V)(a,{...s,defaultPopupTemplateEnabled:!1});(0,C.pC)(u)&&o.unshift({sublayer:a,popupTemplate:u})}};return(r?.toArray()??[]).reverse().map(i),o}(o.sublayers,i,e);if(!a.length)return[];const f=yield function Ae(r,e){return ee.apply(this,arguments)}(o,a);if(!((o.capabilities?.operations?.supportsIdentify??1)&&o.version>=10.5||f))throw new W.Z("fetchPopupFeatures:not-supported","query operation is disabled for this service",{layer:o});return f?s._fetchPopupFeaturesUsingQueries(r,a,e):s._fetchPopupFeaturesUsingIdentify(r,a,e)})()}clearHighlights(){this.highlightGraphics?.removeAll()}highlight(r){const e=this.highlightGraphics;if(!e)return{remove(){}};let s=null;if(r instanceof Z.Z?s=[r]:G.Z.isCollection(r)&&r.length>0?s=r.toArray():Array.isArray(r)&&r.length>0&&(s=r),s=s?.filter(C.pC),!s||!s.length)return{remove:()=>{}};for(const o of s){const i=o.sourceLayer;null!=i&&"geometryType"in i&&"point"===i.geometryType&&(o.visible=!1)}return e.addMany(s),{remove:()=>{e.removeMany(s??[])}}}_updateHighlightedFeaturesSymbols(r){var e=this;return(0,w.Z)(function*(){const{layerView:{view:s},highlightGraphics:o,highlightGraphicUpdated:i}=e;if(o&&i)for(const a of r){const f=a.sourceLayer&&"renderer"in a.sourceLayer&&a.sourceLayer.renderer;a.sourceLayer&&"geometryType"in a.sourceLayer&&"point"===a.sourceLayer.geometryType&&f&&"getSymbolAsync"in f&&f.getSymbolAsync(a).then(function(){var b=(0,w.Z)(function*(u){u||(u=new ue.Z);let h=null;const c="visualVariables"in f?f.visualVariables?.find(d=>"size"===d.type):void 0;c&&(q||(q=(yield Promise.resolve().then(l.bind(l,81808))).getSize),h=q(c,a,{view:s.type,scale:s.scale,shape:"simple-marker"===u.type?u.style:null})),h||(h="width"in u&&"height"in u&&null!=u.width&&null!=u.height?Math.max(u.width,u.height):"size"in u?u.size:16),o.includes(a)&&(a.symbol=new ue.Z({style:"square",size:h,xoffset:"xoffset"in u?u.xoffset:0,yoffset:"yoffset"in u?u.yoffset:0}),i(a,"symbol"),a.visible=!0)});return function(u){return b.apply(this,arguments)}}())}})()}_updateHighlightedFeaturesGeometries(r){var e=this;return(0,w.Z)(function*(){const{layerView:{layer:s,view:o},highlightGraphics:i,highlightGraphicUpdated:a}=e;if(e._highlightGeometriesResolution=r,!a||!i?.length||!s.capabilities.operations.supportsQuery)return;const f=e._getTargetResolution(r),b=new Map;for(const c of i)(!e._featuresResolutions.has(c)||e._featuresResolutions.get(c)>f)&&(0,S.s1)(b,c.sourceLayer,()=>new Map).set(c.getObjectId(),c);const u=Array.from(b,([c,d])=>{const m=c.createQuery();return m.objectIds=[...d.keys()],m.outFields=[c.objectIdField],m.returnGeometry=!0,m.maxAllowableOffset=f,m.outSpatialReference=o.spatialReference,c.queryFeatures(m)}),h=yield Promise.all(u);if(!e.destroyed)for(const{features:c}of h)for(const d of c){const x=b.get(d.sourceLayer).get(d.getObjectId());x&&i.includes(x)&&(x.geometry=d.geometry,a(x,"geometry"),e._featuresResolutions.set(x,f))}})()}_getTargetResolution(r){const e=r*(0,T.c9)(this.layerView.view.spatialReference),s=e/16;return s<=10?0:r/e*s}_fetchPopupFeaturesUsingIdentify(r,e,s){var o=this;return(0,w.Z)(function*(){const i=yield o._createIdentifyParameters(r,e,s);if((0,C.Wi)(i))return[];const{results:a}=yield function je(r,e,s){return k.apply(this,arguments)}(o.layerView.layer.parsedUrl,i);return a.map(f=>f.feature)})()}_createIdentifyParameters(r,e,s){var o=this;return(0,w.Z)(function*(){const{floors:i,layer:a,timeExtent:f,view:{spatialReference:b,scale:u}}=o.layerView,h=(0,C.pC)(s)?s.event:null;if(!e.length)return null;yield Promise.all(e.map(({sublayer:F})=>F.load().catch(()=>{})));const c=Math.min((0,E.Z)("mapservice-popup-identify-max-tolerance"),a.allSublayers.reduce((F,j)=>j.renderer?se({renderer:j.renderer,event:h}):F,2)),d=o.createFetchPopupFeaturesQueryGeometry(r,c),m=(0,N.dp)(u,b),x=Math.round(d.width/m),g=new H.Z({xmin:d.center.x-m*x,ymin:d.center.y-m*x,xmax:d.center.x+m*x,ymax:d.center.y+m*x,spatialReference:d.spatialReference});return new le({floors:i,gdbVersion:"gdbVersion"in a?a.gdbVersion:void 0,geometry:r,height:x,layerOption:"popup",mapExtent:g,returnGeometry:!0,spatialReference:b,sublayers:a.sublayers,timeExtent:f,tolerance:c,width:x})})()}_fetchPopupFeaturesUsingQueries(r,e,s){var o=this;return(0,w.Z)(function*(){const{layerView:{floors:i,timeExtent:a}}=o,f=(0,C.pC)(s)?s.event:null,b=e.map(function(){var u=(0,w.Z)(function*({sublayer:h,popupTemplate:c}){if(yield h.load().catch(()=>{}),h.capabilities&&!h.capabilities.operations.supportsQuery)return[];const d=h.createQuery(),m=se({renderer:h.renderer,event:f}),x=o.createFetchPopupFeaturesQueryGeometry(r,m);if(d.geometry=x,d.outFields=yield(0,pe.e)(h,c),d.timeExtent=a,i){const J=i.clone(),Q=(0,D.f)(J,h);(0,C.pC)(Q)&&(d.where=d.where?`(${d.where}) AND (${Q})`:Q)}const g=o._getTargetResolution(x.width/m),F=yield function Ne(r){return r.expressionInfos?.length||Array.isArray(r.content)&&r.content.some(e=>"expression"===e.type)?(0,Ue.LC)():Promise.resolve()}(c),j="point"===h.geometryType||F&&F.arcadeUtils.hasGeometryOperations(c);j||(d.maxAllowableOffset=g);let{features:P}=yield h.queryFeatures(d);const U=j?0:g;P=yield function Ge(r,e){return te.apply(this,arguments)}(h,P);for(const J of P)o._featuresResolutions.set(J,U);return P});return function(h){return u.apply(this,arguments)}}());return(yield(0,I.as)(b)).reverse().reduce((u,h)=>h.value?[...u,...h.value]:u,[]).filter(u=>null!=u)})()}};function ee(){return(ee=(0,w.Z)(function*(r,e){if(r.capabilities?.operations?.supportsQuery)return!0;try{return yield Promise.any(e.map(({sublayer:s})=>s.load().then(()=>s.capabilities.operations.supportsQuery)))}catch{return!1}})).apply(this,arguments)}function te(){return(te=(0,w.Z)(function*(r,e){const s=r.renderer;return s&&"defaultSymbol"in s&&!s.defaultSymbol&&(e=s.valueExpression?yield Promise.all(e.map(o=>s.getSymbolAsync(o).then(i=>i?o:null))).then(o=>o.filter(i=>null!=i)):e.filter(o=>null!=s.getSymbol(o))),e})).apply(this,arguments)}(0,p._)([(0,y.Cb)({constructOnly:!0})],V.prototype,"createFetchPopupFeaturesQueryGeometry",void 0),(0,p._)([(0,y.Cb)({constructOnly:!0})],V.prototype,"layerView",void 0),(0,p._)([(0,y.Cb)({constructOnly:!0})],V.prototype,"highlightGraphics",void 0),(0,p._)([(0,y.Cb)({constructOnly:!0})],V.prototype,"highlightGraphicUpdated",void 0),(0,p._)([(0,y.Cb)({constructOnly:!0})],V.prototype,"updatingHandles",void 0),V=(0,p._)([(0,O.j)("esri.views.layers.support.MapService")],V)},10023:(re,$,l)=>{l.d($,{V:()=>W,e:()=>z});var w=l(15861),p=l(62208),Z=l(36630);function z(E){return G.apply(this,arguments)}function G(){return(G=(0,w.Z)(function*(E,S=E.popupTemplate){if((0,p.Wi)(S))return[];const C=yield S.getRequiredFields(E.fieldsIndex),{lastEditInfoEnabled:I}=S,{objectIdField:R,typeIdField:T,globalIdField:y,relationships:L}=E;if(C.includes("*"))return["*"];const K=I?yield(0,Z.CH)(E):[],O=(0,Z.Q0)(E.fieldsIndex,[...C,...K]);return T&&O.push(T),O&&R&&E.fieldsIndex?.has(R)&&!O.includes(R)&&O.push(R),O&&y&&E.fieldsIndex?.has(y)&&!O.includes(y)&&O.push(y),L&&L.forEach(H=>{const{keyField:N}=H;O&&N&&E.fieldsIndex?.has(N)&&!O.includes(N)&&O.push(N)}),O})).apply(this,arguments)}function W(E,S){return E.popupTemplate?E.popupTemplate:(0,p.pC)(S)&&S.defaultPopupTemplateEnabled&&(0,p.pC)(E.defaultPopupTemplate)?E.defaultPopupTemplate:null}},94672:(re,$,l)=>{l.d($,{K:()=>G}),l(29132);var p=l(62208),Z=l(16730),z=l(2004);function G(S,C,I,R=new z.Z){let T=0;if("2d"===I.type)T=C*(I.resolution??0);else if("3d"===I.type){const N=I.overlayPixelSizeInMapUnits(S),D=I.basemapSpatialReference;T=(0,p.pC)(D)&&!D.equals(I.spatialReference)?(0,Z.c9)(D)/(0,Z.c9)(I.spatialReference):C*N}const y=S.x-T,L=S.y-T,K=S.x+T,O=S.y+T,{spatialReference:H}=I;return R.xmin=Math.min(y,K),R.ymin=Math.min(L,O),R.xmax=Math.max(y,K),R.ymax=Math.max(L,O),R.spatialReference=H,R}new z.Z}}]);