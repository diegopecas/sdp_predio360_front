"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[2964],{92852:(fe,oe,y)=>{y.d(oe,{Es:()=>u,I_:()=>J,W7:()=>s,qM:()=>i});var b=y(26584),C=y(58817),X=y(63290),j=y(61566),S=y(16396);const A=X.Z.getLogger("esri.views.3d.layers.i3s.I3SBinaryReader");function ne(r,n,m){let h="",f=0;for(;f<m;){const p=r[n+f];if(p<128)h+=String.fromCharCode(p),f++;else if(p>=192&&p<224){if(f+1>=m)throw new b.Z("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");h+=String.fromCharCode((31&p)<<6|63&r[n+f+1]),f+=2}else if(p>=224&&p<240){if(f+2>=m)throw new b.Z("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");h+=String.fromCharCode((15&p)<<12|(63&r[n+f+1])<<6|63&r[n+f+2]),f+=3}else{if(!(p>=240&&p<248))throw new b.Z("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");{if(f+3>=m)throw new b.Z("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");const T=(7&p)<<18|(63&r[n+f+1])<<12|(63&r[n+f+2])<<6|63&r[n+f+3];h+=T>=65536?String.fromCharCode(55296+(T-65536>>10),56320+(1023&T)):String.fromCharCode(T),f+=4}}}return h}function Q(r,n){const m={byteOffset:0,byteCount:0,fields:Object.create(null)};let h=0;for(let f=0;f<n.length;f++){const p=n[f],T=p.valueType||p.type;m.fields[p.property]=(0,W[T])(r,h),h+=I[T].BYTES_PER_ELEMENT}return m.byteCount=h,m}function H(r,n,m){const h=[];let f,p,T=0;for(p=0;p<r;p+=1){if(f=n[p],f>0){if(h.push(ne(m,T,f-1)),0!==m[T+f-1])throw new b.Z("string-array-error","Invalid string array: missing null termination.")}else h.push(null);T+=f}return h}function J(r,n){return new I[n.valueType](r,n.byteOffset,n.count*n.valuesPerElement)}function N(r,n,m){if(n!==r&&A.error(`Invalid ${m} buffer size\n expected: ${r}, actual: ${n})`),n<r)throw new b.Z("buffer-too-small","Binary buffer is too small",{expectedSize:r,actualSize:n})}function s(r,n){const m=Q(r,n&&n.header);let h=m.byteCount;const f={isDraco:!1,header:m,byteOffset:m.byteCount,byteCount:0,vertexAttributes:{}},p=m.fields,T=null!=p.vertexCount?p.vertexCount:p.count;for(const L of n.ordering){if(!n.vertexAttributes[L])continue;const G={...n.vertexAttributes[L],byteOffset:h,count:T};f.vertexAttributes[D[L]?D[L]:"_"+L]=G,h+=R(G.valueType)*G.valuesPerElement*T}const V=p.faceCount;if(n.faces&&V){f.faces={};for(const L of n.ordering){if(!n.faces[L])continue;const G={...n.faces[L],byteOffset:h,count:V};f.faces[L]=G,h+=R(G.valueType)*G.valuesPerElement*V}}const P=p.featureCount;if(n.featureAttributes&&n.featureAttributeOrder&&P){f.featureAttributes={};for(const L of n.featureAttributeOrder){if(!n.featureAttributes[L])continue;const G={...n.featureAttributes[L],byteOffset:h,count:P};f.featureAttributes[L]=G,h+=("UInt64"===G.valueType?8:R(G.valueType))*G.valuesPerElement*P}}return N(h,r.byteLength,"geometry"),f.byteCount=h-f.byteOffset,f}function u(r,n){return r&&r.compressedAttributes&&"draco"===r.compressedAttributes.encoding?function B(r){const n={isDraco:!0,isLegacy:!1,color:!1,normal:!1,uv0:!1,uvRegion:!1,featureIndex:!1};for(const m of r)switch(m){case"position":break;case"normal":n.normal=!0;break;case"uv0":n.uv0=!0;break;case"color":n.color=!0;break;case"uv-region":n.uvRegion=!0;break;case"feature-index":n.featureIndex=!0}return n}(r.compressedAttributes.attributes):r?function O(r){return{isDraco:!1,isLegacy:!1,color:null!=r.color,normal:null!=r.normal,uv0:null!=r.uv0,uvRegion:null!=r.uvRegion,featureIndex:null!=r.faceRange&&null!=r.featureId}}(r):function l(r){const n={isDraco:!1,isLegacy:!0,color:!1,normal:!1,uv0:!1,uvRegion:!1,featureIndex:!1};for(const m of r.ordering)if(r.vertexAttributes[m])switch(m){case"position":break;case"normal":n.normal=!0;break;case"color":n.color=!0;break;case"uv0":n.uv0=!0;break;case"region":n.uvRegion=!0}return r.featureAttributes&&r.featureAttributeOrder&&(n.featureIndex=!0),n}(n)}const D={position:S.T.POSITION,normal:S.T.NORMAL,color:S.T.COLOR,uv0:S.T.UV0,region:S.T.UVREGION};function i(r,n,m){if("lepcc-rgb"===r.encoding)return(0,j.IT)(n);if("lepcc-intensity"===r.encoding)return(0,j.ti)(n);if(null!=r.encoding&&""!==r.encoding)throw new b.Z("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");r["attributeByteCounts "]&&!r.attributeByteCounts&&(A.warn("Warning: Trailing space in 'attributeByteCounts '."),r.attributeByteCounts=r["attributeByteCounts "]),"ObjectIds"===r.ordering[0]&&r.hasOwnProperty("objectIds")&&(A.warn("Warning: Case error in objectIds"),r.ordering[0]="objectIds");const h=function K(r,n,m){const h=null!=n.header?Q(r,n.header):{byteOffset:0,byteCount:0,fields:{count:m}},f={header:h,byteOffset:h.byteCount,byteCount:0,entries:Object.create(null)};let p=h.byteCount;for(let T=0;T<n.ordering.length;T++){const V=n.ordering[T],P=(0,C.d9)(n[V]);if(P.count=h.fields.count??0,"String"===P.valueType){if(P.byteOffset=p,P.byteCount=h.fields[V+"ByteCount"],"UTF-8"!==P.encoding)throw new b.Z("unsupported-encoding","Unsupported String encoding.",{encoding:P.encoding});if(P.timeEncoding&&"ECMA_ISO8601"!==P.timeEncoding)throw new b.Z("unsupported-time-encoding","Unsupported time encoding.",{timeEncoding:P.timeEncoding})}else{if(!w(P.valueType))throw new b.Z("unsupported-value-type","Unsupported binary valueType",{valueType:P.valueType});{const L=R(P.valueType);p+=p%L!=0?L-p%L:0,P.byteOffset=p,P.byteCount=L*P.valuesPerElement*P.count}}p+=P.byteCount??0,f.entries[V]=P}return f.byteCount=p-f.byteOffset,f}(n,r,m);N(h.byteOffset+h.byteCount,n.byteLength,"attribute");const f=h.entries.attributeValues||h.entries.objectIds;if(f){if("String"===f.valueType){const p=h.entries.attributeByteCounts,T=J(n,p),V=function Y(r,n){return new Uint8Array(r,n.byteOffset,n.byteCount)}(n,f);return f.timeEncoding?function k(r,n,m){return H(r,n,m).map(h=>{const f=h?Date.parse(h):null;return f&&!Number.isNaN(f)?f:null})}(p.count,T,V):H(p.count,T,V)}return J(n,f)}throw new b.Z("bad-attribute-storage-info","Bad attributeStorageInfo specification.")}const I={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array},W={Float32:(r,n)=>new DataView(r,0).getFloat32(n,!0),Float64:(r,n)=>new DataView(r,0).getFloat64(n,!0),UInt8:(r,n)=>new DataView(r,0).getUint8(n),Int8:(r,n)=>new DataView(r,0).getInt8(n),UInt16:(r,n)=>new DataView(r,0).getUint16(n,!0),Int16:(r,n)=>new DataView(r,0).getInt16(n,!0),UInt32:(r,n)=>new DataView(r,0).getUint32(n,!0),Int32:(r,n)=>new DataView(r,0).getInt32(n,!0)};function w(r){return I.hasOwnProperty(r)}function R(r){return w(r)?I[r].BYTES_PER_ELEMENT:0}},5590:(fe,oe,y)=>{y.d(oe,{c:()=>S,n:()=>Q});var b=y(43703),C=y(28093),X=y(92383),j=y(55915);function S(k,H,J,Y){const K=Q(k,H,J),N=(0,b.c)();return(0,j.Bm)(J,K,N,Y),N}const A=1,ne=5-A;function Q(k,H,J){const Y=(0,C.c)(),N=2**(Math.ceil(Math.log(k[3])*Math.LOG2E/ne)*ne+A);if(J.isGeographic){const u=N/(0,X.Iu)(J).radius*180/Math.PI,l=Math.round(k[1]/u),B=Math.max(-90,Math.min(90,l*u)),D=u/Math.cos((Math.abs(B)-u/2)/180*Math.PI),i=Math.round(k[0]/D)*D;Y[0]=i,Y[1]=B}else{const u=Math.round(k[0]/N),l=Math.round(k[1]/N);Y[0]=u*N,Y[1]=l*N}const s=Math.round((k[2]+H)/N);return Y[2]=s*N,Y}},42964:(fe,oe,y)=>{y.d(oe,{Cx:()=>it,HV:()=>Je,Jf:()=>ie,Jx:()=>we,OJ:()=>Ue,T2:()=>Ce,VL:()=>ct,WD:()=>ut,X5:()=>p,Yb:()=>P,a7:()=>Xe,bf:()=>Se,c$:()=>st,cr:()=>me,e8:()=>Ee,ei:()=>We,gn:()=>Fe,hv:()=>V,ix:()=>Qe,jv:()=>Oe,ns:()=>G,p8:()=>Ke,pD:()=>ee,tS:()=>T,tp:()=>ve,tq:()=>Ze,uC:()=>Ge,vH:()=>at,xe:()=>be,yS:()=>He,zW:()=>ke});var b=y(15861),C=y(84792),X=y(85931),j=y(26584),S=y(8314),A=y(62208),ne=y(10699),Q=y(55713),k=y(30217),H=y(550),J=y(28347),Y=y(43703),K=y(48977),N=y(56729),O=y(84161),s=y(28093),u=y(92383),l=y(55915),B=y(65234),D=y(81863),i=y(65401),I=y(37053),W=y(96854),w=y(92852),R=y(5590),r=y(2180),n=y(9044),m=y(93394),h=y(94255);function f(e){return e?parseInt(e.substring(e.lastIndexOf("/")+1,e.length),10):void 0}function p(e){if((0,S.Z)("disable-feature:i3s-draco")||!e)return!1;for(const t of e)for(const o of t.geometryBuffers)if("draco"===o.compressedAttributes?.encoding)return!0;return!1}function T(e,t,o,a){o.traverse(t,c=>{const d=c.mbs;return(null!=d&&me(e,d))!==ee.OUTSIDE&&(a(c),!0)})}function V(e,t,o){let a=0,c=0;for(let d=0;d<t.length&&a<e.length;d++)e[a]===t[d]&&(o(d)&&(e[c]=e[a],c++),a++);e.length=c}function P(e,t,o){let a=0,c=0;for(;a<o.length;)(0,X.$A)(e,o[a])>=0===t&&(o[c]=o[a],c++),a++;o.length=c}const L=(0,i.Ue)();function G(e,t){if(0===t.rotationScale[1]&&0===t.rotationScale[2]&&0===t.rotationScale[3]&&0===t.rotationScale[5]&&0===t.rotationScale[6]&&0===t.rotationScale[7])return L[0]=(e[0]-t.position[0])/t.rotationScale[0],L[1]=(e[1]-t.position[1])/t.rotationScale[4],L[2]=(e[2]-t.position[0])/t.rotationScale[0],L[3]=(e[3]-t.position[1])/t.rotationScale[4],L}var ee,e;function me(e,t){const o=t[0],a=t[1],c=t[3],d=e[0]-o,_=o-e[2],g=e[1]-a,M=a-e[3],v=Math.max(d,_,0),z=Math.max(g,M,0),x=v*v+z*z;return x>c*c?ee.OUTSIDE:x>0?ee.INTERSECTS_CENTER_OUTSIDE:-Math.max(d,_,g,M)>c?ee.INSIDE:ee.INTERSECTS_CENTER_INSIDE}function Ee(e,t,o){const a=[],c=o&&o.missingFields,d=o&&o.originalFields;for(const _ of e){const g=_.toLowerCase();let M=!1;for(const v of t)if(g===v.name.toLowerCase()){a.push(v.name),M=!0,d&&d.push(_);break}!M&&c&&c.push(_)}return a}function Se(e,t,o,a,c){return de.apply(this,arguments)}function de(){return de=(0,b.Z)(function*(e,t,o,a,c){if(0===t.length)return[];const d=e.attributeStorageInfo;if((0,A.pC)(e.associatedLayer))try{return yield function Le(e,t,o,a){return _e.apply(this,arguments)}(e.associatedLayer,t,o,a)}catch(_){if(e.associatedLayer.loaded)throw _}if(d){const _=function Ae(e,t,o){const a=new Map,c=[],d=o();for(const _ of e){const g=_.attributes[t];for(let M=0;M<d.length;M++){const v=d[M],z=v.featureIds.indexOf(g);if(z>=0){let x=a.get(v.node);x||(x={node:v.node,indices:[],graphics:[]},c.push(x),a.set(v.node,x)),x.indices.push(z),x.graphics.push(_);for(let F=M;F>0;F--)d[F]=d[F-1];d[0]=v;break}}}return c}(t,o,c);if((0,A.Wi)(_))throw new j.Z("scenelayer:features-not-loaded","Tried to query attributes for unloaded features");const g=e.parsedUrl.path;return(yield Promise.all(_.map(M=>function Re(e,t,o,a,c){return be(e,t,o.resources.attributes,a,c)}(g,d,M.node,M.indices,a).then(v=>{for(let z=0;z<M.graphics.length;z++){const x=M.graphics[z],F=v[z];if(x.attributes)for(const U in x.attributes)U in F||(F[U]=x.attributes[U]);x.attributes=F}return M.graphics})))).flat()}throw new j.Z("scenelayer:no-attribute-source","This scene layer does not have a source for attributes available")}),de.apply(this,arguments)}function _e(){return(_e=(0,b.Z)(function*(e,t,o,a){t.sort((M,v)=>M.attributes[o]-v.attributes[o]);const c=t.map(M=>M.attributes[o]),d=[],_=Ee(a,e.fields,{originalFields:d}),g=yield Me(e,c,_);for(let M=0;M<t.length;M++){const v=t[M],z=g[M],x={};if(v.attributes)for(const F in v.attributes)x[F]=v.attributes[F];for(let F=0;F<d.length;F++)x[d[F]]=z[_[F]];v.attributes=x}return t})).apply(this,arguments)}function Me(e,t,o){const a=e.capabilities.query.maxRecordCount;if(null!=a&&t.length>a){const d=(0,X.vr)(t,a);return Promise.all(d.map(_=>Me(e,_,o))).then(_=>_.flat())}const c=new W.Z({objectIds:t,outFields:o,orderByFields:[e.objectIdField]});return e.queryFeatures(c).then(d=>{if(d&&d.features&&d.features.length===t.length)return d.features.map(_=>_.attributes);throw new j.Z("scenelayer:feature-not-in-associated-layer","Feature not found in associated feature layer")})}function be(e,t,o,a,c){const d=[];for(const _ of t)_&&c.includes(_.name)&&d.push({url:`${e}/nodes/${o}/attributes/${_.key}/0`,storageInfo:_});return(0,ne.as)(d.map(_=>(0,C.default)(_.url,{responseType:"array-buffer"}).then(g=>(0,w.qM)(_.storageInfo,g.data)))).then(_=>{const g=[];for(const M of a){const v={};for(let z=0;z<_.length;z++){const x=_[z].value;null!=x&&(v[d[z].storageInfo.name]=we(x,M))}g.push(v)}return g})}(e=ee||(ee={}))[e.OUTSIDE=0]="OUTSIDE",e[e.INTERSECTS_CENTER_OUTSIDE=1]="INTERSECTS_CENTER_OUTSIDE",e[e.INTERSECTS_CENTER_INSIDE=2]="INTERSECTS_CENTER_INSIDE",e[e.INSIDE=3]="INSIDE";const xe=-32768,Be=-(2**31);function we(e,t){if(!e)return null;const o=e[t];return(0,Q.z3)(e)?o===xe?null:o:(0,Q.Hx)(e)?o===Be?null:o:o!=o?null:o}function ve(e){const t=e.store,o=t.indexCRS||t.geographicCRS,a=void 0===o?t.indexWKT:void 0;if(a){if(!e.spatialReference)throw new j.Z("layerview:no-store-spatial-reference-wkt-index-and-no-layer-spatial-reference","Found indeWKT in the scene layer store but no layer spatial reference",{});if(a!==e.spatialReference.wkt)throw new j.Z("layerview:store-spatial-reference-wkt-index-incompatible","The indeWKT of the scene layer store does not match the WKT of the layer spatial reference",{})}const c=o?new B.Z(f(o)):e.spatialReference;return c.equals(e.spatialReference)?e.spatialReference:c}function Ce(e){const t=e.store,o=t.vertexCRS||t.projectedCRS,a=void 0===o?t.vertexWKT:void 0;if(a){if(!e.spatialReference)throw new j.Z("layerview:no-store-spatial-reference-wkt-vertex-and-no-layer-spatial-reference","Found vertexWKT in the scene layer store but no layer spatial reference",{});if(a!==e.spatialReference.wkt)throw new j.Z("layerview:store-spatial-reference-wkt-vertex-incompatible","The vertexWKT of the scene layer store does not match the WKT of the layer spatial reference",{})}const c=o?new B.Z(f(o)):e.spatialReference;return c.equals(e.spatialReference)?e.spatialReference:c}function We(e,t){return(0,A.Wi)(t)?"@null":t===(0,D.rS)(t)?"@ECEF":e.equals(t)?"":null!=t.wkid?"@"+t.wkid:null}function ie(e,t,o){if(!(0,l.Up)(e,t))throw new j.Z("layerview:spatial-reference-incompatible","The spatial reference of this scene layer is incompatible with the spatial reference of the view",{});if("local"===o&&!function je(e,t){return e.equals(t)||e.isWGS84&&t.isWebMercator||e.isWebMercator&&t.isWGS84}(e,t))throw new j.Z("layerview:spatial-reference-incompatible","The spatial reference of this scene layer is incompatible with the spatial reference of the view",{})}function Ze(e,t,o){if(e.serviceUpdateTimeStamp?.lastUpdate!==t.serviceUpdateTimeStamp?.lastUpdate||!o.isEmpty||(0,A.yw)(e.associatedLayer,a=>a.url)!==(0,A.yw)(t.associatedLayer,a=>a.url))throw new j.Z("layerview:recycle-failed")}function Ue(e,t,o){const a=ve(e),c=Ce(e);ie(a,t,o),ie(c,t,o)}function Ke(e){if(null==e.store||null==e.store.defaultGeometrySchema||!function ze(e){return!(null!=e.geometryType&&"triangles"!==e.geometryType||null!=e.topology&&"PerAttributeArray"!==e.topology||null==e.vertexAttributes||null==e.vertexAttributes.position)}(e.store.defaultGeometrySchema))throw new j.Z("scenelayer:unsupported-geometry-schema","The geometry schema of this scene layer is not supported.",{url:e.parsedUrl.path})}function Fe(e,t){Ue(e,t.spatialReference,t.viewingMode)}function ke(e){if(null==e.store||null==e.store.defaultGeometrySchema||!function Ne(e){return!(null==e.geometryType||"points"!==e.geometryType||null!=e.topology&&"PerAttributeArray"!==e.topology||null!=e.encoding&&""!==e.encoding&&"lepcc-xyz"!==e.encoding||null==e.vertexAttributes||null==e.vertexAttributes.position)}(e.store.defaultGeometrySchema))throw new j.Z("pointcloud:unsupported-geometry-schema","The geometry schema of this point cloud scene layer is not supported.",{})}function He(e,t){ie(e.spatialReference,t.spatialReference,t.viewingMode)}function Ye(e){return"mesh-3d"===e.type}function Xe(e){if(null==e||!function Ve(e){return"simple"===e.type||"class-breaks"===e.type||"unique-value"===e.type}(e)||("unique-value"===e.type||"class-breaks"===e.type)&&null==e.defaultSymbol)return!0;const t=e.getSymbols();if(0===t.length)return!0;for(const o of t){if(!Ye(o)||0===o.symbolLayers.length)return!0;for(const a of o.symbolLayers.items)if("fill"!==a.type||(0,A.Wi)(a.material)||(0,A.Wi)(a.material.color)||"replace"!==a.material.colorMixMode)return!0}return!1}const Ge=(0,r.$s)({color:[0,0,0,0],opacity:0});class $e{constructor(){this.edgeMaterial=null,this.material=null,this.castShadows=!0}}function Qe(e){const t=new $e;let o=!1,a=!1;for(const c of e.symbolLayers.items)if("fill"===c.type&&c.enabled){const d=c.material,_=c.edges;if((0,A.pC)(d)&&!o){const g=d.color,M=(0,n.F5)(d.colorMixMode);t.material=(0,A.pC)(g)?{color:[g.r/255,g.g/255,g.b/255],alpha:g.a,colorMixMode:M}:{color:[1,1,1],alpha:1,colorMixMode:n.a9.Multiply},t.castShadows=c.castShadows,o=!0}(0,A.pC)(_)&&!a&&(t.edgeMaterial=(0,r.C8)(_,{}),a=!0)}return t.material||(t.material={color:[1,1,1],alpha:1,colorMixMode:n.a9.Multiply}),t}function Je(e,t){return(0|e)+(0|t)|0}function Oe(e,t,o,a,c=0){a===(0,D.rS)(a)?t.isGeographic?function ot(e,t,o,a){const c=(0,u.Iu)(o),d=1+Math.max(0,a)/(c.radius+e.center[2]);(0,O.s)(t.center,e.center[0],e.center[1],e.center[2]+a),(0,l.CM)(t.center,o,0,t.center,(0,D.rS)(o),0,1),(0,K.a)(t.quaternion,e.quaternion),(0,K.c)(te,e.quaternion),(0,O.s)(E,0,0,1),(0,O.q)(E,E,te),(0,O.s)(E,e.halfSize[0]*Math.abs(E[0]),e.halfSize[1]*Math.abs(E[1]),e.halfSize[2]*Math.abs(E[2])),(0,O.g)(E,E,c.inverseFlattening),(0,O.a)(t.halfSize,e.halfSize,E),(0,O.g)(t.halfSize,t.halfSize,d)}(e,o,t,c):function rt(e,t,o,a){(0,m.$e)(e,he),(0,O.s)(t.center,e.center[0],e.center[1],e.center[2]+a),(0,l.Bm)(o,t.center,q,(0,D.rS)(o)),(0,O.s)(t.center,q[12],q[13],q[14]);const c=2*Math.sqrt(1+q[0]+q[5]+q[10]);te[0]=(q[6]-q[9])/c,te[1]=(q[8]-q[2])/c,te[2]=(q[1]-q[4])/c,te[3]=.25*c,(0,K.m)(t.quaternion,te,e.quaternion),(0,K.c)(te,t.quaternion);let d=0,_=0,g=0;for(const M of he)M[2]+=a,(0,l.CM)(M,o,0,M,(0,D.rS)(o),0,1),(0,O.w)(E,M,t.center),(0,O.q)(E,E,te),d=Math.max(d,Math.abs(E[0])),_=Math.max(_,Math.abs(E[1])),g=Math.max(g,Math.abs(E[2]));(0,O.s)(t.halfSize,d,_,g)}(e,o,t,c):t.isWGS84&&(a.isWebMercator||(0,I.QM)(a))?function qe(e,t,o,a,c){(0,O.c)(re,t.center),re[2]+=c;const d=(0,D.rS)(o);(0,l.CM)(re,e,0,re,d,0,1),Te(d,t,re,o,a)}(t,e,a,o,c):t.isWebMercator&&(0,I.QM)(a)?function nt(e,t,o,a,c){(0,O.c)(re,t.center),re[2]+=c,Te(e,t,re,o,a)}(t,e,a,o,c):e===o?(o.center[2]+=c,(0,l.CM)(o.center,t,0,o.center,a,0,1)):((0,O.s)(o.center,e.center[0],e.center[1],e.center[2]+c),(0,l.CM)(o.center,t,0,o.center,a,0,1),(0,K.a)(o.quaternion,e.quaternion),(0,O.c)(o.halfSize,e.halfSize))}const ae=new Array(24),et=new h.a(ae,3,!0),Ie=(0,s.c)(),re=(0,s.c)(),tt=(0,H.c)();function Te(e,t,o,a,c){const d=(0,k.c)(tt,t.quaternion);for(let _=0;_<8;++_){for(let g=0;g<3;++g)Ie[g]=t.halfSize[g]*(_&1<<g?-1:1);for(let g=0;g<3;++g){let M=o[g];for(let v=0;v<3;++v)M+=Ie[v]*d[3*v+g];ae[3*_+g]=M}}(0,l.CM)(ae,e,0,ae,a,0,8),(0,m.Qb)(et,c)}function it(e,t,o,a,c,d){if(!d||0===d.length||(0,A.Wi)(t)||!e.mbs)return null;const _=(0,R.c)(e.mbs,c,o,t);(0,J.a)(ce,_);let g=null,v=1/0,z=-1/0;if(d.forEach(U=>(U=>{if("replace"!==U.type)return;const Z=U.geometry;if(!Z?.hasZ)return;(0,i.cS)(pe);const $=Z.spatialReference||a,ue=Z.rings.reduce((ye,ge)=>ge.reduce((le,lt)=>((0,l.SH)(lt,$,E,t),(0,O.m)(E,E,ce),(0,i.Ho)(pe,E),Math.min(E[2],le)),ye),1/0);(()=>{if(!g)if(g=he,(0,i.cS)(se),(0,A.pC)(e.serviceObb)){Oe(e.serviceObb,o,De,t,c),(0,m.$e)(De,g);for(const U of g)(0,O.m)(U,U,ce),(0,i.Ho)(se,U)}else{const U=e.mbs;if(!U)return;const Z=U[3];(0,l.SH)(U,o,E,t),(0,O.m)(E,E,ce),E[2]+=c;for(let $=0;$<8;++$){const le=g[$];(0,O.c)(le,[E[0]+(1&$?Z:-Z),E[1]+(2&$?Z:-Z),E[2]+(4&$?Z:-Z)]),(0,i.Ho)(se,le)}}})(),(0,i.kK)(se,pe)&&(v=Math.min(v,ue),z=Math.max(z,ue))})(U)),v===1/0)return null;const F=(U,Z,$)=>{(0,O.m)(E,$,_),U[Z+0]=E[0],U[Z+1]=E[1],U[Z+2]=E[2],Z+=24,$[2]=v,(0,O.m)(E,$,_),U[Z+0]=E[0],U[Z+1]=E[1],U[Z+2]=E[2],Z+=24,$[2]=z,(0,O.m)(E,$,_),U[Z+0]=E[0],U[Z+1]=E[1],U[Z+2]=E[2]};for(let U=0;U<8;++U)F(Pe.data,3*U,g[U]);return(0,m.Qb)(Pe)}function at(e){return(0,A.pC)(e)&&e.halfSize[0]>=0}function st(e){return e[3]>=0}function ct(e){(0,A.pC)(e)&&(e.halfSize[0]=-1)}function ut(e){(0,A.pC)(e)&&(e[3]=-1)}const q=(0,Y.c)(),te=(0,N.c)(),he=[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],pe=(0,i.Ue)(),se=(0,i.Ue)(),De=(0,m.Ue)(),E=(0,s.c)(),Pe={data:new Array(72),size:3,exclusive:!0,stride:3},ce=(0,Y.c)()},61566:(fe,oe,y)=>{y.d(oe,{Gi:()=>ne,IT:()=>Y,ti:()=>O});var b=y(26584);const C=!0,X={identifierOffset:0,identifierLength:10,versionOffset:10,checksumOffset:12,byteCount:16};function j(s,u,l){return{identifier:String.fromCharCode.apply(null,new Uint8Array(s,l+X.identifierOffset,X.identifierLength)),version:u.getUint16(l+X.versionOffset,C),checksum:u.getUint32(l+X.checksumOffset,C)}}const S={sizeLo:0,sizeHi:4,minX:8,minY:16,minZ:24,maxX:32,maxY:40,maxZ:48,errorX:56,errorY:64,errorZ:72,count:80,reserved:84,byteCount:88};function ne(s){const u=new DataView(s,0);let l=0;const{identifier:B,version:D}=j(s,u,l);if(l+=X.byteCount,"LEPCC     "!==B)throw new b.Z("lepcc-decode-error","Bad identifier");if(D>1)throw new b.Z("lepcc-decode-error","Unknown version");const i=function A(s,u){return{sizeLo:s.getUint32(u+S.sizeLo,C),sizeHi:s.getUint32(u+S.sizeHi,C),minX:s.getFloat64(u+S.minX,C),minY:s.getFloat64(u+S.minY,C),minZ:s.getFloat64(u+S.minZ,C),maxX:s.getFloat64(u+S.maxX,C),maxY:s.getFloat64(u+S.maxY,C),maxZ:s.getFloat64(u+S.maxZ,C),errorX:s.getFloat64(u+S.errorX,C),errorY:s.getFloat64(u+S.errorY,C),errorZ:s.getFloat64(u+S.errorZ,C),count:s.getUint32(u+S.count,C),reserved:s.getUint32(u+S.reserved,C)}}(u,l);if(l+=S.byteCount,i.sizeHi*2**32+i.sizeLo!==s.byteLength)throw new b.Z("lepcc-decode-error","Bad size");const I=new Float64Array(3*i.count),W=[],w=[],R=[],r=[];if(l=Q(s,l,W),l=Q(s,l,w),l=Q(s,l,R),l=Q(s,l,r),l!==s.byteLength)throw new b.Z("lepcc-decode-error","Bad length");let n=0,m=0;for(let h=0;h<W.length;h++){m+=W[h];let f=0;for(let p=0;p<w[h];p++){f+=R[n];const T=r[n];I[3*n]=Math.min(i.maxX,i.minX+2*i.errorX*f),I[3*n+1]=Math.min(i.maxY,i.minY+2*i.errorY*m),I[3*n+2]=Math.min(i.maxZ,i.minZ+2*i.errorZ*T),n++}}return{errorX:i.errorX,errorY:i.errorY,errorZ:i.errorZ,result:I}}function Q(s,u,l){const B=[];u=k(s,u,B);const D=[];for(let i=0;i<B.length;i++){D.length=0,u=k(s,u,D);for(let I=0;I<D.length;I++)l.push(D[I]+B[i])}return u}function k(s,u,l){const B=new DataView(s,u),D=B.getUint8(0),i=31&D,I=!!(32&D),W=(192&D)>>6;let w=0;if(0===W)w=B.getUint32(1,C),u+=5;else if(1===W)w=B.getUint16(1,C),u+=3;else{if(2!==W)throw new b.Z("lepcc-decode-error","Bad count type");w=B.getUint8(1),u+=2}if(I)throw new b.Z("lepcc-decode-error","LUT not implemented");const R=Math.ceil(w*i/8),r=new Uint8Array(s,u,R);let n=0,m=0,h=0;const f=-1>>>32-i;for(let p=0;p<w;p++){for(;m<i;)n|=r[h]<<m,m+=8,h+=1;l[p]=n&f,n>>>=i,m-=i,m+i>32&&(n|=r[h-1]>>8-m)}return u+h}const H={sizeLo:0,sizeHi:4,count:8,colorMapCount:12,lookupMethod:14,compressionMethod:15,byteCount:16};function Y(s){const u=new DataView(s,0);let l=0;const{identifier:B,version:D}=j(s,u,l);if(l+=X.byteCount,"ClusterRGB"!==B)throw new b.Z("lepcc-decode-error","Bad identifier");if(D>1)throw new b.Z("lepcc-decode-error","Unknown version");const i=function J(s,u){return{sizeLo:s.getUint32(u+H.sizeLo,C),sizeHi:s.getUint32(u+H.sizeHi,C),count:s.getUint32(u+H.count,C),colorMapCount:s.getUint16(u+H.colorMapCount,C),lookupMethod:s.getUint8(u+H.lookupMethod),compressionMethod:s.getUint8(u+H.compressionMethod)}}(u,l);if(l+=H.byteCount,i.sizeHi*2**32+i.sizeLo!==s.byteLength)throw new b.Z("lepcc-decode-error","Bad size");if((2===i.lookupMethod||1===i.lookupMethod)&&0===i.compressionMethod){if(3*i.colorMapCount+i.count+l!==s.byteLength||i.colorMapCount>256)throw new b.Z("lepcc-decode-error","Bad count");const I=new Uint8Array(s,l,3*i.colorMapCount),W=new Uint8Array(s,l+3*i.colorMapCount,i.count),w=new Uint8Array(3*i.count);for(let R=0;R<i.count;R++){const r=W[R];w[3*R]=I[3*r],w[3*R+1]=I[3*r+1],w[3*R+2]=I[3*r+2]}return w}if(0===i.lookupMethod&&0===i.compressionMethod){if(3*i.count+l!==s.byteLength||0!==i.colorMapCount)throw new b.Z("lepcc-decode-error","Bad count");return new Uint8Array(s,l).slice()}if(i.lookupMethod<=2&&1===i.compressionMethod){if(l+3!==s.byteLength||1!==i.colorMapCount)throw new b.Z("lepcc-decode-error","Bad count");const I=u.getUint8(l),W=u.getUint8(l+1),w=u.getUint8(l+2),R=new Uint8Array(3*i.count);for(let r=0;r<i.count;r++)R[3*r]=I,R[3*r+1]=W,R[3*r+2]=w;return R}throw new b.Z("lepcc-decode-error","Bad method "+i.lookupMethod+","+i.compressionMethod)}const K={sizeLo:0,sizeHi:4,count:8,scaleFactor:12,bitsPerPoint:14,reserved:15,byteCount:16};function O(s){const u=new DataView(s,0);let l=0;const{identifier:B,version:D}=j(s,u,l);if(l+=X.byteCount,"Intensity "!==B)throw new b.Z("lepcc-decode-error","Bad identifier");if(D>1)throw new b.Z("lepcc-decode-error","Unknown version");const i=function N(s,u){return{sizeLo:s.getUint32(u+K.sizeLo,C),sizeHi:s.getUint32(u+K.sizeHi,C),count:s.getUint32(u+K.count,C),scaleFactor:s.getUint16(u+K.scaleFactor,C),bitsPerPoint:s.getUint8(u+K.bitsPerPoint),reserved:s.getUint8(u+K.reserved)}}(u,l);if(l+=K.byteCount,i.sizeHi*2**32+i.sizeLo!==s.byteLength)throw new b.Z("lepcc-decode-error","Bad size");const I=new Uint16Array(i.count);if(8===i.bitsPerPoint){if(i.count+l!==s.byteLength)throw new b.Z("lepcc-decode-error","Bad size");const W=new Uint8Array(s,l,i.count);for(let w=0;w<i.count;w++)I[w]=W[w]*i.scaleFactor}else if(16===i.bitsPerPoint){if(2*i.count+l!==s.byteLength)throw new b.Z("lepcc-decode-error","Bad size");const W=new Uint16Array(s,l,i.count);for(let w=0;w<i.count;w++)I[w]=W[w]*i.scaleFactor}else{const W=[];if(k(s,l,W)!==s.byteLength)throw new b.Z("lepcc-decode-error","Bad size");for(let w=0;w<i.count;w++)I[w]=W[w]*i.scaleFactor}return I}}}]);