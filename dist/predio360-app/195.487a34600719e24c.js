"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[195],{58774:(re,Ft,k)=>{k.d(Ft,{b:()=>nt,j:()=>Mt});var U=k(15861),wt=k(54346),j=k(8314);const Dt=128e3;let w=null,S=null;function Mt(){return mt.apply(this,arguments)}function mt(){return mt=(0,U.Z)(function*(){return w||(w=function ft(){return gt.apply(this,arguments)}()),w}),mt.apply(this,arguments)}function gt(){return(gt=(0,U.Z)(function*(){S=yield((0,j.Z)("esri-csp-restrictions")?yield k.e(71).then(k.bind(k,10071)).then(Et=>Et.l):yield k.e(9507).then(k.bind(k,99507)).then(Et=>Et.l)).load({locateFile:Et=>(0,wt.V)(`esri/core/libs/libtess/${Et}`)})})).apply(this,arguments)}function nt(P,Et){const N=Math.max(P.length,Dt);return S.triangulate(P,Et,N)}},7547:(re,Ft,k)=>{var U,wt,j,Dt,w,S,Mt,mt,ft,gt,nt,P,Et,N,C,B,lt,_t,It,yt,vt,dt,Tt,Ct,Bt,xt,st,it,G,K,W,M,T,St,Ot,H,Y,X,Wt,Vt,at,Q,$,Gt,J,Yt,Xt,q,Ht,bt,zt,Nt,ut,Lt,tt,ot,F,ct,ht,Ut,Pt,t;k.d(Ft,{$y:()=>dt,AH:()=>wt,CS:()=>Xt,DD:()=>mt,Dd:()=>G,Em:()=>vt,JS:()=>J,Ky:()=>ft,Lh:()=>q,Qb:()=>F,RL:()=>U,RS:()=>ht,TF:()=>yt,Tx:()=>w,UR:()=>lt,UX:()=>ot,bj:()=>Yt,eZ:()=>Mt,id:()=>Bt,kP:()=>H,of:()=>nt,r4:()=>Vt,sj:()=>Y,v2:()=>j,zQ:()=>it,zV:()=>B}),(t=U||(U={}))[t.BUTT=0]="BUTT",t[t.ROUND=1]="ROUND",t[t.SQUARE=2]="SQUARE",t[t.UNKNOWN=4]="UNKNOWN",function(t){t[t.BEVEL=0]="BEVEL",t[t.ROUND=1]="ROUND",t[t.MITER=2]="MITER",t[t.UNKNOWN=4]="UNKNOWN"}(wt||(wt={})),function(t){t[t.SCREEN=0]="SCREEN",t[t.MAP=1]="MAP"}(j||(j={})),function(t){t[t.Tint=0]="Tint",t[t.Ignore=1]="Ignore",t[t.Multiply=99]="Multiply"}(Dt||(Dt={})),function(t){t.Both="Both",t.JustBegin="JustBegin",t.JustEnd="JustEnd",t.None="None"}(w||(w={})),function(t){t[t.Mosaic=0]="Mosaic",t[t.Centered=1]="Centered"}(S||(S={})),function(t){t[t.Normal=0]="Normal",t[t.Superscript=1]="Superscript",t[t.Subscript=2]="Subscript"}(Mt||(Mt={})),function(t){t[t.MSSymbol=0]="MSSymbol",t[t.Unicode=1]="Unicode"}(mt||(mt={})),function(t){t[t.Unspecified=0]="Unspecified",t[t.TrueType=1]="TrueType",t[t.PSOpenType=2]="PSOpenType",t[t.TTOpenType=3]="TTOpenType",t[t.Type1=4]="Type1"}(ft||(ft={})),function(t){t[t.Display=0]="Display",t[t.Map=1]="Map"}(gt||(gt={})),function(t){t.None="None",t.Loop="Loop",t.Oscillate="Oscillate"}(nt||(nt={})),function(t){t[t.Z=0]="Z",t[t.X=1]="X",t[t.Y=2]="Y"}(P||(P={})),function(t){t[t.XYZ=0]="XYZ",t[t.ZXY=1]="ZXY",t[t.YXZ=2]="YXZ"}(Et||(Et={})),function(t){t[t.Rectangle=0]="Rectangle",t[t.RoundedRectangle=1]="RoundedRectangle",t[t.Oval=2]="Oval"}(N||(N={})),function(t){t[t.None=0]="None",t[t.Alpha=1]="Alpha",t[t.Screen=2]="Screen",t[t.Multiply=3]="Multiply",t[t.Add=4]="Add"}(C||(C={})),function(t){t[t.TTB=0]="TTB",t[t.RTL=1]="RTL",t[t.BTT=2]="BTT"}(B||(B={})),function(t){t[t.None=0]="None",t[t.SignPost=1]="SignPost",t[t.FaceNearPlane=2]="FaceNearPlane"}(lt||(lt={})),function(t){t[t.Float=0]="Float",t[t.String=1]="String",t[t.Boolean=2]="Boolean"}(_t||(_t={})),function(t){t[t.Intersect=0]="Intersect",t[t.Subtract=1]="Subtract"}(It||(It={})),function(t){t.OpenEnded="OpenEnded",t.Block="Block",t.Crossed="Crossed"}(yt||(yt={})),function(t){t.FullGeometry="FullGeometry",t.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",t.ReversedFirstSegment="ReversedFirstSegment",t.PerpendicularToSecondSegment="PerpendicularToSecondSegment",t.SecondSegmentWithTicks="SecondSegmentWithTicks",t.DoublePerpendicular="DoublePerpendicular",t.OppositeToFirstSegment="OppositeToFirstSegment",t.TriplePerpendicular="TriplePerpendicular",t.HalfCircleFirstSegment="HalfCircleFirstSegment",t.HalfCircleSecondSegment="HalfCircleSecondSegment",t.HalfCircleExtended="HalfCircleExtended",t.OpenCircle="OpenCircle",t.CoverageEdgesWithTicks="CoverageEdgesWithTicks",t.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",t.GapExtentMidline="GapExtentMidline",t.Chevron="Chevron",t.PerpendicularWithArc="PerpendicularWithArc",t.ClosedHalfCircle="ClosedHalfCircle",t.TripleParallelExtended="TripleParallelExtended",t.ParallelWithTicks="ParallelWithTicks",t.Parallel="Parallel",t.PerpendicularToFirstSegment="PerpendicularToFirstSegment",t.ParallelOffset="ParallelOffset",t.OffsetOpposite="OffsetOpposite",t.OffsetSame="OffsetSame",t.CircleWithArc="CircleWithArc",t.DoubleJog="DoubleJog",t.PerpendicularOffset="PerpendicularOffset",t.LineExcludingLastSegment="LineExcludingLastSegment",t.MultivertexArrow="MultivertexArrow",t.CrossedArrow="CrossedArrow",t.ChevronArrow="ChevronArrow",t.ChevronArrowOffset="ChevronArrowOffset",t.PartialFirstSegment="PartialFirstSegment",t.Arch="Arch",t.CurvedParallelTicks="CurvedParallelTicks",t.Arc90Degrees="Arc90Degrees"}(vt||(vt={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square",t.TrueBuffer="TrueBuffer"}(dt||(dt={})),function(t){t.ClosePath="ClosePath",t.ConvexHull="ConvexHull",t.RectangularBox="RectangularBox"}(Tt||(Tt={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(Ct||(Ct={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square"}(Bt||(Bt={})),function(t){t.Fast="Fast",t.Accurate="Accurate"}(xt||(xt={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(st||(st={})),function(t){t.Sinus="Sinus",t.Square="Square",t.Triangle="Triangle",t.Random="Random"}(it||(it={})),function(t){t[t.None=0]="None",t[t.Default=1]="Default",t[t.Force=2]="Force"}(G||(G={})),function(t){t[t.Buffered=0]="Buffered",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.AlongLine=3]="AlongLine"}(K||(K={})),function(t){t[t.Linear=0]="Linear",t[t.Rectangular=1]="Rectangular",t[t.Circular=2]="Circular",t[t.Buffered=3]="Buffered"}(W||(W={})),function(t){t[t.Discrete=0]="Discrete",t[t.Continuous=1]="Continuous"}(M||(M={})),function(t){t[t.AcrossLine=0]="AcrossLine",t[t.AloneLine=1]="AloneLine"}(T||(T={})),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Center=2]="Center",t[t.Justify=3]="Justify"}(St||(St={})),function(t){t[t.Base=0]="Base",t[t.MidPoint=1]="MidPoint",t[t.ThreePoint=2]="ThreePoint",t[t.FourPoint=3]="FourPoint",t[t.Underline=4]="Underline",t[t.CircularCW=5]="CircularCW",t[t.CircularCCW=6]="CircularCCW"}(Ot||(Ot={})),function(t){t.Butt="Butt",t.Round="Round",t.Square="Square"}(H||(H={})),function(t){t.NoConstraint="NoConstraint",t.HalfPattern="HalfPattern",t.HalfGap="HalfGap",t.FullPattern="FullPattern",t.FullGap="FullGap",t.Custom="Custom"}(Y||(Y={})),function(t){t[t.None=-1]="None",t[t.Custom=0]="Custom",t[t.Circle=1]="Circle",t[t.OpenArrow=2]="OpenArrow",t[t.ClosedArrow=3]="ClosedArrow",t[t.Diamond=4]="Diamond"}(X||(X={})),function(t){t[t.ExtraLeading=0]="ExtraLeading",t[t.Multiple=1]="Multiple",t[t.Exact=2]="Exact"}(Wt||(Wt={})),function(t){t.Bevel="Bevel",t.Round="Round",t.Miter="Miter"}(Vt||(Vt={})),function(t){t[t.Default=0]="Default",t[t.String=1]="String",t[t.Numeric=2]="Numeric"}(at||(at={})),function(t){t[t.InsidePolygon=0]="InsidePolygon",t[t.PolygonCenter=1]="PolygonCenter",t[t.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(Q||(Q={})),function(t){t[t.Tint=0]="Tint",t[t.Replace=1]="Replace",t[t.Multiply=2]="Multiply"}($||($={})),function(t){t[t.ClipAtBoundary=0]="ClipAtBoundary",t[t.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",t[t.DoNotTouchBoundary=2]="DoNotTouchBoundary",t[t.DoNotClip=3]="DoNotClip"}(Gt||(Gt={})),function(t){t.NoConstraint="NoConstraint",t.WithMarkers="WithMarkers",t.WithFullGap="WithFullGap",t.WithHalfGap="WithHalfGap",t.Custom="Custom"}(J||(J={})),function(t){t.Fixed="Fixed",t.Random="Random",t.RandomFixedQuantity="RandomFixedQuantity"}(Yt||(Yt={})),function(t){t.LineMiddle="LineMiddle",t.LineBeginning="LineBeginning",t.LineEnd="LineEnd",t.SegmentMidpoint="SegmentMidpoint"}(Xt||(Xt={})),function(t){t.OnPolygon="OnPolygon",t.CenterOfMass="CenterOfMass",t.BoundingBoxCenter="BoundingBoxCenter"}(q||(q={})),function(t){t[t.Low=0]="Low",t[t.Medium=1]="Medium",t[t.High=2]="High"}(Ht||(Ht={})),function(t){t[t.MarkerCenter=0]="MarkerCenter",t[t.MarkerBounds=1]="MarkerBounds"}(bt||(bt={})),function(t){t[t.None=0]="None",t[t.PropUniform=1]="PropUniform",t[t.PropNonuniform=2]="PropNonuniform",t[t.DifUniform=3]="DifUniform",t[t.DifNonuniform=4]="DifNonuniform"}(zt||(zt={})),function(t){t.Tube="Tube",t.Strip="Strip",t.Wall="Wall"}(Nt||(Nt={})),function(t){t[t.Random=0]="Random",t[t.Increasing=1]="Increasing",t[t.Decreasing=2]="Decreasing",t[t.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(ut||(ut={})),function(t){t[t.Relative=0]="Relative",t[t.Absolute=1]="Absolute"}(Lt||(Lt={})),function(t){t[t.Normal=0]="Normal",t[t.LowerCase=1]="LowerCase",t[t.Allcaps=2]="Allcaps"}(tt||(tt={})),function(t){t[t.LTR=0]="LTR",t[t.RTL=1]="RTL"}(ot||(ot={})),function(t){t.Draft="Draft",t.Picture="Picture",t.Text="Text"}(F||(F={})),function(t){t[t.Top=0]="Top",t[t.Center=1]="Center",t[t.Baseline=2]="Baseline",t[t.Bottom=3]="Bottom"}(ct||(ct={})),function(t){t[t.Right=0]="Right",t[t.Upright=1]="Upright"}(ht||(ht={})),function(t){t[t.Small=0]="Small",t[t.Medium=1]="Medium",t[t.Large=2]="Large"}(Ut||(Ut={})),function(t){t[t.Calm=0]="Calm",t[t.Rippled=1]="Rippled",t[t.Slight=2]="Slight",t[t.Moderate=3]="Moderate"}(Pt||(Pt={}))},90195:(re,Ft,k)=>{k.r(Ft),k.d(Ft,{default:()=>Qt});var U=k(15861),wt=k(10699),j=k(919),Dt=k(62208),w=k(13160),S=k(86575);function mt(u){return!(u<11904)&&(u>=12704&&u<=12735||u>=12544&&u<=12591||u>=65072&&u<=65103||u>=63744&&u<=64255||u>=13056&&u<=13311||u>=11904&&u<=12031||u>=12736&&u<=12783||u>=12288&&u<=12351||u>=13312&&u<=19903||u>=19968&&u<=40959||u>=12800&&u<=13055||u>=65280&&u<=65519||u>=12352&&u<=12447||u>=12272&&u<=12287||u>=12032&&u<=12255||u>=12784&&u<=12799||u>=12448&&u<=12543||u>=65040&&u<=65055||u>=42128&&u<=42191||u>=40960&&u<=42127)}function ft(u){switch(u){case 10:case 32:case 38:case 40:case 41:case 43:case 45:case 47:case 173:case 183:case 8203:case 8208:case 8211:case 8231:return!0}return!1}function gt(u){switch(u){case 9:case 10:case 11:case 12:case 13:case 32:return!0}return!1}var nt=k(84439);const P=24;class N{constructor(e,n,r,i,a,o,l){this._glyphItems=e,this._maxWidth=n,this._lineHeight=r,this._letterSpacing=i,this._hAnchor=a,this._vAnchor=o,this._justify=l}getShaping(e,n,r){const i=this._letterSpacing,a=this._lineHeight,o=this._justify,l=this._maxWidth,c=[];let f=0,d=0;const y=e.length;for(let _=0;_<y;_++){const E=e.charCodeAt(_),R=r&&(746===(u=E)||747===u||!(u<4352)&&(u>=12704&&u<=12735||u>=12544&&u<=12591||u>=65072&&u<=65103&&!(u>=65097&&u<=65103)||u>=63744&&u<=64255||u>=13056&&u<=13311||u>=11904&&u<=12031||u>=12736&&u<=12783||u>=12288&&u<=12351&&!(u>=12296&&u<=12305||u>=12308&&u<=12319||12336===u)||u>=13312&&u<=19903||u>=19968&&u<=40959||u>=12800&&u<=13055||u>=12592&&u<=12687||u>=43360&&u<=43391||u>=55216&&u<=55295||u>=4352&&u<=4607||u>=44032&&u<=55215||u>=12352&&u<=12447||u>=12272&&u<=12287||u>=12688&&u<=12703||u>=12032&&u<=12255||u>=12784&&u<=12799||u>=12448&&u<=12543&&12540!==u||u>=65280&&u<=65519&&!(65288===u||65289===u||65293===u||u>=65306&&u<=65310||65339===u||65341===u||65343===u||u>=65371&&u<=65503||65507===u||u>=65512&&u<=65519)||u>=65104&&u<=65135&&!(u>=65112&&u<=65118||u>=65123&&u<=65126)||u>=5120&&u<=5759||u>=6320&&u<=6399||u>=65040&&u<=65055||u>=19904&&u<=19967||u>=40960&&u<=42127||u>=42128&&u<=42191));let b;for(const L of this._glyphItems)if(b=L[E],b)break;c.push({codePoint:E,x:f,y:d,vertical:R,glyphMosaicItem:b}),b&&(f+=b.metrics.advance+i)}var u;let h=f;l>0&&(h=f/Math.max(1,Math.ceil(f/l)));const x=e.includes("\u200b"),p=[];for(let _=0;_<y-1;_++){const E=c[_].codePoint,R=mt(E);if(ft(E)||R){let b=0;if(10===E)b-=1e4;else if(R&&x)b+=150;else{40!==E&&65288!==E||(b+=50);const L=c[_+1].codePoint;41!==L&&65289!==L||(b+=50)}p.push(this._buildBreak(_+1,c[_].x,h,p,b,!1))}}const g=this._optimalBreaks(this._buildBreak(y,f,h,p,0,!0));let v=0;const m=n?-a:a;let I=0;for(let _=0;_<g.length;_++){const E=g[_];let R=I;for(;R<E&&gt(c[R].codePoint);)c[R].glyphMosaicItem=null,++R;let b=E-1;for(;b>R&&gt(c[b].codePoint);)c[b].glyphMosaicItem=null,--b;if(R<=b){const L=c[R].x;for(let A=R;A<=b;A++)c[A].x-=L,c[A].y=d;let O=c[b].x;c[b].glyphMosaicItem&&(O+=c[b].glyphMosaicItem.metrics.advance),v=Math.max(O,v),o&&this._applyJustification(c,R,b)}I=E,d+=m}if(c.length>0){const _=g.length-1,E=(o-this._hAnchor)*v;let R=(-this._vAnchor*(_+1)+.5)*a;n&&_&&(R+=_*a);for(const b of c)b.x+=E,b.y+=R}return c.filter(_=>_.glyphMosaicItem)}static getTextBox(e,n){if(!e.length)return null;let r=1/0,i=1/0,a=0,o=0;for(const l of e){const f=l.x,d=l.y-17,y=f+l.glyphMosaicItem.metrics.advance,h=d+n;r=Math.min(r,f),a=Math.max(a,y),i=Math.min(i,d),o=Math.max(o,h)}return{x:r,y:i,width:a-r,height:o-i}}static getBox(e){if(!e.length)return null;let n=1/0,r=1/0,i=0,a=0;for(const o of e){const{height:l,left:c,top:f,width:d}=o.glyphMosaicItem.metrics,y=o.x,h=o.y-(l-Math.abs(f)),x=y+d+c,p=h+l;n=Math.min(n,y),i=Math.max(i,x),r=Math.min(r,h),a=Math.max(a,p)}return{x:n,y:r,width:i-n,height:a-r}}static addDecoration(e,n){const r=e.length;if(0===r)return;let a=e[0].x+e[0].glyphMosaicItem.metrics.left,o=e[0].y;for(let c=1;c<r;c++){const f=e[c];if(f.y!==o){const d=e[c-1].x+e[c-1].glyphMosaicItem.metrics.left+e[c-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:a,y:o+n-3,vertical:!1,glyphMosaicItem:{sdf:!0,rect:new nt.Z(4,0,4,8),metrics:{width:d-a,height:8,left:0,top:0,advance:0},page:0,code:0}}),o=f.y,a=f.x+f.glyphMosaicItem.metrics.left}}const l=e[r-1].x+e[r-1].glyphMosaicItem.metrics.left+e[r-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:a,y:o+n-3,vertical:!1,glyphMosaicItem:{sdf:!0,rect:new nt.Z(4,0,4,8),metrics:{width:l-a,height:8,left:0,top:0,advance:0},page:0,code:0}})}_breakScore(e,n,r,i){const a=(e-n)*(e-n);return i?e<n?a/2:2*a:a+Math.abs(r)*r}_buildBreak(e,n,r,i,a,o){let l=null,c=this._breakScore(n,r,a,o);for(const f of i){const y=this._breakScore(n-f.x,r,a,o)+f.score;y<=c&&(l=f,c=y)}return{index:e,x:n,score:c,previousBreak:l}}_optimalBreaks(e){return e?this._optimalBreaks(e.previousBreak).concat(e.index):[]}_applyJustification(e,n,r){const i=e[r],o=(i.x+(i.vertical?P:i.glyphMosaicItem?i.glyphMosaicItem.metrics.advance:0))*this._justify;for(let l=n;l<=r;l++)e[l].x-=o}}var C=k(47132),B=k(1268);class dt{constructor(e,n,r=0,i=-1,a=.5){this.x=e,this.y=n,this.angle=r,this.segment=i,this.minzoom=a}}class Tt{constructor(e,n,r,i,a,o=.5,l=S.B1){this.anchor=e,this.labelAngle=n,this.glyphAngle=r,this.page=i,this.alternateVerticalGlyph=a,this.minzoom=o,this.maxzoom=l}}class Ct{constructor(e,n,r,i,a,o,l,c,f,d,y,h){this.tl=e,this.tr=n,this.bl=r,this.br=i,this.mosaicRect=a,this.labelAngle=o,this.minAngle=l,this.maxAngle=c,this.anchor=f,this.minzoom=d,this.maxzoom=y,this.page=h}}class Bt{constructor(e){this.shapes=e}}class xt{getIconPlacement(e,n,r){const i=new w.E9(e.x,e.y),a=r.rotationAlignment===B.aF.MAP,o=r.keepUpright;let l=r.rotate*S.DT;a&&(l+=e.angle);const c=new Bt([]);return r.allowOverlap&&r.ignorePlacement||!C.Bf||(c.iconColliders=[]),this._addIconPlacement(c,i,n,r,l),a&&o&&this._addIconPlacement(c,i,n,r,l+S.JJ),c}_addIconPlacement(e,n,r,i,a){const o=r.pixelRatio,l=r.width/o,c=r.height/o,f=i.offset;let d=f[0],y=f[1];switch(i.anchor){case B.nR.CENTER:d-=l/2,y-=c/2;break;case B.nR.LEFT:y-=c/2;break;case B.nR.RIGHT:d-=l,y-=c/2;break;case B.nR.TOP:d-=l/2;break;case B.nR.BOTTOM:d-=l/2,y-=c;break;case B.nR.TOP_LEFT:break;case B.nR.BOTTOM_LEFT:y-=c;break;case B.nR.TOP_RIGHT:d-=l;break;case B.nR.BOTTOM_RIGHT:d-=l,y-=c}const h=r.rect,x=2/o,p=d-x,g=y-x,v=p+h.width/o,m=g+h.height/o,I=new w.E9(p,g),_=new w.E9(v,m),E=new w.E9(p,m),R=new w.E9(v,g);if(0!==a){const L=Math.cos(a),O=Math.sin(a);I.rotate(L,O),_.rotate(L,O),E.rotate(L,O),R.rotate(L,O)}const b=new Ct(I,R,E,_,h,a,0,256,n,.5,S.B1,0);if(e.shapes.push(b),(!i.allowOverlap||!i.ignorePlacement)&&C.Bf){const L=i.size,O=i.padding;e.iconColliders.push({xTile:n.x,yTile:n.y,dxPixels:d*L-O,dyPixels:y*L-O,hard:!i.optional,partIndex:0,width:l*L+2*O,height:c*L+2*O,angle:a,minLod:.5,maxLod:S.B1})}}getTextPlacement(e,n,r,i){const a=new w.E9(e.x,e.y),o=i.rotate*S.DT,l=i.rotationAlignment===B.aF.MAP,c=i.keepUpright,f=i.padding;let d=.5;const y=l?e.angle:0,h=e.segment>=0&&l,x=i.allowOverlap&&i.ignorePlacement?null:[],p=[],v=!h;let m=Number.POSITIVE_INFINITY,I=Number.NEGATIVE_INFINITY,_=m,E=I;const R=(h||l)&&c,b=i.size/P;let L=!1;for(const D of n)if(D.vertical){L=!0;break}let O,A=0,V=0;if(!h&&L){const D=N.getTextBox(n,i.lineHeight*P);switch(i.anchor){case B.nR.LEFT:A=D.height/2,V=-D.width/2;break;case B.nR.RIGHT:A=-D.height/2,V=D.width/2;break;case B.nR.TOP:A=D.height/2,V=D.width/2;break;case B.nR.BOTTOM:A=-D.height/2,V=-D.width/2;break;case B.nR.TOP_LEFT:A=D.height;break;case B.nR.BOTTOM_LEFT:V=-D.width;break;case B.nR.TOP_RIGHT:V=D.width;break;case B.nR.BOTTOM_RIGHT:A=-D.height}}A+=i.offset[0]*P,V+=i.offset[1]*P;for(const D of n){const rt=D.glyphMosaicItem;if(!rt||rt.rect.isEmpty)continue;const Z=rt.rect,et=rt.metrics,Rt=rt.page;if(x&&v){if(void 0!==O&&O!==D.y){let pt,kt,Kt,Jt;L?(pt=-E+A,kt=m+V,Kt=E-_,Jt=I-m):(pt=m+A,kt=_+V,Kt=I-m,Jt=E-_),x.push({xTile:e.x,yTile:e.y,dxPixels:pt*b-f,dyPixels:kt*b-f,hard:!i.optional,partIndex:1,width:Kt*b+2*f,height:Jt*b+2*f,angle:o,minLod:.5,maxLod:S.B1}),m=Number.POSITIVE_INFINITY,I=Number.NEGATIVE_INFINITY,_=m,E=I}O=D.y}const ee=[];if(h){const kt=(D.x+et.left-4+.5*rt.metrics.width)*b*8;if(d=this._placeGlyph(e,d,kt,r,e.segment,1,D.vertical,Rt,ee),c&&(d=this._placeGlyph(e,d,kt,r,e.segment,-1,D.vertical,Rt,ee)),d>=2)break}else ee.push(new Tt(a,y,y,Rt,!1)),l&&c&&ee.push(new Tt(a,y+S.JJ,y+S.JJ,Rt,!1));const Zt=D.x+et.left,$t=D.y-17-et.top,ne=Zt+et.width,de=$t+et.height;let At,jt,oe,le,ie,ce,xe,pe;!h&&L?D.vertical?(At=new w.E9(-(($t+de)/2+et.width/2)-4+A,(Zt+ne)/2-et.height/2-4+V),jt=new w.E9(At.x+Z.width,At.y+Z.height),oe=new w.E9(At.x,jt.y),le=new w.E9(jt.x,At.y)):(At=new w.E9(4-$t+A,Zt-4+V),jt=new w.E9(At.x-Z.height,At.y+Z.width),oe=new w.E9(jt.x,At.y),le=new w.E9(At.x,jt.y)):(At=new w.E9(Zt-4+A,$t-4+V),jt=new w.E9(At.x+Z.width,At.y+Z.height),oe=new w.E9(At.x,jt.y),le=new w.E9(jt.x,At.y));for(const pt of ee){let kt,Kt,Jt,qt;pt.alternateVerticalGlyph?(ie||(ie=new w.E9((Zt+ne)/2+A-et.height/2-4,($t+de)/2+V+et.width/2+4),ce=new w.E9(ie.x+Z.height,ie.y-Z.width),xe=new w.E9(ce.x,ie.y),pe=new w.E9(ie.x,ce.y)),kt=ie,Kt=xe,Jt=pe,qt=ce):(kt=At,Kt=oe,Jt=le,qt=jt);const ue=$t,ye=de,he=pt.glyphAngle+o;if(0!==he){const te=Math.cos(he),fe=Math.sin(he);kt=kt.clone(),Kt=Kt?.clone(),Jt=Jt?.clone(),qt=qt?.clone(),kt.rotate(te,fe),qt?.rotate(te,fe),Kt?.rotate(te,fe),Jt?.rotate(te,fe)}let se=0,ae=256;h&&L?D.vertical?pt.alternateVerticalGlyph?(se=32,ae=96):(se=224,ae=32):(se=224,ae=96):(se=192,ae=64),p.push(new Ct(kt,Jt,Kt,qt,Z,pt.labelAngle,se,ae,pt.anchor,pt.minzoom,pt.maxzoom,pt.page)),!x||R&&!this._legible(pt.labelAngle)||(v?(Zt<m&&(m=Zt),ue<_&&(_=ue),ne>I&&(I=ne),ye>E&&(E=ye)):pt.minzoom<2&&x.push({xTile:e.x,yTile:e.y,dxPixels:(Zt+A)*b-f,dyPixels:(ue+A)*b-f,hard:!i.optional,partIndex:1,width:(ne-Zt)*b+2*f,height:(ye-ue)*b+2*f,angle:he,minLod:pt.minzoom,maxLod:pt.maxzoom}))}}if(d>=2)return null;if(x&&v){let D,rt,Z,et;L?(D=-E+A,rt=m+V,Z=E-_,et=I-m):(D=m+A,rt=_+V,Z=I-m,et=E-_),x.push({xTile:e.x,yTile:e.y,dxPixels:D*b-f,dyPixels:rt*b-f,hard:!i.optional,partIndex:1,width:Z*b+2*f,height:et*b+2*f,angle:o,minLod:.5,maxLod:S.B1})}const z=new Bt(p);return x&&x.length>0&&(z.textColliders=x),z}_legible(e){const n=(0,S.Or)(e);return n<65||n>=193}_placeGlyph(e,n,r,i,a,o,l,c,f){let d=o;const y=d<0?(0,S.DQ)(e.angle+S.JJ,S._U):e.angle;let h=0;r<0&&(d*=-1,r*=-1,h=S.JJ),d>0&&++a;let x=new w.E9(e.x,e.y),p=i[a],g=S.B1;if(i.length<=a)return g;for(;;){const v=p.x-x.x,m=p.y-x.y,I=Math.sqrt(v*v+m*m),_=Math.max(r/I,n),b=(0,S.DQ)(Math.atan2(m/I,v/I)+h,S._U);if(f.push(new Tt(x,y,b,c,!1,_,g)),l&&f.push(new Tt(x,y,b,c,!0,_,g)),_<=n)return _;x=p.clone();do{if(i.length<=(a+=d)||a<0)return _;p=i[a]}while(x.isEqual(p));let L=p.x-x.x,O=p.y-x.y;const A=Math.sqrt(L*L+O*O);L*=I/A,O*=I/A,x.x-=L,x.y-=O,g=_}}}var G,u,st=k(24192),it=k(58774);(u=G||(G={}))[u.moveTo=1]="moveTo",u[u.lineTo=2]="lineTo",u[u.close=7]="close";class K{constructor(e,n){this.values={},this._geometry=void 0,this._pbfGeometry=null;const r=n.keys,i=n.values,a=e.asUnsafe();for(;a.next();)switch(a.tag()){case 1:this.id=a.getUInt64();break;case 2:{const o=a.getMessage().asUnsafe(),l=this.values;for(;!o.empty();){const c=o.getUInt32(),f=o.getUInt32();l[r[c]]=i[f]}o.release();break}case 3:this.type=a.getUInt32();break;case 4:this._pbfGeometry=a.getMessage();break;default:a.skip()}}getGeometry(e){if(void 0!==this._geometry)return this._geometry;if(!this._pbfGeometry)return null;const n=this._pbfGeometry.asUnsafe();let r,i;this._pbfGeometry=null,e?e.reset(this.type):r=[];let a,o=G.moveTo,l=0,c=0,f=0;for(;!n.empty();){if(0===l){const d=n.getUInt32();o=7&d,l=d>>3}switch(l--,o){case G.moveTo:c+=n.getSInt32(),f+=n.getSInt32(),e?e.moveTo(c,f):r&&(i&&r.push(i),i=[],i.push(new w.E9(c,f)));break;case G.lineTo:c+=n.getSInt32(),f+=n.getSInt32(),e?e.lineTo(c,f):i&&i.push(new w.E9(c,f));break;case G.close:e?e.close():i&&!i[0].equals(c,f)&&i.push(i[0].clone());break;default:throw n.release(),new Error("Invalid path operation")}}return e?a=e.result():r&&(i&&r.push(i),a=r),n.release(),this._geometry=a,a}}var W=k(36243);class M extends W.Z{constructor(){super(12)}add(e,n,r){const i=this.array;i.push(e),i.push(n),i.push(r)}}class St{constructor(e){this.extent=4096,this.keys=[],this.values=[],this._pbfLayer=e.clone();const n=e.asUnsafe();for(;n.next();)switch(n.tag()){case 1:this.name=n.getString();break;case 3:this.keys.push(n.getString());break;case 4:this.values.push(n.processMessage(St._parseValue));break;case 5:this.extent=n.getUInt32();break;default:n.skip()}}getData(){return this._pbfLayer}static _parseValue(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getInt64();case 5:return e.getUInt64();case 6:return e.getSInt64();case 7:return e.getBool();default:e.skip()}return null}}class Ot extends W.Z{constructor(e){super(e)}add(e,n,r,i,a,o,l,c,f,d,y,h){const x=this.array;let p=W.Z.i1616to32(e,n);x.push(p);const g=31;p=W.Z.i8888to32(Math.round(g*r),Math.round(g*i),Math.round(g*a),Math.round(g*o)),x.push(p),p=W.Z.i8888to32(Math.round(g*l),Math.round(g*c),Math.round(g*f),Math.round(g*d)),x.push(p),p=W.Z.i1616to32(y,0),x.push(p),h&&x.push(...h)}}class H extends W.Z{constructor(e){super(e)}add(e,n,r){const i=this.array;i.push(W.Z.i1616to32(e,n)),r&&i.push(...r)}}class Y extends W.Z{constructor(e){super(e)}add(e,n,r,i,a,o,l){const c=this.array,f=this.index;let d=W.Z.i1616to32(e,n);return c.push(d),d=W.Z.i8888to32(Math.round(15*r),Math.round(15*i),a,o),c.push(d),l&&c.push(...l),f}}class X extends W.Z{constructor(e){super(e)}add(e,n,r,i,a,o,l,c,f,d,y,h){const x=this.array;let p=W.Z.i1616to32(e,n);x.push(p),p=W.Z.i1616to32(Math.round(8*r),Math.round(8*i)),x.push(p),p=W.Z.i8888to32(a/4,o/4,c,f),x.push(p),p=W.Z.i8888to32(0,(0,S.Or)(l),10*d,Math.min(10*y,255)),x.push(p),h&&x.push(...h)}}class Wt extends W.Z{constructor(e){super(e)}add(e,n,r,i,a){const o=this.array,l=W.Z.i1616to32(2*e+r,2*n+i);o.push(l),a&&o.push(...a)}}class Vt{constructor(e,n,r){this.layerExtent=4096,this._features=[],this.layer=e,this.zoom=n,this._spriteInfo=r,this._filter=e.getFeatureFilter()}pushFeature(e){this._filter&&!this._filter.filter(e,this.zoom)||this._features.push(e)}hasFeatures(){return this._features.length>0}getResources(e,n,r){}}class at extends Vt{constructor(e,n,r,i,a){super(e,n,r),this.type=j.al.CIRCLE,this._circleVertexBuffer=i,this._circleIndexBuffer=a}get circleIndexStart(){return this._circleIndexStart}get circleIndexCount(){return this._circleIndexCount}processFeatures(e){const n=this._circleVertexBuffer,r=this._circleIndexBuffer;this._circleIndexStart=3*r.index,this._circleIndexCount=0;const i=this.layer,a=this.zoom;e&&e.setExtent(this.layerExtent);for(const o of this._features){const l=o.getGeometry(e);if(!l)continue;const c=i.circleMaterial.encodeAttributes(o,a,i);for(const f of l)if(f)for(const d of f){const y=n.index;n.add(d.x,d.y,0,0,c),n.add(d.x,d.y,0,1,c),n.add(d.x,d.y,1,0,c),n.add(d.x,d.y,1,1,c),r.add(y+0,y+1,y+2),r.add(y+1,y+2,y+3),this._circleIndexCount+=6}}}serialize(){let e=6;e+=this.layerUIDs.length,e+=this._circleVertexBuffer.array.length,e+=this._circleIndexBuffer.array.length;const n=new Uint32Array(e),r=new Int32Array(n.buffer);let i=0;n[i++]=this.type,n[i++]=this.layerUIDs.length;for(let a=0;a<this.layerUIDs.length;a++)n[i++]=this.layerUIDs[a];n[i++]=this._circleIndexStart,n[i++]=this._circleIndexCount,n[i++]=this._circleVertexBuffer.array.length;for(let a=0;a<this._circleVertexBuffer.array.length;a++)r[i++]=this._circleVertexBuffer.array[a];n[i++]=this._circleIndexBuffer.array.length;for(let a=0;a<this._circleIndexBuffer.array.length;a++)n[i++]=this._circleIndexBuffer.array[a];return n.buffer}}var Q=k(35575),$=k(11915);class Gt extends Vt{constructor(e,n,r,i,a,o,l){super(e,n,r),this.type=j.al.FILL,this._patternMap=new Map,this._fillVertexBuffer=i,this._fillIndexBuffer=a,this._outlineVertexBuffer=o,this._outlineIndexBuffer=l}get fillIndexStart(){return this._fillIndexStart}get fillIndexCount(){return this._fillIndexCount}get outlineIndexStart(){return this._outlineIndexStart}get outlineIndexCount(){return this._outlineIndexCount}getResources(e,n,r){const a=this.zoom,o=this.layer.getPaintProperty("fill-pattern");if(o)if(o.isDataDriven)for(const l of this._features)n(o.getValue(a,l),!0);else n(o.getValue(a),!0)}processFeatures(e){this._fillIndexStart=3*this._fillIndexBuffer.index,this._fillIndexCount=0,this._outlineIndexStart=3*this._outlineIndexBuffer.index,this._outlineIndexCount=0;const n=this.layer,r=this.zoom,{fillMaterial:i,outlineMaterial:a,hasDataDrivenFill:o,hasDataDrivenOutline:l}=n;e&&e.setExtent(this.layerExtent);const c=n.getPaintProperty("fill-pattern"),f=c?.isDataDriven;let d=!c&&n.getPaintValue("fill-antialias",r);if(n.outlineUsesFillColor){if(d&&!n.hasDataDrivenOpacity){const x=n.getPaintValue("fill-opacity",r),p=n.getPaintValue("fill-opacity",r+1);x<1&&p<1&&(d=!1)}if(d&&!n.hasDataDrivenColor){const x=n.getPaintValue("fill-color",r),p=n.getPaintValue("fill-color",r+1);x[3]<1&&p[3]<1&&(d=!1)}}const y=this._features,h=e?.validateTessellation;if(f){const x=[];for(const p of y){const g=c.getValue(r,p),v=this._spriteInfo[g];if(!v||!v.rect)continue;const m=i.encodeAttributes(p,r,n,v),I=d&&l?a.encodeAttributes(p,r,n):[],_=p.getGeometry(e);x.push({ddFillAttributes:m,ddOutlineAttributes:I,page:v.page,geometry:_}),x.sort((E,R)=>E.page-R.page);for(const{ddFillAttributes:E,ddOutlineAttributes:R,page:b,geometry:L}of x)this._processFeature(L,d,n.outlineUsesFillColor,E,R,h,b)}}else for(const x of y){const p=o?i.encodeAttributes(x,r,n):null,g=d&&l?a.encodeAttributes(x,r,n):null,v=x.getGeometry(e);this._processFeature(v,d,n.outlineUsesFillColor,p,g,h)}}serialize(){let e=10;e+=this.layerUIDs.length,e+=this._fillVertexBuffer.array.length,e+=this._fillIndexBuffer.array.length,e+=this._outlineVertexBuffer.array.length,e+=this._outlineIndexBuffer.array.length,e+=3*this._patternMap.size+1;const n=new Uint32Array(e),r=new Int32Array(n.buffer);let i=0;n[i++]=this.type,n[i++]=this.layerUIDs.length;for(let l=0;l<this.layerUIDs.length;l++)n[i++]=this.layerUIDs[l];n[i++]=this._fillIndexStart,n[i++]=this._fillIndexCount,n[i++]=this._outlineIndexStart,n[i++]=this._outlineIndexCount;const a=this._patternMap,o=a.size;if(n[i++]=o,o>0)for(const[l,[c,f]]of a)n[i++]=l,n[i++]=c,n[i++]=f;n[i++]=this._fillVertexBuffer.array.length;for(let l=0;l<this._fillVertexBuffer.array.length;l++)r[i++]=this._fillVertexBuffer.array[l];n[i++]=this._fillIndexBuffer.array.length;for(let l=0;l<this._fillIndexBuffer.array.length;l++)n[i++]=this._fillIndexBuffer.array[l];n[i++]=this._outlineVertexBuffer.array.length;for(let l=0;l<this._outlineVertexBuffer.array.length;l++)r[i++]=this._outlineVertexBuffer.array[l];n[i++]=this._outlineIndexBuffer.array.length;for(let l=0;l<this._outlineIndexBuffer.array.length;l++)n[i++]=this._outlineIndexBuffer.array[l];return n.buffer}_processFeature(e,n,r,i,a,o,l){if(!e)return;const c=e.length;if(n&&(!r||!a||0===a.length))for(let h=0;h<c;h++)this._processOutline(e[h],a);let y;for(let h=0;h<c;h++){const x=Gt._area(e[h]);x>32?(void 0!==y&&this._processFill(e,y,i,o,l),y=[h]):x<-32&&void 0!==y&&y.push(h)}void 0!==y&&this._processFill(e,y,i,o,l)}_processOutline(e,n){const r=this._outlineVertexBuffer,i=this._outlineIndexBuffer,a=i.index;let o,l,c;const f=new w.E9(0,0),d=new w.E9(0,0),y=new w.E9(0,0);let h=-1,x=-1,p=-1,g=-1,v=-1,m=!1,_=e.length;if(_<2)return;const E=e[0];let R=e[_-1];for(;_&&R.isEqual(E);)--_,R=e[_-1];if(!(_-0<2)){for(let b=0;b<_;++b){0===b?(o=e[_-1],l=e[0],c=e[1],f.assignSub(l,o),f.normalize(),f.rightPerpendicular()):(o=l,l=c,c=b!==_-1?e[b+1]:e[0],f.assign(d));const L=this._isClipEdge(o,l);-1===g&&(m=L),d.assignSub(c,l),d.normalize(),d.rightPerpendicular();const O=f.x*d.y-f.y*d.x;y.assignAdd(f,d),y.normalize();const A=-y.x*-f.x+-y.y*-f.y;let V=Math.abs(0!==A?1/A:1);V>8&&(V=8),O>=0?(p=r.add(l.x,l.y,f.x,f.y,0,1,n),-1===g&&(g=p),h>=0&&x>=0&&p>=0&&!L&&i.add(h,x,p),x=r.add(l.x,l.y,V*-y.x,V*-y.y,0,-1,n),-1===v&&(v=x),h>=0&&x>=0&&p>=0&&!L&&i.add(h,x,p),h=x,x=p,p=r.add(l.x,l.y,y.x,y.y,0,1,n),h>=0&&x>=0&&p>=0&&!L&&i.add(h,x,p),x=r.add(l.x,l.y,d.x,d.y,0,1,n),h>=0&&x>=0&&p>=0&&!L&&i.add(h,x,p)):(p=r.add(l.x,l.y,V*y.x,V*y.y,0,1,n),-1===g&&(g=p),h>=0&&x>=0&&p>=0&&!L&&i.add(h,x,p),x=r.add(l.x,l.y,-f.x,-f.y,0,-1,n),-1===v&&(v=x),h>=0&&x>=0&&p>=0&&!L&&i.add(h,x,p),h=x,x=p,p=r.add(l.x,l.y,-y.x,-y.y,0,-1,n),h>=0&&x>=0&&p>=0&&!L&&i.add(h,x,p),h=r.add(l.x,l.y,-d.x,-d.y,0,-1,n),h>=0&&x>=0&&p>=0&&!L&&i.add(h,x,p))}h>=0&&x>=0&&g>=0&&!m&&i.add(h,x,g),h>=0&&g>=0&&v>=0&&!m&&i.add(h,v,g),this._outlineIndexCount+=3*(i.index-a)}}_processFill(e,n,r,i,a){let o;n.length>1&&(o=[]);let l=0;for(const y of n)0!==l&&o.push(l),l+=e[y].length;const c=2*l,f=Q.Z.acquire();for(const y of n){const h=e[y],x=h.length;for(let p=0;p<x;++p)f.push(h[p].x,h[p].y)}const d=(0,$.e)(f,o,2);if($.e.deviation(f,o,2,d)>0){const y=n.map(p=>e[p].length),{buffer:h,vertexCount:x}=(0,it.b)(f,y);if(x>0){const p=this._fillVertexBuffer.index;for(let g=0;g<x;g++)this._fillVertexBuffer.add(h[2*g],h[2*g+1],r);for(let g=0;g<x;g+=3){const v=p+g;this._fillIndexBuffer.add(v,v+1,v+2)}if(void 0!==a){const g=this._patternMap,v=g.get(a);v?v[1]+=x:g.set(a,[this._fillIndexStart+this._fillIndexCount,x])}this._fillIndexCount+=x}}else{const y=d.length;if(y>0){const h=this._fillVertexBuffer.index;let x=0;for(;x<c;)this._fillVertexBuffer.add(f[x++],f[x++],r);let p=0;for(;p<y;)this._fillIndexBuffer.add(h+d[p++],h+d[p++],h+d[p++]);if(void 0!==a){const g=this._patternMap,v=g.get(a);v?v[1]+=y:g.set(a,[this._fillIndexStart+this._fillIndexCount,y])}this._fillIndexCount+=y}}Q.Z.release(f)}_isClipEdge(e,n){return e.x===n.x?e.x<=-64||e.x>=4160:e.y===n.y&&(e.y<=-64||e.y>=4160)}static _area(e){let n=0;const r=e.length-1;for(let i=0;i<r;i++)n+=(e[i].x-e[i+1].x)*(e[i].y+e[i+1].y);return n+=(e[r].x-e[0].x)*(e[r].y+e[0].y),.5*n}}var J=k(46519);class Xt extends Vt{constructor(e,n,r,i,a){super(e,n,r),this.type=j.al.LINE,this._tessellationOptions={pixelCoordRatio:8,halfWidth:0,offset:0},this._patternMap=new Map,this.tessellationProperties={_lineVertexBuffer:null,_lineIndexBuffer:null,_ddValues:null},this.tessellationProperties._lineVertexBuffer=i,this.tessellationProperties._lineIndexBuffer=a,this._lineTessellator=new J.z(q(this.tessellationProperties),Ht(this.tessellationProperties),e.canUseThinTessellation)}get lineIndexStart(){return this._lineIndexStart}get lineIndexCount(){return this._lineIndexCount}getResources(e,n,r){const i=this.layer,a=this.zoom,o=i.getPaintProperty("line-pattern"),l=i.getPaintProperty("line-dasharray"),c=i.getLayoutProperty("line-cap");if(!o&&!l)return;const f=c?.getValue(a)||0,d=c?.isDataDriven,y=o?.isDataDriven,h=l?.isDataDriven;if(y||h)for(const x of this._features)n(y?o.getValue(a,x):this._getDashArrayKey(x,a,i,l,d,c,f));else if(o)n(o.getValue(a));else if(l){const x=l.getValue(a);n(i.getDashKey(x,f))}}processFeatures(e){this._lineIndexStart=3*this.tessellationProperties._lineIndexBuffer.index,this._lineIndexCount=0;const n=this.layer,r=this.zoom,i=this._features,a=this._tessellationOptions,{hasDataDrivenLine:o,lineMaterial:l}=n;e&&e.setExtent(this.layerExtent);const c=n.getPaintProperty("line-pattern"),f=n.getPaintProperty("line-dasharray"),d=c?.isDataDriven,y=f?.isDataDriven;let h;h=n.getLayoutProperty("line-cap");const x=h?.isDataDriven?h:null,p=x?null:n.getLayoutValue("line-cap",r),g=p||0,v=!!x;h=n.getLayoutProperty("line-join");const m=h?.isDataDriven?h:null,I=m?null:n.getLayoutValue("line-join",r);h=n.getLayoutProperty("line-miter-limit");const _=h?.isDataDriven?h:null,E=_?null:n.getLayoutValue("line-miter-limit",r);h=n.getLayoutProperty("line-round-limit");const R=h?.isDataDriven?h:null,b=R?null:n.getLayoutValue("line-round-limit",r);h=n.getPaintProperty("line-width");const L=h?.isDataDriven?h:null,O=L?null:n.getPaintValue("line-width",r);h=n.getPaintProperty("line-offset");const A=h?.isDataDriven?h:null,V=A?null:n.getPaintValue("line-offset",r);if(d||y){const z=[];for(const D of i){const rt=d?c.getValue(r,D):this._getDashArrayKey(D,r,n,f,v,x,g),Z=this._spriteInfo[rt];if(!Z||!Z.rect)continue;const et=l.encodeAttributes(D,r,n,Z),Rt=D.getGeometry(e);z.push({ddAttributes:et,page:Z.page,cap:x?x.getValue(r,D):p,join:m?m.getValue(r,D):I,miterLimit:_?_.getValue(r,D):E,roundLimit:R?R.getValue(r,D):b,halfWidth:.5*(L?L.getValue(r,D):O),offset:A?A.getValue(r,D):V,geometry:Rt})}z.sort((D,rt)=>D.page-rt.page),a.textured=!0;for(const{ddAttributes:D,page:rt,cap:Z,join:et,miterLimit:Rt,roundLimit:ee,halfWidth:Zt,offset:$t,geometry:ne}of z)a.capType=Z,a.joinType=et,a.miterLimit=Rt,a.roundLimit=ee,a.halfWidth=Zt,a.offset=$t,this._processFeature(ne,D,rt)}else{if(c){const z=c.getValue(r),D=this._spriteInfo[z];if(!D||!D.rect)return}a.textured=!(!c&&!f),a.capType=p,a.joinType=I,a.miterLimit=E,a.roundLimit=b,a.halfWidth=.5*O,a.offset=V;for(const z of i){const D=o?l.encodeAttributes(z,r,n):null;x&&(a.capType=x.getValue(r,z)),m&&(a.joinType=m.getValue(r,z)),_&&(a.miterLimit=_.getValue(r,z)),R&&(a.roundLimit=R.getValue(r,z)),L&&(a.halfWidth=.5*L.getValue(r,z)),A&&(a.offset=A.getValue(r,z));const rt=z.getGeometry(e);this._processFeature(rt,D)}}}serialize(){let e=6;e+=this.layerUIDs.length,e+=this.tessellationProperties._lineVertexBuffer.array.length,e+=this.tessellationProperties._lineIndexBuffer.array.length,e+=3*this._patternMap.size+1;const n=new Uint32Array(e),r=new Int32Array(n.buffer);let i=0;n[i++]=this.type,n[i++]=this.layerUIDs.length;for(let l=0;l<this.layerUIDs.length;l++)n[i++]=this.layerUIDs[l];n[i++]=this._lineIndexStart,n[i++]=this._lineIndexCount;const a=this._patternMap,o=a.size;if(n[i++]=o,o>0)for(const[l,[c,f]]of a)n[i++]=l,n[i++]=c,n[i++]=f;n[i++]=this.tessellationProperties._lineVertexBuffer.array.length;for(let l=0;l<this.tessellationProperties._lineVertexBuffer.array.length;l++)r[i++]=this.tessellationProperties._lineVertexBuffer.array[l];n[i++]=this.tessellationProperties._lineIndexBuffer.array.length;for(let l=0;l<this.tessellationProperties._lineIndexBuffer.array.length;l++)n[i++]=this.tessellationProperties._lineIndexBuffer.array[l];return n.buffer}_processFeature(e,n,r){if(!e)return;const i=e.length;for(let a=0;a<i;a++)this._processGeometry(e[a],n,r)}_processGeometry(e,n,r){if(e.length<2)return;let a,o,l=e[0],c=1;for(;c<e.length;)a=e[c].x-l.x,o=e[c].y-l.y,a*a+o*o<1e-6?e.splice(c,1):(l=e[c],++c);if(e.length<2)return;const f=this.tessellationProperties._lineIndexBuffer,d=3*f.index;this._tessellationOptions.initialDistance=0,this._tessellationOptions.wrapDistance=65535,this.tessellationProperties._ddValues=n,this._lineTessellator.tessellate(e,this._tessellationOptions);const y=3*f.index-d;if(void 0!==r){const h=this._patternMap,x=h.get(r);x?x[1]+=y:h.set(r,[d+this._lineIndexCount,y])}this._lineIndexCount+=y}_getDashArrayKey(e,n,r,i,a,o,l){const c=a?o.getValue(n,e):l,f=i.getValue(n,e);return r.getDashKey(f,c)}}const q=u=>(e,n,r,i,a,o,l,c,f,d,y)=>(u._lineVertexBuffer.add(e,n,l,c,r,i,a,o,f,d,y,u._ddValues),u._lineVertexBuffer.index-1),Ht=u=>(e,n,r)=>{u._lineIndexBuffer.add(e,n,r)};var ot,bt=k(6879),zt=k(77275),Nt=k(77928);function Lt(u,e){return u.iconMosaicItem&&e.iconMosaicItem?u.iconMosaicItem.page===e.iconMosaicItem.page?0:u.iconMosaicItem.page-e.iconMosaicItem.page:u.iconMosaicItem&&!e.iconMosaicItem?1:!u.iconMosaicItem&&e.iconMosaicItem?-1:0}class tt extends Vt{constructor(e,n,r,i,a,o,l,c){super(e,n,c.getSpriteItems()),this.type=j.al.SYMBOL,this._markerMap=new Map,this._glyphMap=new Map,this._glyphBufferDataStorage=new Map,this._isIconSDF=!1,this._iconVertexBuffer=r,this._iconIndexBuffer=i,this._textVertexBuffer=a,this._textIndexBuffer=o,this._placementEngine=l,this._workerTileHandler=c}get markerPageMap(){return this._markerMap}get glyphsPageMap(){return this._glyphMap}get symbolInstances(){return this._symbolInstances}getResources(e,n,r){const i=this.layer,a=this.zoom;e&&e.setExtent(this.layerExtent);const o=i.getLayoutProperty("icon-image"),l=i.getLayoutProperty("text-field");let c=i.getLayoutProperty("text-transform"),f=i.getLayoutProperty("text-font");const d=[];let y,h,x,p;o&&!o.isDataDriven&&(y=o.getValue(a)),l&&!l.isDataDriven&&(h=l.getValue(a)),c&&c.isDataDriven||(x=i.getLayoutValue("text-transform",a),c=null),f&&f.isDataDriven||(p=i.getLayoutValue("text-font",a),f=null);for(const g of this._features){const v=g.getGeometry(e);if(!v||0===v.length)continue;let m,I;o&&(m=o.isDataDriven?o.getValue(a,g):this._replaceKeys(y,g.values),m&&n(m));let _=!1;if(l&&(I=l.isDataDriven?l.getValue(a,g):this._replaceKeys(h,g.values),I)){switch(I=I.replace(/\\n/g,"\n"),c&&(x=c.getValue(a,g)),x){case B._5.LOWERCASE:I=I.toLowerCase();break;case B._5.UPPERCASE:I=I.toUpperCase()}if(tt._bidiEngine.hasBidiChar(I)){let L;L="rtl"===tt._bidiEngine.checkContextual(I)?"IDNNN":"ICNNN",I=tt._bidiEngine.bidiTransform(I,L,"VLYSN"),_=!0}const b=I.length;if(b>0){f&&(p=f.getValue(a,g));for(const L of p){let O=r[L];O||(O=r[L]=new Set);for(let A=0;A<b;A++){const V=I.charCodeAt(A);O.add(V)}}}}if(!m&&!I)continue;const E=i.getLayoutValue("symbol-sort-key",a,g),R={feature:g,sprite:m,label:I,rtl:_,geometry:v,hash:(I?(0,zt.hP)(I):0)^(m?(0,zt.hP)(m):0),priority:E,textFont:p};d.push(R)}this._symbolFeatures=d}processFeatures(e){e&&e.setExtent(this.layerExtent);const n=this.layer,r=this.zoom,i=n.getLayoutValue("symbol-placement",r),a=i!==B.R.POINT,o=8*n.getLayoutValue("symbol-spacing",r),l=n.getLayoutProperty("icon-image"),c=n.getLayoutProperty("text-field"),f=l?new Nt._L(n,r,a):null,d=c?new Nt.nj(n,r,a):null,y=this._workerTileHandler;let h;l&&(h=y.getSpriteItems()),this._iconIndexStart=3*this._iconIndexBuffer.index,this._textIndexStart=3*this._textIndexBuffer.index,this._iconIndexCount=0,this._textIndexCount=0,this._markerMap.clear(),this._glyphMap.clear();const x=[];let p=1;d&&d.size&&(p=d.size/P);const g=d?d.maxAngle*S.DT:0,v=d?8*d.size:0;for(const m of this._symbolFeatures){let I,_;f&&h&&m.sprite&&(I=h[m.sprite],I&&I.sdf&&(this._isIconSDF=!0)),I&&f.update(r,m.feature);let E=0;const R=m.label;if(R){(0,Dt.O3)(d),d.update(r,m.feature);const b=a&&d.rotationAlignment===B.aF.MAP?d.keepUpright:d.writingMode&&d.writingMode.includes(B.r1.VERTICAL);let L=.5;switch(d.anchor){case B.nR.TOP_LEFT:case B.nR.LEFT:case B.nR.BOTTOM_LEFT:L=0;break;case B.nR.TOP_RIGHT:case B.nR.RIGHT:case B.nR.BOTTOM_RIGHT:L=1}let O=.5;switch(d.anchor){case B.nR.TOP_LEFT:case B.nR.TOP:case B.nR.TOP_RIGHT:O=0;break;case B.nR.BOTTOM_LEFT:case B.nR.BOTTOM:case B.nR.BOTTOM_RIGHT:O=1}let A=.5;switch(d.justify){case B.vL.AUTO:A=L;break;case B.vL.LEFT:A=0;break;case B.vL.RIGHT:A=1}const V=d.letterSpacing*P,z=a?0:d.maxWidth*P,D=d.lineHeight*P,rt=m.textFont.map(Z=>y.getGlyphItems(Z));if(_=new N(rt,z,D,V,L,O,A).getShaping(R,m.rtl,b),_&&_.length>0){let Z=1e30,et=-1e30;for(const Rt of _)Z=Math.min(Z,Rt.x),et=Math.max(et,Rt.x);E=(et-Z+48)*p*8}}for(let b of m.geometry){const L=[];if(i===B.R.LINE){if(_?.length&&d?.size){const O=8*d.size*(2+Math.min(2,4*Math.abs(d.offset[1])));b=tt._smoothVertices(b,O)}tt._pushAnchors(L,b,o,E)}else i===B.R.LINE_CENTER?tt._pushCenterAnchor(L,b):m.feature.type===w.Vl.Polygon?tt._pushCentroid(L,b):L.push(new dt(b[0].x,b[0].y));for(const O of L){if(O.x<0||O.x>4096||O.y<0||O.y>4096||a&&E>0&&d?.rotationAlignment===B.aF.MAP&&!tt._honorsTextMaxAngle(b,O,E,g,v))continue;const A={shaping:_,line:b,iconMosaicItem:I,anchor:O,symbolFeature:m,textColliders:[],iconColliders:[],textVertexRanges:[],iconVertexRanges:[]};x.push(A),this._processFeature(A,f,d)}}}x.sort(Lt),this._addPlacedGlyphs(),this._symbolInstances=x}serialize(){let e=11;e+=this.layerUIDs.length,e+=3*this.markerPageMap.size,e+=3*this.glyphsPageMap.size,e+=tt._symbolsSerializationLength(this._symbolInstances),e+=this._iconVertexBuffer.array.length,e+=this._iconIndexBuffer.array.length,e+=this._textVertexBuffer.array.length,e+=this._textIndexBuffer.array.length;const n=new Uint32Array(e),r=new Int32Array(n.buffer),i=new Float32Array(n.buffer);let a=0;n[a++]=this.type,n[a++]=this.layerUIDs.length;for(let o=0;o<this.layerUIDs.length;o++)n[a++]=this.layerUIDs[o];n[a++]=this._isIconSDF?1:0,n[a++]=this.markerPageMap.size;for(const[o,[l,c]]of this.markerPageMap)n[a++]=o,n[a++]=l,n[a++]=c;n[a++]=this.glyphsPageMap.size;for(const[o,[l,c]]of this.glyphsPageMap)n[a++]=o,n[a++]=l,n[a++]=c;n[a++]=this._iconVertexBuffer.index/4,n[a++]=this._textVertexBuffer.index/4,a=tt.serializeSymbols(n,r,i,a,this._symbolInstances),n[a++]=this._iconVertexBuffer.array.length;for(let o=0;o<this._iconVertexBuffer.array.length;o++)r[a++]=this._iconVertexBuffer.array[o];n[a++]=this._iconIndexBuffer.array.length;for(let o=0;o<this._iconIndexBuffer.array.length;o++)n[a++]=this._iconIndexBuffer.array[o];n[a++]=this._textVertexBuffer.array.length;for(let o=0;o<this._textVertexBuffer.array.length;o++)r[a++]=this._textVertexBuffer.array[o];n[a++]=this._textIndexBuffer.array.length;for(let o=0;o<this._textIndexBuffer.array.length;o++)n[a++]=this._textIndexBuffer.array[o];return n.buffer}static _symbolsSerializationLength(e){let n=0;n+=1;for(const r of e||[]){n+=4,n+=1;for(const i of r.textColliders)n+=10;for(const i of r.iconColliders)n+=10;n+=1,n+=2*r.textVertexRanges.length,n+=1,n+=2*r.iconVertexRanges.length}return n}static serializeSymbols(e,n,r,i,a){n[i++]=(a=a||[]).length;for(const o of a){n[i++]=o.anchor.x,n[i++]=o.anchor.y,n[i++]=o.symbolFeature.hash,n[i++]=o.symbolFeature.priority,n[i++]=o.textColliders.length+o.iconColliders.length;for(const l of o.textColliders)n[i++]=l.xTile,n[i++]=l.yTile,n[i++]=l.dxPixels,n[i++]=l.dyPixels,n[i++]=l.hard?1:0,n[i++]=l.partIndex,r[i++]=l.minLod,r[i++]=l.maxLod,n[i++]=l.width,n[i++]=l.height;for(const l of o.iconColliders)n[i++]=l.xTile,n[i++]=l.yTile,n[i++]=l.dxPixels,n[i++]=l.dyPixels,n[i++]=l.hard?1:0,n[i++]=l.partIndex,r[i++]=l.minLod,r[i++]=l.maxLod,n[i++]=l.width,n[i++]=l.height;n[i++]=o.textVertexRanges.length;for(const[l,c]of o.textVertexRanges)n[i++]=l,n[i++]=c;n[i++]=o.iconVertexRanges.length;for(const[l,c]of o.iconVertexRanges)n[i++]=l,n[i++]=c}return i}_replaceKeys(e,n){return e.replace(/{([^{}]+)}/g,(r,i)=>i in n?n[i]:"")}_processFeature(e,n,r){const{line:i,iconMosaicItem:a,shaping:o,anchor:l}=e,c=this.zoom,f=this.layer,d=!!a;let y=!0;d&&(y=n?.optional||!a);const h=o&&o.length>0,x=!h||r?.optional;let p,g;if(d&&(p=this._placementEngine.getIconPlacement(l,a,n)),(p||y)&&(h&&(g=this._placementEngine.getTextPlacement(l,o,i,r)),g||x)){if(p&&g||(x||y?x||g?y||p||(g=null):p=null:(p=null,g=null)),g){const v=f.hasDataDrivenText?f.textMaterial.encodeAttributes(e.symbolFeature.feature,c,f):null;if(this._storePlacedGlyphs(e,g.shapes,c,r.rotationAlignment,v),g.textColliders){e.textColliders=g.textColliders;for(const m of g.textColliders){m.minLod=Math.max(c+(0,S.k3)(m.minLod),0),m.maxLod=Math.min(c+(0,S.k3)(m.maxLod),25);const I=m.angle;if(I){const _=Math.cos(I),E=Math.sin(I),R=m.dxPixels*_-m.dyPixels*E,b=m.dxPixels*E+m.dyPixels*_,L=(m.dxPixels+m.width)*_-m.dyPixels*E,O=(m.dxPixels+m.width)*E+m.dyPixels*_,A=m.dxPixels*_-(m.dyPixels+m.height)*E,V=m.dxPixels*E+(m.dyPixels+m.height)*_,z=(m.dxPixels+m.width)*_-(m.dyPixels+m.height)*E,D=(m.dxPixels+m.width)*E+(m.dyPixels+m.height)*_,rt=Math.min(R,L,A,z),Z=Math.max(R,L,A,z),et=Math.min(b,O,V,D),Rt=Math.max(b,O,V,D);m.dxPixels=rt,m.dyPixels=et,m.width=Z-rt,m.height=Rt-et}}}}if(p){const v=f.hasDataDrivenIcon?f.iconMaterial.encodeAttributes(e.symbolFeature.feature,c,f):null;if(this._addPlacedIcons(e,p.shapes,c,a.page,n.rotationAlignment===B.aF.VIEWPORT,v),p.iconColliders){e.iconColliders=p.iconColliders;for(const m of p.iconColliders){m.minLod=Math.max(c+(0,S.k3)(m.minLod),0),m.maxLod=Math.min(c+(0,S.k3)(m.maxLod),25);const I=m.angle;if(I){const _=Math.cos(I),E=Math.sin(I),R=m.dxPixels*_-m.dyPixels*E,b=m.dxPixels*E+m.dyPixels*_,L=(m.dxPixels+m.width)*_-m.dyPixels*E,O=(m.dxPixels+m.width)*E+m.dyPixels*_,A=m.dxPixels*_-(m.dyPixels+m.height)*E,V=m.dxPixels*E+(m.dyPixels+m.height)*_,z=(m.dxPixels+m.width)*_-(m.dyPixels+m.height)*E,D=(m.dxPixels+m.width)*E+(m.dyPixels+m.height)*_,rt=Math.min(R,L,A,z),Z=Math.max(R,L,A,z),et=Math.min(b,O,V,D),Rt=Math.max(b,O,V,D);m.dxPixels=rt,m.dyPixels=et,m.width=Z-rt,m.height=Rt-et}}}}}}_addPlacedIcons(e,n,r,i,a,o){const l=Math.max(r-1,0),c=this._iconVertexBuffer,f=this._iconIndexBuffer,d=this._markerMap;for(const y of n){const h=a?0:Math.max(r+(0,S.k3)(y.minzoom),l),x=a?25:Math.min(r+(0,S.k3)(y.maxzoom),25);if(x<=h)continue;const p=y.tl,g=y.tr,v=y.bl,m=y.br,I=y.mosaicRect,_=y.labelAngle,E=y.minAngle,R=y.maxAngle,b=y.anchor,L=c.index,O=I.x,A=I.y,V=O+I.width,z=A+I.height,D=c.index;c.add(b.x,b.y,p.x,p.y,O,A,_,E,R,h,x,o),c.add(b.x,b.y,g.x,g.y,V,A,_,E,R,h,x,o),c.add(b.x,b.y,v.x,v.y,O,z,_,E,R,h,x,o),c.add(b.x,b.y,m.x,m.y,V,z,_,E,R,h,x,o),e.iconVertexRanges.length>0&&e.iconVertexRanges[0][0]+e.iconVertexRanges[0][1]===D?e.iconVertexRanges[0][1]+=4:e.iconVertexRanges.push([D,4]),f.add(L+0,L+1,L+2),f.add(L+1,L+2,L+3),d.has(i)?d.get(i)[1]+=6:d.set(i,[this._iconIndexStart+this._iconIndexCount,6]),this._iconIndexCount+=6}}_addPlacedGlyphs(){const e=this._textVertexBuffer,n=this._textIndexBuffer,r=this._glyphMap;for(const[i,a]of this._glyphBufferDataStorage)for(const o of a){const l=e.index,c=o.symbolInstance,f=o.ddAttributes,d=e.index;e.add(o.glyphAnchor[0],o.glyphAnchor[1],o.tl[0],o.tl[1],o.xmin,o.ymin,o.labelAngle,o.minAngle,o.maxAngle,o.minLod,o.maxLod,f),e.add(o.glyphAnchor[0],o.glyphAnchor[1],o.tr[0],o.tr[1],o.xmax,o.ymin,o.labelAngle,o.minAngle,o.maxAngle,o.minLod,o.maxLod,f),e.add(o.glyphAnchor[0],o.glyphAnchor[1],o.bl[0],o.bl[1],o.xmin,o.ymax,o.labelAngle,o.minAngle,o.maxAngle,o.minLod,o.maxLod,f),e.add(o.glyphAnchor[0],o.glyphAnchor[1],o.br[0],o.br[1],o.xmax,o.ymax,o.labelAngle,o.minAngle,o.maxAngle,o.minLod,o.maxLod,f),c.textVertexRanges.length>0&&c.textVertexRanges[0][0]+c.textVertexRanges[0][1]===d?c.textVertexRanges[0][1]+=4:c.textVertexRanges.push([d,4]),n.add(l+0,l+1,l+2),n.add(l+1,l+2,l+3),r.has(i)?r.get(i)[1]+=6:r.set(i,[this._textIndexStart+this._textIndexCount,6]),this._textIndexCount+=6}this._glyphBufferDataStorage.clear()}_storePlacedGlyphs(e,n,r,i,a){const o=Math.max(r-1,0),l=i===B.aF.VIEWPORT;let c,f,d,y,h,x,p,g,v,m,I;for(const _ of n)c=l?0:Math.max(r+(0,S.k3)(_.minzoom),o),f=l?25:Math.min(r+(0,S.k3)(_.maxzoom),25),!(f<=c)&&(d=_.tl,y=_.tr,h=_.bl,x=_.br,p=_.labelAngle,g=_.minAngle,v=_.maxAngle,m=_.anchor,I=_.mosaicRect,this._glyphBufferDataStorage.has(_.page)||this._glyphBufferDataStorage.set(_.page,[]),this._glyphBufferDataStorage.get(_.page).push({glyphAnchor:[m.x,m.y],tl:[d.x,d.y],tr:[y.x,y.y],bl:[h.x,h.y],br:[x.x,x.y],xmin:I.x,ymin:I.y,xmax:I.x+I.width,ymax:I.y+I.height,labelAngle:p,minAngle:g,maxAngle:v,minLod:c,maxLod:f,placementLod:o,symbolInstance:e,ddAttributes:a}))}static _pushAnchors(e,n,r,i){r+=i;let a=0;const o=n.length-1;for(let h=0;h<o;h++)a+=w.E9.distance(n[h],n[h+1]);let l=i||r;if(l*=.5,a<=l)return;const c=l/a;let f=0,d=-(r=a/Math.max(Math.round(a/r),1))/2;const y=n.length-1;for(let h=0;h<y;h++){const x=n[h],p=n[h+1],g=p.x-x.x,v=p.y-x.y,m=Math.sqrt(g*g+v*v);let I;for(;d+r<f+m;){d+=r;const _=(d-f)/m,E=(0,S.sX)(x.x,p.x,_),R=(0,S.sX)(x.y,p.y,_);void 0===I&&(I=Math.atan2(v,g)),e.push(new dt(E,R,I,h,c))}f+=m}}static _pushCenterAnchor(e,n){let r=0;const i=n.length-1;for(let c=0;c<i;c++)r+=w.E9.distance(n[c],n[c+1]);const a=r/2;let o=0;const l=n.length-1;for(let c=0;c<l;c++){const f=n[c],d=n[c+1],y=d.x-f.x,h=d.y-f.y,x=Math.sqrt(y*y+h*h);if(a<o+x){const p=(a-o)/x,g=(0,S.sX)(f.x,d.x,p),v=(0,S.sX)(f.y,d.y,p),m=Math.atan2(h,y);return void e.push(new dt(g,v,m,c,0))}o+=x}}static _deviation(e,n,r){return Math.atan2((n.x-e.x)*(r.y-n.y)-(n.y-e.y)*(r.x-n.x),(n.x-e.x)*(r.x-n.x)+(n.y-e.y)*(r.y-n.y))}static _honorsTextMaxAngle(e,n,r,i,a){let o=0;const l=r/2;let c=new w.E9(n.x,n.y),f=n.segment+1;for(;o>-l;){if(--f,f<0)return!1;o-=w.E9.distance(e[f],c),c=e[f]}o+=w.E9.distance(e[f],e[f+1]);const d=[];let y=0;const h=e.length;for(;o<l;){const x=e[f];let p,g=f;do{if(++g,g===h)return!1;p=e[g]}while(p.isEqual(x));let v,m=g;do{if(++m,m===h)return!1;v=e[m]}while(v.isEqual(p));const I=this._deviation(x,p,v);for(d.push({deviation:I,distToAnchor:o}),y+=I;o-d[0].distToAnchor>a;)y-=d.shift().deviation;if(Math.abs(y)>i)return!1;o+=w.E9.distance(p,v),f=g}return!0}static _smoothVertices(e,n){if(n<=0)return e;let r=e.length;if(r<3)return e;const i=[];let a=0,o=0;i.push(0);for(let g=1;g<r;g++){const v=w.E9.distance(e[g],e[g-1]);v>0&&(a+=v,i.push(a),o++,o!==g&&(e[o]=e[g]))}if(r=o+1,r<3)return e;n=Math.min(n,.2*a);const l=e[0].x,c=e[0].y,f=e[r-1].x,d=e[r-1].y,y=w.E9.sub(e[0],e[1]);y.normalize(),e[0].x+=n*y.x,e[0].y+=n*y.y,y.assignSub(e[r-1],e[r-2]),y.normalize(),e[r-1].x+=n*y.x,e[r-1].y+=n*y.y,i[0]-=n,i[r-1]+=n;const h=[];h.push(new w.E9(l,c));const x=1e-6,p=.5*n;for(let g=1;g<r-1;g++){let v=0,m=0,I=0;for(let _=g-1;_>=0;_--){const E=p+i[_+1]-i[g];if(E<0)break;const R=i[_+1]-i[_],b=i[g]-i[_]<p?1:E/R;if(b<x)break;const L=b*b,O=b*E-.5*L*R,A=b*R/n,V=e[_+1],z=e[_].x-V.x,D=e[_].y-V.y;v+=A/O*(V.x*b*E+.5*L*(E*z-R*V.x)-L*b*R*z/3),m+=A/O*(V.y*b*E+.5*L*(E*D-R*V.y)-L*b*R*D/3),I+=A}for(let _=g+1;_<r;_++){const E=p-i[_-1]+i[g];if(E<0)break;const R=i[_]-i[_-1],b=i[_]-i[g]<p?1:E/R;if(b<x)break;const L=b*b,O=b*E-.5*L*R,A=b*R/n,V=e[_-1],z=e[_].x-V.x,D=e[_].y-V.y;v+=A/O*(V.x*b*E+.5*L*(E*z-R*V.x)-L*b*R*z/3),m+=A/O*(V.y*b*E+.5*L*(E*D-R*V.y)-L*b*R*D/3),I+=A}h.push(new w.E9(v/I,m/I))}return h.push(new w.E9(f,d)),e[0].x=l,e[0].y=c,e[r-1].x=f,e[r-1].y=d,h}static _pushCentroid(e,n){const l=n.length-1;let c=0,f=0,d=0,y=n[0].x,h=n[0].y;y>4096&&(y=4096),y<0&&(y=0),h>4096&&(h=4096),h<0&&(h=0);for(let x=1;x<l;x++){let p=n[x].x,g=n[x].y,v=n[x+1].x,m=n[x+1].y;p>4096&&(p=4096),p<0&&(p=0),g>4096&&(g=4096),g<0&&(g=0),v>4096&&(v=4096),v<0&&(v=0),m>4096&&(m=4096),m<0&&(m=0);const I=(p-y)*(m-h)-(v-y)*(g-h);c+=I*(y+p+v),f+=I*(h+g+m),d+=I}c/=3*d,f/=3*d,isNaN(c)||isNaN(f)||e.push(new dt(c,f))}}tt._bidiEngine=new bt.Z,function(u){u[u.INITIALIZED=0]="INITIALIZED",u[u.NO_DATA=1]="NO_DATA",u[u.READY=2]="READY",u[u.MODIFIED=3]="MODIFIED",u[u.INVALID=4]="INVALID"}(ot||(ot={}));class Ut{constructor(e,n,r,i,a){if(this._pbfTiles={},this._tileClippers={},this._client=r,this._tile=n,a){this._styleLayerUIDs=new Set;for(const d of a)this._styleLayerUIDs.add(d)}this._styleRepository=i,this._layers=this._styleRepository?.layers??[];const[o,l,c]=n.tileKey.split("/").map(parseFloat);this._level=o;const f=8+Math.max(5*(this._level-14),0);for(const d of Object.keys(e)){const y=e[d];if(this._pbfTiles[d]=new st.Z(new Uint8Array(y.protobuff),new DataView(y.protobuff)),y.refKey){const[h]=y.refKey.split("/").map(parseFloat),x=o-h;if(x>0){const p=(1<<x)-1;this._tileClippers[d]=new w.bN(x,l&p,c&p,8,f)}}this._tileClippers[d]||(this._tileClippers[d]=new w.I6)}}_canParseStyleLayer(e){return!this._styleLayerUIDs||this._styleLayerUIDs.has(e)}parse(e){var n=this;return(0,U.Z)(function*(){const r=(0,it.j)(),i=n._initialize(e),{returnedBuckets:a}=i;n._processLayers(i),n._linkReferences(i),n._filterFeatures(i);const o=[],l=new Set,c=(y,h)=>{l.has(y)||(o.push({name:y,repeat:h}),l.add(y))},f={};for(const y of a)y.getResources(y.tileClipper,c,f);if(n._tile.status===ot.INVALID)return[];const d=n._fetchResources(o,f,e);return Promise.all([...d,r]).then(()=>n._processFeatures(i.returnedBuckets))})()}_initialize(e){return{signal:e&&e.signal,sourceNameToTileData:this._parseTileData(this._pbfTiles),layers:this._layers,zoom:this._level,sourceNameToTileClipper:this._tileClippers,sourceNameToUniqueSourceLayerBuckets:{},sourceNameToUniqueSourceLayers:{},returnedBuckets:[],layerIdToBucket:{},referencerUIDToReferencedId:new Map}}_processLayers(e){const{sourceNameToTileData:n,layers:r,zoom:i,sourceNameToTileClipper:a,sourceNameToUniqueSourceLayerBuckets:o,sourceNameToUniqueSourceLayers:l,returnedBuckets:c,layerIdToBucket:f,referencerUIDToReferencedId:d}=e;for(let y=r.length-1;y>=0;y--){const h=r[y];if(!this._canParseStyleLayer(h.uid)||h.minzoom&&i<Math.floor(h.minzoom)||h.maxzoom&&i>=h.maxzoom||h.type===B.fR.BACKGROUND||!n[h.source]||!a[h.source])continue;const p=a[h.source],g=h.sourceLayer,v=n[h.source][g];if(v){let m=l[h.source];if(m||(m=l[h.source]=new Set),m.add(h.sourceLayer),h.refLayerId)d.set(h.uid,h.refLayerId);else{const I=this._createBucket(h);if(I){I.layerUIDs=[h.uid],I.layerExtent=v.extent,I.tileClipper=p;let _=o[h.source];_||(_=o[h.source]={});let E=_[g];E||(E=_[g]=[]),E.push(I),c.push(I),f[h.id]=I}}}}}_linkReferences(e){const{layerIdToBucket:n,referencerUIDToReferencedId:r}=e;r.forEach((i,a)=>{n[i]&&n[i].layerUIDs.push(a)})}_filterFeatures(e){const{signal:n,sourceNameToTileData:r,sourceNameToUniqueSourceLayerBuckets:i,sourceNameToUniqueSourceLayers:a}=e,o=10*this._level,l=10*(this._level+1),c=[],f=[];for(const d of Object.keys(a))a[d].forEach(y=>{c.push(y),f.push(d)});for(let d=0;d<c.length;d++){const y=f[d],h=c[d];if(!r[y]||!i[y])continue;const x=r[y][h],p=i[y][h];if(!p||0===p.length)continue;if((0,wt.Hc)(n))return;const g=x.getData();for(;g.nextTag(2);){const v=g.getMessage(),m=new K(v,x);v.release();const I=m.values;if(I){const _=I._minzoom;if(_&&_>=l)continue;const E=I._maxzoom;if(E&&E<=o)continue}for(const _ of p)_.pushFeature(m)}}}_fetchResources(e,n,r){const i=[],a=this._tile.getWorkerTileHandler();let o,l;e.length>0&&(o=a.fetchSprites(e,this._client,r),i.push(o));for(const c in n){const f=n[c];f.size>0&&(l=a.fetchGlyphs(this._tile.tileKey,c,f,this._client,r),i.push(l))}return i}_processFeatures(e){const n=e.filter(r=>r.hasFeatures()||this._canParseStyleLayer(r.layer.uid));for(const r of n)r.processFeatures(r.tileClipper);return n}_parseTileData(e){const n={};for(const r of Object.keys(e)){const i=e[r],a={};for(;i.next();)switch(i.tag()){case 3:{const o=i.getMessage(),l=new St(o);o.release(),a[l.name]=l;break}default:i.skip()}n[r]=a}return n}_createBucket(e){switch(e.type){case B.fR.BACKGROUND:return null;case B.fR.FILL:return this._createFillBucket(e);case B.fR.LINE:return this._createLineBucket(e);case B.fR.CIRCLE:return this._createCircleBucket(e);case B.fR.SYMBOL:return this._createSymbolBucket(e)}}_createFillBucket(e){return new Gt(e,this._level,this._tile.getWorkerTileHandler().getSpriteItems(),new H(e.fillMaterial.getStride()),new M,new Y(e.outlineMaterial.getStride()),new M)}_createLineBucket(e){return new Xt(e,this._level,this._tile.getWorkerTileHandler().getSpriteItems(),new Ot(e.lineMaterial.getStride()),new M)}_createCircleBucket(e){return new at(e,this._level,this._tile.getWorkerTileHandler().getSpriteItems(),new Wt(e.circleMaterial.getStride()),new M)}_createSymbolBucket(e){const n=this._tile;return new tt(e,this._level,new X(e.iconMaterial.getStride()),new M,new X(e.textMaterial.getStride()),new M,n.placementEngine,n.getWorkerTileHandler())}}class Pt{constructor(e,n,r,i){this.status=ot.INITIALIZED,this.placementEngine=new xt,this.tileKey=e,this.refKeys=n,this._workerTileHandler=r,this._styleRepository=i}release(){this.tileKey="",this.refKeys=null,this.status=ot.INITIALIZED,this._workerTileHandler=null}parse(e,n){var r=this;return(0,U.Z)(function*(){const i=n&&n.signal;if((0,Dt.pC)(i)){const y=()=>{i.removeEventListener("abort",y),r.status=ot.INVALID};i.addEventListener("abort",y)}let a;const o={bucketsWithData:[],emptyBuckets:null};try{a=yield r._parse(e,n)}catch(y){if((0,wt.D_)(y))throw y;return{result:o,transferList:[]}}r.status=ot.READY;const l=o.bucketsWithData,c=[];for(const y of a)if(y.hasFeatures()){const h=y.serialize();l.push(h)}else c.push(y.layer.uid);const f=[...l];let d=null;return c.length>0&&(d=Uint32Array.from(c),f.push(d.buffer)),o.emptyBuckets=d,{result:o,transferList:f}})()}setObsolete(){this.status=ot.INVALID}getLayers(){return this._workerTileHandler.getLayers()}getWorkerTileHandler(){return this._workerTileHandler}_parse(e,n){var r=this;return(0,U.Z)(function*(){const i=e.sourceName2DataAndRefKey;return 0===Object.keys(i).length?[]:(r.status=ot.MODIFIED,new Ut(i,r,n.client,r._styleRepository,e.styleLayerUIDs).parse(n))})()}}var t=k(78364);class Qt{constructor(){this._spriteInfo={},this._glyphInfo={}}reset(){return this._spriteInfo={},this._glyphInfo={},Promise.resolve()}getLayers(){return this._styleRepository?.layers??[]}createTileAndParse(e,n){var r=this;return(0,U.Z)(function*(){const{key:i}=e,a={};for(const l of Object.keys(e.sourceName2DataAndRefKey))a[l]=e.sourceName2DataAndRefKey[l].refKey;const o=new Pt(i,a,r,r._styleRepository);try{return yield o.parse(e,n)}catch(l){if(o.setObsolete(),o.release(),!(0,wt.D_)(l))throw l;return null}})()}updateStyle(e){if(!e||0===e.length||!this._styleRepository)return;const n=this._styleRepository;for(const r of e){const a=r.data;switch(r.type){case j.Fr.PAINTER_CHANGED:n.setPaintProperties(a.layer,a.paint);break;case j.Fr.LAYOUT_CHANGED:n.setLayoutProperties(a.layer,a.layout);break;case j.Fr.LAYER_REMOVED:n.deleteStyleLayer(a.layer);break;case j.Fr.LAYER_CHANGED:n.setStyleLayer(a.layer,a.index);break;case j.Fr.SPRITES_CHANGED:this._spriteInfo={}}}}setStyle(e){this._styleRepository=new t.Z(e),this._spriteInfo={},this._glyphInfo={}}fetchSprites(e,n,r){const i=[],a=this._spriteInfo;for(const o of e)void 0===a[o.name]&&i.push(o);return 0===i.length?Promise.resolve():n.invoke("getSprites",i,{signal:r&&r.signal}).then(o=>{for(const l in o)a[l]=o[l]})}getSpriteItems(){return this._spriteInfo}fetchGlyphs(e,n,r,i,a){const o=[];let l=this._glyphInfo[n];return l?r.forEach(c=>{l[c]||o.push(c)}):(l=this._glyphInfo[n]=[],r.forEach(c=>o.push(c))),0===o.length?Promise.resolve():i.invoke("getGlyphs",{tileID:e,font:n,codePoints:o},a).then(c=>{for(let f=0;f<c.length;f++)c[f]&&(l[f]=c[f])})}getGlyphItems(e){return this._glyphInfo[e]}}},1268:(re,Ft,k)=>{k.d(Ft,{EE:()=>j,R:()=>Dt,_5:()=>mt,aF:()=>w,f2:()=>nt,fD:()=>ft,fR:()=>wt,nR:()=>Mt,r1:()=>gt,vL:()=>S});var wt,j,Dt,w,S,Mt,mt,ft,gt,P,U=k(7547);(P=wt||(wt={}))[P.BACKGROUND=0]="BACKGROUND",P[P.FILL=1]="FILL",P[P.LINE=2]="LINE",P[P.SYMBOL=3]="SYMBOL",P[P.CIRCLE=4]="CIRCLE",function(P){P[P.VISIBLE=0]="VISIBLE",P[P.NONE=1]="NONE"}(j||(j={})),function(P){P[P.POINT=0]="POINT",P[P.LINE=1]="LINE",P[P.LINE_CENTER=2]="LINE_CENTER"}(Dt||(Dt={})),function(P){P[P.MAP=0]="MAP",P[P.VIEWPORT=1]="VIEWPORT",P[P.AUTO=2]="AUTO"}(w||(w={})),function(P){P[P.AUTO=0]="AUTO",P[P.LEFT=1]="LEFT",P[P.CENTER=2]="CENTER",P[P.RIGHT=3]="RIGHT"}(S||(S={})),function(P){P[P.CENTER=0]="CENTER",P[P.LEFT=1]="LEFT",P[P.RIGHT=2]="RIGHT",P[P.TOP=3]="TOP",P[P.BOTTOM=4]="BOTTOM",P[P.TOP_LEFT=5]="TOP_LEFT",P[P.TOP_RIGHT=6]="TOP_RIGHT",P[P.BOTTOM_LEFT=7]="BOTTOM_LEFT",P[P.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"}(Mt||(Mt={})),function(P){P[P.NONE=0]="NONE",P[P.UPPERCASE=1]="UPPERCASE",P[P.LOWERCASE=2]="LOWERCASE"}(mt||(mt={})),function(P){P[P.MAP=0]="MAP",P[P.VIEWPORT=1]="VIEWPORT"}(ft||(ft={})),function(P){P[P.HORIZONTAL=0]="HORIZONTAL",P[P.VERTICAL=1]="VERTICAL"}(gt||(gt={}));class nt{}nt.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:j.VISIBLE}},nt.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:j.VISIBLE}},nt.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:j.VISIBLE},"line-cap":{type:"enum",values:["butt","round","square"],default:U.RL.BUTT},"line-join":{type:"enum",values:["bevel","round","miter"],default:U.AH.MITER},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}},nt.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:j.VISIBLE},"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",values:["point","line","line-center"],default:Dt.POINT},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:Mt.CENTER},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:w.AUTO},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:Mt.CENTER},"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:S.CENTER},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:w.AUTO},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:mt.NONE},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:[gt.HORIZONTAL]}},nt.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:j.VISIBLE}},nt.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}},nt.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:ft.MAP}},nt.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:ft.MAP},"line-width":{type:"number",minimum:0,default:1}},nt.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:ft.MAP},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:ft.MAP}},nt.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}},nt.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:ft.MAP}}},46519:(re,Ft,k)=>{k.d(Ft,{z:()=>Et});var U=k(7547),wt=k(39351);function j(N,C){return N.x===C.x&&N.y===C.y}function w(N,C){return N.x=C.y,N.y=-C.x,N}function S(N,C){return N.x=-C.y,N.y=C.x,N}function Mt(N,C){return N.x=C.x,N.y=C.y,N}function mt(N,C){return N.x=-C.x,N.y=-C.y,N}function ft(N){return Math.sqrt(N.x*N.x+N.y*N.y)}function gt(N,C){return N.x*C.y-N.y*C.x}function nt(N,C){return N.x*C.x+N.y*C.y}function P(N,C,B,lt){return N.x=C.x*B+C.y*lt,N.y=C.x*lt-C.y*B,N}class Et{constructor(C,B,lt){this._writeVertex=C,this._writeTriangle=B,this._canUseThinTessellation=lt,this._prevNormal={x:void 0,y:void 0},this._nextNormal={x:void 0,y:void 0},this._textureNormalLeft={x:0,y:1},this._textureNormalRight={x:0,y:-1},this._textureNormal={x:void 0,y:void 0},this._joinNormal={x:void 0,y:void 0},this._inner={x:void 0,y:void 0},this._outer={x:void 0,y:void 0},this._roundStart={x:void 0,y:void 0},this._roundEnd={x:void 0,y:void 0},this._startBreak={x:void 0,y:void 0},this._endBreak={x:void 0,y:void 0},this._innerPrev={x:void 0,y:void 0},this._innerNext={x:void 0,y:void 0},this._bevelStart={x:void 0,y:void 0},this._bevelEnd={x:void 0,y:void 0},this._bevelMiddle={x:void 0,y:void 0}}tessellate(C,B){(function Dt(N){if(!N)return;const C=N.length;if(C<=1)return;let B=0;for(let lt=1;lt<C;lt++)j(N[lt],N[B])||++B===lt||(N[B]=N[lt]);N.length=B+1})(C),this._canUseThinTessellation&&B.halfWidth<wt.tQ&&!B.offset?this._tessellateThin(C,B):this._tessellate(C,B)}_tessellateThin(C,B){if(C.length<2)return;const lt=B.wrapDistance||65535;let _t=B.initialDistance||0,It=!1,yt=C[0].x,vt=C[0].y;const dt=C.length;for(let Tt=1;Tt<dt;++Tt){It&&(It=!1,_t=0);let Ct=C[Tt].x,Bt=C[Tt].y,xt=Ct-yt,st=Bt-vt,it=Math.sqrt(xt*xt+st*st);if(xt/=it,st/=it,_t+it>lt){It=!0;const T=(lt-_t)/it;it=lt-_t,Ct=(1-T)*yt+T*Ct,Bt=(1-T)*vt+T*Bt,--Tt}const G=this._writeVertex(yt,vt,0,0,xt,st,st,-xt,0,-1,_t),K=this._writeVertex(yt,vt,0,0,xt,st,-st,xt,0,1,_t);_t+=it;const W=this._writeVertex(Ct,Bt,0,0,xt,st,st,-xt,0,-1,_t),M=this._writeVertex(Ct,Bt,0,0,xt,st,-st,xt,0,1,_t);this._writeTriangle(G,K,W),this._writeTriangle(K,W,M),yt=Ct,vt=Bt}}_tessellate(C,B){const _t=C[C.length-1],It=j(C[0],_t);if(C.length<(It?3:2))return;const vt=B.pixelCoordRatio,dt=null!=B.capType?B.capType:U.RL.BUTT,Tt=null!=B.joinType?B.joinType:U.AH.MITER,Ct=null!=B.miterLimit?Math.min(B.miterLimit,4):2,Bt=null!=B.roundLimit?Math.min(B.roundLimit,1.05):1.05,xt=null!=B.halfWidth?B.halfWidth:2,st=!!B.textured;let it,G,K,W=null;const M=this._prevNormal,T=this._nextNormal;let St=-1,Ot=-1;const H=this._joinNormal;let Y,X;const Wt=this._textureNormalLeft,Vt=this._textureNormalRight,at=this._textureNormal;let Q=-1,$=-1;const Gt=B.wrapDistance||65535;let J=B.initialDistance||0;const Yt=this._writeVertex,Xt=this._writeTriangle,q=(bt,zt,Nt,ut,Lt,tt)=>{const ot=Yt(G,K,Y,X,Nt,ut,bt,zt,Lt,tt,J);return Q>=0&&$>=0&&ot>=0&&Xt(Q,$,ot),Q=$,$=ot,ot};It&&(it=C[C.length-2],T.x=_t.x-it.x,T.y=_t.y-it.y,Ot=ft(T),T.x/=Ot,T.y/=Ot);let Ht=!1;for(let bt=0;bt<C.length;++bt){if(Ht&&(Ht=!1,J=0),it&&(M.x=-T.x,M.y=-T.y,St=Ot,J+St>Gt&&(Ht=!0)),Ht){const F=(Gt-J)/St;St=Gt-J,it={x:(1-F)*it.x+F*C[bt].x,y:(1-F)*it.y+F*C[bt].y},--bt}else it=C[bt];G=it.x,K=it.y;const zt=bt<=0&&!Ht,Nt=bt===C.length-1;if(zt||(J+=St),W=Nt?It?C[1]:null:C[bt+1],W?(T.x=W.x-G,T.y=W.y-K,Ot=ft(T),T.x/=Ot,T.y/=Ot):(T.x=void 0,T.y=void 0),!It){if(zt){S(H,T),Y=H.x,X=H.y,dt===U.RL.SQUARE&&(q(-T.y-T.x,T.x-T.y,T.x,T.y,0,-1),q(T.y-T.x,-T.x-T.y,T.x,T.y,0,1)),dt===U.RL.ROUND&&(q(-T.y-T.x,T.x-T.y,T.x,T.y,-1,-1),q(T.y-T.x,-T.x-T.y,T.x,T.y,-1,1)),dt!==U.RL.ROUND&&dt!==U.RL.BUTT||(q(-T.y,T.x,T.x,T.y,0,-1),q(T.y,-T.x,T.x,T.y,0,1));continue}if(Nt){w(H,M),Y=H.x,X=H.y,dt!==U.RL.ROUND&&dt!==U.RL.BUTT||(q(M.y,-M.x,-M.x,-M.y,0,-1),q(-M.y,M.x,-M.x,-M.y,0,1)),dt===U.RL.SQUARE&&(q(M.y-M.x,-M.x-M.y,-M.x,-M.y,0,-1),q(-M.y-M.x,M.x-M.y,-M.x,-M.y,0,1)),dt===U.RL.ROUND&&(q(M.y-M.x,-M.x-M.y,-M.x,-M.y,1,-1),q(-M.y-M.x,M.x-M.y,-M.x,-M.y,1,1));continue}}let ut,Lt,tt=-gt(M,T);if(Math.abs(tt)<.01)nt(M,T)>0?(H.x=M.x,H.y=M.y,tt=1,ut=Number.MAX_VALUE,Lt=!0):(S(H,T),tt=1,ut=1,Lt=!1);else{H.x=(M.x+T.x)/tt,H.y=(M.y+T.y)/tt,ut=ft(H);const F=(ut-1)*xt*vt;Lt=ut>4||F>St&&F>Ot}Y=H.x,X=H.y;let ot=Tt;switch(Tt){case U.AH.BEVEL:ut<1.05&&(ot=U.AH.MITER);break;case U.AH.ROUND:ut<Bt&&(ot=U.AH.MITER);break;case U.AH.MITER:ut>Ct&&(ot=U.AH.BEVEL)}switch(ot){case U.AH.MITER:if(q(H.x,H.y,-M.x,-M.y,0,-1),q(-H.x,-H.y,-M.x,-M.y,0,1),Nt)break;if(st){const F=Ht?0:J;Q=this._writeVertex(G,K,Y,X,T.x,T.y,H.x,H.y,0,-1,F),$=this._writeVertex(G,K,Y,X,T.x,T.y,-H.x,-H.y,0,1,F)}break;case U.AH.BEVEL:{const F=tt<0;let ct,ht,Ut,Pt;if(F){const e=Q;Q=$,$=e,ct=Wt,ht=Vt}else ct=Vt,ht=Wt;if(Lt)Ut=F?S(this._innerPrev,M):w(this._innerPrev,M),Pt=F?w(this._innerNext,T):S(this._innerNext,T);else{const e=F?mt(this._inner,H):Mt(this._inner,H);Ut=e,Pt=e}const t=F?w(this._bevelStart,M):S(this._bevelStart,M);q(Ut.x,Ut.y,-M.x,-M.y,ct.x,ct.y);const Qt=q(t.x,t.y,-M.x,-M.y,ht.x,ht.y);if(Nt)break;const u=F?S(this._bevelEnd,T):w(this._bevelEnd,T);if(Lt){const e=this._writeVertex(G,K,Y,X,-M.x,-M.y,0,0,0,0,J);Q=this._writeVertex(G,K,Y,X,T.x,T.y,Pt.x,Pt.y,ct.x,ct.y,J),$=this._writeVertex(G,K,Y,X,T.x,T.y,u.x,u.y,ht.x,ht.y,J),this._writeTriangle(Qt,e,$)}else{if(st){const e=this._bevelMiddle;e.x=(t.x+u.x)/2,e.y=(t.y+u.y)/2,P(at,e,-M.x,-M.y),q(e.x,e.y,-M.x,-M.y,at.x,at.y),P(at,e,T.x,T.y),Q=this._writeVertex(G,K,Y,X,T.x,T.y,e.x,e.y,at.x,at.y,J),$=this._writeVertex(G,K,Y,X,T.x,T.y,Pt.x,Pt.y,ct.x,ct.y,J)}else{const e=Q;Q=$,$=e}q(u.x,u.y,T.x,T.y,ht.x,ht.y)}if(F){const e=Q;Q=$,$=e}break}case U.AH.ROUND:{const F=tt<0;let ct,ht;if(F){const g=Q;Q=$,$=g,ct=Wt,ht=Vt}else ct=Vt,ht=Wt;const Ut=F?mt(this._inner,H):Mt(this._inner,H);let Pt,t;Lt?(Pt=F?S(this._innerPrev,M):w(this._innerPrev,M),t=F?w(this._innerNext,T):S(this._innerNext,T)):(Pt=Ut,t=Ut);const Qt=F?w(this._roundStart,M):S(this._roundStart,M),u=F?S(this._roundEnd,T):w(this._roundEnd,T),e=q(Pt.x,Pt.y,-M.x,-M.y,ct.x,ct.y),n=q(Qt.x,Qt.y,-M.x,-M.y,ht.x,ht.y);if(Nt)break;const r=this._writeVertex(G,K,Y,X,-M.x,-M.y,0,0,0,0,J);Lt||this._writeTriangle(Q,$,r);const i=mt(this._outer,Ut),a=this._writeVertex(G,K,Y,X,T.x,T.y,u.x,u.y,ht.x,ht.y,J);let o,l;const c=ut>2;if(c){let g;ut!==Number.MAX_VALUE?(i.x/=ut,i.y/=ut,g=nt(M,i),g=(ut*(g*g-1)+1)/g):g=-1,o=F?w(this._startBreak,M):S(this._startBreak,M),o.x+=M.x*g,o.y+=M.y*g,l=F?S(this._endBreak,T):w(this._endBreak,T),l.x+=T.x*g,l.y+=T.y*g}P(at,i,-M.x,-M.y);const f=this._writeVertex(G,K,Y,X,-M.x,-M.y,i.x,i.y,at.x,at.y,J);P(at,i,T.x,T.y);const d=st?this._writeVertex(G,K,Y,X,T.x,T.y,i.x,i.y,at.x,at.y,J):f,y=r,h=st?this._writeVertex(G,K,Y,X,T.x,T.y,0,0,0,0,J):r;let x=-1,p=-1;if(c&&(P(at,o,-M.x,-M.y),x=this._writeVertex(G,K,Y,X,-M.x,-M.y,o.x,o.y,at.x,at.y,J),P(at,l,T.x,T.y),p=this._writeVertex(G,K,Y,X,T.x,T.y,l.x,l.y,at.x,at.y,J)),st?c?(this._writeTriangle(y,n,x),this._writeTriangle(y,x,f),this._writeTriangle(h,d,p),this._writeTriangle(h,p,a)):(this._writeTriangle(y,n,f),this._writeTriangle(h,d,a)):c?(this._writeTriangle(r,n,x),this._writeTriangle(r,x,p),this._writeTriangle(r,p,a)):(this._writeTriangle(r,n,f),this._writeTriangle(r,d,a)),Lt?(Q=this._writeVertex(G,K,Y,X,T.x,T.y,t.x,t.y,ct.x,ct.y,J),$=a):(Q=st?this._writeVertex(G,K,Y,X,T.x,T.y,t.x,t.y,ct.x,ct.y,J):e,this._writeTriangle(Q,h,a),$=a),F){const g=Q;Q=$,$=g}break}}}}}},39351:(re,Ft,k)=>{k.d(Ft,{$0:()=>nt,AI:()=>j,Al:()=>xt,By:()=>M,C1:()=>t,CQ:()=>u,CU:()=>ut,D3:()=>Bt,Ex:()=>vt,I_:()=>S,Ic:()=>st,Ij:()=>K,Ip:()=>ct,Iv:()=>i,Iw:()=>dt,Jw:()=>H,MI:()=>Pt,QU:()=>Ot,SD:()=>o,Tz:()=>e,Uh:()=>Qt,V4:()=>Nt,XD:()=>y,XJ:()=>F,Xj:()=>St,Zd:()=>Xt,_5:()=>Wt,_6:()=>a,a:()=>Lt,aK:()=>Q,dn:()=>zt,e0:()=>r,eF:()=>Tt,eV:()=>P,f2:()=>W,fL:()=>ot,iJ:()=>it,iV:()=>q,jk:()=>l,kF:()=>Y,lK:()=>Gt,m4:()=>J,mx:()=>T,nM:()=>G,nb:()=>d,oK:()=>n,pU:()=>at,ru:()=>w,tQ:()=>bt,u4:()=>f,uG:()=>Yt,vw:()=>c,xl:()=>Vt,xm:()=>Et,yP:()=>X});const j=1e-30,w=4294967295,S=512,nt=8,P=10,Et=29,vt=24,dt=8,Tt={metrics:{width:15,height:17,left:0,top:-7,advance:14}},Bt=0,xt=0,st=0,it=1,G=2,K=3,W=4,M=5,T=6,St=12,Ot=5,H=6,Y=5,X=6,Wt=0,Vt=1,at=2,Q=3,Gt=4,J=2,Yt=1,Xt=2,q=4,bt=1.05,zt=3,Nt=5,ut=6,Lt=1.15,ot=2,F=8,ct=500,Pt=10,t=1024,Qt=2,u=0,e=1,n=4,r=8,i=16,a=4,o=1,l=4,c=8,f=128,d=4,y=2}}]);