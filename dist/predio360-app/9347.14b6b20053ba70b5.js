"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[9347],{36592:(Mt,G,u)=>{u.d(G,{Q:()=>y});var g=u(85931),z=u(62208),Y=u(77029),H=u(14259);class y{constructor(e=9,i){this._compareMinX=W,this._compareMinY=M,this._toBBox=s=>s,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&("function"==typeof i?this._toBBox=i:this._initFormat(i)),this.clear()}destroy(){this.clear(),Z.prune(),V.prune(),w.prune(),x.prune()}all(e){this._all(this._data,e)}search(e,i){let s=this._data;const h=this._toBBox;if(F(e,s))for(Z.clear();s;){for(let c=0,m=s.children.length;c<m;c++){const _=s.children[c],C=s.leaf?h(_):_;F(e,C)&&(s.leaf?i(_):Q(e,C)?this._all(_,i):Z.push(_))}s=Z.pop()}}collides(e){let i=this._data;const s=this._toBBox;if(!F(e,i))return!1;for(Z.clear();i;){for(let h=0,c=i.children.length;h<c;h++){const m=i.children[h],_=i.leaf?s(m):m;if(F(e,_)){if(i.leaf||Q(e,_))return!0;Z.push(m)}}i=Z.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let s=0,h=e.length;s<h;s++)this.insert(e[s]);return this}let i=this._build(e.slice(0,e.length),0,e.length-1,0);if(this._data.children.length)if(this._data.height===i.height)this._splitRoot(this._data,i);else{if(this._data.height<i.height){const s=this._data;this._data=i,i=s}this._insert(i,this._data.height-i.height-1,!0)}else this._data=i;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new d([]),this}remove(e){if(!e)return this;let i,s=this._data,h=null,c=0,m=!1;const _=this._toBBox(e);for(w.clear(),x.clear();s||w.length>0;){if(s||(s=(0,z.j0)(w.pop()),h=w.data[w.length-1],c=x.pop()??0,m=!0),s.leaf&&(i=(0,g.cq)(s.children,e,s.children.length,s.indexHint),-1!==i))return s.children.splice(i,1),w.push(s),this._condense(w),this;m||s.leaf||!Q(s,_)?h?(c++,s=h.children[c],m=!1):s=null:(w.push(s),x.push(c),c=0,h=s,s=s.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_all(e,i){let s=e;for(V.clear();s;){if(!0===s.leaf)for(const h of s.children)i(h);else V.pushArray(s.children);s=V.pop()??null}}_build(e,i,s,h){const c=s-i+1;let m=this._maxEntries;if(c<=m){const O=new d(e.slice(i,s+1));return j(O,this._toBBox),O}h||(h=Math.ceil(Math.log(c)/Math.log(m)),m=Math.ceil(c/m**(h-1)));const _=new v([]);_.height=h;const C=Math.ceil(c/m),S=C*Math.ceil(Math.sqrt(m));tt(e,i,s,S,this._compareMinX);for(let O=i;O<=s;O+=S){const X=Math.min(O+S-1,s);tt(e,O,X,C,this._compareMinY);for(let U=O;U<=X;U+=C){const $=Math.min(U+C-1,X);_.children.push(this._build(e,U,$,h-1))}}return j(_,this._toBBox),_}_chooseSubtree(e,i,s,h){for(;h.push(i),!0!==i.leaf&&h.length-1!==s;){let c,m=1/0,_=1/0;for(let C=0,S=i.children.length;C<S;C++){const O=i.children[C],X=I(O),U=mt(e,O)-X;U<_?(_=U,m=X<m?X:m,c=O):U===_&&X<m&&(m=X,c=O)}i=c||i.children[0]}return i}_insert(e,i,s){const c=s?e:(0,this._toBBox)(e);w.clear();const m=this._chooseSubtree(c,this._data,i,w);for(m.children.push(e),D(m,c);i>=0&&w.data[i].children.length>this._maxEntries;)this._split(w,i),i--;this._adjustParentBBoxes(c,w,i)}_split(e,i){const s=e.data[i],h=s.children.length,c=this._minEntries;this._chooseSplitAxis(s,c,h);const m=this._chooseSplitIndex(s,c,h);if(!m)return void console.log("  Error: assertion failed at PooledRBush._split: no valid split index");const _=s.children.splice(m,s.children.length-m),C=s.leaf?new d(_):new v(_);C.height=s.height,j(s,this._toBBox),j(C,this._toBBox),i?e.data[i-1].children.push(C):this._splitRoot(s,C)}_splitRoot(e,i){this._data=new v([e,i]),this._data.height=e.height+1,j(this._data,this._toBBox)}_chooseSplitIndex(e,i,s){let h,c,m;h=c=1/0;for(let _=i;_<=s-i;_++){const C=P(e,0,_,this._toBBox),S=P(e,_,s,this._toBBox),O=xt(C,S),X=I(C)+I(S);O<h?(h=O,m=_,c=X<c?X:c):O===h&&X<c&&(c=X,m=_)}return m}_chooseSplitAxis(e,i,s){const h=e.leaf?this._compareMinX:W,c=e.leaf?this._compareMinY:M;this._allDistMargin(e,i,s,h)<this._allDistMargin(e,i,s,c)&&e.children.sort(h)}_allDistMargin(e,i,s,h){e.children.sort(h);const c=this._toBBox,m=P(e,0,i,c),_=P(e,s-i,s,c);let C=b(m)+b(_);for(let S=i;S<s-i;S++){const O=e.children[S];D(m,e.leaf?c(O):O),C+=b(m)}for(let S=s-i-1;S>=i;S--){const O=e.children[S];D(_,e.leaf?c(O):O),C+=b(_)}return C}_adjustParentBBoxes(e,i,s){for(let h=s;h>=0;h--)D(i.data[h],e)}_condense(e){for(let i=e.length-1;i>=0;i--){const s=e.data[i];if(0===s.children.length)if(i>0){const h=e.data[i-1],c=h.children;c.splice((0,g.cq)(c,s,c.length,h.indexHint),1)}else this.clear();else j(s,this._toBBox)}}_initFormat(e){const i=["return a"," - b",";"];this._compareMinX=new Function("a","b",i.join(e[0])),this._compareMinY=new Function("a","b",i.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function j(r,e){P(r,0,r.children.length,e,r)}function P(r,e,i,s,h){h||(h=new d([])),h.minX=1/0,h.minY=1/0,h.maxX=-1/0,h.maxY=-1/0;for(let c,m=e;m<i;m++)c=r.children[m],D(h,r.leaf?s(c):c);return h}function D(r,e){r.minX=Math.min(r.minX,e.minX),r.minY=Math.min(r.minY,e.minY),r.maxX=Math.max(r.maxX,e.maxX),r.maxY=Math.max(r.maxY,e.maxY)}function W(r,e){return r.minX-e.minX}function M(r,e){return r.minY-e.minY}function I(r){return(r.maxX-r.minX)*(r.maxY-r.minY)}function b(r){return r.maxX-r.minX+(r.maxY-r.minY)}function mt(r,e){return(Math.max(e.maxX,r.maxX)-Math.min(e.minX,r.minX))*(Math.max(e.maxY,r.maxY)-Math.min(e.minY,r.minY))}function xt(r,e){const i=Math.max(r.minX,e.minX),s=Math.max(r.minY,e.minY),h=Math.min(r.maxX,e.maxX),c=Math.min(r.maxY,e.maxY);return Math.max(0,h-i)*Math.max(0,c-s)}function Q(r,e){return r.minX<=e.minX&&r.minY<=e.minY&&e.maxX<=r.maxX&&e.maxY<=r.maxY}function F(r,e){return e.minX<=r.maxX&&e.minY<=r.maxY&&e.maxX>=r.minX&&e.maxY>=r.minY}function tt(r,e,i,s,h){const c=[e,i];for(;c.length;){const m=(0,z.j0)(c.pop()),_=(0,z.j0)(c.pop());if(m-_<=s)continue;const C=_+Math.ceil((m-_)/s/2)*s;(0,H.q)(r,C,_,m,h),c.push(_,C,C,m)}}const Z=new Y.Z,V=new Y.Z,w=new Y.Z,x=new Y.Z({deallocator:void 0});class a{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class f extends a{constructor(){super(...arguments),this.height=1,this.indexHint=new g.SO}}class d extends f{constructor(e){super(),this.children=e,this.leaf=!0}}class v extends f{constructor(e){super(),this.children=e,this.leaf=!1}}},65629:(Mt,G,u)=>{u.d(G,{SR:()=>W,Ui:()=>D});var g=u(62208),z=u(65401),Y=u(32442),H=u(25748),y=u(91179),j=u(74618),P=u(37053);function D(x){return M(x,!0)}function W(x){return M(x,!1)}function M(x,a){if((0,g.Wi)(x))return null;const f=x.spatialReference,d=(0,P.C5)(f),v="toJSON"in x?x.toJSON():x;if(!d)return v;const r=(0,P.sS)(f)?102100:4326,e=j.UZ[r].maxX,i=j.UZ[r].minX;if((0,y.wp)(v))return b(v,e,i);if((0,y.aW)(v))return v.points=v.points.map(s=>b(s,e,i)),v;if((0,y.YX)(v))return function I(x,a){if(!a)return x;const f=function mt(x,a){const f=[],{ymin:d,ymax:v,xmin:r,xmax:e}=x,i=x.xmax-x.xmin,[s,h]=a.valid,{x:c,frameId:m}=xt(x.xmin,a),{x:_,frameId:C}=xt(x.xmax,a),S=c===_&&i>0;if(i>2*h){const O={xmin:r<e?c:_,ymin:d,xmax:h,ymax:v},X={xmin:s,ymin:d,xmax:r<e?_:c,ymax:v},U={xmin:0,ymin:d,xmax:h,ymax:v},$={xmin:s,ymin:d,xmax:0,ymax:v},at=[],L=[];Q(O,U)&&at.push(m),Q(O,$)&&L.push(m),Q(X,U)&&at.push(C),Q(X,$)&&L.push(C);for(let k=m+1;k<C;k++)at.push(k),L.push(k);f.push(new Z(O,[m]),new Z(X,[C]),new Z(U,at),new Z($,L))}else c>_||S?f.push(new Z({xmin:c,ymin:d,xmax:h,ymax:v},[m]),new Z({xmin:s,ymin:d,xmax:_,ymax:v},[C])):f.push(new Z({xmin:c,ymin:d,xmax:_,ymax:v},[m]));return f}(x,a).map(d=>d.extent);return f.length<2?f[0]||x:f.length>2?(x.xmin=a.valid[0],x.xmax=a.valid[1],x):{rings:f.map(d=>[[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]])}}(v,d);if((0,y.oU)(v)||(0,y.l9)(v)){const s=(0,Y.$P)(V,v),h={xmin:s[0],ymin:s[1],xmax:s[2],ymax:s[3]},c=(0,j.XZ)(h.xmin,i)*(2*e),m=0===c?v:(0,j.Sy)(v,c);return h.xmin+=c,h.xmax+=c,h.xmax>e?tt(m,e,a):h.xmin<i?tt(m,i,a):m}return v}function b(x,a,f){if(Array.isArray(x)){const d=x[0];if(d>a){const v=(0,j.XZ)(d,a);x[0]=d+v*(-2*a)}else if(d<f){const v=(0,j.XZ)(d,f);x[0]=d+v*(-2*f)}}else{const d=x.x;if(d>a){const v=(0,j.XZ)(d,a);x.x+=v*(-2*a)}else if(d<f){const v=(0,j.XZ)(d,f);x.x+=v*(-2*f)}}return x}function xt(x,a){const[f,d]=a.valid,v=2*d;let r,e=0;return x>d?(r=Math.ceil(Math.abs(x-d)/v),x-=r*v,e=r):x<f&&(r=Math.ceil(Math.abs(x-f)/v),x+=r*v,e=-r),{x,frameId:e}}function Q(x,a){const{xmin:f,ymin:d,xmax:v,ymax:r}=a;return F(x,f,d)&&F(x,f,r)&&F(x,v,r)&&F(x,v,d)}function F(x,a,f){return a>=x.xmin&&a<=x.xmax&&f>=x.ymin&&f<=x.ymax}function tt(x,a,f=!0){const d=!(0,y.l9)(x);if(d&&(0,H.Zy)(x),f)return(new w).cut(x,a);const v=d?x.rings:x.paths,r=d?4:2,e=v.length,i=-2*a;for(let s=0;s<e;s++){const h=v[s];if(h&&h.length>=r){const c=[];for(const m of h)c.push([m[0]+i,m[1]]);v.push(c)}}return d?x.rings=v:x.paths=v,x}class Z{constructor(a,f){this.extent=a,this.frameIds=f}}const V=(0,z.Ue)();class w{constructor(){this._linesIn=[],this._linesOut=[]}cut(a,f){let d;if(this._xCut=f,a.rings)this._closed=!0,d=a.rings,this._minPts=4;else{if(!a.paths)return null;this._closed=!1,d=a.paths,this._minPts=2}for(const r of d){if(!r||r.length<this._minPts)continue;let e=!0;for(const i of r)e?(this.moveTo(i),e=!1):this.lineTo(i);this._closed&&this.close()}this._pushLineIn(),this._pushLineOut(),d=[];for(const r of this._linesIn)r&&r.length>=this._minPts&&d.push(r);const v=-2*this._xCut;for(const r of this._linesOut)if(r&&r.length>=this._minPts){for(const e of r)e[0]+=v;d.push(r)}return this._closed?a.rings=d:a.paths=d,a}moveTo(a){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(a[0]),this._moveTo(a[0],a[1],this._prevSide),this._prevPt=a,this._firstPt=a}lineTo(a){const f=this._side(a[0]);if(f*this._prevSide==-1){const d=this._intersect(this._prevPt,a);this._lineTo(this._xCut,d,0),this._prevSide=0,this._lineTo(a[0],a[1],f)}else this._lineTo(a[0],a[1],f);this._prevSide=f,this._prevPt=a}close(){const a=this._firstPt,f=this._prevPt;a[0]===f[0]&&a[1]===f[1]||this.lineTo(a),this._checkClosingPt(this._lineIn),this._checkClosingPt(this._lineOut)}_moveTo(a,f,d){this._closed?(this._lineIn.push([d<=0?a:this._xCut,f]),this._lineOut.push([d>=0?a:this._xCut,f])):(d<=0&&this._lineIn.push([a,f]),d>=0&&this._lineOut.push([a,f]))}_lineTo(a,f,d){this._closed?(this._addPolyVertex(this._lineIn,d<=0?a:this._xCut,f),this._addPolyVertex(this._lineOut,d>=0?a:this._xCut,f)):d<0?(0===this._prevSide&&this._pushLineOut(),this._lineIn.push([a,f])):d>0?(0===this._prevSide&&this._pushLineIn(),this._lineOut.push([a,f])):this._prevSide<0?(this._lineIn.push([a,f]),this._lineOut.push([a,f])):this._prevSide>0&&(this._lineOut.push([a,f]),this._lineIn.push([a,f]))}_addPolyVertex(a,f,d){const v=a.length;v>1&&a[v-1][0]===f&&a[v-2][0]===f?a[v-1][1]=d:a.push([f,d])}_checkClosingPt(a){const f=a.length;f>3&&a[0][0]===this._xCut&&a[f-2][0]===this._xCut&&a[1][0]===this._xCut&&(a[0][1]=a[f-2][1],a.pop())}_side(a){return a<this._xCut?-1:a>this._xCut?1:0}_intersect(a,f){return a[1]+(this._xCut-a[0])/(f[0]-a[0])*(f[1]-a[1])}_pushLineIn(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn),this._lineIn=[]}_pushLineOut(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut),this._lineOut=[]}}},24762:(Mt,G,u)=>{u.r(G),u.d(G,{default:()=>le});var g=u(17626),z=u(46160),Y=u(26584),H=u(63290),y=u(62208),j=u(99959),P=u(77712),D=u(66656),M=(u(85931),u(68653)),I=u(76898),b=u(99433),mt=u(44917),xt=u(552),Q=u(49286),F=u(99555),tt=u(15861),Z=u(84792),V=u(21726),w=u(35948),a=(u(90912),u(61996)),f=u(86810),d=u(47996),v=u(14517),r=u(88070),e=u(23841),i=u(30217),s=u(550),h=u(67831),c=u(99770),m=u(72642),_=u(37118),C=u(55915),S=u(65234),O=u(79608);u(8314);let U=class extends O.j{projectOrWarn(t,n){if((0,y.Wi)(t))return t;const{geometry:o,pending:l}=(0,C.dz)(t,n);return l?null:l||o?o:(H.Z.getLogger(this.declaredClass).warn("geometry could not be projected to the spatial reference",{georeference:this,geometry:t,sourceSpatialReference:t.spatialReference,targetSpatialReference:n}),null)}};U=(0,g._)([(0,I.j)("esri.layers.support.GeoreferenceBase")],U);const $=U,at=(0,s.c)(),L=(0,c.a)();let k=class extends v.Z{constructor(){super(...arguments),this.sourcePoint=null,this.mapPoint=null}};(0,g._)([(0,P.Cb)()],k.prototype,"sourcePoint",void 0),(0,g._)([(0,P.Cb)({type:m.Z})],k.prototype,"mapPoint",void 0),k=(0,g._)([(0,I.j)("esri.layers.support.ControlPoint")],k);let J=class extends((0,f.eC)($)){constructor(t){super(t),this.controlPoints=null,this.height=0,this.type="control-points",this.width=0}readControlPoints(t,n){const o=S.Z.fromJSON(n.spatialReference),l=(0,s.f)(...n.coefficients,1);return t.map(p=>((0,h.s)(L,p.x,p.y),(0,r.H)(L,L,l),{sourcePoint:p,mapPoint:new m.Z({x:L[0],y:L[1],spatialReference:o})}))}writeControlPoints(t,n,o,l){if((0,y.Wi)(this.transform)){const p=new Y.Z("web-document-write:invalid-georeference","Invalid 'controlPoints', 'width', 'height' configuration.",{layer:l?.layer,georeference:this});l?.messages?l.messages.push(p):H.Z.getLogger(this.declaredClass).error(p.name,p.message)}else(0,y.pC)(t)&&A(t[0])&&(n.controlPoints=t.map(p=>{const R=(0,y.Wg)(p.sourcePoint);return{x:R.x,y:R.y}}),n.spatialReference=t[0].mapPoint.spatialReference.toJSON(),n.coefficients=this.transform.slice(0,8))}get coords(){if((0,y.Wi)(this.controlPoints))return null;const t=this._updateTransform(at);return(0,y.Wi)(t)||!A(this.controlPoints[0])?null:function Ht(t,n,o,l){const p=(0,c.f)(0,o),R=(0,c.f)(0,0),E=(0,c.f)(n,0),B=(0,c.f)(n,o);return(0,r.H)(p,p,t),(0,r.H)(R,R,t),(0,r.H)(E,E,t),(0,r.H)(B,B,t),new _.Z({rings:[[p,R,E,B,p]],spatialReference:l})}(t,this.width,this.height,this.controlPoints[0].mapPoint.spatialReference)}set coords(t){if((0,y.Wi)(this.controlPoints)||!A(this.controlPoints[0]))return;const n=this.controlPoints[0].mapPoint.spatialReference;if(t=this.projectOrWarn(t,n),(0,y.Wi)(t))return;const{width:o,height:l}=this,{rings:[[p,R,E,B]]}=t,T={sourcePoint:(0,e.vW)(0,l),mapPoint:new m.Z({x:p[0],y:p[1],spatialReference:n})},N={sourcePoint:(0,e.vW)(0,0),mapPoint:new m.Z({x:R[0],y:R[1],spatialReference:n})},q={sourcePoint:(0,e.vW)(o,0),mapPoint:new m.Z({x:E[0],y:E[1],spatialReference:n})},ut={sourcePoint:(0,e.vW)(o,l),mapPoint:new m.Z({x:B[0],y:B[1],spatialReference:n})};A(T)&&A(N)&&A(q)&&A(ut)&&(Lt(at,T,N,q,ut),this.controlPoints=(0,y.Wg)(this.controlPoints).map(({sourcePoint:rt})=>((0,h.s)(L,rt.x,rt.y),(0,r.H)(L,L,at),{sourcePoint:rt,mapPoint:new m.Z({x:L[0],y:L[1],spatialReference:n})})))}get inverseTransform(){return(0,y.Wi)(this.transform)?null:(0,i.e)((0,s.c)(),this.transform)}get transform(){return this._updateTransform()}toMap(t){if((0,y.Wi)(t)||(0,y.Wi)(this.transform)||(0,y.Wi)(this.controlPoints)||!A(this.controlPoints[0]))return null;(0,h.s)(L,t.x,t.y);const n=this.controlPoints[0].mapPoint.spatialReference;return(0,r.H)(L,L,this.transform),new m.Z({x:L[0],y:L[1],spatialReference:n})}toSource(t){if((0,y.Wi)(t)||(0,y.Wi)(this.inverseTransform)||(0,y.Wi)(this.controlPoints)||!A(this.controlPoints[0]))return null;const n=this.controlPoints[0].mapPoint.spatialReference;return t=t.normalize(),t=(0,C.dz)(t,n).geometry,(0,y.Wi)(t)?null:((0,h.s)(L,t.x,t.y),(0,r.H)(L,L,this.inverseTransform),(0,e.vW)(L[0],L[1]))}_updateTransform(t){const{controlPoints:n,width:o,height:l}=this;if((0,y.Wi)(n)||!(o>0)||!(l>0))return null;const[p,R,E,B]=n;if(!A(p))return null;const T=p.mapPoint.spatialReference,N=this._projectControlPoint(R,T),q=this._projectControlPoint(E,T),ut=this._projectControlPoint(B,T);if(!(N.valid&&q.valid&&ut.valid&&A(N.controlPoint)))return null;(0,y.Wi)(t)&&(t=(0,s.c)());let rt=null;return rt=A(q.controlPoint)&&A(ut.controlPoint)?Lt(t,p,N.controlPoint,q.controlPoint,ut.controlPoint):A(q.controlPoint)?function Ut(t,n,o,l){return ot(et,st,n),ot(nt,it,o),ot(pt,ft,l),(0,h.l)(lt,et,nt,.5),(0,h.r)(lt,pt,lt,Math.PI),(0,h.l)(ht,st,it,.5),(0,h.r)(ht,ft,ht,Math.PI),Ct(t,et,nt,pt,lt,st,it,ft,ht)}(t,p,N.controlPoint,q.controlPoint):function Yt(t,n,o){return ot(et,st,n),ot(nt,it,o),(0,h.r)(pt,nt,et,Rt),(0,h.r)(lt,et,nt,Rt),(0,h.r)(ft,it,st,-Rt),(0,h.r)(ht,st,it,-Rt),Ct(t,et,nt,pt,lt,st,it,ft,ht)}(t,p,N.controlPoint),rt.every(he=>0===he)?null:rt}_projectControlPoint(t,n){if(!A(t))return{valid:!0,controlPoint:t};const{sourcePoint:o,mapPoint:l}=t,{geometry:p,pending:R}=(0,C.dz)(l,n);return R?{valid:!1,controlPoint:null}:R||p?{valid:!0,controlPoint:{sourcePoint:o,mapPoint:p}}:(H.Z.getLogger(this.declaredClass).warn("map point could not be projected to the spatial reference",{georeference:this,controlPoint:t,sourceSpatialReference:l.spatialReference,targetSpatialReference:n}),{valid:!1,controlPoint:null})}};function A(t){return(0,y.pC)(t)&&(0,y.pC)(t.sourcePoint)&&(0,y.pC)(t.mapPoint)}(0,g._)([(0,P.Cb)({type:[k],json:{write:{allowNull:!1,isRequired:!0}}})],J.prototype,"controlPoints",void 0),(0,g._)([(0,M.r)("controlPoints")],J.prototype,"readControlPoints",null),(0,g._)([(0,b.c)("controlPoints")],J.prototype,"writeControlPoints",null),(0,g._)([(0,P.Cb)()],J.prototype,"coords",null),(0,g._)([(0,P.Cb)({json:{write:!0}})],J.prototype,"height",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],J.prototype,"inverseTransform",null),(0,g._)([(0,P.Cb)({readOnly:!0})],J.prototype,"transform",null),(0,g._)([(0,P.Cb)({json:{write:!0}})],J.prototype,"width",void 0),J=(0,g._)([(0,I.j)("esri.layers.support.ControlPointsGeoreference")],J);const et=(0,c.a)(),nt=(0,c.a)(),pt=(0,c.a)(),lt=(0,c.a)(),st=(0,c.a)(),it=(0,c.a)(),ft=(0,c.a)(),ht=(0,c.a)(),Rt=Math.PI/2;function ot(t,n,o){(0,h.s)(t,o.sourcePoint.x,o.sourcePoint.y),(0,h.s)(n,o.mapPoint.x,o.mapPoint.y)}function Lt(t,n,o,l,p){return ot(et,st,n),ot(nt,it,o),ot(pt,ft,l),ot(lt,ht,p),Ct(t,et,nt,pt,lt,st,it,ft,ht)}const Dt=new Array(8).fill(0),At=new Array(8).fill(0);function Wt(t,n,o,l,p){return t[0]=n[0],t[1]=n[1],t[2]=o[0],t[3]=o[1],t[4]=l[0],t[5]=l[1],t[6]=p[0],t[7]=p[1],t}function Ct(t,n,o,l,p,R,E,B,T){return(0,r.E)(t,Wt(Dt,n,o,l,p),Wt(At,R,E,B,T))}const jt=J;let ct=class extends ${constructor(t){super(t),this.bottomLeft=null,this.bottomRight=null,this.topLeft=null,this.topRight=null,this.type="corners"}get coords(){let{topLeft:t,topRight:n,bottomLeft:o,bottomRight:l}=this;if((0,y.Wi)(t)||(0,y.Wi)(n)||(0,y.Wi)(o)||(0,y.Wi)(l))return null;const p=t.spatialReference;return n=this.projectOrWarn(n,p),o=this.projectOrWarn(o,p),l=this.projectOrWarn(l,p),(0,y.Wi)(n)||(0,y.Wi)(o)||(0,y.Wi)(l)?null:new _.Z({rings:[[[o.x,o.y],[t.x,t.y],[n.x,n.y],[l.x,l.y],[o.x,o.y]]],spatialReference:p})}set coords(t){const{topLeft:n}=this;if((0,y.Wi)(n))return;const o=n.spatialReference;if(t=this.projectOrWarn(t,o),(0,y.Wi)(t))return;const{rings:[[l,p,R,E]]}=t;this.bottomLeft=new m.Z({x:l[0],y:l[1],spatialReference:o}),this.topLeft=new m.Z({x:p[0],y:p[1],spatialReference:o}),this.topRight=new m.Z({x:R[0],y:R[1],spatialReference:o}),this.bottomRight=new m.Z({x:E[0],y:E[1],spatialReference:o})}};(0,g._)([(0,P.Cb)()],ct.prototype,"coords",null),(0,g._)([(0,P.Cb)({type:m.Z})],ct.prototype,"bottomLeft",void 0),(0,g._)([(0,P.Cb)({type:m.Z})],ct.prototype,"bottomRight",void 0),(0,g._)([(0,P.Cb)({type:m.Z})],ct.prototype,"topLeft",void 0),(0,g._)([(0,P.Cb)({type:m.Z})],ct.prototype,"topRight",void 0),ct=(0,g._)([(0,I.j)("esri.layers.support.CornersGeoreference")],ct);const Vt=ct;var Kt=u(21286),zt=u(39863),It=u(2004);let yt=class extends ${constructor(t){super(t),this.extent=null,this.rotation=0,this.type="extent-and-rotation"}get coords(){if((0,y.Wi)(this.extent))return null;const{xmin:t,ymin:n,xmax:o,ymax:l,spatialReference:p}=this.extent;let R;if(this.rotation){const{x:E,y:B}=this.extent.center,T=St(E,B,this.rotation);R=[T(t,n),T(t,l),T(o,l),T(o,n)],R.push(R[0])}else R=[[t,n],[t,l],[o,l],[o,n],[t,n]];return new _.Z({rings:[R],spatialReference:p})}set coords(t){if((0,y.Wi)(t)||(0,y.Wi)(this.extent))return;const n=this.extent.spatialReference;if(t=this.projectOrWarn(t,n),(0,y.Wi)(t)||(0,y.Wi)(t.extent))return;const{rings:[[o,l,p]],extent:{center:{x:R,y:E}}}=t,B=(0,Kt.BV)(Math.PI/2-Math.atan2(l[1]-o[1],l[0]-o[0])),T=St(R,E,-B),[N,q]=T(o[0],o[1]),[ut,rt]=T(p[0],p[1]);this.extent=new It.Z({xmin:N,ymin:q,xmax:ut,ymax:rt,spatialReference:n}),this.rotation=B}};function St(t,n,o){const l=(0,zt.t)(o),p=Math.cos(l),R=Math.sin(l);return(E,B)=>[p*(E-t)+R*(B-n)+t,p*(B-n)-R*(E-t)+n]}(0,g._)([(0,P.Cb)()],yt.prototype,"coords",null),(0,g._)([(0,P.Cb)({type:It.Z})],yt.prototype,"extent",void 0),(0,g._)([(0,P.Cb)({type:Number})],yt.prototype,"rotation",void 0),yt=(0,g._)([(0,I.j)("esri.layers.support.ExtentAndRotationGeoreference")],yt);const Nt={key:"type",base:$,typeMap:{"control-points":jt,corners:Vt,"extent-and-rotation":yt}};let gt=class extends((0,a.iv)((0,f.eC)(d.Z))){constructor(){super(...arguments),this.georeference=null,this.opacity=1}readGeoreference(t){return jt.fromJSON(t)}};(0,g._)([(0,P.Cb)({types:Nt,json:{write:!0}})],gt.prototype,"georeference",void 0),(0,g._)([(0,M.r)("georeference")],gt.prototype,"readGeoreference",null),(0,g._)([(0,P.Cb)()],gt.prototype,"opacity",void 0),gt=(0,g._)([(0,I.j)("esri.layers.support.MediaElementBase")],gt);const Bt=gt;var Ft=u(61556),_t=u(29840);let dt=class extends Bt{constructor(t){super(t),this.content=null,this.image=null,this.type="image",this.image=null}load(){const t=this.image;if("string"==typeof t){const n=(0,Z.default)(t,{responseType:"image"}).then(({data:o})=>{this._set("content",o)});this.addResolvingPromise(n)}else if(t instanceof HTMLImageElement){const n=t.decode().then(()=>{this._set("content",t)});this.addResolvingPromise(n)}else t?this._set("content",t):this.addResolvingPromise(Promise.reject(new Y.Z("image-element:invalid-image-type","Invalid image type",{image:t})));return Promise.resolve(this)}readImage(t,n,o){return(0,_t.f)(n.url,o)}writeImage(t,n,o,l){if((0,y.Wi)(t))return;const p=l?.portalItem,R=l?.resources;if(!p||!R)return void("string"==typeof t&&(n[o]=(0,_t.t)(t,l)));const E="string"!=typeof t||(0,V.HK)(t)||(0,V.jc)(t)?null:t;if(E){if(null==(0,_t.i)(E))return void(n[o]=E);const B=(0,_t.t)(E,{...l,verifyItemRelativeUrls:l&&l.verifyItemRelativeUrls?{writtenUrls:l.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},_t.M.NO);if(p&&B&&!(0,V.YP)(B))return R.toKeep.push({resource:p.resourceFromPath(B),compress:!1}),void(n[o]=B)}n[o]="<pending>",R.pendingOperations.push(Zt(t).then(B=>{const T=function Gt(t,n){const o=(0,w.D)(),l=`${(0,V.v_)("media",o)}.${(0,Ft.B)(t)}`;return n.resourceFromPath(l)}(B,p);n[o]=T.itemRelativeUrl,R.toAdd.push({resource:T,content:B,compress:!1,finish:N=>{this.image=N.url}})}))}};(0,g._)([(0,P.Cb)({readOnly:!0})],dt.prototype,"content",void 0),(0,g._)([(0,P.Cb)({json:{name:"url",type:String}})],dt.prototype,"image",void 0),(0,g._)([(0,M.r)("image",["url"])],dt.prototype,"readImage",null),(0,g._)([(0,b.c)("image")],dt.prototype,"writeImage",null),(0,g._)([(0,P.Cb)({readOnly:!0,json:{name:"mediaType"}})],dt.prototype,"type",void 0),dt=(0,g._)([(0,I.j)("esri.layers.support.ImageElement")],dt);const Tt=dt;function Zt(t){return Et.apply(this,arguments)}function Et(){return(Et=(0,tt.Z)(function*(t){if("string"==typeof t){if((0,V.jc)(t)){const{data:n}=yield(0,Z.default)(t,{responseType:"blob"});return n}return(0,V.HK)(t)?(0,V.fw)(t):Zt((yield(0,Z.default)(t,{responseType:"image"})).data)}return new Promise(n=>function Jt(t){if(t instanceof HTMLCanvasElement)return t;const n=t instanceof HTMLImageElement?t.naturalWidth:t.width,o=t instanceof HTMLImageElement?t.naturalHeight:t.height,l=document.createElement("canvas"),p=l.getContext("2d");return l.width=n,l.height=o,t instanceof HTMLImageElement?p.drawImage(t,0,0,t.width,t.height):t instanceof ImageData&&p.putImageData(t,0,0),l}(t).toBlob(n))})).apply(this,arguments)}u(29132);var Qt=u(89726),$t=u(61885),kt=u(80542),qt=u(60330),te=u(10699),ee=u(32917),ne=u(65401),se=u(11519),ie=u(37053),oe=u(61256),re=u(17732);let Pt=class extends Bt{constructor(t){super(t),this.content=null,this.type="video"}load(){const t=this.video;if("string"==typeof t){const n=document.createElement("video");n.src=t,n.crossOrigin="anonymous",n.autoplay=!0,n.muted=!0,n.loop=!0,this.addResolvingPromise(this._loadVideo(n).then(()=>{this._set("content",n)}))}else t instanceof HTMLVideoElement?this.addResolvingPromise(this._loadVideo(t).then(()=>{this._set("content",t)})):this.addResolvingPromise(Promise.reject(new Y.Z("video-element:invalid-video-type","Invalid video type",{video:t})));return Promise.resolve(this)}set video(t){"not-loaded"===this.loadStatus?this._set("video",t):H.Z.getLogger(this.declaredClass).error("#video","video cannot be changed after the element is loaded.")}_loadVideo(t){return new Promise((n,o)=>{t.oncanplay=()=>{t.oncanplay=null,t.play().then(n,o)},"anonymous"!==t.crossOrigin&&(t.crossOrigin="anonymous",t.src=t.src)})}};(0,g._)([(0,P.Cb)({readOnly:!0})],Pt.prototype,"content",void 0),(0,g._)([(0,P.Cb)()],Pt.prototype,"video",null),Pt=(0,g._)([(0,I.j)("esri.layers.support.VideoElement")],Pt);const Xt=Pt,bt=z.Z.ofType({key:"type",defaultKeyValue:"image",base:Bt,typeMap:{image:Tt,video:Xt}});let vt=class extends(d.Z.LoadableMixin((0,qt.v)((0,kt.p)($t.Z.EventedAccessor)))){constructor(t){super(t),this._index=new oe.H,this._elementViewsMap=new Map,this._elementsIndexes=new Map,this._elementsChangedHandler=n=>{for(const l of n.removed){const p=this._elementViewsMap.get(l);this._elementViewsMap.delete(l),this._index.delete(p),this.handles.remove(p),p.destroy(),this.notifyChange("fullExtent")}const{spatialReference:o}=this;for(const l of n.added){if(this._elementViewsMap.get(l))continue;const p=new re.L({spatialReference:o,element:l});this._elementViewsMap.set(l,p);const R=(0,ee.YP)(()=>p.coords,()=>this._updateIndexForElement(p,!1));this._updateIndexForElement(p,!0),this.handles.add(R,p)}this._elementsIndexes.clear(),this.elements.forEach((l,p)=>this._elementsIndexes.set(l,p)),this.emit("refresh")},this.elements=new bt}load(t){var n=this;return(0,tt.Z)(function*(){if((0,te.k_)(t),!n.spatialReference){const o=n.elements.find(l=>(0,y.pC)(l.georeference)&&(0,y.pC)(l.georeference.coords));n._set("spatialReference",o?(0,y.Wg)((0,y.Wg)(o.georeference).coords).spatialReference:S.Z.WGS84)}return n._elementsChangedHandler({added:n.elements.items,removed:[]}),n.handles.add(n.elements.on("change",n._elementsChangedHandler)),n})()}destroy(){this._index.clear(),this._elementViewsMap.clear(),this._elementsIndexes.clear()}set elements(t){this._set("elements",(0,Qt.Z)(t,this._get("elements"),bt))}get fullExtent(){if("not-loaded"===this.loadStatus)return null;const t=this._index.fullBounds;return(0,y.Wi)(t)?null:new It.Z({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:this.spatialReference})}set spatialReference(t){"not-loaded"===this.loadStatus?this._set("spatialReference",t):H.Z.getLogger(this.declaredClass).error("#spatialReference","spatialReference cannot be changed after the source is loaded.")}queryElements(t,n){var o=this;return(0,tt.Z)(function*(){yield o.load(),yield(0,C.iQ)(t.spatialReference,o.spatialReference,null,n);const l=(0,ie.fS)(t.spatialReference,o.spatialReference)?t:(0,C.iV)(t,o.spatialReference);if(!l)return[];const p=l.normalize(),R=[];for(const E of p)o._index.forEachInBounds((0,ne.oJ)(E),({normalizedCoords:B,element:T})=>{(0,y.pC)(B)&&(0,se.Nl)(E,B)&&R.push(T)});return R.sort((E,B)=>o._elementsIndexes.get(E)-o._elementsIndexes.get(B)),R})()}_updateIndexForElement(t,n){const o=t.normalizedBounds,l=this._index.has(t),p=(0,y.pC)(o);this._index.delete(t),p&&this._index.set(t,o),this.notifyChange("fullExtent"),n||(l!==p?this.emit("refresh"):this.emit("change",{element:t.element}))}};(0,g._)([(0,P.Cb)()],vt.prototype,"elements",null),(0,g._)([(0,P.Cb)({readOnly:!0})],vt.prototype,"fullExtent",null),(0,g._)([(0,P.Cb)()],vt.prototype,"spatialReference",null),vt=(0,g._)([(0,I.j)("esri.layers.support.LocalMediaElementSource")],vt);const Ot=vt;function wt(t){return"object"==typeof t&&null!=t&&"type"in t}let K=class extends((0,xt.h)((0,F.M)((0,Q.q)((0,j.R)(mt.Z))))){constructor(t){super(t),this.effectiveSource=null,this.copyright=null,this.operationalLayerType="MediaLayer",this.spatialReference=null,this.type="media",this.source=new Ot}load(t){const n=this.source;if(!n)return this.addResolvingPromise(Promise.reject(new Y.Z("media-layer:source-missing","Set 'MediaLayer.source' before loading the layer."))),Promise.resolve(this);const o=wt(n)?new Ot({elements:new z.Z([n])}):n;this._set("effectiveSource",o),this.spatialReference&&(o.spatialReference=this.spatialReference);const l=o.load(t).then(()=>{this.spatialReference=o.spatialReference});return this.addResolvingPromise(l),Promise.resolve(this)}destroy(){(0,y.Wg)(this.effectiveSource)?.destroy(),(0,y.Wg)(this.source)?.destroy()}get fullExtent(){return this.loaded?this.effectiveSource.fullExtent:null}set source(t){"not-loaded"===this.loadStatus?this._set("source",t):H.Z.getLogger(this.declaredClass).error("#source","source cannot be changed after the layer is loaded.")}castSource(t){return t?Array.isArray(t)||t instanceof z.Z?new Ot({elements:t}):t:null}readSource(t,n,o){const l="image"===n.mediaType?new Tt:"video"===n.mediaType?new Xt:null;return l?.read(n,o),l}writeSource(t,n,o,l){t&&wt(t)&&"image"===t.type?t.write(n,l):l?.messages&&l?.messages?.push(new Y.Z("media-layer:unsupported-source","source must be an 'ImageElement'"))}};(0,g._)([(0,P.Cb)({readOnly:!0})],K.prototype,"effectiveSource",void 0),(0,g._)([(0,P.Cb)({type:String})],K.prototype,"copyright",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],K.prototype,"fullExtent",null),(0,g._)([(0,P.Cb)({type:["MediaLayer"]})],K.prototype,"operationalLayerType",void 0),(0,g._)([(0,P.Cb)({type:["show","hide"]})],K.prototype,"listMode",void 0),(0,g._)([(0,P.Cb)({nonNullable:!0,json:{write:{enabled:!0,allowNull:!1}}})],K.prototype,"source",null),(0,g._)([(0,D.p)("source")],K.prototype,"castSource",null),(0,g._)([(0,M.r)("source",["url"])],K.prototype,"readSource",null),(0,g._)([(0,b.c)("source")],K.prototype,"writeSource",null),(0,g._)([(0,P.Cb)()],K.prototype,"spatialReference",void 0),(0,g._)([(0,P.Cb)({readOnly:!0})],K.prototype,"type",void 0),K=(0,g._)([(0,I.j)("esri.layers.MediaLayer")],K);const le=K},61256:(Mt,G,u)=>{u.d(G,{H:()=>D});var g=u(8314),z=u(36592),Y=u(65401);const y={minX:0,minY:0,maxX:0,maxY:0};class D{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new z.Q(9,(0,g.Z)("esri-csp-restrictions")?M=>({minX:M[0],minY:M[1],maxX:M[2],maxY:M[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const M=new Array(this._idByBounds.size);let I=0;this._idByBounds.forEach((b,mt)=>{M[I++]=mt}),this._indexInvalid=!1,this._index.clear(),this._index.load(M)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(M=>this._idByBounds.has(M))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const M=(0,Y.cS)();for(const I of this._boundsById.values())I&&(M[0]=Math.min(I[0],M[0]),M[1]=Math.min(I[1],M[1]),M[2]=Math.max(I[2],M[2]),M[3]=Math.max(I[3],M[3]));return M}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(M){const I=this._boundsById.get(M);this._boundsById.delete(M),I&&(this._idByBounds.delete(I),this._indexInvalid||this._index.remove(I))}forEachInBounds(M,I){this._loadIndex(),function P(W,M,I){(function j(W){y.minX=W[0],y.minY=W[1],y.maxX=W[2],y.maxY=W[3]})(M),W.search(y,I)}(this._index,M,b=>I(this._idByBounds.get(b)))}get(M){return this._boundsById.get(M)}has(M){return this._boundsById.has(M)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(M,I){if(!this._indexInvalid){const b=this._boundsById.get(M);b&&(this._index.remove(b),this._idByBounds.delete(b))}this._boundsById.set(M,I),I&&(this._idByBounds.set(I,M),this._indexInvalid||(this._boundsToLoad.push(I),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},61556:(Mt,G,u)=>{u.d(G,{B:()=>z});var g=u(21726);function z(W){return y[function Y(W){return W instanceof Blob?W.type:function H(W){const M=(0,g.Ml)(W);return D[M]||j}(W.url)}(W)]||P}const y={},j="text/plain",P=y[j],D={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const W in D)y[D[W]]=W}}]);