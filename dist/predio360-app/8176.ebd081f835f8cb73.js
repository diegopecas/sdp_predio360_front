"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[8176],{78176:(T,E,t)=>{t.r(E),t.d(E,{FeatureCollectionSnappingSource:()=>i});var g=t(15861),s=t(17626),M=t(83761),O=t(75618),y=t(10699),u=t(32917),_=t(77712),f=(t(8314),t(63290),t(4619),t(76898)),m=t(60507),d=t(44725),v=t(9218),h=t(17936),A=t(1520),D=t(83010);let i=class extends M.Z{get availability(){return 1}get updating(){return this.layerSource.updating}get _snappingElevationAligner(){const{view:e}=this,{layer:n}=this.layerSource,o=null!=e&&"3d"===e.type;if(!o||"subtype-group"===n.type)return(0,h.p)();const r=function(){var a=(0,g.Z)(function*(l,p){return(yield(0,y.Hl)(e.whenLayerView(n),p)).elevationAlignPointsInFeatures(l,p)});return function(p,P){return a.apply(this,arguments)}}();return(0,h.p)(o,{elevationInfo:n.elevationInfo,alignPointsInFeatures:r})}get _snappingElevationFilter(){const{view:e}=this;return(0,A.c)(null!=e&&"3d"===e.type&&"subtype-group"!==this.layerSource.layer.type)}get _symbologySnappingFetcher(){const{view:e}=this,{layer:n}=this.layerSource;return null!=e&&"3d"===e.type&&"subtype-group"!==n.type?(0,D.k)(this._symbologySnappingSupported,function(){var o=(0,g.Z)(function*(r,a){const l=yield e.whenLayerView(n);return(0,y.k_)(a),l.queryForSymbologySnapping({candidates:r,spatialReference:e.spatialReference},a)});return function(r,a){return o.apply(this,arguments)}}()):(0,D.k)()}get _symbologySnappingSupported(){return null!=this._layerView3D&&this._layerView3D.symbologySnappingSupported}initialize(){const{view:e}=this,{layer:n}=this.layerSource;null!=e&&"3d"===e.type&&"subtype-group"!==n.type&&(e.whenLayerView(n).then(o=>this._layerView3D=o),this.addHandles([e.elevationProvider.on("elevation-change",({context:o})=>{const{elevationInfo:r}=n;(0,m.W_)(o,r)&&this._snappingElevationAligner.notifyElevationSourceChange()}),(0,u.YP)(()=>n.elevationInfo,()=>this._snappingElevationAligner.notifyElevationSourceChange(),u.nn),(0,u.YP)(()=>null!=this._layerView3D?this._layerView3D.processor?.renderer:null,()=>this._symbologySnappingFetcher.notifySymbologyChange(),u.nn),(0,u.on)(()=>this._layerView3D?.layer,["edits","apply-edits","graphic-update"],()=>this._symbologySnappingFetcher.notifySymbologyChange())]))}constructor(e){super(e),this.view=null,this._layerView3D=null,this._memoizedMakeGetGroundElevation=(0,O.H)(v.g)}refresh(){}fetchCandidates(e,n){var o=this;return(0,g.Z)(function*(){const{layer:r}=o.layerSource,a=r.source;if(!a?.querySnapping)return[];const l=(0,d.ML)(r),p=(0,d.rh)(e,o.view?.type??"2d",l),P=yield a.querySnapping(p,{signal:n});(0,y.k_)(n);const C=e.coordinateHelper.spatialReference,c=yield o._snappingElevationAligner.alignCandidates(P.candidates,C,n);(0,y.k_)(n);const S=yield o._symbologySnappingFetcher.fetch(c,n);(0,y.k_)(n);const I=0===S.length?c:[...c,...S],U=o._snappingElevationFilter.filter(p,I),L=o._memoizedMakeGetGroundElevation(o.view,C);return U.map(R=>(0,v.X)(R,L))})()}};(0,s._)([(0,_.Cb)({constructOnly:!0})],i.prototype,"layerSource",void 0),(0,s._)([(0,_.Cb)({constructOnly:!0})],i.prototype,"view",void 0),(0,s._)([(0,_.Cb)()],i.prototype,"_snappingElevationAligner",null),(0,s._)([(0,_.Cb)()],i.prototype,"_snappingElevationFilter",null),(0,s._)([(0,_.Cb)()],i.prototype,"_symbologySnappingFetcher",null),(0,s._)([(0,_.Cb)()],i.prototype,"_layerView3D",void 0),(0,s._)([(0,_.Cb)()],i.prototype,"_symbologySnappingSupported",null),i=(0,s._)([(0,f.j)("esri.views.interactive.snapping.featureSources.FeatureCollectionSnappingSource")],i)}}]);