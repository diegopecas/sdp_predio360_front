"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[3724,587],{52489:(K,y,r)=>{r.d(y,{D:()=>m});var u=r(22558);function m(g){g?.writtenProperties&&g.writtenProperties.forEach(({target:i,propName:c,newOrigin:p})=>{(0,u.l)(i)&&p&&i.originOf(c)!==p&&i.updateOrigin(c,p)})}},22558:(K,y,r)=>{function u(m){return m&&"getAtOrigin"in m&&"originOf"in m}r.d(y,{l:()=>u})},46826:(K,y,r)=>{r.r(y),r.d(y,{save:()=>d,saveAs:()=>D});var u=r(15861),m=r(82674),g=r(88755),i=r(37281),c=r(20677);const p="Group Layer",E="group-layer-save",U="group-layer-save-as",v=i.hz.GROUP_LAYER_MAP;function M(e){return{isValid:"group"===e.type,errorMessage:"Layer.type should be 'group'"}}function A(e){return{isValid:(0,i._$)(e,v),errorMessage:`Layer.portalItem.typeKeywords should have '${v}'`}}function x(e,t){return{...(0,g.Y)(e,"web-map",!0),initiator:t}}function R(e){const t=e.layerJSON;return Promise.resolve(t&&Object.keys(t).length?t:null)}function a(e,t){return o.apply(this,arguments)}function o(){return(o=(0,u.Z)(function*(e,t){t.title||=e.title,(0,i.ck)(t,i.hz.METADATA),(0,i.qj)(t,v)})).apply(this,arguments)}function d(e,t){return _.apply(this,arguments)}function _(){return _=(0,u.Z)(function*(e,t){return(0,m.a1)({layer:e,itemType:p,validateLayer:M,validateItem:A,createJSONContext:n=>x(n,e),createItemData:R,errorNamePrefix:E,saveResources:(n=(0,u.Z)(function*(l,h){return e.sourceIsPortalItem||(yield l.removeAllResources().catch(()=>{})),(0,c.H)(e.resourceReferences,h)}),function(h,s){return n.apply(this,arguments)})},t);var n}),_.apply(this,arguments)}function D(e,t,n){return P.apply(this,arguments)}function P(){return(P=(0,u.Z)(function*(e,t,n){return(0,m.po)({layer:e,itemType:p,validateLayer:M,createJSONContext:l=>x(l,e),createItemData:R,errorNamePrefix:U,newItem:t,setItemProperties:a,saveResources:(l,h)=>(0,c.H)(e.resourceReferences,h)},n)})).apply(this,arguments)}},88755:(K,y,r)=>{r.d(y,{Y:()=>i,h:()=>g});var u=r(21726),m=r(31099);function g(p,E){return{...c(p,E),readResourcePaths:[]}}function i(p,E,U){const v=(0,u.mN)(p.itemUrl);return{...c(p,E),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:v?{rootPath:v.path,writtenUrls:[]}:null,resources:U?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function c(p,E){return{origin:E,url:(0,u.mN)(p.itemUrl),portal:p.portal||m.Z.getDefault(),portalItem:p}}},10587:(K,y,r)=>{r.r(y),r.d(y,{addOrUpdateResources:()=>E,contentToBlob:()=>d,fetchResources:()=>c,getSiblingOfSameType:()=>D,getSiblingOfSameTypeI:()=>P,removeAllResources:()=>A,removeResource:()=>v,splitPrefixFileNameAndExtension:()=>a});var u=r(15861),m=r(84792),g=r(26584),i=r(21726);function c(e){return p.apply(this,arguments)}function p(){return(p=(0,u.Z)(function*(e,t={},n){yield e.load(n);const l=(0,i.v_)(e.itemUrl,"resources"),{start:h=1,num:s=10,sortOrder:f="asc",sortField:B="resource"}=t,I={query:{start:h,num:s,sortOrder:f,sortField:B,token:e.apiKey},signal:n?.signal},O=yield e.portal.request(l,I);return{total:O.total,nextStart:O.nextStart,resources:O.resources.map(({created:C,size:T,resource:j})=>({created:new Date(C),size:T,resource:e.resourceFromPath(j)}))}})).apply(this,arguments)}function E(e,t,n,l){return U.apply(this,arguments)}function U(){return(U=(0,u.Z)(function*(e,t,n,l){const h=new Map;for(const{resource:f,content:B,compress:I,access:O}of t){if(!f.hasPath())throw new g.Z(`portal-item-resource-${n}:invalid-path`,"Resource does not have a valid path");const[C,T]=R(f.path),j=`${C}/${I??""}/${O??""}`;h.has(j)||h.set(j,{prefix:C,compress:I,access:O,files:[]}),h.get(j).files.push({fileName:T,content:B})}yield e.load(l);const s=(0,i.v_)(e.userItemUrl,"add"===n?"addResources":"updateResources");for(const{prefix:f,compress:B,access:I,files:O}of h.values())for(let T=0;T<O.length;T+=25){const j=O.slice(T,T+25),L=new FormData;f&&"."!==f&&L.append("resourcesPrefix",f),B&&L.append("compress","true"),I&&L.append("access",I);let S=0;for(const{fileName:W,content:Z}of j)L.append("file"+ ++S,Z,W);L.append("f","json"),yield e.portal.request(s,{method:"post",body:L,signal:l?.signal})}})).apply(this,arguments)}function v(e,t,n){return M.apply(this,arguments)}function M(){return(M=(0,u.Z)(function*(e,t,n){if(!t.hasPath())throw new g.Z("portal-item-resources-remove:invalid-path","Resource does not have a valid path");yield e.load(n);const l=(0,i.v_)(e.userItemUrl,"removeResources");yield e.portal.request(l,{method:"post",query:{resource:t.path},signal:n?.signal}),t.portalItem=null})).apply(this,arguments)}function A(e,t){return x.apply(this,arguments)}function x(){return(x=(0,u.Z)(function*(e,t){yield e.load(t);const n=(0,i.v_)(e.userItemUrl,"removeResources");return e.portal.request(n,{method:"post",query:{deleteAll:!0},signal:t?.signal})})).apply(this,arguments)}function R(e){const t=e.lastIndexOf("/");return-1===t?[".",e]:[e.slice(0,t),e.slice(t+1)]}function a(e){const[t,n]=function o(e){const t=(0,i.Ml)(e);return null==t?[e,""]:[e.slice(0,e.length-t.length-1),`.${t}`]}(e),[l,h]=R(t);return[l,h,n]}function d(e){return _.apply(this,arguments)}function _(){return(_=(0,u.Z)(function*(e){return"blob"===e.type?e.blob:"json"===e.type?new Blob([e.jsonString],{type:"application/json"}):(yield(0,m.Z)(e.url,{responseType:"blob"})).data})).apply(this,arguments)}function D(e,t){if(!e.hasPath())return null;const[n,,l]=a(e.path);return e.portalItem.resourceFromPath((0,i.v_)(n,t+l))}function P(e,t){if(!e.hasPath())return null;const[n,,l]=a(e.path);return e.portalItem.resourceFromPath((0,i.v_)(n,t+l))}},20677:(K,y,r)=>{r.d(y,{H:()=>p,b:()=>U});var u=r(15861),m=r(26584),g=r(10699),i=r(35948),c=r(10587);function p(a,o,d){return E.apply(this,arguments)}function E(){return(E=(0,u.Z)(function*(a,o,d){const _=yield M(a,o,d);yield x(_,o,d)})).apply(this,arguments)}function U(a,o,d,_,D){return v.apply(this,arguments)}function v(){return(v=(0,u.Z)(function*(a,o,d,_,D){const P=yield M(d,_,D);yield a.update({data:o}),yield x(P,_,D)})).apply(this,arguments)}function M(a,o,d){return A.apply(this,arguments)}function A(){return(A=(0,u.Z)(function*(a,o,d){if(!o?.resources)return;const _=o.portalItem===a.portalItem?new Set(a.paths):new Set;a.paths.length=0,a.portalItem=o.portalItem;const D=new Set(o.resources.toKeep.map(s=>s.resource.path)),P=new Set,e=[];D.forEach(s=>{_.delete(s),a.paths.push(s)});const t=[],n=[],l=[];for(const s of o.resources.toUpdate)if(_.delete(s.resource.path),D.has(s.resource.path)||P.has(s.resource.path)){const{resource:f,content:B,finish:I}=s,O=(0,c.getSiblingOfSameTypeI)(f,(0,i.DO)());a.paths.push(O.path),t.push({resource:O,content:yield(0,c.contentToBlob)(B),compress:s.compress}),I&&l.push(()=>I(O))}else{a.paths.push(s.resource.path),n.push({resource:s.resource,content:yield(0,c.contentToBlob)(s.content),compress:s.compress});const f=s.finish;f&&l.push(()=>f(s.resource)),P.add(s.resource.path)}for(const s of o.resources.toAdd)if(a.paths.push(s.resource.path),_.has(s.resource.path))_.delete(s.resource.path);else{t.push({resource:s.resource,content:yield(0,c.contentToBlob)(s.content),compress:s.compress});const f=s.finish;f&&l.push(()=>f(s.resource))}if(t.length||n.length){const{addOrUpdateResources:s}=yield Promise.resolve().then(r.bind(r,10587));yield s(o.portalItem,t,"add",d),yield s(o.portalItem,n,"update",d)}if(l.forEach(s=>s()),0===e.length)return _;const h=yield(0,g.UO)(e);if((0,g.k_)(d),h.length>0)throw new m.Z("save:resources","Failed to save one or more resources",{errors:h});return _})).apply(this,arguments)}function x(a,o,d){return R.apply(this,arguments)}function R(){return(R=(0,u.Z)(function*(a,o,d){if(!a||!o.portalItem)return;const _=[];for(const D of a){const P=o.portalItem.resourceFromPath(D);_.push(P.portalItem.removeResource(P,d))}yield(0,g.as)(_)})).apply(this,arguments)}},53675:(K,y,r)=>{r.d(y,{w:()=>i});var u=r(59318),m=r(26584),g=r(12680);function i(c){if(u.Z.apiKey&&(0,g.r)(c.portal.url))throw new m.Z("save-api-key-utils:api-key-not-supported",`Saving is not supported on ${c.portal.url} when using an api key`)}}}]);