"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[2279],{45181:(O,m,s)=>{s.r(m),s.d(m,{default:()=>f});var u=s(15861),p=s(17626),h=s(62208),P=s(10699),E=s(32917),n=(s(63290),s(90912),s(85931),s(26584),s(8314),s(76898)),D=s(69759),d=s(96942);let o=class extends((0,d.Z)(D.Z)){constructor(){var e;super(...arguments),e=this,this.type="imagery-3d",this.redrawDebounced=(0,P.Ds)(function(){var i=(0,u.Z)(function*(a){e.redraw((_,c)=>e._redrawImage(_,c),a)});return function(a){return i.apply(this,arguments)}}(),2e3)}initialize(){this.handles.add([(0,E.gx)(()=>this.view.basemapTerrain.ready,()=>this._initializeMaximumDataResolution(),{once:!0,initial:!0}),this.layer.on("redraw",()=>this.updatingHandles.addPromise(this.redrawDebounced()))]),this.updatingHandles.add(()=>this.layer?.exportImageServiceParameters?.version,()=>{this.updatingHandles.addPromise(this.refreshDebounced())}),this.updatingHandles.add(()=>this.layer?.renderer,()=>{this.updatingHandles.addPromise(this.refreshDebounced())}),this.updatingHandles.add(()=>this.timeExtent,()=>this.updatingHandles.addPromise(this.refreshDebounced()))}_initializeMaximumDataResolution(){this.maximumDataResolution=this.layer.loaded?this.layer.serviceRasterInfo.pixelSize:null}getFetchOptions(){return{timeExtent:this.timeExtent}}processResult(e,i,a){var _=this;return(0,u.Z)(function*(){i.imageOrCanvasElement?e.image=i.imageOrCanvasElement:(e.image=document.createElement("canvas"),e.pixelData=i.pixelData,yield _._redrawImage(e,a))})()}_redrawImage(e,i){var a=this;return(0,u.Z)(function*(){if(!(e.image instanceof HTMLCanvasElement)||(0,h.Wi)(e.pixelData))throw new Error;const _=e.image,c=_.getContext("2d"),v=yield a.layer.applyRenderer(e.pixelData,{signal:i}),l=a.layer.applyFilter(v).pixelBlock;if((0,h.Wi)(l))throw new Error;_.width=l.width,_.height=l.height;const M=c.createImageData(l.width,l.height);M.data.set(l.getAsRGBA()),c.putImageData(M,0,0)})()}};o=(0,p._)([(0,n.j)("esri.views.3d.layers.ImageryLayerView3D")],o);const f=o},10023:(O,m,s)=>{s.d(m,{V:()=>y,e:()=>P});var u=s(15861),p=s(62208),h=s(36630);function P(t){return E.apply(this,arguments)}function E(){return(E=(0,u.Z)(function*(t,r=t.popupTemplate){if((0,p.Wi)(r))return[];const g=yield r.getRequiredFields(t.fieldsIndex),{lastEditInfoEnabled:I}=r,{objectIdField:n,typeIdField:D,globalIdField:d,relationships:o}=t;if(g.includes("*"))return["*"];const f=I?yield(0,h.CH)(t):[],e=(0,h.Q0)(t.fieldsIndex,[...g,...f]);return D&&e.push(D),e&&n&&t.fieldsIndex?.has(n)&&!e.includes(n)&&e.push(n),e&&d&&t.fieldsIndex?.has(d)&&!e.includes(d)&&e.push(d),o&&o.forEach(i=>{const{keyField:a}=i;e&&a&&t.fieldsIndex?.has(a)&&!e.includes(a)&&e.push(a)}),e})).apply(this,arguments)}function y(t,r){return t.popupTemplate?t.popupTemplate:(0,p.pC)(r)&&r.defaultPopupTemplateEnabled&&(0,p.pC)(t.defaultPopupTemplate)?t.defaultPopupTemplate:null}}}]);