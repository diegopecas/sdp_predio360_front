"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[2456],{26268:(C,n,e)=>{e.d(n,{Z:()=>u});var l=e(8314),_=e(39406),p=e(44589),d=e(8650),E=e(13382);const c=(h,t)=>h.key.level-t.key.level!=0?h.key.level-t.key.level:h.key.row-t.key.row!=0?h.key.row-t.key.row:h.key.col-t.key.col;class u extends p.Z{constructor(t){super(),this._tileInfoView=t}get requiresDedicatedFBO(){return!1}renderChildren(t){this.sortChildren(c),this.setStencilReference(t),super.renderChildren(t)}createRenderParams(t){const{state:r}=t,i=super.createRenderParams(t);return i.requiredLevel=this._tileInfoView.getClosestInfoForScale(r.scale).level,i.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(r.scale),i}prepareRenderPasses(t){const r=super.prepareRenderPasses(t);return r.push(t.registerRenderPass({name:"stencil",brushes:[E.Z],drawPhase:_.jx.DEBUG|_.jx.MAP|_.jx.HIGHLIGHT,target:()=>this.getStencilTarget()})),(0,l.Z)("esri-tiles-debug")&&r.push(t.registerRenderPass({name:"tileInfo",brushes:[d.Z],drawPhase:_.jx.DEBUG,target:()=>this.children})),r}getStencilTarget(){return this.children}setStencilReference(t){let r=1;for(const i of this.children)i.stencilRef=r++}}},66806:(C,n,e)=>{e.r(n),e.d(n,{default:()=>T});var l=e(15861),_=e(17626),p=e(63290),d=e(10699),E=e(32917),c=e(77712),t=(e(90912),e(85931),e(76898)),r=e(51815),i=e(91757),M=e(37384),D=e(78209),y=e(13305),U=e(67802),m=e(45611),I=e(17845),R=e(94421),L=e(84537),B=e(94672);let g=class extends((0,I.Z)((0,R.Z)((0,M.y)(m.Z)))){constructor(){super(...arguments),this._highlightGraphics=new r.J,this._updateHash=""}fetchPopupFeatures(s,a){return this._popupHighlightHelper.fetchPopupFeatures(s,a)}update(s){const a=`${this.exportImageVersion}/${s.state.id}/${s.pixelRatio}/${s.stationary}`;this._updateHash!==a&&(this._updateHash=a,this.strategy.update(s).catch(o=>{(0,d.D_)(o)||p.Z.getLogger(this.declaredClass).error(o)}),s.stationary&&this._popupHighlightHelper.updateHighlightedFeatures(s.state.resolution)),this._highlightView.processUpdate(s)}attach(){const{imageMaxWidth:s,imageMaxHeight:a,version:o}=this.layer,P=o>=10.3,f=o>=10;this._bitmapContainer=new i.c,this.container.addChild(this._bitmapContainer),this._highlightView=new D.Z({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new y.Z(this.view.featuresTilingScheme),defaultPointSymbolEnabled:!1}),this.container.addChild(this._highlightView.container),this._popupHighlightHelper=new L.VF({createFetchPopupFeaturesQueryGeometry:(O,v)=>(0,B.K)(O,v,this.view),highlightGraphics:this._highlightGraphics,highlightGraphicUpdated:(O,v)=>{this._highlightView.graphicUpdateHandler({graphic:O,property:v})},layerView:this,updatingHandles:this.updatingHandles}),this.strategy=new U.Z({container:this._bitmapContainer,fetchSource:this.fetchImageBitmap.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:s,imageMaxHeight:a,imageRotationSupported:P,imageNormalizationSupported:f,hidpi:!0}),this.addAttachHandles((0,E.YP)(()=>this.exportImageVersion,()=>this.requestUpdate())),this.requestUpdate()}detach(){this.strategy.destroy(),this.container.removeAllChildren(),this._bitmapContainer.removeAllChildren(),this._highlightView.destroy(),this._popupHighlightHelper.destroy()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}supportsSpatialReference(s){return this.layer.serviceSupportsSpatialReference(s)}doRefresh(){var s=this;return(0,l.Z)(function*(){s._updateHash="",s.requestUpdate()})()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(s,a,o,P){return this.layer.fetchImage(s,a,o,{timeExtent:this.timeExtent,floors:this.floors,...P})}fetchImageBitmap(s,a,o,P){return this.layer.fetchImageBitmap(s,a,o,{timeExtent:this.timeExtent,floors:this.floors,...P})}highlight(s){return this._popupHighlightHelper.highlight(s)}};(0,_._)([(0,c.Cb)()],g.prototype,"strategy",void 0),(0,_._)([(0,c.Cb)()],g.prototype,"updating",void 0),g=(0,_._)([(0,t.j)("esri.views.2d.layers.MapImageLayerView2D")],g);const T=g},94421:(C,n,e)=>{e.d(n,{Z:()=>t});var l=e(17626),_=e(63290),p=e(10699),d=e(32917),E=e(77712),h=(e(90912),e(85931),e(76898));const t=r=>{let i=class extends r{initialize(){this.handles.add((0,d.on)(()=>this.layer,"refresh",M=>{this.doRefresh(M.dataChanged).catch(D=>{(0,p.D_)(D)||_.Z.getLogger(this.declaredClass).error(D)})}),"RefreshableLayerView")}};return(0,l._)([(0,E.Cb)()],i.prototype,"layer",void 0),i=(0,l._)([(0,h.j)("esri.layers.mixins.RefreshableLayerView")],i),i}}}]);