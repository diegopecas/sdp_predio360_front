"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[7986],{128:(J,M,r)=>{r.d(M,{B:()=>R});var n=r(26584),i=r(50011),c=r(22558),j=r(21726),Z=r(35948),B=r(34117),I=r(31283),L=r(77712),b=r(61556),C=r(29840);function R(a){const p=a?.origins??[void 0];return(u,o)=>{const y=function F(a,p,u){if("resource"===a?.type)return function O(a,p,u){const o=(0,B.Oe)(p,u);return{type:String,read:(y,T,x)=>{const E=(0,C.r)(y,T,x);return o.type===String?E:"function"==typeof o.type?new o.type({url:E}):void 0},write:{writer(y,T,x,E){if(!E?.resources)return"string"==typeof y?void(T[x]=(0,C.t)(y,E)):void(T[x]=y.write({},E));const _=function d(a){return null==a?null:"string"==typeof a?a:a.url}(y),w=(0,C.t)(_,{...E,verifyItemRelativeUrls:E?.verifyItemRelativeUrls?{writtenUrls:E.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},C.M.NO),K=o.type!==String&&(!(0,c.l)(this)||E?.origin&&this.originIdOf(u)>(0,I.M9)(E.origin)),N={object:this,propertyName:u,value:y,targetUrl:w,dest:T,targetPropertyName:x,context:E,params:a};E?.portalItem&&w&&!(0,j.YP)(w)?K&&a?.contentAddressed?g(N):K?function D(a){const{context:p,targetUrl:u,params:o,value:y,dest:T,targetPropertyName:x}=a;if(!p.portalItem)return;const E=p.portalItem.resourceFromPath(u),_=m(y,u,p),w=(0,b.B)(_),K=(0,j.Ml)(E.path),N=o?.compress??!1;w===K?(p.resources&&U({...a,resource:E,content:_,compress:N,updates:p.resources.toUpdate}),T[x]=u):g(a)}(N):function S({context:a,targetUrl:p,dest:u,targetPropertyName:o}){a.portalItem&&a.resources&&(a.resources.toKeep.push({resource:a.portalItem.resourceFromPath(p),compress:!1}),u[o]=p)}(N):E?.portalItem&&(null==w||null!=(0,C.i)(w)||(0,j.jc)(w)||K)?g(N):T[x]=w}}}}(a,p,u);switch(a?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:o,write:y}=C.b;return{read:o,write:y}}}}(a,u,o);for(const T of p){const x=(0,L.CJ)(u,T,o);for(const E in y)x[E]=y[E]}}}function g(a){const{targetUrl:p,params:u,value:o,context:y,dest:T,targetPropertyName:x}=a;if(!y.portalItem)return;const E=(0,C.p)(p),_=m(o,p,y);if(u?.contentAddressed&&"json"!==_.type)return void y.messages?.push(new n.Z("persistable:contentAddressingUnsupported",`Property "${x}" is trying to serializing a resource with content of type ${_.type} with content addressing. Content addressing is only supported for json resources.`,{content:_}));const w=u?.contentAddressed&&"json"===_.type?(0,i.F)(_.jsonString):E?.filename??(0,Z.DO)(),K=(0,j.v_)(u?.prefix??E?.prefix,w),N=`${K}.${(0,b.B)(_)}`;if(u?.contentAddressed&&y.resources&&"json"===_.type){const W=y.resources.toKeep.find(({resource:$})=>$.path===N)??y.resources.toAdd.find(({resource:$})=>$.path===N);if(W)return void(T[x]=W.resource.itemRelativeUrl)}const Q=y.portalItem.resourceFromPath(N);(0,j.jc)(p)&&y.resources&&y.resources.pendingOperations.push((0,j.gi)(p).then(W=>{Q.path=`${K}.${(0,b.B)({type:"blob",blob:W})}`,T[x]=Q.itemRelativeUrl}).catch(()=>{}));const z=u?.compress??!1;y.resources&&U({...a,resource:Q,content:_,compress:z,updates:y.resources.toAdd}),T[x]=Q.itemRelativeUrl}function U({object:a,propertyName:p,updates:u,resource:o,content:y,compress:T}){u.push({resource:o,content:y,compress:T,finish:E=>{!function v(a,p,u){"string"==typeof a[p]?a[p]=u.url:a[p].url=u.url}(a,p,E)}})}function m(a,p,u){return"string"==typeof a?{type:"url",url:p}:{type:"json",jsonString:JSON.stringify(a.toJSON(u))}}},47986:(J,M,r)=>{r.r(M),r.d(M,{default:()=>et});var n=r(15861),i=r(17626),c=r(88879),j=r(73281),g=(r(4832),r(68387),r(96794),r(69747),r(40425),r(69357),r(40342),r(73640),r(33474),r(32088)),D=r(84792),S=r(79608),U=r(46160),m=r(26584),d=r(63290),v=r(99959),a=r(10699),p=r(32917),u=r(21726),o=r(77712),x=(r(8314),r(4619),r(52323)),E=r(68653),_=r(76898),w=r(31283),K=r(15453),N=r(72642),Q=r(44917),z=r(68301),W=r(50085),$=r(65088),Oe=r(50107),De=r(6733),je=r(49286),Fe=r(6647),Ue=r(99555),ne=r(42432),Te=r(91522),me=r(38305),xe=r(39593),Re=r(59787),q=r(13812),ve=r(26331),_e=r(83989),Ae=r(47058),Me=r(55911),we=r(60466),ie=r(90194),k=r(35031),ge=r(35391),Ze=r(170),Ie=r(62667),Be=r(2430),Ne=r(30164),ae=r(86810);let H=class extends ae.wq{constructor(){super(...arguments),this.name=null,this.field=null,this.currentRangeExtent=null,this.fullRangeExtent=null,this.type="rangeInfo"}};(0,i._)([(0,o.Cb)({type:String,json:{read:!0,write:!0}})],H.prototype,"name",void 0),(0,i._)([(0,o.Cb)({type:String,json:{read:!0,write:!0}})],H.prototype,"field",void 0),(0,i._)([(0,o.Cb)({type:[Number],json:{read:!0,write:!0}})],H.prototype,"currentRangeExtent",void 0),(0,i._)([(0,o.Cb)({type:[Number],json:{read:!0,write:!0}})],H.prototype,"fullRangeExtent",void 0),(0,i._)([(0,o.Cb)({type:["rangeInfo"],readOnly:!0,json:{read:!1,write:!0}})],H.prototype,"type",void 0),H=(0,i._)([(0,_.j)("esri.layers.support.RangeInfo")],H);var te,Ke=r(58817),We=r(128),be=r(14889),le=r(37118),Ce=r(55915);let pe=te=class extends((0,ae.eC)(U.Z.ofType(le.Z))){constructor(e){super(e)}clone(){return new te(this.items.map(e=>e.clone()))}write(e,s){return this.toJSON(s)}toJSON(e){const s=e?.layer?.spatialReference;return s?this.toArray().map(t=>{if(!s.equals(t.spatialReference)){if(!(0,Ce.canProjectWithoutEngine)(t.spatialReference,s))return e?.messages&&e.messages.push(new be.Z("scenefilter:unsupported","Scene filters with incompatible spatial references are not supported",{modification:this,spatialReference:e.layer.spatialReference,context:e})),null;const h=new le.Z;(0,Ce.projectPolygon)(t,h,s),t=h}const f=t.toJSON(e);return delete f.spatialReference,f}).filter(t=>null!=t):(e?.messages&&e.messages.push(new be.Z("scenefilter:unsupported","Writing Scene filters without context layer is not supported",{modification:this,spatialReference:e.layer.spatialReference,context:e})),this.toArray().map(t=>t.toJSON(e)))}static fromJSON(e,s){const t=new te;return e.forEach(f=>t.add(le.Z.fromJSON(f,s))),t}};pe=te=(0,i._)([(0,_.j)("esri.layers.support.PolygonCollection")],pe);const re=pe;var de,Ge=r(29840);let X=de=class extends ae.wq{constructor(e){super(e),this.spatialRelationship="disjoint",this.geometries=new re,this._geometriesSource=null}initialize(){this.addHandles((0,p.on)(()=>this.geometries,"after-changes",()=>this.geometries=this.geometries,p.Z_))}readGeometries(e,s,t){Array.isArray(e)?this.geometries=re.fromJSON(e,t):this._geometriesSource={url:(0,Ge.f)(e,t),context:t}}loadGeometries(e,s){var t=this;return(0,n.Z)(function*(){if(null==t._geometriesSource)return;const{url:f,context:h}=t._geometriesSource,P=yield(0,D.Z)(f,{responseType:"json",signal:s?.signal}),A=e.toJSON(),G=P.data.map(V=>({...V,spatialReference:A}));t.geometries=re.fromJSON(G,h),t._geometriesSource=null})()}clone(){const e=new de({geometries:(0,Ke.d9)(this.geometries),spatialRelationship:this.spatialRelationship});return e._geometriesSource=this._geometriesSource,e}};(0,i._)([(0,o.Cb)({type:["disjoint","contains"],nonNullable:!0,json:{write:!0}})],X.prototype,"spatialRelationship",void 0),(0,i._)([(0,o.Cb)({type:re,nonNullable:!0,json:{write:!0}}),(0,We.B)({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries",contentAddressed:!0})],X.prototype,"geometries",void 0),(0,i._)([(0,E.r)(["web-scene","portal-item"],"geometries")],X.prototype,"readGeometries",null),X=de=(0,i._)([(0,_.j)("esri.layers.support.SceneFilter")],X);const Qe=X;var ze=r(39683),Ve=r(96854),se=r(60507),Ee=r(35560),Je=r(49430);function ue(){return(ue=(0,n.Z)(function*(e){const s=[];for(const t of e)t.name.toLowerCase().endsWith(".zip")?s.push($e(t)):s.push(Promise.resolve(t));return(yield Promise.all(s)).flat()})).apply(this,arguments)}function $e(e){return ce.apply(this,arguments)}function ce(){return(ce=(0,n.Z)(function*(e){const{BlobReader:s,ZipReader:t,BlobWriter:f}=yield Promise.all([r.e(8592),r.e(3370)]).then(r.bind(r,53370)),h=[];return(yield new t(new s(e)).getEntries()).forEach(A=>{if(A.directory||/^__MACOS/i.test(A.filename))return;const G=new f,V=A.getData?.(G).then(ee=>new File([ee],A.filename));V&&h.push(V)}),Promise.all(h)})).apply(this,arguments)}var Ye=r(42964),Le=r(10023),Xe=r(92236);const qe=new Set(["3DObject","Point"]),Se=(0,Me.v)();let l=class extends((0,Te.G)((0,De.o1)((0,ne.Vt)((0,$.Y)((0,je.q)((0,Fe.I)((0,Ue.M)((0,v.R)((0,Oe.N)((0,W.V)((0,S.J)(Q.Z)))))))))))){constructor(...e){super(...e),this.featureReduction=null,this.rangeInfos=null,this.operationalLayerType="ArcGISSceneServiceLayer",this.type="scene",this.fields=null,this.floorInfo=null,this.outFields=null,this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.excludeObjectIds=new U.Z,this.definitionExpression=null,this.filter=null,this.path=null,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.priority=null,this.semantic=null,this.cachedDrawingInfo={color:!1},this.popupEnabled=!0,this.popupTemplate=null,this.objectIdField=null,this.globalIdField=null,this._fieldUsageInfo={},this.screenSizePerspectiveEnabled=!0,this.serviceItemId=void 0}normalizeCtorArgs(e,s){return"string"==typeof e?{url:e,...s}:e}destroy(){this._set("renderer",null)}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,s){const t=this.getFeatureType(s?.feature)?.domains?.[e];return t&&"inherited"!==t.type?t:this.getField(e)?.domain??null}getFeatureType(e){return e&&this.associatedLayer?this.associatedLayer.getFeatureType(e):null}get types(){return this.associatedLayer?.types??[]}get typeIdField(){return this.associatedLayer?.typeIdField??null}get templates(){return this.associatedLayer?.templates??null}get formTemplate(){return this.associatedLayer?.formTemplate??null}get fieldsIndex(){return new we.Z(this.fields)}readNodePages(e,s,t){return"Point"===s.layerType&&(e=s.pointNodePages),null==e||"object"!=typeof e?null:k.U4.fromJSON(e,t)}set elevationInfo(e){this._set("elevationInfo",e),this.loaded&&this._validateElevationInfo()}get effectiveCapabilities(){return this._capabilitiesFromAssociatedFeatureLayer(this.associatedLayer?.effectiveCapabilities)}get effectiveEditingEnabled(){return null!=this.associatedLayer&&(0,ve.sX)(this.associatedLayer)}get geometryType(){return ke[this.profile]||"mesh"}set renderer(e){(0,ie.YN)(e,this.fieldsIndex),this._set("renderer",e)}readCachedDrawingInfo(e){return null!=e&&"object"==typeof e||(e={}),null==e.color&&(e.color=!1),e}get capabilities(){return this._capabilitiesFromAssociatedFeatureLayer(this.associatedLayer?.capabilities)}_capabilitiesFromAssociatedFeatureLayer(e){e=e??Re.C;const{query:s,queryRelated:t,editing:{supportsGlobalId:f,supportsRollbackOnFailure:h,supportsUploadWithItemId:P,supportsGeometryUpdate:A,supportsReturnServiceEditsInSourceSpatialReference:G},data:{supportsZ:V,supportsM:ee,isVersioned:ye,supportsAttachment:Y},operations:{supportsEditing:fe,supportsAdd:tt,supportsUpdate:rt,supportsDelete:st,supportsQuery:ot,supportsQueryAttachments:nt,supportsAsyncConvert3D:it}}=e,oe=e.operations.supportsChangeTracking,he=!!this.associatedLayer?.infoFor3D&&(0,Ee.Rx)();return{query:s,queryRelated:t,editing:{supportsGlobalId:f,supportsReturnServiceEditsInSourceSpatialReference:G,supportsRollbackOnFailure:h,supportsGeometryUpdate:he&&A,supportsUploadWithItemId:P},data:{supportsAttachment:Y,supportsZ:V,supportsM:ee,isVersioned:ye},operations:{supportsQuery:ot,supportsQueryAttachments:nt,supportsEditing:fe&&oe,supportsAdd:he&&tt&&oe,supportsDelete:he&&st&&oe,supportsUpdate:rt&&oe,supportsAsyncConvert3D:it}}}get editingEnabled(){return this._isOverridden("editingEnabled")?this._get("editingEnabled"):this.associatedLayer?.editingEnabled??!1}set editingEnabled(e){this._overrideIfSome("editingEnabled",e)}get infoFor3D(){return this.associatedLayer?.infoFor3D??null}get relationships(){return this.associatedLayer?.relationships}get defaultPopupTemplate(){return this.associatedLayer||this.attributeStorageInfo?this.createPopupTemplate():null}readObjectIdField(e,s){return!e&&s.fields&&s.fields.some(t=>("esriFieldTypeOID"===t.type&&(e=t.name),!!e)),e||void 0}readGlobalIdField(e,s){return!e&&s.fields&&s.fields.some(t=>("esriFieldTypeGlobalID"===t.type&&(e=t.name),!!e)),e||void 0}get displayField(){return this.associatedLayer?.displayField??null}readProfile(e,s){const t=s.store.profile;return null!=t&&Pe[t]?Pe[t]:(d.Z.getLogger(this).error("Unknown or missing profile",{profile:t,layer:this}),"mesh-pyramids")}load(e){return this.addResolvingPromise(this._load(e)),Promise.resolve(this)}_load(e){var s=this;return(0,n.Z)(function*(){const t=null!=e?e.signal:null;yield s.loadFromPortal({supportedTypes:["Scene Service"]},e).catch(a.r9),yield s._fetchService(t),yield Promise.all([s._fetchIndexAndUpdateExtent(s.nodePages,t),s._setAssociatedFeatureLayer(t),s._loadFilterGeometries()]),s._validateElevationInfo(),s._applyAssociatedLayerOverrides(),s._populateFieldUsageInfo(),yield(0,ze.y)(s,{origin:"service"},t),(0,ie.YN)(s.renderer,s.fieldsIndex),yield s.finishLoadEditablePortalLayer(e)})()}beforeSave(){var e=this;return(0,n.Z)(function*(){null!=e.filter&&(e.filter=e.filter.clone(),yield e.load())})()}_loadFilterGeometries(){var e=this;return(0,n.Z)(function*(){if(e.filter)try{yield e.filter.loadGeometries(e.spatialReference)}catch(s){d.Z.getLogger(e).error("#_loadFilterGeometries()",e,"Failed to load filter geometries. Geometry filter will not be applied for this layer.",{error:s}),e.filter=null}})()}createQuery(){const e=new Ve.Z;return"mesh"!==this.geometryType&&(e.returnGeometry=!0,e.returnZ=!0),e.where=this.definitionExpression||"1=1",e.sqlFormat="standard",e.outFields=["*"],e}queryExtent(e,s){return this._getAssociatedLayerForQuery().then(t=>t.queryExtent(e||this.createQuery(),s))}queryFeatureCount(e,s){return this._getAssociatedLayerForQuery().then(t=>t.queryFeatureCount(e||this.createQuery(),s))}queryFeatures(e,s){return this._getAssociatedLayerForQuery().then(t=>t.queryFeatures(e||this.createQuery(),s)).then(t=>{if(t?.features)for(const f of t.features)f.layer=this,f.sourceLayer=this;return t})}queryRelatedFeatures(e,s){var t=this;return(0,n.Z)(function*(){if(yield t.load(),!t.associatedLayer)throw new m.Z("scenelayer:query-not-available","SceneLayer queries are not available without an associated feature layer",{layer:t});return t.associatedLayer.queryRelatedFeatures(e,s)})()}queryRelatedFeaturesCount(e,s){var t=this;return(0,n.Z)(function*(){if(yield t.load(),!t.associatedLayer)throw new m.Z("scenelayer:query-not-available","SceneLayer queries are not available without an associated feature layer",{layer:t});return t.associatedLayer.queryRelatedFeaturesCount(e,s)})()}queryCachedAttributes(e,s){var t=this;return(0,n.Z)(function*(){const f=(0,ie.Lk)(t.fieldsIndex,yield(0,Le.e7)(t,(0,Le.V5)(t)));return(0,Ye.xe)(t.parsedUrl.path,t.attributeStorageInfo??[],e,s,f,t.apiKey,t.customParameters)})()}queryCachedFeature(e,s){var t=this;return(0,n.Z)(function*(){const f=yield t.queryCachedAttributes(e,[s]);if(!f||0===f.length)throw new m.Z("scenelayer:feature-not-in-cached-data","Feature not found in cached data");const h=new c.Z;return h.attributes=f[0],h.layer=t,h.sourceLayer=t,h})()}queryObjectIds(e,s){return this._getAssociatedLayerForQuery().then(t=>t.queryObjectIds(e||this.createQuery(),s))}queryAttachments(e,s){return this._getAssociatedLayerForQuery().then(t=>t.queryAttachments(e,s))}getFieldUsageInfo(e){const s={supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1};return this.loaded?this._fieldUsageInfo[e]||s:(d.Z.getLogger(this).error("#getFieldUsageInfo()","Unavailable until layer is loaded"),s)}createPopupTemplate(e){return(0,Je.eZ)(this,e)}_getAssociatedLayerForQuery(){const e=this.associatedLayer;return e?.loaded?Promise.resolve(e):this._loadAssociatedLayerForQuery()}_loadAssociatedLayerForQuery(){var e=this;return(0,n.Z)(function*(){if(yield e.load(),!e.associatedLayer)throw new m.Z("scenelayer:query-not-available","SceneLayer queries are not available without an associated feature layer",{layer:e});try{yield e.associatedLayer.load()}catch(s){throw new m.Z("scenelayer:query-not-available","SceneLayer associated feature layer could not be loaded",{layer:e,error:s})}return e.associatedLayer})()}hasCachedStatistics(e){return null!=this.statisticsInfo&&this.statisticsInfo.some(s=>s.name===e)}queryCachedStatistics(e,s){var t=this;return(0,n.Z)(function*(){if(yield t.load(s),!t.statisticsInfo)throw new m.Z("scenelayer:no-cached-statistics","Cached statistics are not available for this layer");const f=t.fieldsIndex.get(e);if(!f)throw new m.Z("scenelayer:field-unexisting",`Field '${e}' does not exist on the layer`);for(const h of t.statisticsInfo)if(h.name===f.name){const P=(0,u.v_)(t.parsedUrl.path,h.href);return(0,D.Z)(P,{query:{f:"json",...t.customParameters,token:t.apiKey},responseType:"json",signal:s?s.signal:null}).then(A=>A.data)}throw new m.Z("scenelayer:no-cached-statistics","Cached statistics for this attribute are not available")})()}saveAs(e,s){var t=this;return(0,n.Z)(function*(){return t._debouncedSaveOperations(ne.xp.SAVE_AS,{...s,getTypeKeywords:()=>t._getTypeKeywords(),portalItemLayerType:"scene"},e)})()}save(){var e=this;return(0,n.Z)(function*(){const s={getTypeKeywords:()=>e._getTypeKeywords(),portalItemLayerType:"scene"};return e._debouncedSaveOperations(ne.xp.SAVE,s)})()}applyEdits(e,s){var t=this;return(0,n.Z)(function*(){const{applyEdits:f}=yield r.e(1e3).then(r.bind(r,81913));let h=s;yield t.load();const P=t.associatedLayer;if(!P)throw new m.Z(`${t.type}-layer:not-editable`,"Service is not editable");yield P.load();const{globalIdField:A}=P,G=!!P.infoFor3D,V=h?.globalIdUsed??!0;if(G&&null==A)throw new m.Z(`${t.type}-layer:not-editable`,"Valid globalIdField expected on editable SceneLayer");if(G&&!V)throw new m.Z(`${t.type}-layer:globalid-required`,"globalIdUsed must not be false for SceneLayer editing as globalIds are required.");return(0,me.M8)(P.url)&&G&&null!=e.deleteFeatures&&null!=A&&(h={...h,globalIdToObjectId:yield(0,ve.HW)(P,e.deleteFeatures,A)}),f(t,P.source,e,h)})()}uploadAssets(e,s){var t=this;return(0,n.Z)(function*(){if(yield t.load(),null==t.associatedLayer)throw new m.Z(`${t.type}-layer:not-editable`,"Service is not editable");return yield t.associatedLayer.load(),t.associatedLayer.uploadAssets(e,s)})()}on(e,s){return super.on(e,s)}convertMesh(e,s){var t=this;return(0,n.Z)(function*(){const f=Y=>{throw d.Z.getLogger(t).error(".convertMesh()",Y.message),Y};yield t.load(),t.infoFor3D||f(new m.Z("invalid:layer","SceneLayer has no capability for mesh conversion"));const h=yield t.extractAndFilterFiles(e),P=h.reduce((Y,fe)=>(0,ge.$z)(t.infoFor3D,fe)?Y+1:Y,0);0===P&&f(new z.Q_),P>1&&f(new z.i1);const G=s?.location??new N.Z({x:0,y:0,z:0,spatialReference:t.spatialReference}),ee=K.Z.createWithExternalSource(G,h,{vertexSpace:G.spatialReference.isGeographic?"local":"georeferenced"}),[ye]=yield t.uploadAssets([ee],s);return ye})()}extractAndFilterFiles(e){var s=this;return(0,n.Z)(function*(){yield s.load();const t=s.infoFor3D;return t?(yield function He(e){return ue.apply(this,arguments)}(e)).filter(f=>(0,ge.F7)(t,f)):e})()}validateLayer(e){if(e.layerType&&!qe.has(e.layerType))throw new m.Z("scenelayer:layer-type-not-supported","SceneLayer does not support this layer type",{layerType:e.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new m.Z("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x, 2.x"});if(this.version.major>2)throw new m.Z("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x, 2.x"});!function s(t,f){let h=!1,P=!1;if(null==t)h=!0,P=!0;else{const A=f&&f.isGeographic;switch(t){case"east-north-up":case"earth-centered":h=!0,P=A;break;case"vertex-reference-frame":h=!0,P=!A;break;default:h=!1}}if(!h)throw new m.Z("scenelayer:unsupported-normal-reference-frame","Normal reference frame is invalid.");if(!P)throw new m.Z("scenelayer:incompatible-normal-reference-frame","Normal reference frame is incompatible with layer spatial reference.")}(this.normalReferenceFrame,this.spatialReference)}_getTypeKeywords(){const e=[];if("points"===this.profile)e.push("Point");else{if("mesh-pyramids"!==this.profile)throw new m.Z("scenelayer:unknown-profile","SceneLayer:save() encountered an unknown SceneLayer profile: "+this.profile);e.push("3DObject")}return e}_populateFieldUsageInfo(){if(this._fieldUsageInfo={},this.fields)for(const e of this.fields){const s=!(!this.attributeStorageInfo||!this.attributeStorageInfo.some(h=>h.name===e.name)),t=!!this.associatedLayer?.fields?.some(h=>h&&e.name===h.name);this._fieldUsageInfo[e.name]={supportsLabelingInfo:s,supportsRenderer:s,supportsPopupTemplate:s||t,supportsLayerQuery:t}}}_applyAssociatedLayerOverrides(){this._applyAssociatedLayerFieldsOverrides(),this._applyAssociatedLayerPopupOverrides(),this._applyAssociatedLayerExtentOverride(),this._applyAssociatedLayerPrivileges()}_applyAssociatedLayerFieldsOverrides(){if(!this.associatedLayer?.fields)return;let e=null;for(const s of this.associatedLayer.fields){const t=this.getField(s.name);t?(!t.domain&&s.domain&&(t.domain=s.domain.clone()),t.editable=s.editable,t.nullable=s.nullable,t.length=s.length):(e||(e=this.fields?this.fields.slice():[]),e.push(s.clone()))}e&&this._set("fields",e)}_applyAssociatedLayerPopupOverrides(){if(!this.associatedLayer)return;const e=["popupTemplate","popupEnabled"],s=(0,x.vw)(this);for(let t=0;t<e.length;t++){const f=e[t],h=this.originIdOf(f),P=this.associatedLayer.originIdOf(f);h<P&&(P===w.s3.SERVICE||P===w.s3.PORTAL_ITEM)&&s.setAtOrigin(f,this.associatedLayer[f],P)}}_applyAssociatedLayerExtentOverride(){const e=this.associatedLayer?.editingInfo?.lastEditDate,s=this.associatedLayer?.serverGens,t=this.associatedLayer?.getAtOrigin("fullExtent","service");!(0,Ee.Rx)()||null==this.associatedLayer?.infoFor3D||!t||!(0,me.M8)(this.associatedLayer?.url)||!e||this.serviceUpdateTimeStamp?.lastUpdate===e.getTime()||!this.serviceUpdateTimeStamp&&s?.minServerGen===s?.serverGen||(0,x.vw)(this).setAtOrigin("fullExtent",t.clone(),w.s3.SERVICE)}_applyAssociatedLayerPrivileges(){const e=this.associatedLayer;e&&(this._set("userHasEditingPrivileges",e.userHasEditingPrivileges),this._set("userHasFullEditingPrivileges",e.userHasFullEditingPrivileges),this._set("userHasUpdateItemPrivileges",e.userHasUpdateItemPrivileges))}_setAssociatedFeatureLayer(e){var s=this;return(0,n.Z)(function*(){if(["mesh-pyramids","points"].includes(s.profile))try{const{serverUrl:t,layerId:f,portalItem:h}=yield(0,xe.w)(`${s.url}/layers/${s.layerId}`,{sceneLayerItem:s.portalItem,customParameters:s.customParameters,apiKey:s.apiKey,signal:e}),P=yield Ne.T.FeatureLayer();s.associatedLayer=new P({url:t,customParameters:s.customParameters,layerId:f,portalItem:h}),yield s.associatedLayer.load()}catch(t){(0,a.D_)(t)||s._logWarningOnPopupEnabled()}})()}_logWarningOnPopupEnabled(){var e=this;return(0,n.Z)(function*(){yield(0,p.N1)(()=>e.popupEnabled&&null!=e.popupTemplate);const s=`this SceneLayer: ${e.title}`;null==e.attributeStorageInfo?d.Z.getLogger(e).warn(`Associated FeatureLayer could not be loaded and no binary attributes found. Popups will not work on ${s}`):d.Z.getLogger(e).info(`Associated FeatureLayer could not be loaded. Falling back to binary attributes for Popups on ${s}`)})()}_validateElevationInfo(){const e=this.elevationInfo;"mesh-pyramids"===this.profile&&(0,se.LR)(d.Z.getLogger(this),(0,se.Wb)("Mesh scene layers","relative-to-scene",e)),(0,se.LR)(d.Z.getLogger(this),(0,se.kf)("Scene layers",e))}};(0,i._)([(0,o.Cb)({types:{key:"type",base:_e.B,typeMap:{selection:Ae.Z}},json:{origins:{"web-scene":{name:"layerDefinition.featureReduction",write:!0},"portal-item":{name:"layerDefinition.featureReduction",write:!0}}}})],l.prototype,"featureReduction",void 0),(0,i._)([(0,o.Cb)({type:[H],json:{read:!1,origins:{"web-scene":{name:"layerDefinition.rangeInfos",write:!0},"portal-item":{name:"layerDefinition.rangeInfos",write:!0}}}})],l.prototype,"rangeInfos",void 0),(0,i._)([(0,o.Cb)({json:{read:!1}})],l.prototype,"associatedLayer",void 0),(0,i._)([(0,o.Cb)({type:["show","hide"]})],l.prototype,"listMode",void 0),(0,i._)([(0,o.Cb)({type:["ArcGISSceneServiceLayer"]})],l.prototype,"operationalLayerType",void 0),(0,i._)([(0,o.Cb)({json:{read:!1},readOnly:!0})],l.prototype,"type",void 0),(0,i._)([(0,o.Cb)({...Se.fields,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],l.prototype,"fields",void 0),(0,i._)([(0,o.Cb)()],l.prototype,"types",null),(0,i._)([(0,o.Cb)()],l.prototype,"typeIdField",null),(0,i._)([(0,o.Cb)()],l.prototype,"templates",null),(0,i._)([(0,o.Cb)()],l.prototype,"formTemplate",null),(0,i._)([(0,o.Cb)({readOnly:!0,clonable:!1})],l.prototype,"fieldsIndex",null),(0,i._)([(0,o.Cb)({type:Be.Z,json:{read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo"}}})],l.prototype,"floorInfo",void 0),(0,i._)([(0,o.Cb)(Se.outFields)],l.prototype,"outFields",void 0),(0,i._)([(0,o.Cb)({type:k.U4,readOnly:!0,json:{read:!1}})],l.prototype,"nodePages",void 0),(0,i._)([(0,E.r)("service","nodePages",["nodePages","pointNodePages"])],l.prototype,"readNodePages",null),(0,i._)([(0,o.Cb)({type:[k.QI],readOnly:!0})],l.prototype,"materialDefinitions",void 0),(0,i._)([(0,o.Cb)({type:[k.Yh],readOnly:!0})],l.prototype,"textureSetDefinitions",void 0),(0,i._)([(0,o.Cb)({type:[k.H3],readOnly:!0})],l.prototype,"geometryDefinitions",void 0),(0,i._)([(0,o.Cb)({readOnly:!0})],l.prototype,"serviceUpdateTimeStamp",void 0),(0,i._)([(0,o.Cb)({readOnly:!0})],l.prototype,"attributeStorageInfo",void 0),(0,i._)([(0,o.Cb)({readOnly:!0})],l.prototype,"statisticsInfo",void 0),(0,i._)([(0,o.Cb)({type:U.Z.ofType(Number),nonNullable:!0,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.excludeObjectIds",write:{enabled:!0}}})],l.prototype,"excludeObjectIds",void 0),(0,i._)([(0,o.Cb)({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],l.prototype,"definitionExpression",void 0),(0,i._)([(0,o.Cb)({type:Qe,json:{name:"layerDefinition.polygonFilter",write:{enabled:!0,allowNull:!0},origins:{service:{read:!1,write:!1}}}})],l.prototype,"filter",void 0),(0,i._)([(0,o.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],l.prototype,"path",void 0),(0,i._)([(0,o.Cb)(q.PV)],l.prototype,"elevationInfo",null),(0,i._)([(0,o.Cb)({readOnly:!0,json:{read:!1}})],l.prototype,"effectiveCapabilities",null),(0,i._)([(0,o.Cb)({readOnly:!0})],l.prototype,"effectiveEditingEnabled",null),(0,i._)([(0,o.Cb)({type:String})],l.prototype,"geometryType",null),(0,i._)([(0,o.Cb)(q.iR)],l.prototype,"labelsVisible",void 0),(0,i._)([(0,o.Cb)({type:[Ze.Z],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:{reader:Ie.r},write:!1}},name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:Ie.r},write:!0}})],l.prototype,"labelingInfo",void 0),(0,i._)([(0,o.Cb)(q.rn)],l.prototype,"legendEnabled",void 0),(0,i._)([(0,o.Cb)({type:Number,json:{origins:{"web-document":{default:1,write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}},read:{source:["opacity","layerDefinition.drawingInfo.transparency"],reader(e,s){if("number"==typeof e&&e>=0&&e<=1)return e;const t=s.layerDefinition?.drawingInfo?.transparency;return void 0!==t?(0,Xe.b)(t):void 0}}},"portal-item":{write:!0},service:{read:!1}}}})],l.prototype,"opacity",void 0),(0,i._)([(0,o.Cb)({type:["Low","High"],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],l.prototype,"priority",void 0),(0,i._)([(0,o.Cb)({type:["Labels"],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],l.prototype,"semantic",void 0),(0,i._)([(0,o.Cb)({types:g.o,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:!0},value:null})],l.prototype,"renderer",null),(0,i._)([(0,o.Cb)({json:{read:!1}})],l.prototype,"cachedDrawingInfo",void 0),(0,i._)([(0,E.r)("service","cachedDrawingInfo")],l.prototype,"readCachedDrawingInfo",null),(0,i._)([(0,o.Cb)({readOnly:!0,json:{read:!1}})],l.prototype,"capabilities",null),(0,i._)([(0,o.Cb)({type:Boolean,json:{read:!1}})],l.prototype,"editingEnabled",null),(0,i._)([(0,o.Cb)({readOnly:!0,json:{write:!1,read:!1}})],l.prototype,"infoFor3D",null),(0,i._)([(0,o.Cb)({readOnly:!0,json:{write:!1,read:!1}})],l.prototype,"relationships",null),(0,i._)([(0,o.Cb)(q.C_)],l.prototype,"popupEnabled",void 0),(0,i._)([(0,o.Cb)({type:j.Z,json:{name:"popupInfo",write:!0}})],l.prototype,"popupTemplate",void 0),(0,i._)([(0,o.Cb)({readOnly:!0,json:{read:!1}})],l.prototype,"defaultPopupTemplate",null),(0,i._)([(0,o.Cb)({type:String,json:{read:!1}})],l.prototype,"objectIdField",void 0),(0,i._)([(0,E.r)("service","objectIdField",["objectIdField","fields"])],l.prototype,"readObjectIdField",null),(0,i._)([(0,o.Cb)({type:String,json:{read:!1}})],l.prototype,"globalIdField",void 0),(0,i._)([(0,E.r)("service","globalIdField",["globalIdField","fields"])],l.prototype,"readGlobalIdField",null),(0,i._)([(0,o.Cb)({readOnly:!0,type:String,json:{read:!1}})],l.prototype,"displayField",null),(0,i._)([(0,o.Cb)({type:String,json:{read:!1}})],l.prototype,"profile",void 0),(0,i._)([(0,E.r)("service","profile",["store.profile"])],l.prototype,"readProfile",null),(0,i._)([(0,o.Cb)({readOnly:!0,type:String,json:{origins:{service:{read:{source:"store.normalReferenceFrame"}}},read:!1}})],l.prototype,"normalReferenceFrame",void 0),(0,i._)([(0,o.Cb)(q.YI)],l.prototype,"screenSizePerspectiveEnabled",void 0),(0,i._)([(0,o.Cb)({json:{read:!1,origins:{service:{read:!0}}}})],l.prototype,"serviceItemId",void 0),l=(0,i._)([(0,_.j)("esri.layers.SceneLayer")],l);const Pe={"mesh-pyramids":"mesh-pyramids",meshpyramids:"mesh-pyramids","features-meshes":"mesh-pyramids",points:"points","features-points":"points",lines:"lines","features-lines":"lines",polygons:"polygons","features-polygons":"polygons"},ke={"mesh-pyramids":"mesh",points:"point",lines:"polyline",polygons:"polygon"},et=l},91522:(J,M,r)=>{r.d(M,{G:()=>R});var n=r(17626),i=r(97478),c=r(20849),j=r(77712),L=(r(8314),r(63290),r(4619),r(76898)),b=r(90194),C=r(73917);const R=F=>{let O=class extends F{get timeInfo(){const g=this.associatedLayer?.timeInfo;if(null==g)return g;const D=g.clone();return(0,b.UF)(D,this.fieldsIndex),D}set timeInfo(g){(0,b.UF)(g,this.fieldsIndex),this._override("timeInfo",g)}get timeExtent(){return this.associatedLayer?.timeExtent}set timeExtent(g){this._override("timeExtent",g)}get timeOffset(){return this.associatedLayer?.timeOffset}set timeOffset(g){this._override("timeOffset",g)}get useViewTime(){return this.associatedLayer?.useViewTime??!0}set useViewTime(g){this._override("useViewTime",g)}get datesInUnknownTimezone(){return this.associatedLayer?.datesInUnknownTimezone??!1}set datesInUnknownTimezone(g){this._override("datesInUnknownTimezone",g)}};return(0,n._)([(0,j.Cb)({type:C.Z})],O.prototype,"timeInfo",null),(0,n._)([(0,j.Cb)({type:i.Z})],O.prototype,"timeExtent",null),(0,n._)([(0,j.Cb)({type:c.Z})],O.prototype,"timeOffset",null),(0,n._)([(0,j.Cb)({type:Boolean,nonNullable:!0})],O.prototype,"useViewTime",null),(0,n._)([(0,j.Cb)({type:Boolean,nonNullable:!0})],O.prototype,"datesInUnknownTimezone",null),O=(0,n._)([(0,L.j)("esri.layers.mixins.TemporalSceneLayer")],O),O}},35031:(J,M,r)=>{r.d(M,{H3:()=>m,QI:()=>F,U4:()=>b,Yh:()=>g});var n=r(17626),i=r(86810),c=r(77712),I=(r(8314),r(63290),r(4619),r(55342)),L=r(76898);let b=class extends i.wq{constructor(){super(...arguments),this.nodesPerPage=null,this.rootIndex=0,this.lodSelectionMetricType=null}};(0,n._)([(0,c.Cb)({type:Number})],b.prototype,"nodesPerPage",void 0),(0,n._)([(0,c.Cb)({type:Number})],b.prototype,"rootIndex",void 0),(0,n._)([(0,c.Cb)({type:String})],b.prototype,"lodSelectionMetricType",void 0),b=(0,n._)([(0,L.j)("esri.layer.support.I3SNodePageDefinition")],b);let C=class extends i.wq{constructor(){super(...arguments),this.factor=1}};(0,n._)([(0,c.Cb)({type:Number,json:{read:{source:"textureSetDefinitionId"}}})],C.prototype,"id",void 0),(0,n._)([(0,c.Cb)({type:Number})],C.prototype,"factor",void 0),C=(0,n._)([(0,L.j)("esri.layer.support.I3SMaterialTexture")],C);let R=class extends i.wq{constructor(){super(...arguments),this.baseColorFactor=[1,1,1,1],this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.metallicFactor=1,this.roughnessFactor=1}};(0,n._)([(0,c.Cb)({type:[Number]})],R.prototype,"baseColorFactor",void 0),(0,n._)([(0,c.Cb)({type:C})],R.prototype,"baseColorTexture",void 0),(0,n._)([(0,c.Cb)({type:C})],R.prototype,"metallicRoughnessTexture",void 0),(0,n._)([(0,c.Cb)({type:Number})],R.prototype,"metallicFactor",void 0),(0,n._)([(0,c.Cb)({type:Number})],R.prototype,"roughnessFactor",void 0),R=(0,n._)([(0,L.j)("esri.layer.support.I3SMaterialPBRMetallicRoughness")],R);let F=class extends i.wq{constructor(){super(...arguments),this.alphaMode="opaque",this.alphaCutoff=.25,this.doubleSided=!1,this.cullFace="none",this.normalTexture=null,this.occlusionTexture=null,this.emissiveTexture=null,this.emissiveFactor=null,this.pbrMetallicRoughness=null}};(0,n._)([(0,I.J)({opaque:"opaque",mask:"mask",blend:"blend"})],F.prototype,"alphaMode",void 0),(0,n._)([(0,c.Cb)({type:Number})],F.prototype,"alphaCutoff",void 0),(0,n._)([(0,c.Cb)({type:Boolean})],F.prototype,"doubleSided",void 0),(0,n._)([(0,I.J)({none:"none",back:"back",front:"front"})],F.prototype,"cullFace",void 0),(0,n._)([(0,c.Cb)({type:C})],F.prototype,"normalTexture",void 0),(0,n._)([(0,c.Cb)({type:C})],F.prototype,"occlusionTexture",void 0),(0,n._)([(0,c.Cb)({type:C})],F.prototype,"emissiveTexture",void 0),(0,n._)([(0,c.Cb)({type:[Number]})],F.prototype,"emissiveFactor",void 0),(0,n._)([(0,c.Cb)({type:R})],F.prototype,"pbrMetallicRoughness",void 0),F=(0,n._)([(0,L.j)("esri.layer.support.I3SMaterialDefinition")],F);let O=class extends i.wq{};(0,n._)([(0,c.Cb)({type:String,json:{read:{source:["name","index"],reader:(d,v)=>d??`${v.index}`}}})],O.prototype,"name",void 0),(0,n._)([(0,I.J)({jpg:"jpg",png:"png",dds:"dds","ktx-etc2":"ktx-etc2",ktx2:"ktx2",basis:"basis"})],O.prototype,"format",void 0),O=(0,n._)([(0,L.j)("esri.layer.support.I3STextureFormat")],O);let g=class extends i.wq{constructor(){super(...arguments),this.atlas=!1}};(0,n._)([(0,c.Cb)({type:[O]})],g.prototype,"formats",void 0),(0,n._)([(0,c.Cb)({type:Boolean})],g.prototype,"atlas",void 0),g=(0,n._)([(0,L.j)("esri.layer.support.I3STextureSetDefinition")],g);let D=class extends i.wq{};(0,n._)([(0,I.J)({Float32:"Float32",UInt64:"UInt64",UInt32:"UInt32",UInt16:"UInt16",UInt8:"UInt8"})],D.prototype,"type",void 0),(0,n._)([(0,c.Cb)({type:Number})],D.prototype,"component",void 0),D=(0,n._)([(0,L.j)("esri.layer.support.I3SGeometryAttribute")],D);let S=class extends i.wq{};(0,n._)([(0,I.J)({draco:"draco"})],S.prototype,"encoding",void 0),(0,n._)([(0,c.Cb)({type:[String]})],S.prototype,"attributes",void 0),S=(0,n._)([(0,L.j)("esri.layer.support.I3SGeometryCompressedAttributes")],S);let U=class extends i.wq{constructor(){super(...arguments),this.offset=0}};(0,n._)([(0,c.Cb)({type:Number})],U.prototype,"offset",void 0),(0,n._)([(0,c.Cb)({type:D})],U.prototype,"position",void 0),(0,n._)([(0,c.Cb)({type:D})],U.prototype,"normal",void 0),(0,n._)([(0,c.Cb)({type:D})],U.prototype,"uv0",void 0),(0,n._)([(0,c.Cb)({type:D})],U.prototype,"color",void 0),(0,n._)([(0,c.Cb)({type:D})],U.prototype,"uvRegion",void 0),(0,n._)([(0,c.Cb)({type:D})],U.prototype,"featureId",void 0),(0,n._)([(0,c.Cb)({type:D})],U.prototype,"faceRange",void 0),(0,n._)([(0,c.Cb)({type:S})],U.prototype,"compressedAttributes",void 0),U=(0,n._)([(0,L.j)("esri.layer.support.I3SGeometryBuffer")],U);let m=class extends i.wq{};(0,n._)([(0,I.J)({triangle:"triangle"})],m.prototype,"topology",void 0),(0,n._)([(0,c.Cb)()],m.prototype,"geometryBuffers",void 0),m=(0,n._)([(0,L.j)("esri.layer.support.I3SGeometryDefinition")],m)},39593:(J,M,r)=>{r.d(M,{w:()=>b});var n=r(15861),i=r(24263),c=r(84792),j=r(26584),Z=r(10699),B=r(38305),I=r(31099),L=r(55463);function b(a,p){return C.apply(this,arguments)}function C(){return C=(0,n.Z)(function*(a,p){const u=(0,B.Qc)(a);if(!u)throw new j.Z("invalid-url","Invalid scene service url");const o={...p,sceneServerUrl:u.url.path,layerId:u.sublayer??void 0};if(o.sceneLayerItem??=(yield function R(a){return F.apply(this,arguments)}(o)),null==o.sceneLayerItem)return U(o.sceneServerUrl.replace("/SceneServer","/FeatureServer"),o);const y=yield function d(a){return v.apply(this,arguments)}(o);if(!y?.url)throw new j.Z("related-service-not-found","Could not find feature service through portal item relationship");o.featureServiceItem=y;const T=yield U(y.url,o);return T.portalItem=y,T}),C.apply(this,arguments)}function F(){return F=(0,n.Z)(function*(a){const p=(yield O(a)).serviceItemId;if(!p)return null;const u=new L.default({id:p,apiKey:a.apiKey}),o=yield function D(a){return S.apply(this,arguments)}(a);null!=o&&(u.portal=new I.Z({url:o}));try{return u.load({signal:a.signal})}catch(y){return(0,Z.r9)(y),null}}),F.apply(this,arguments)}function O(a){return g.apply(this,arguments)}function g(){return(g=(0,n.Z)(function*(a){if(a.rootDocument)return a.rootDocument;const p={query:{f:"json",...a.customParameters,token:a.apiKey},responseType:"json",signal:a.signal};try{const u=yield(0,c.Z)(a.sceneServerUrl,p);a.rootDocument=u.data}catch{a.rootDocument={}}return a.rootDocument})).apply(this,arguments)}function S(){return(S=(0,n.Z)(function*(a){const p=i.id?.findServerInfo(a.sceneServerUrl);if(p?.owningSystemUrl)return p.owningSystemUrl;const u=a.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const o=(yield(0,c.Z)(u,{query:{f:"json"},responseType:"json",signal:a.signal})).data.owningSystemUrl;if(o)return o}catch(o){(0,Z.r9)(o)}return null})).apply(this,arguments)}function U(a,p){return m.apply(this,arguments)}function m(){return(m=(0,n.Z)(function*(a,p){const u=(0,B.Qc)(a);if(!u)throw new j.Z("invalid-feature-service-url","Invalid feature service url");const o=u.url.path,y=p.layerId;if(null==y)return{serverUrl:o};const T=O(p),x=p.featureServiceItem?yield p.featureServiceItem.fetchData("json"):null,E=(x?.layers?.[0]||x?.tables?.[0])?.customParameters,_=W=>{const $={query:{f:"json",...E},responseType:"json",authMode:W,signal:p.signal};return(0,c.Z)(o,$)},w=_("anonymous").catch(()=>_("no-prompt")),[K,N]=yield Promise.all([w,T]),Q=N?.layers,z=K.data&&K.data.layers;if(!Array.isArray(z))throw new Error("expected layers array");if(Array.isArray(Q)){for(let W=0;W<Math.min(Q.length,z.length);W++)if(Q[W].id===y)return{serverUrl:o,layerId:z[W].id}}else if(null!=y&&y<z.length)return{serverUrl:o,layerId:z[y].id};throw new Error("could not find matching associated sublayer")})).apply(this,arguments)}function v(){return(v=(0,n.Z)(function*({sceneLayerItem:a,signal:p}){if(!a)return null;try{const u=(yield a.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:p})).find(y=>"Feature Service"===y.type)||null;if(!u)return null;const o=new L.default({portal:u.portal,id:u.id});return yield o.load(),o}catch(u){return(0,Z.r9)(u),null}})).apply(this,arguments)}},59787:(J,M,r)=>{r.d(M,{C:()=>n});const n={analytics:{supportsCacheHint:!1},attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1,supportsCacheHint:!1,supportsResize:!1},data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsAsyncApplyEdits:!1,zDefault:void 0},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1,supportsAsyncConvert3D:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsCompactGeometry:!1,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByAnonymous:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsStatistics:!1,tileMaxRecordCount:0}}},35391:(J,M,r)=>{r.d(M,{$6:()=>m,$z:()=>c,F7:()=>i,Ow:()=>I,S0:()=>B,d1:()=>L,dm:()=>b});const n=[["binary","application/octet-stream","bin",""]];function i(d,v){return null!=O(v.name,d?.supportedFormats??[])}function c(d,v){if(!d)return!1;const a=b(v,d.supportedFormats??[]);return null!=a&&d.editFormats.includes(a)}function B(d,v){return g(function F(d,v){const a=d.toLowerCase();return C(v).find(p=>D(p)===a)}(d,v))}function I(d,v){return g(O(d,v))}function L(d,v){return D(function R(d,v){return C(v).find(a=>g(a)===d)}(d,v))}function b(d,v){return I(d.name,v)??B(d.type,v)}function C(d){return[...n,...d]}function O(d,v){const a=d.toLowerCase();return C(v).find(p=>function S(d){return d?.[2].split(",").map(v=>v.toLowerCase())??[]}(p).some(u=>a.endsWith(u)))}function g(d){return d?.[0]}function D(d){return d?.[1].toLowerCase()}function m(d){return d.tables?.find(v=>"assetMaps"===v.role)}},61556:(J,M,r)=>{r.d(M,{B:()=>i});var n=r(21726);function i(b){return Z[function c(b){return"json"===b.type?"application/json":"blob"===b.type?b.blob.type:function j(b){const C=(0,n.Ml)(b);return L[C]||B}(b.url)}(b)]||I}const Z={},B="text/plain",I=Z[B],L={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const b in L)Z[L[b]]=b},10023:(J,M,r)=>{r.d(M,{V5:()=>Z,e7:()=>c,zc:()=>B});var n=r(15861),i=r(90194);function c(I){return j.apply(this,arguments)}function j(){return(j=(0,n.Z)(function*(I,L=I.popupTemplate){if(null==L)return[];const b=yield L.getRequiredFields(I.fieldsIndex),{lastEditInfoEnabled:C}=L,{objectIdField:R,typeIdField:F,globalIdField:O,relationships:g}=I;if(b.includes("*"))return["*"];const D=C?(0,i.CH)(I):[],S=(0,i.Q0)(I.fieldsIndex,[...b,...D]);return F&&S.push(F),S&&R&&I.fieldsIndex?.has(R)&&!S.includes(R)&&S.push(R),S&&O&&I.fieldsIndex?.has(O)&&!S.includes(O)&&S.push(O),g&&g.forEach(U=>{const{keyField:m}=U;S&&m&&I.fieldsIndex?.has(m)&&!S.includes(m)&&S.push(m)}),S})).apply(this,arguments)}function Z(I,L){return I.popupTemplate?I.popupTemplate:null!=L&&L.defaultPopupTemplateEnabled&&null!=I.defaultPopupTemplate?I.defaultPopupTemplate:null}function B(I,L){return null!=Z(I,{defaultPopupTemplateEnabled:L})}}}]);