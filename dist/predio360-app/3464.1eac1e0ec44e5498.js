"use strict";(self.webpackChunkpredio360_app=self.webpackChunkpredio360_app||[]).push([[3464],{14259:(ee,V,_)=>{_.d(V,{q:()=>N});var g,j,L={};g={get exports(){return L},set exports(K){L=K}},void 0!==(j=function(){function O(n,a,l,c,x){for(;c>l;){if(c-l>600){var h=c-l+1,m=a-l+1,P=Math.log(h),R=.5*Math.exp(2*P/3),C=.5*Math.sqrt(P*R*(h-R)/h)*(m-h/2<0?-1:1);O(n,a,Math.max(l,Math.floor(a-m*R/h+C)),Math.min(c,Math.floor(a+(h-m)*R/h+C)),x)}var U=n[a],T=l,S=c;for(F(n,l,a),x(n[c],U)>0&&F(n,l,c);T<S;){for(F(n,T,S),T++,S--;x(n[T],U)<0;)T++;for(;x(n[S],U)>0;)S--}0===x(n[l],U)?F(n,l,S):F(n,++S,c),S<=a&&(l=S+1),a<=S&&(c=S-1)}}function F(n,a,l){var c=n[a];n[a]=n[l],n[l]=c}function o(n,a){return n<a?-1:n>a?1:0}return function K(n,a,l,c,x){O(n,a,l||0,c||n.length-1,x||o)}}())&&(g.exports=j);const N=L},77044:(ee,V,_)=>{_.d(V,{Y:()=>j});var g=_(62208);function w(o,n){return o?n?4:3:n?3:2}function j(o,n,a,l,c){if((0,g.Wi)(n)||!n.lengths.length)return null;const x="upperLeft"===c?.originPosition?-1:1;o.lengths.length&&(o.lengths.length=0),o.coords.length&&(o.coords.length=0);const h=o.coords,m=[],P=a?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:R,coords:C}=n,U=w(a,l);let T=0;for(const S of R){const B=L(P,C,T,S,a,l,x);B&&m.push(B),T+=S*U}if(m.sort((S,B)=>{let Z=x*S[2]-x*B[2];return 0===Z&&a&&(Z=S[4]-B[4]),Z}),m.length){let S=6*m[0][2];h[0]=m[0][0]/S,h[1]=m[0][1]/S,a&&(S=6*m[0][4],h[2]=0!==S?m[0][3]/S:0),(h[0]<P[0]||h[0]>P[1]||h[1]<P[2]||h[1]>P[3]||a&&(h[2]<P[4]||h[2]>P[5]))&&(h.length=0)}if(!h.length){const S=n.lengths[0]?function I(o,n,a,l,c){const x=w(l,c);let h=n,m=n+x,P=0,R=0,C=0,U=0;for(let T=0,S=a-1;T<S;T++,h+=x,m+=x){const B=o[h],Z=o[h+1],H=o[h+2],G=o[m],p=o[m+1],f=o[m+2],E=l?K(B,Z,H,G,p,f):N(B,Z,G,p);if(E)if(P+=E,l){const v=F(B,Z,H,G,p,f);R+=E*v[0],C+=E*v[1],U+=E*v[2]}else{const v=O(B,Z,G,p);R+=E*v[0],C+=E*v[1]}}return P>0?l?[R/P,C/P,U/P]:[R/P,C/P]:a>0?l?[o[n],o[n+1],o[n+2]]:[o[n],o[n+1]]:null}(C,0,R[0],a,l):null;if(!S)return null;h[0]=S[0],h[1]=S[1],a&&S.length>2&&(h[2]=S[2])}return o}function L(o,n,a,l,c,x,h=1){const m=w(c,x);let P=a,R=a+m,C=0,U=0,T=0,S=0,B=0;for(let H=0,G=l-1;H<G;H++,P+=m,R+=m){const p=n[P],f=n[P+1],E=n[P+2],v=n[R],Q=n[R+1],e=n[R+2];let r=p*Q-v*f;S+=r,C+=(p+v)*r,U+=(f+Q)*r,c&&(r=p*e-v*E,T+=(E+e)*r,B+=r),p<o[0]&&(o[0]=p),p>o[1]&&(o[1]=p),f<o[2]&&(o[2]=f),f>o[3]&&(o[3]=f),c&&(E<o[4]&&(o[4]=E),E>o[5]&&(o[5]=E))}if(S*h>0&&(S*=-1),B*h>0&&(B*=-1),!S)return null;const Z=[C,U,.5*S];return c&&(Z[3]=T,Z[4]=.5*B),Z}function N(o,n,a,l){const c=a-o,x=l-n;return Math.sqrt(c*c+x*x)}function K(o,n,a,l,c,x){const h=l-o,m=c-n,P=x-a;return Math.sqrt(h*h+m*m+P*P)}function O(o,n,a,l){return[o+.5*(a-o),n+.5*(l-n)]}function F(o,n,a,l,c,x){return[o+.5*(l-o),n+.5*(c-n),a+.5*(x-a)]}},58175:(ee,V,_)=>{_.d(V,{q:()=>v});var g=_(15861),w=_(85931),j=_(26584),L=_(58817),I=_(62208),N=_(1036),K=_(10699),O=_(16730),F=_(5548),o=_(65401),n=_(32442),a=_(91179),l=_(93555),c=_(37053),x=_(82054),h=_(50736),m=_(82959),P=_(87757),R=_(83308),C=_(53023),U=_(76530),T=_(6185),S=_(60466),B=_(46679),Z=_(87091);const G="feature-store:unsupported-query",f=new N.WJ(2e6);let E=0;class v{constructor(e){this._geometryQueryCache=null,this._changeHandle=null,this.capabilities={query:P.g},this.geometryType=e.geometryType,this.hasM=!!e.hasM,this.hasZ=!!e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache()),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new N.Xq(E+++"$$",f)),this.fieldsIndex=new S.Z(e.fields),e.scheduler&&e.priority&&(this._frameTask=e.scheduler.registerTask(e.priority))}destroy(){this._frameTask=(0,I.hw)(this._frameTask),this.clearCache(),(0,I.SC)(this._geometryQueryCache),this._changeHandle=(0,I.hw)(this._changeHandle),(0,I.SC)(this.fieldsIndex)}get featureAdapter(){return this.featureStore.featureAdapter}clearCache(){this._geometryQueryCache?.clear(),this._allFeaturesPromise=null,this._timeExtentPromise=null}executeQuery(e,r){var t=this;return(0,g.Z)(function*(){try{return(yield t._executeQuery(e,{},r)).createQueryResponse()}catch(i){if(i!==T.vF)throw i;return new R.y([],e,t).createQueryResponse()}})()}executeQueryForCount(e={},r){var t=this;return(0,g.Z)(function*(){try{return(yield t._executeQuery(e,{returnGeometry:!1,returnCentroid:!1,outSR:null},r)).createQueryResponseForCount()}catch(i){if(i!==T.vF)throw i;return 0}})()}executeQueryForExtent(e,r){var t=this;return(0,g.Z)(function*(){const i=e.outSR;try{const s=yield t._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},r),u=s.size;return u?{count:u,extent:yield t._getBounds(s.items,s.spatialReference,i||t.spatialReference)}:{count:0,extent:null}}catch(s){if(s===T.vF)return{count:0,extent:null};throw s}})()}executeQueryForIds(e,r){var t=this;return(0,g.Z)(function*(){return t.executeQueryForIdSet(e,r).then(i=>Array.from(i))})()}executeQueryForIdSet(e,r){var t=this;return(0,g.Z)(function*(){try{const i=yield t._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},r),s=i.items,u=new Set;return yield t._reschedule(()=>{for(const d of s)u.add(i.featureAdapter.getObjectId(d))},r),u}catch(i){if(i===T.vF)return new Set;throw i}})()}executeQueryForSnapping(e,r){var t=this;return(0,g.Z)(function*(){const{point:i,distance:s,types:u}=e;if(u===R.r.NONE)return{candidates:[]};const d=yield t._reschedule(()=>t._checkQuerySupport(e.query),r),y=!(0,c.fS)(i.spatialReference,t.spatialReference);y&&(yield(0,m._W)(i.spatialReference,t.spatialReference));const A="number"==typeof s?s:s.x,M="number"==typeof s?s:s.y,D={xmin:i.x-A,xmax:i.x+A,ymin:i.y-M,ymax:i.y+M,spatialReference:i.spatialReference},b=y?(0,m.iV)(D,t.spatialReference):D;if(!b)return{candidates:[]};const J=(yield(0,l.aX)((0,a.im)(i),null,{signal:r}))[0],X=(yield(0,l.aX)((0,a.im)(b),null,{signal:r}))[0];if((0,I.Wi)(J)||(0,I.Wi)(X))return{candidates:[]};const q=new R.y(yield t._reschedule(()=>t._searchFeatures(t._getQueryBBoxes(X.toJSON())),r),d,t);yield t._reschedule(()=>t._executeObjectIdsQuery(q),r),yield t._reschedule(()=>t._executeTimeQuery(q),r),yield t._reschedule(()=>t._executeAttributesQuery(q),r);const W=J.toJSON(),$=y?(0,m.iV)(W,t.spatialReference):W,k=y?Math.max(b.xmax-b.xmin,b.ymax-b.ymin)/2:s;return q.createSnappingResponse({...e,point:$,distance:k},i.spatialReference)})()}executeQueryForLatestObservations(e,r){var t=this;return(0,g.Z)(function*(){if(!t.timeInfo||!t.timeInfo.trackIdField)throw new j.Z(G,"Missing timeInfo or timeInfo.trackIdField",{query:e,timeInfo:t.timeInfo});try{const i=yield t._executeQuery(e,{},r);return yield t._reschedule(()=>t._filterLatest(i),r),i.createQueryResponse()}catch(i){if(i!==T.vF)throw i;return new R.y([],e,t).createQueryResponse()}})()}executeQueryForSummaryStatistics(e={},r,t){var i=this;return(0,g.Z)(function*(){const{field:s,normalizationField:u,valueExpression:d}=r;return(yield i._getQueryEngineResultForStats(e,{field:s,normalizationField:u,valueExpression:d},t)).createSummaryStatisticsResponse(r)})()}executeQueryForUniqueValues(e={},r,t){var i=this;return(0,g.Z)(function*(){const{field:s,field2:u,field3:d,valueExpression:y}=r;return(yield i._getQueryEngineResultForStats(e,{field:s,field2:u,field3:d,valueExpression:y},t)).createUniqueValuesResponse(r)})()}executeQueryForClassBreaks(e={},r,t){var i=this;return(0,g.Z)(function*(){const{field:s,normalizationField:u,valueExpression:d}=r;return(yield i._getQueryEngineResultForStats(e,{field:s,normalizationField:u,valueExpression:d},t)).createClassBreaksResponse(r)})()}executeQueryForHistogram(e={},r,t){var i=this;return(0,g.Z)(function*(){const{field:s,normalizationField:u,valueExpression:d}=r;return(yield i._getQueryEngineResultForStats(e,{field:s,normalizationField:u,valueExpression:d},t)).createHistogramResponse(r)})()}fetchRecomputedExtents(e){var r=this;return(0,g.Z)(function*(){const[t,i]=yield Promise.all(["getFullExtent"in r.featureStore&&r.featureStore.getFullExtent?Promise.resolve(r.featureStore.getFullExtent(r.spatialReference)):r._getBounds(yield r._getAllFeatures(),r.spatialReference,r.spatialReference),(0,I.pC)(r._timeExtentPromise)?r._timeExtentPromise:r._timeExtentPromise=(0,U.R)(r.timeInfo,r.featureStore)]);return(0,K.k_)(e),{fullExtent:t,timeExtent:i}})()}_getBounds(e,r,t){var i=this;return(0,g.Z)(function*(){const s=(0,F.t8)((0,F.Ue)(),F.Gv);yield i.featureStore.forEachBounds(e,y=>(0,F.TC)(s,y));const u={xmin:s[0],ymin:s[1],xmax:s[3],ymax:s[4],spatialReference:(0,T.S2)(i.spatialReference)};i.hasZ&&isFinite(s[2])&&isFinite(s[5])&&(u.zmin=s[2],u.zmax=s[5]);const d=(0,m.iV)(u,r,t);if(d.spatialReference=(0,T.S2)(t),d.xmax-d.xmin==0){const y=(0,O.c9)(d.spatialReference);d.xmin-=y,d.xmax+=y}if(d.ymax-d.ymin==0){const y=(0,O.c9)(d.spatialReference);d.ymin-=y,d.ymax+=y}if(i.hasZ&&null!=d.zmin&&null!=d.zmax&&d.zmax-d.zmin==0){const y=(0,O.c9)(d.spatialReference);d.zmin-=y,d.zmax+=y}return d})()}_schedule(e,r){var t=this;return(0,g.Z)(function*(){return(0,I.pC)(t._frameTask)?t._frameTask.schedule(e,r):e(Z.G5)})()}_reschedule(e,r){var t=this;return(0,g.Z)(function*(){return(0,I.pC)(t._frameTask)?t._frameTask.reschedule(e,r):e(Z.G5)})()}_getAllFeaturesQueryEngineResult(e){var r=this;return(0,g.Z)(function*(){return new R.y(yield r._getAllFeatures(),e,r)})()}_getAllFeatures(){var e=this;return(0,g.Z)(function*(){if((0,I.Wi)(e._allFeaturesPromise)){const i=[];e._allFeaturesPromise=(0,g.Z)(function*(){yield e.featureStore.forEach(s=>i.push(s))})().then(()=>i)}const r=e._allFeaturesPromise,t=yield r;return r===e._allFeaturesPromise?t.slice():e._getAllFeatures()})()}_executeQuery(e,r,t){var i=this;return(0,g.Z)(function*(){e=(0,L.d9)(e),e=yield i._schedule(()=>(0,T.Up)(e,i.definitionExpression,i.spatialReference),t),e=yield i._reschedule(()=>i._checkQuerySupport(e),t),e={...e,...r};const s=yield i._reschedule(()=>i._executeSceneFilterQuery(e,t),t),u=yield i._reschedule(()=>i._executeGeometryQuery(e,s,t),t);return yield i._reschedule(()=>i._executeAggregateIdsQuery(u),t),yield i._reschedule(()=>i._executeObjectIdsQuery(u),t),yield i._reschedule(()=>i._executeTimeQuery(u),t),yield i._reschedule(()=>i._executeAttributesQuery(u),t),u})()}_executeSceneFilterQuery(e,r){var t=this;return(0,g.Z)(function*(){if((0,I.Wi)(e.sceneFilter))return null;const{outSR:i,returnGeometry:s,returnCentroid:u}=e,d=t.featureStore.featureSpatialReference,y=e.sceneFilter.geometry,A=(0,I.Wi)(d)||(0,c.fS)(d,y.spatialReference)?y:(0,m.iV)(y,d);if(!A)return null;const M=s||u,D=(0,c.JY)(i)&&!(0,c.fS)(t.spatialReference,i)&&M?function(){var W=(0,g.Z)(function*($){return t._project($,i)});return function($){return W.apply(this,arguments)}}():W=>W,b=t.featureAdapter,J=yield t._reschedule(()=>t._searchFeatures(t._getQueryBBoxes(A)),r);if("disjoint"===e.sceneFilter.spatialRelationship){if(!J.length)return null;const W=new Set;for(const te of J)W.add(b.getObjectId(te));const $=yield t._reschedule(()=>t._getAllFeatures(),r);return D(yield t._reschedule((0,g.Z)(function*(){const te=yield(0,C.cW)("esriSpatialRelDisjoint",A,t.geometryType,t.hasZ,t.hasM),z=yield t._runSpatialFilter($,Y=>!W.has(b.getObjectId(Y))||te(b.getGeometry(Y)),r);return new R.y(z,e,t)}),r))}if(!J.length)return new R.y([],e,t);if(t._canExecuteSinglePass(A,e))return D(new R.y(J,e,t));const X=yield(0,C.cW)("esriSpatialRelContains",A,t.geometryType,t.hasZ,t.hasM),q=yield t._runSpatialFilter(J,W=>X(b.getGeometry(W)),r);return D(new R.y(q,e,t))})()}_executeGeometryQuery(e,r,t){var i=this;return(0,g.Z)(function*(){if((0,I.pC)(r)&&0===r.items.length)return r;e=(0,I.pC)(r)?r.query:e;const{geometry:s,outSR:u,spatialRel:d,returnGeometry:y,returnCentroid:A}=e,M=i.featureStore.featureSpatialReference,D=!s||(0,I.Wi)(M)||(0,c.fS)(M,s.spatialReference)?s:(0,m.iV)(s,M),b=y||A,J=(0,c.JY)(u)&&!(0,c.fS)(i.spatialReference,u),X=i._geometryQueryCache&&(0,I.Wi)(r)?JSON.stringify(J&&b?{originalFilterGeometry:s,spatialRelationship:d,outSpatialReference:u}:{originalFilterGeometry:s,spatialRelationship:d}):null,q=X?i._geometryQueryCache.get(X):null;if((0,I.pC)(q))return new R.y(q,e,i);const W=function(){var z=(0,g.Z)(function*(Y){return J&&b&&(yield i._project(Y,u)),X&&i._geometryQueryCache.put(X,Y.items,Y.items.length+1),Y});return function(se){return z.apply(this,arguments)}}();if(!D)return W((0,I.pC)(r)?r:yield i._getAllFeaturesQueryEngineResult(e));const $=i.featureAdapter;let k=yield i._reschedule(()=>i._searchFeatures(i._getQueryBBoxes(s)),t);if("esriSpatialRelDisjoint"===d){if(!k.length)return W((0,I.pC)(r)?r:yield i._getAllFeaturesQueryEngineResult(e));const z=new Set;for(const ie of k)z.add($.getObjectId(ie));const Y=(0,I.pC)(r)?r.items:yield i._reschedule(()=>i._getAllFeatures(),t);return W(yield i._reschedule((0,g.Z)(function*(){const ie=yield(0,C.cW)(d,D,i.geometryType,i.hasZ,i.hasM),ae=yield i._runSpatialFilter(Y,ne=>!z.has($.getObjectId(ne))||ie($.getGeometry(ne)),t);return new R.y(ae,e,i)}),t))}if((0,I.pC)(r)){const z=new w.SO;k=k.filter(Y=>(0,w.cq)(r.items,Y,r.items.length,z)>=0)}if(!k.length){const z=new R.y([],e,i);return X&&i._geometryQueryCache.put(X,z.items,1),z}if(i._canExecuteSinglePass(D,e))return W(new R.y(k,e,i));const te=yield(0,C.cW)(d,D,i.geometryType,i.hasZ,i.hasM),re=yield i._runSpatialFilter(k,z=>te($.getGeometry(z)),t);return W(new R.y(re,e,i))})()}_executeAggregateIdsQuery(e){if(0===e.items.length||!e.query.aggregateIds||!e.query.aggregateIds.length||(0,I.Wi)(this.aggregateAdapter))return;const r=new Set;for(const i of e.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(i).forEach(s=>r.add(s));const t=this.featureAdapter.getObjectId;e.items=e.items.filter(i=>r.has(t(i)))}_executeObjectIdsQuery(e){if(0===e.items.length||!e.query.objectIds||!e.query.objectIds.length)return;const r=new Set(e.query.objectIds),t=this.featureAdapter.getObjectId;e.items=e.items.filter(i=>r.has(t(i)))}_executeTimeQuery(e){if(0===e.items.length)return;const r=(0,U.y)(this.timeInfo,e.query.timeExtent,this.featureAdapter);(0,I.Wi)(r)||(e.items=e.items.filter(r))}_executeAttributesQuery(e){if(0===e.items.length)return;const r=(0,h.Jc)(e.query.where,this.fieldsIndex);if(r){if(!r.isStandardized)throw new TypeError("Where clause is not standardized");e.items=e.items.filter(t=>r.testFeature(t,this.featureAdapter))}}_runSpatialFilter(e,r,t){var i=this;return(0,g.Z)(function*(){if(!r)return e;if((0,I.Wi)(i._frameTask))return e.filter(y=>r(y));let s=0;const u=new Array,d=function(){var y=(0,g.Z)(function*(A){for(;s<e.length;){const M=e[s++];r(M)&&(u.push(M),A.madeProgress()),A.done&&(yield i._reschedule(D=>d(D),t))}});return function(M){return y.apply(this,arguments)}}();return i._reschedule(y=>d(y),t).then(()=>u)})()}_filterLatest(e){const{trackIdField:r,startTimeField:t,endTimeField:i}=this.timeInfo,s=i||t,u=new Map,d=this.featureAdapter.getAttribute;for(const y of e.items){const A=d(y,r),M=d(y,s),D=u.get(A);(!D||M>d(D,s))&&u.set(A,y)}e.items=Array.from(u.values())}_canExecuteSinglePass(e,r){const{spatialRel:t}=r;return(0,C.hN)(e)&&("esriSpatialRelEnvelopeIntersects"===t||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===t||"esriSpatialRelContains"===t||"esriSpatialRelWithin"===t))}_project(e,r){var t=this;return(0,g.Z)(function*(){if(!r||(0,c.fS)(t.spatialReference,r))return e;const i=t.featureAdapter,s=yield(0,m.oj)(e.items.map(u=>(0,T.Op)(t.geometryType,t.hasZ,t.hasM,i.getGeometry(u))),t.spatialReference,r);return e.items=s.map((u,d)=>i.cloneWithGeometry(e.items[d],(0,x.GH)(u,t.hasZ,t.hasM))),e})()}_getQueryBBoxes(e){if((0,C.hN)(e)){if((0,a.YX)(e))return[(0,o.al)(e.xmin,e.ymin,e.xmax,e.ymax)];if((0,a.oU)(e))return e.rings.map(r=>(0,o.al)(Math.min(r[0][0],r[2][0]),Math.min(r[0][1],r[2][1]),Math.max(r[0][0],r[2][0]),Math.max(r[0][1],r[2][1])))}return[(0,n.$P)((0,o.Ue)(),e)]}_searchFeatures(e){var r=this;return(0,g.Z)(function*(){const t=new Set;yield Promise.all(e.map(s=>r.featureStore.forEachInBounds(s,u=>t.add(u))));const i=Array.from(t.values());return t.clear(),i})()}_checkStatisticsSupport(e,r){var t=this;return(0,g.Z)(function*(){if((e.distance??0)<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text||e.outStatistics||e.groupByFieldsForStatistics||e.having||e.orderByFields)throw new j.Z(G,"Unsupported query options",{query:e});return t._checkAttributesQuerySupport(e),Promise.all([t._checkStatisticsParamsSupport(r),(0,C.P0)(e,t.geometryType,t.spatialReference),(0,m._W)(t.spatialReference,e.outSR)]).then(()=>e)})()}_checkStatisticsParamsSupport(e){var r=this;return(0,g.Z)(function*(){let t=[];if(e.valueExpression){const{arcadeUtils:i}=yield(0,B.LC)();t=i.extractFieldNames(e.valueExpression)}if(e.field&&t.push(e.field),e.field2&&t.push(e.field2),e.field3&&t.push(e.field3),e.normalizationField&&t.push(e.normalizationField),!t.length)throw new j.Z(G,"params should have at least a field or valueExpression",{params:e});(0,h.Of)(r.fieldsIndex,t,"params contains missing fields")})()}_checkQuerySupport(e){var r=this;return(0,g.Z)(function*(){if((e.distance??0)<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new j.Z(G,"Unsupported query options",{query:e});return r._checkAttributesQuerySupport(e),r._checkStatisticsQuerySupport(e),Promise.all([(0,C.P0)(e,r.geometryType,r.spatialReference),(0,m._W)(r.spatialReference,e.outSR)]).then(()=>e)})()}_checkAttributesQuerySupport(e){const{outFields:r,orderByFields:t,returnDistinctValues:i,outStatistics:s}=e,u=s?s.map(d=>d.outStatisticFieldName&&d.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(t&&t.length>0){const d=" asc",y=" desc",A=t.map(M=>{const D=M.toLowerCase();return D.includes(d)?D.split(d)[0]:D.includes(y)?D.split(y)[0]:M}).filter(M=>!u.includes(M));(0,h.Of)(this.fieldsIndex,A,"orderByFields contains missing fields")}if(r&&r.length>0)(0,h.Of)(this.fieldsIndex,r,"outFields contains missing fields");else if(i)throw new j.Z(G,"outFields should be specified for returnDistinctValues",{query:e});(0,h.hO)(this.fieldsIndex,e.where)}_checkStatisticsQuerySupport(e){const{outStatistics:r,groupByFieldsForStatistics:t,having:i}=e,s=t&&t.length,u=r&&r.length;if(i){if(!s||!u)throw new j.Z(G,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:e});(0,h.z4)(this.fieldsIndex,i,r)}if(u){if(!function H(Q){return null!=Q&&Q.every(e=>"exceedslimit"!==e.statisticType)}(r))return;const d=r.map(y=>y.onStatisticField).filter(Boolean);(0,h.Of)(this.fieldsIndex,d,"onStatisticFields contains missing fields"),s&&(0,h.Of)(this.fieldsIndex,t,"groupByFieldsForStatistics contains missing fields");for(const y of r){const{onStatisticField:A,statisticType:M}=y;if("percentile_disc"!==M&&"percentile_cont"!==M||!("statisticParameters"in y)){if("count"!==M&&A&&(0,h.G3)(A,this.fieldsIndex))throw new j.Z(G,"outStatistics contains non-numeric fields",{definition:y,query:e})}else{const{statisticParameters:D}=y;if(!D)throw new j.Z(G,"statisticParamters should be set for percentile type",{definition:y,query:e})}}}}_getQueryEngineResultForStats(e,r,t){var i=this;return(0,g.Z)(function*(){e=(0,L.d9)(e);try{e=yield i._schedule(()=>(0,T.Up)(e,i.definitionExpression,i.spatialReference),t),e=yield i._reschedule(()=>i._checkStatisticsSupport(e,r),t);const s=yield i._reschedule(()=>i._executeSceneFilterQuery(e,t),t),u=yield i._reschedule(()=>i._executeGeometryQuery(e,s,t),t);return yield i._reschedule(()=>i._executeAggregateIdsQuery(u),t),yield i._reschedule(()=>i._executeObjectIdsQuery(u),t),yield i._reschedule(()=>i._executeTimeQuery(u),t),yield i._reschedule(()=>i._executeAttributesQuery(u),t),u}catch(s){if(s!==T.vF)throw s;return new R.y([],e,i)}})()}}},87757:(ee,V,_)=>{_.d(V,{g:()=>g});const g={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},53023:(ee,V,_)=>{_.d(V,{hN:()=>G,P0:()=>Z,cW:()=>B});var g=_(15861),w=_(26584),j=_(33190),L=_(11519),N=_(91179),K=_(37053);function O(p,f){return p?f?4:3:f?3:2}function n(p,f,E,v,Q){if(!p)return!1;const e=O(f,E),{coords:r,lengths:t}=p;let i=!1,s=0;for(const u of t)i=a(i,r,e,s,u,v,Q),s+=u*e;return i}function a(p,f,E,v,Q,e,r){let t=p,i=v;for(let s=v,u=v+Q*E;s<u;s+=E){i=s+E,i===u&&(i=v);const d=f[s],y=f[s+1],M=f[i+1];(y<r&&M>=r||M<r&&y>=r)&&d+(r-y)/(M-y)*(f[i]-d)<e&&(t=!t)}return t}var l=_(82054),c=_(88071),x=_(82959),h=_(6185);const m="feature-store:unsupported-query",P={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},R={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};function B(p,f,E,v,Q){if((0,N.oU)(f)&&"esriGeometryPoint"===E&&("esriSpatialRelIntersects"===p||"esriSpatialRelContains"===p)){const e=(0,l.Uy)(new c.Z,f,!1,!1);return Promise.resolve(r=>function F(p,f,E,v){return n(p,f,E,v.coords[0],v.coords[1])}(e,!1,!1,r))}if((0,N.oU)(f)&&"esriGeometryMultipoint"===E){const e=(0,l.Uy)(new c.Z,f,!1,!1);if("esriSpatialRelContains"===p)return Promise.resolve(r=>function o(p,f,E,v,Q,e){const r=O(Q,e),{coords:t,lengths:i}=v;if(!i)return!1;for(let s=0,u=0;s<i.length;s++,u+=r)if(!n(p,f,E,t[u],t[u+1]))return!1;return!0}(e,!1,!1,r,v,Q))}if((0,N.YX)(f)&&"esriGeometryPoint"===E&&("esriSpatialRelIntersects"===p||"esriSpatialRelContains"===p))return Promise.resolve(e=>(0,j.aV)(f,(0,h.Op)(E,v,Q,e)));if((0,N.YX)(f)&&"esriGeometryMultipoint"===E&&"esriSpatialRelContains"===p)return Promise.resolve(e=>(0,j.lQ)(f,(0,h.Op)(E,v,Q,e)));if((0,N.YX)(f)&&"esriSpatialRelIntersects"===p){const e=function I(p){return"mesh"===p?L.h_:(0,L.IY)(p)}(E);return Promise.resolve(r=>e(f,(0,h.Op)(E,v,Q,r)))}return function S(){return Promise.all([_.e(4918),_.e(8592)]).then(_.bind(_,32825))}().then(e=>{const r=e[P[p]].bind(null,f.spatialReference,f);return t=>r((0,h.Op)(E,v,Q,t))})}function Z(p,f,E){return H.apply(this,arguments)}function H(){return(H=(0,g.Z)(function*(p,f,E){const{spatialRel:v,geometry:Q}=p;if(Q){if(!function C(p){return null!=p&&!0===R.spatialRelationship[p]}(v))throw new w.Z(m,"Unsupported query spatial relationship",{query:p});if((0,K.JY)(Q.spatialReference)&&(0,K.JY)(E)){if(!function U(p){return null!=p&&!0===R.queryGeometry[(0,N.Ji)(p)]}(Q))throw new w.Z(m,"Unsupported query geometry type",{query:p});if(!function T(p){return null!=p&&!0===R.layerGeometry[p]}(f))throw new w.Z(m,"Unsupported layer geometry type",{query:p});if(p.outSR)return(0,x._W)(p.geometry&&p.geometry.spatialReference,p.outSR)}}})).apply(this,arguments)}function G(p){if((0,N.YX)(p))return!0;if((0,N.oU)(p)){for(const f of p.rings)if(5!==f.length||f[0][0]!==f[1][0]||f[0][0]!==f[4][0]||f[2][0]!==f[3][0]||f[0][1]!==f[3][1]||f[0][1]!==f[4][1]||f[1][1]!==f[2][1])return!1;return!0}return!1}},76530:(ee,V,_)=>{_.d(V,{R:()=>w,y:()=>L});var g=_(15861);function w(O,F){return j.apply(this,arguments)}function j(){return(j=(0,g.Z)(function*(O,F){if(!O)return null;const o=F.featureAdapter,{startTimeField:n,endTimeField:a}=O;let l=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY;if(n&&a)yield F.forEach(x=>{const h=o.getAttribute(x,n),m=o.getAttribute(x,a);null==h||isNaN(h)||(l=Math.min(l,h)),null==m||isNaN(m)||(c=Math.max(c,m))});else{const x=n||a;yield F.forEach(h=>{const m=o.getAttribute(h,x);null==m||isNaN(m)||(l=Math.min(l,m),c=Math.max(c,m))})}return{start:l,end:c}})).apply(this,arguments)}function L(O,F,o){if(!F||!O)return null;const{startTimeField:n,endTimeField:a}=O;if(!n&&!a)return null;const{start:l,end:c}=F;return null===l&&null===c?null:void 0===l&&void 0===c?()=>!1:n&&a?function I(O,F,o,n,a){return null!=n&&null!=a?l=>{const c=O.getAttribute(l,F),x=O.getAttribute(l,o);return(null==c||c<=a)&&(null==x||x>=n)}:null!=n?l=>{const c=O.getAttribute(l,o);return null==c||c>=n}:null!=a?l=>{const c=O.getAttribute(l,F);return null==c||c<=a}:void 0}(o,n,a,l,c):function N(O,F,o,n){return null!=o&&null!=n&&o===n?a=>O.getAttribute(a,F)===o:null!=o&&null!=n?a=>{const l=O.getAttribute(a,F);return l>=o&&l<=n}:null!=o?a=>O.getAttribute(a,F)>=o:null!=n?a=>O.getAttribute(a,F)<=n:void 0}(o,n||a,l,c)}}}]);